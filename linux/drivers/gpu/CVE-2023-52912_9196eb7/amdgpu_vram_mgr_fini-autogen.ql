/**
 * @name linux-9196eb7c52e55749a332974f0081f77d53d60199-amdgpu_vram_mgr_fini
 * @id cpp/linux/9196eb7c52e55749a332974f0081f77d53d60199/amdgpu-vram-mgr-fini
 * @description linux-9196eb7c52e55749a332974f0081f77d53d60199-drivers/gpu/drm/amd/amdgpu/amdgpu_vram_mgr.c-amdgpu_vram_mgr_fini CVE-2023-52912
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vrsv_872, PointerFieldAccess target_0) {
	target_0.getTarget().getName()="blocks"
	and target_0.getQualifier().(VariableAccess).getTarget()=vrsv_872
}

from Function func, Variable vrsv_872, PointerFieldAccess target_0
where
func_0(vrsv_872, target_0)
and vrsv_872.getType().hasName("amdgpu_vram_reservation *")
and vrsv_872.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
