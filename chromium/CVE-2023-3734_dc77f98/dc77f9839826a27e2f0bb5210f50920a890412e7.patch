commit dc77f9839826a27e2f0bb5210f50920a890412e7	dc77f9839826a27e2f0bb5210f50920a890412e7
Author: Tommy Steimel <steimel@chromium.org>
Date:   Fri Jun 2 18:00:17 2023 +0000

    pip2: Always elide the URL in the titlebar
    
    This CL ensures that the URL in a document picture-in-picture window is
    always elided, even when the user has selected "Always Show Full URLs"
    in the omnibox.
    
    Bug: 1450376
    Change-Id: I6275e0ff9d3a9a860e5e4086732d717c47bdc3fc
    Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/4581312
    Commit-Queue: Tommy Steimel <steimel@chromium.org>
    Reviewed-by: Scott Violet <sky@chromium.org>
    Cr-Commit-Position: refs/heads/main@{#1152637}

diff --git a/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.cc b/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.cc
index 11037b5990cc3..48d3eff9583e5 100644
--- a/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.cc
+++ b/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.cc
@@ -587,6 +587,12 @@ bool PictureInPictureBrowserFrameView::GetURL(GURL* url) const {
   return false;
 }
 
+bool PictureInPictureBrowserFrameView::ShouldPreventElision() {
+  // We should never allow the full URL to show, as the PiP window only cares
+  // about the origin of the opener.
+  return false;
+}
+
 bool PictureInPictureBrowserFrameView::ShouldTrimDisplayUrlAfterHostName()
     const {
   // We need to set the window title URL to be eTLD+1.
diff --git a/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.h b/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.h
index e731140f9c0ea..d61e2179be1fd 100644
--- a/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.h
+++ b/chrome/browser/ui/views/frame/picture_in_picture_browser_frame_view.h
@@ -87,6 +87,7 @@ class PictureInPictureBrowserFrameView
   // ChromeLocationBarModelDelegate:
   content::WebContents* GetActiveWebContents() const override;
   bool GetURL(GURL* url) const override;
+  bool ShouldPreventElision() override;
   bool ShouldTrimDisplayUrlAfterHostName() const override;
   bool ShouldDisplayURL() const override;
 
