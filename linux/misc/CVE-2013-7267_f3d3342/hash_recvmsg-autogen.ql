/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-hash_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/hash-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-crypto/algif_hash.c-hash_recvmsg CVE-2013-7269
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable verr_157, VariableAccess target_0) {
	target_0.getTarget()=verr_157
	and target_0.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_1(Variable vsk_153, Initializer target_1) {
	target_1.getExpr().(FunctionCall).getTarget().hasName("alg_sk")
	and target_1.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_153
}

predicate func_2(Variable vask_154, Initializer target_2) {
	target_2.getExpr().(PointerFieldAccess).getTarget().getName()="private"
	and target_2.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vask_154
}

predicate func_3(Function func, Initializer target_3) {
	target_3.getExpr().(FunctionCall).getTarget().hasName("crypto_ahash_digestsize")
	and target_3.getExpr().(FunctionCall).getArgument(0) instanceof FunctionCall
	and target_3.getExpr().getEnclosingFunction() = func
}

predicate func_4(Parameter vlen_151, Variable vds_156, ExprStmt target_76, VariableAccess target_4) {
	target_4.getTarget()=vlen_151
	and vlen_151.getIndex() = 3
	and target_4.getParent().(GTExpr).getLesserOperand().(VariableAccess).getTarget()=vds_156
	and target_4.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_76
}

predicate func_5(Parameter vlen_151, Variable vds_156, ExprStmt target_55, VariableAccess target_5) {
	target_5.getTarget()=vlen_151
	and vlen_151.getIndex() = 3
	and target_5.getParent().(LTExpr).getGreaterOperand().(VariableAccess).getTarget()=vds_156
	and target_5.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_55
}

predicate func_6(Variable vctx_155, FunctionCall target_6) {
	target_6.getTarget().hasName("ahash_request_set_crypt")
	and not target_6.getTarget().hasName("skb_free_datagram")
	and target_6.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="req"
	and target_6.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_6.getArgument(1) instanceof Literal
	and target_6.getArgument(2).(PointerFieldAccess).getTarget().getName()="result"
	and target_6.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_6.getArgument(3) instanceof Literal
}

predicate func_7(Variable vctx_155, Variable verr_157, VariableAccess target_7) {
	target_7.getTarget()=verr_157
	and target_7.getParent().(AssignExpr).getLValue() = target_7
	and target_7.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("af_alg_wait_for_completion")
	and target_7.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("crypto_ahash_final")
	and target_7.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="req"
	and target_7.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_7.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="completion"
	and target_7.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
}

/*predicate func_8(Variable vctx_155, Variable verr_157, FunctionCall target_8) {
	target_8.getTarget().hasName("af_alg_wait_for_completion")
	and not target_8.getTarget().hasName("__ipx_bind")
	and target_8.getArgument(0).(FunctionCall).getTarget().hasName("crypto_ahash_final")
	and target_8.getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="req"
	and target_8.getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_8.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="completion"
	and target_8.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_8.getParent().(AssignExpr).getRValue() = target_8
	and target_8.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_157
}

*/
predicate func_9(Parameter vmsg_151, Parameter vlen_151, Variable vctx_155, Variable verr_157, VariableAccess target_9) {
	target_9.getTarget()=verr_157
	and target_9.getParent().(AssignExpr).getLValue() = target_9
	and target_9.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("memcpy_toiovec")
	and target_9.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="msg_iov"
	and target_9.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_9.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="result"
	and target_9.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_9.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vlen_151
}

/*predicate func_10(Parameter vmsg_151, Parameter vlen_151, Variable vctx_155, Variable verr_157, FunctionCall target_10) {
	target_10.getTarget().hasName("memcpy_toiovec")
	and not target_10.getTarget().hasName("skb_copy_datagram_iovec")
	and target_10.getArgument(0).(PointerFieldAccess).getTarget().getName()="msg_iov"
	and target_10.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_10.getArgument(1).(PointerFieldAccess).getTarget().getName()="result"
	and target_10.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_10.getArgument(2).(VariableAccess).getTarget()=vlen_151
	and target_10.getParent().(AssignExpr).getRValue() = target_10
	and target_10.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_157
}

*/
predicate func_11(Variable verr_157, VariableAccess target_11) {
	target_11.getTarget()=verr_157
}

predicate func_13(Variable vsk_153) {
exists(FunctionCall target_13 |
	target_13.getTarget().hasName("ipx_sk")
	and target_13.getArgument(0).(VariableAccess).getTarget()=vsk_153)
}

predicate func_18(BlockStmt target_77, Function func) {
exists(NotExpr target_18 |
	target_18.getOperand().(PointerFieldAccess).getTarget().getName()="port"
	and target_18.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipx_sock *")
	and target_18.getParent().(IfStmt).getThen()=target_77
	and target_18.getEnclosingFunction() = func)
}

predicate func_19(Function func) {
exists(AssignExpr target_19 |
	target_19.getLValue().(ValueFieldAccess).getTarget().getName()="sipx_port"
	and target_19.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx")
	and target_19.getRValue() instanceof Literal
	and target_19.getEnclosingFunction() = func)
}

predicate func_20(Function func) {
exists(AssignExpr target_20 |
	target_20.getLValue().(ValueFieldAccess).getTarget().getName()="sipx_network"
	and target_20.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx")
	and target_20.getRValue() instanceof Literal
	and target_20.getEnclosingFunction() = func)
}

predicate func_21(Parameter vmsg_151) {
exists(UnaryMinusExpr target_21 |
	target_21.getValue()="-100"
	and target_21.getParent().(AssignExpr).getRValue() = target_21
	and target_21.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_21.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151)
}

predicate func_22(ExprStmt target_76, Function func) {
exists(NotExpr target_22 |
	target_22.getOperand().(PointerFieldAccess).getTarget().getName()="intrfc"
	and target_22.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipx_sock *")
	and target_22.getParent().(IfStmt).getThen()=target_76
	and target_22.getEnclosingFunction() = func)
}

predicate func_23(RelationalOperation target_78, Function func) {
exists(GotoStmt target_23 |
	target_23.getName() ="out"
	and target_23.getParent().(IfStmt).getCondition()=target_78
	and target_23.getEnclosingFunction() = func)
}

predicate func_24(PointerFieldAccess target_68, Function func) {
exists(ExprStmt target_24 |
	target_24.getExpr().(FunctionCall).getTarget().hasName("memcpy")
	and target_24.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="sipx_node"
	and target_24.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx")
	and target_24.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="if_node"
	and target_24.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="intrfc"
	and target_24.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipx_sock *")
	and target_24.getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="6"
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(5)=target_24
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_68
	and target_24.getEnclosingFunction() = func)
}

predicate func_26(Function func) {
exists(AddressOfExpr target_26 |
	target_26.getOperand().(VariableAccess).getType().hasName("sockaddr_ipx")
	and target_26.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_26.getEnclosingFunction() = func)
}

predicate func_27(Function func) {
exists(SizeofTypeOperator target_27 |
	target_27.getType() instanceof LongType
	and target_27.getValue()="16"
	and target_27.getEnclosingFunction() = func)
}

predicate func_28(ExprStmt target_79, Function func) {
exists(ExprStmt target_28 |
	target_28.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_28.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-107"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
	and target_28.getLocation().isBefore(target_79.getLocation()))
}

/*predicate func_30(Variable verr_157) {
exists(UnaryMinusExpr target_30 |
	target_30.getValue()="-107"
	and target_30.getParent().(AssignExpr).getRValue() = target_30
	and target_30.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_157)
}

*/
predicate func_31(Variable vsk_153, ExprStmt target_55, ExprStmt target_79) {
exists(FunctionCall target_31 |
	target_31.getTarget().hasName("sock_flag")
	and target_31.getArgument(0).(VariableAccess).getTarget()=vsk_153
	and target_31.getParent().(IfStmt).getThen()=target_55
	and target_31.getArgument(0).(VariableAccess).getLocation().isBefore(target_79.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_32(RelationalOperation target_78, Function func) {
exists(GotoStmt target_32 |
	target_32.getName() ="out"
	and target_32.getParent().(IfStmt).getParent().(IfStmt).getElse().(IfStmt).getThen()=target_32
	and target_32.getParent().(IfStmt).getParent().(IfStmt).getCondition()=target_78
	and target_32.getEnclosingFunction() = func)
}

predicate func_33(Parameter vflags_151, Variable vsk_153, IfStmt target_80, ExprStmt target_79, Function func) {
exists(ExprStmt target_33 |
	target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("sk_buff *")
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_153
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="-65"
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_151
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_33
	and target_33.getLocation().isBefore(target_80.getLocation())
	and target_79.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_34(IfStmt target_80, Function func) {
exists(IfStmt target_34 |
	target_34.getCondition().(NotExpr).getOperand().(VariableAccess).getType().hasName("sk_buff *")
	and target_34.getThen().(GotoStmt).getName() ="out"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_34
	and target_34.getLocation().isBefore(target_80.getLocation()))
}

predicate func_35(IfStmt target_80, Function func) {
exists(ExprStmt target_35 |
	target_35.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("ipxhdr *")
	and target_35.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ipx_hdr")
	and target_35.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("sk_buff *")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
	and target_35.getLocation().isBefore(target_80.getLocation()))
}

predicate func_36(IfStmt target_80, Function func) {
exists(ExprStmt target_36 |
	target_36.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("__builtin_constant_p")
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ipx_pktsize"
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipxhdr *")
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getThen().(BitwiseOrExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="8"
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getThen().(BitwiseOrExpr).getRightOperand().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="8"
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("__fswab16")
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ipx_pktsize"
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipxhdr *")
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(SizeofTypeOperator).getValue()="30"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
	and target_36.getLocation().isBefore(target_80.getLocation()))
}

/*predicate func_37(Function func) {
exists(PointerFieldAccess target_37 |
	target_37.getTarget().getName()="ipx_pktsize"
	and target_37.getQualifier().(VariableAccess).getType().hasName("ipxhdr *")
	and target_37.getEnclosingFunction() = func)
}

*/
predicate func_38(IfStmt target_80, Function func) {
exists(IfStmt target_38 |
	target_38.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("int")
	and target_38.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("size_t")
	and target_38.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_38.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("size_t")
	and target_38.getThen().(BlockStmt).getStmt(1) instanceof ExprStmt
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
	and target_38.getLocation().isBefore(target_80.getLocation()))
}

/*predicate func_40(Function func) {
exists(AssignExpr target_40 |
	target_40.getLValue().(VariableAccess).getType().hasName("int")
	and target_40.getRValue().(VariableAccess).getType().hasName("size_t")
	and target_40.getEnclosingFunction() = func)
}

*/
predicate func_41(Parameter vmsg_151, IfStmt target_80, ExprStmt target_81, Function func) {
exists(ExprStmt target_41 |
	target_41.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("sk_buff *")
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(SizeofTypeOperator).getType() instanceof LongType
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(SizeofTypeOperator).getValue()="30"
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_41
	and target_41.getLocation().isBefore(target_80.getLocation())
	and target_81.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_43(Function func) {
exists(SizeofTypeOperator target_43 |
	target_43.getType() instanceof LongType
	and target_43.getValue()="30"
	and target_43.getEnclosingFunction() = func)
}

*/
predicate func_45(IfStmt target_80, Function func) {
exists(IfStmt target_45 |
	target_45.getCondition().(VariableAccess).getType().hasName("int")
	and target_45.getThen().(GotoStmt).getName() ="out_free"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_45
	and target_45.getLocation().isBefore(target_80.getLocation()))
}

predicate func_46(Variable vsk_153, IfStmt target_80, FunctionCall target_82, Function func) {
exists(IfStmt target_46 |
	target_46.getCondition().(ValueFieldAccess).getTarget().getName()="tv64"
	and target_46.getCondition().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="tstamp"
	and target_46.getCondition().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sk_buff *")
	and target_46.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sk_stamp"
	and target_46.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_153
	and target_46.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="tstamp"
	and target_46.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sk_buff *")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
	and target_46.getLocation().isBefore(target_80.getLocation())
	and target_82.getArgument(0).(VariableAccess).getLocation().isBefore(target_46.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_47(Variable vsk_153, FunctionCall target_82) {
exists(AssignExpr target_47 |
	target_47.getLValue().(PointerFieldAccess).getTarget().getName()="sk_stamp"
	and target_47.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_153
	and target_47.getRValue().(PointerFieldAccess).getTarget().getName()="tstamp"
	and target_47.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sk_buff *")
	and target_82.getArgument(0).(VariableAccess).getLocation().isBefore(target_47.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_48(Parameter vmsg_151, IfStmt target_80, Function func) {
exists(IfStmt target_48 |
	target_48.getCondition().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sipx_family"
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="4"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sipx_port"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="sock"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ipx_source"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipxhdr *")
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("memcpy")
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="sipx_node"
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getTarget().getName()="node"
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ipx_source"
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipxhdr *")
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="6"
	and target_48.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sipx_network"
	and target_48.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="ipx_source_net"
	and target_48.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sipx_type"
	and target_48.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="ipx_type"
	and target_48.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ipxhdr *")
	and target_48.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sipx_zero"
	and target_48.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ipx *")
	and target_48.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_48.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_48.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_48.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofExprOperator).getValue()="16"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
	and target_48.getLocation().isBefore(target_80.getLocation()))
}

predicate func_49(IfStmt target_80, Function func) {
exists(ExprStmt target_49 |
	target_49.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_49.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
	and target_49.getLocation().isBefore(target_80.getLocation()))
}

predicate func_50(Variable vsk_153, ExprStmt target_84, ExprStmt target_85, Function func) {
exists(ExprStmt target_50 |
	target_50.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
	and target_50.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_153
	and target_50.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("sk_buff *")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_50
	and target_50.getLocation().isBefore(target_84.getLocation())
	and target_50.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_85.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_54(Parameter vmsg_151, PointerFieldAccess target_54) {
	target_54.getTarget().getName()="msg_namelen"
	and target_54.getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_54.getParent().(AssignExpr).getLValue() = target_54
	and target_54.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_55(Parameter vmsg_151, RelationalOperation target_78, ExprStmt target_55) {
	target_55.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
	and target_55.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_55.getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
	and target_55.getParent().(IfStmt).getParent().(IfStmt).getCondition()=target_78
}

predicate func_56(Variable vsk_153, VariableAccess target_56) {
	target_56.getTarget()=vsk_153
	and target_56.getParent().(FunctionCall).getParent().(Initializer).getExpr().(FunctionCall).getTarget().hasName("alg_sk")
}

predicate func_64(Variable vctx_155, FunctionCall target_64) {
	target_64.getTarget().hasName("crypto_ahash_reqtfm")
	and target_64.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="req"
	and target_64.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_64.getParent().(FunctionCall).getParent().(Initializer).getExpr().(FunctionCall).getTarget().hasName("crypto_ahash_digestsize")
}

predicate func_65(Variable vds_156, ExprStmt target_76, VariableAccess target_65) {
	target_65.getTarget()=vds_156
	and target_65.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_76
}

predicate func_66(Parameter vlen_151, Variable vds_156, AssignExpr target_66) {
	target_66.getLValue().(VariableAccess).getTarget()=vlen_151
	and target_66.getRValue().(VariableAccess).getTarget()=vds_156
}

predicate func_67(Parameter vlen_151, Variable vds_156, ExprStmt target_55, RelationalOperation target_67) {
	 (target_67 instanceof GTExpr or target_67 instanceof LTExpr)
	and target_67.getLesserOperand().(VariableAccess).getTarget()=vlen_151
	and target_67.getGreaterOperand().(VariableAccess).getTarget()=vds_156
	and target_67.getParent().(IfStmt).getThen()=target_55
}

predicate func_68(Variable vctx_155, PointerFieldAccess target_68) {
	target_68.getTarget().getName()="more"
	and target_68.getQualifier().(VariableAccess).getTarget()=vctx_155
}

predicate func_69(Variable vctx_155, AssignExpr target_69) {
	target_69.getLValue().(PointerFieldAccess).getTarget().getName()="more"
	and target_69.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_69.getRValue() instanceof Literal
}

predicate func_70(Variable vctx_155, PointerFieldAccess target_70) {
	target_70.getTarget().getName()="req"
	and target_70.getQualifier().(VariableAccess).getTarget()=vctx_155
}

predicate func_71(Variable vctx_155, AddressOfExpr target_88, VariableAccess target_71) {
	target_71.getTarget()=vctx_155
	and target_71.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_71.getLocation().isBefore(target_88.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_72(Variable vctx_155, AddressOfExpr target_90, PointerFieldAccess target_72) {
	target_72.getTarget().getName()="req"
	and target_72.getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_72.getQualifier().(VariableAccess).getLocation().isBefore(target_90.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_73(Variable vctx_155, PointerFieldAccess target_73) {
	target_73.getTarget().getName()="completion"
	and target_73.getQualifier().(VariableAccess).getTarget()=vctx_155
}

predicate func_74(Variable vctx_155, AddressOfExpr target_90, VariableAccess target_74) {
	target_74.getTarget()=vctx_155
	and target_74.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_90.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_74.getLocation())
}

predicate func_75(Parameter vlen_151, Variable verr_157, ConditionalExpr target_75) {
	target_75.getCondition().(VariableAccess).getTarget()=verr_157
	and target_75.getElse().(VariableAccess).getTarget()=vlen_151
}

predicate func_76(Function func, ExprStmt target_76) {
	target_76.getExpr() instanceof AssignExpr
	and target_76.getEnclosingFunction() = func
}

predicate func_77(Variable verr_157, BlockStmt target_77) {
	target_77.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
	and target_77.getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
	and target_77.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_157
	and target_77.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and target_77.getStmt(3).(IfStmt).getCondition().(VariableAccess).getTarget()=verr_157
	and target_77.getStmt(3).(IfStmt).getThen().(GotoStmt).getName() ="unlock"
}

predicate func_78(Parameter vlen_151, Variable vds_156, RelationalOperation target_78) {
	 (target_78 instanceof GTExpr or target_78 instanceof LTExpr)
	and target_78.getGreaterOperand().(VariableAccess).getTarget()=vlen_151
	and target_78.getLesserOperand().(VariableAccess).getTarget()=vds_156
}

predicate func_79(Variable vsk_153, ExprStmt target_79) {
	target_79.getExpr().(FunctionCall).getTarget().hasName("lock_sock")
	and target_79.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_153
}

predicate func_80(Variable vctx_155, Variable verr_157, IfStmt target_80) {
	target_80.getCondition().(PointerFieldAccess).getTarget().getName()="more"
	and target_80.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_80.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
	and target_80.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
	and target_80.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_157
	and target_80.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and target_80.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(VariableAccess).getTarget()=verr_157
	and target_80.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(GotoStmt).getName() ="unlock"
}

predicate func_81(Parameter vmsg_151, ExprStmt target_81) {
	target_81.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_81.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_151
	and target_81.getExpr().(AssignExpr).getRValue() instanceof Literal
}

predicate func_82(Variable vsk_153, FunctionCall target_82) {
	target_82.getTarget().hasName("alg_sk")
	and target_82.getArgument(0).(VariableAccess).getTarget()=vsk_153
}

predicate func_84(Variable verr_157, ExprStmt target_84) {
	target_84.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_157
	and target_84.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_85(Variable vsk_153, ExprStmt target_85) {
	target_85.getExpr().(FunctionCall).getTarget().hasName("release_sock")
	and target_85.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_153
}

predicate func_88(Variable vctx_155, AddressOfExpr target_88) {
	target_88.getOperand().(PointerFieldAccess).getTarget().getName()="req"
	and target_88.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
	and target_88.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(0) instanceof FunctionCall
}

predicate func_90(Variable vctx_155, AddressOfExpr target_90) {
	target_90.getOperand().(PointerFieldAccess).getTarget().getName()="completion"
	and target_90.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_155
}

from Function func, Parameter vmsg_151, Parameter vlen_151, Parameter vflags_151, Variable vsk_153, Variable vask_154, Variable vctx_155, Variable vds_156, Variable verr_157, VariableAccess target_0, Initializer target_1, Initializer target_2, Initializer target_3, VariableAccess target_4, VariableAccess target_5, FunctionCall target_6, VariableAccess target_7, VariableAccess target_9, VariableAccess target_11, PointerFieldAccess target_54, ExprStmt target_55, VariableAccess target_56, FunctionCall target_64, VariableAccess target_65, AssignExpr target_66, RelationalOperation target_67, PointerFieldAccess target_68, AssignExpr target_69, PointerFieldAccess target_70, VariableAccess target_71, PointerFieldAccess target_72, PointerFieldAccess target_73, VariableAccess target_74, ConditionalExpr target_75, ExprStmt target_76, BlockStmt target_77, RelationalOperation target_78, ExprStmt target_79, IfStmt target_80, ExprStmt target_81, FunctionCall target_82, ExprStmt target_84, ExprStmt target_85, AddressOfExpr target_88, AddressOfExpr target_90
where
func_0(verr_157, target_0)
and func_1(vsk_153, target_1)
and func_2(vask_154, target_2)
and func_3(func, target_3)
and func_4(vlen_151, vds_156, target_76, target_4)
and func_5(vlen_151, vds_156, target_55, target_5)
and func_6(vctx_155, target_6)
and func_7(vctx_155, verr_157, target_7)
and func_9(vmsg_151, vlen_151, vctx_155, verr_157, target_9)
and func_11(verr_157, target_11)
and not func_13(vsk_153)
and not func_18(target_77, func)
and not func_19(func)
and not func_20(func)
and not func_21(vmsg_151)
and not func_22(target_76, func)
and not func_23(target_78, func)
and not func_24(target_68, func)
and not func_26(func)
and not func_27(func)
and not func_28(target_79, func)
and not func_31(vsk_153, target_55, target_79)
and not func_32(target_78, func)
and not func_33(vflags_151, vsk_153, target_80, target_79, func)
and not func_34(target_80, func)
and not func_35(target_80, func)
and not func_36(target_80, func)
and not func_38(target_80, func)
and not func_41(vmsg_151, target_80, target_81, func)
and not func_45(target_80, func)
and not func_46(vsk_153, target_80, target_82, func)
and not func_48(vmsg_151, target_80, func)
and not func_49(target_80, func)
and not func_50(vsk_153, target_84, target_85, func)
and func_54(vmsg_151, target_54)
and func_55(vmsg_151, target_78, target_55)
and func_56(vsk_153, target_56)
and func_64(vctx_155, target_64)
and func_65(vds_156, target_76, target_65)
and func_66(vlen_151, vds_156, target_66)
and func_67(vlen_151, vds_156, target_55, target_67)
and func_68(vctx_155, target_68)
and func_69(vctx_155, target_69)
and func_70(vctx_155, target_70)
and func_71(vctx_155, target_88, target_71)
and func_72(vctx_155, target_90, target_72)
and func_73(vctx_155, target_73)
and func_74(vctx_155, target_90, target_74)
and func_75(vlen_151, verr_157, target_75)
and func_76(func, target_76)
and func_77(verr_157, target_77)
and func_78(vlen_151, vds_156, target_78)
and func_79(vsk_153, target_79)
and func_80(vctx_155, verr_157, target_80)
and func_81(vmsg_151, target_81)
and func_82(vsk_153, target_82)
and func_84(verr_157, target_84)
and func_85(vsk_153, target_85)
and func_88(vctx_155, target_88)
and func_90(vctx_155, target_90)
and vmsg_151.getType().hasName("msghdr *")
and vlen_151.getType().hasName("size_t")
and vflags_151.getType().hasName("int")
and vsk_153.getType().hasName("sock *")
and vask_154.getType().hasName("alg_sock *")
and vctx_155.getType().hasName("hash_ctx *")
and vds_156.getType().hasName("unsigned int")
and verr_157.getType().hasName("int")
and vmsg_151.getFunction() = func
and vlen_151.getFunction() = func
and vflags_151.getFunction() = func
and vsk_153.(LocalVariable).getFunction() = func
and vask_154.(LocalVariable).getFunction() = func
and vctx_155.(LocalVariable).getFunction() = func
and vds_156.(LocalVariable).getFunction() = func
and verr_157.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
