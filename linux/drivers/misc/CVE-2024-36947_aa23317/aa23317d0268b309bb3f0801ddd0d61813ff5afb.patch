commit aa23317d0268b309bb3f0801ddd0d61813ff5afb
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Sun Feb 25 23:58:42 2024 -0500

    qibfs: fix dentry leak
    
    simple_recursive_removal() drops the pinning references to all positives
    in subtree.  For the cases when its argument has been kept alive by
    the pinning alone that's exactly the right thing to do, but here
    the argument comes from dcache lookup, that needs to be balanced by
    explicit dput().
    
    Fixes: e41d237818598 "qib_fs: switch to simple_recursive_removal()"
    Fucked-up-by: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

diff --git a/drivers/infiniband/hw/qib/qib_fs.c b/drivers/infiniband/hw/qib/qib_fs.c
index 455e966eeff3..b27791029fa9 100644
--- a/drivers/infiniband/hw/qib/qib_fs.c
+++ b/drivers/infiniband/hw/qib/qib_fs.c
@@ -439,6 +439,7 @@ static int remove_device_files(struct super_block *sb,
 		return PTR_ERR(dir);
 	}
 	simple_recursive_removal(dir, NULL);
+	dput(dir);
 	return 0;
 }
 
