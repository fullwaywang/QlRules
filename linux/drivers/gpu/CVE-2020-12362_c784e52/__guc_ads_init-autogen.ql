/**
 * @name linux-c784e5249e773689e38d2bc1749f08b986621a26-__guc_ads_init
 * @id cpp/linux/c784e5249e773689e38d2bc1749f08b986621a26/--guc-ads-init
 * @description linux-c784e5249e773689e38d2bc1749f08b986621a26-drivers/gpu/drm/i915/gt/uc/intel_guc_ads.c-__guc_ads_init CVE-2020-12362
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, BuiltInOperationBuiltInOffsetOf target_0) {
	target_0.getValue()="63752"
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Function func, BuiltInOperationBuiltInOffsetOf target_1) {
	target_1.getValue()="128"
	and target_1.getEnclosingFunction() = func
}

predicate func_2(Variable vblob_71, ValueFieldAccess target_2) {
	target_2.getTarget().getName()="reg_state_buffer"
	and target_2.getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_2.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_3(Function func, BuiltInOperationBuiltInOffsetOf target_3) {
	target_3.getValue()="63608"
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, BuiltInOperationBuiltInOffsetOf target_4) {
	target_4.getValue()="63672"
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Variable vbase_73, VariableAccess target_5) {
	target_5.getTarget()=vbase_73
}

predicate func_6(ExprStmt target_42, Function func, ExprStmt target_6) {
	target_6.getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_6.getExpr().(AssignExpr).getRValue() instanceof ConditionalExpr
	and target_6.getLocation().isBefore(target_42.getLocation())
	and target_6.getEnclosingFunction() = func
}

predicate func_7(ExprStmt target_43, Function func, ExprStmt target_7) {
	target_7.getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_7.getExpr().(AssignExpr).getRValue() instanceof AddExpr
	and target_43.getLocation().isBefore(target_7.getLocation())
	and target_7.getEnclosingFunction() = func
}

predicate func_8(Variable vblob_71, ExprStmt target_42) {
exists(ArrayExpr target_8 |
	target_8.getArrayBase().(ValueFieldAccess).getTarget().getName()="engine_enabled_masks"
	and target_8.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_8.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_8.getArrayOffset().(Literal).getValue()="0"
	and target_8.getParent().(AssignExpr).getLValue() = target_8
	and target_8.getParent().(AssignExpr).getRValue() instanceof ConditionalExpr)
}

predicate func_9(Variable vblob_71) {
exists(ArrayExpr target_9 |
	target_9.getArrayBase().(ValueFieldAccess).getTarget().getName()="engine_enabled_masks"
	and target_9.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_9.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_9.getArrayOffset().(Literal).getValue()="3"
	and target_9.getParent().(AssignExpr).getLValue() = target_9
	and target_9.getParent().(AssignExpr).getRValue() instanceof Literal)
}

predicate func_10(Variable vblob_71) {
exists(ArrayExpr target_10 |
	target_10.getArrayBase().(ValueFieldAccess).getTarget().getName()="engine_enabled_masks"
	and target_10.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_10.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_10.getArrayOffset().(Literal).getValue()="1"
	and target_10.getParent().(AssignExpr).getLValue() = target_10
	and target_10.getParent().(AssignExpr).getRValue() instanceof Literal)
}

predicate func_11(Variable vblob_71) {
exists(ArrayExpr target_11 |
	target_11.getArrayBase().(ValueFieldAccess).getTarget().getName()="engine_enabled_masks"
	and target_11.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_11.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_11.getArrayOffset().(Literal).getValue()="2"
	and target_11.getParent().(AssignExpr).getLValue() = target_11
	and target_11.getParent().(AssignExpr).getRValue() instanceof StmtExpr)
}

predicate func_12(Variable vblob_71) {
exists(ArrayExpr target_12 |
	target_12.getArrayBase().(ValueFieldAccess).getTarget().getName()="generic_gt_sysinfo"
	and target_12.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_12.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_12.getArrayOffset().(Literal).getValue()="0"
	and target_12.getParent().(AssignExpr).getLValue() = target_12
	and target_12.getParent().(AssignExpr).getRValue() instanceof StmtExpr)
}

predicate func_13(Variable vgt_70, Variable vblob_71, ExprStmt target_48) {
exists(ArrayExpr target_13 |
	target_13.getArrayBase().(ValueFieldAccess).getTarget().getName()="generic_gt_sysinfo"
	and target_13.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_13.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_13.getArrayOffset().(Literal).getValue()="1"
	and target_13.getParent().(AssignExpr).getLValue() = target_13
	and target_13.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="vdbox_sfc_access"
	and target_13.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="info"
	and target_13.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgt_70
	and target_13.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_48.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_14(ExprStmt target_49, Function func) {
exists(IfStmt target_14 |
	target_14.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="gen"
	and target_14.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="__info"
	and target_14.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_i915_private *")
	and target_14.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getLesserOperand().(Literal).getValue()="12"
	and target_14.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getTarget().getName()="is_dgfx"
	and target_14.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="__info"
	and target_14.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_i915_private *")
	and target_14.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getTarget().getName()="generic_gt_sysinfo"
	and target_14.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_14.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="2"
	and target_14.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="255"
	and target_14.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(Literal).getValue()="1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_14
	and target_14.getLocation().isBefore(target_49.getLocation()))
}

/*predicate func_15(Variable vblob_71, ExprStmt target_50) {
exists(ArrayExpr target_15 |
	target_15.getArrayBase().(ValueFieldAccess).getTarget().getName()="generic_gt_sysinfo"
	and target_15.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_15.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_15.getArrayOffset().(Literal).getValue()="2"
	and target_15.getParent().(AssignExpr).getLValue() = target_15
	and target_15.getParent().(AssignExpr).getRValue() instanceof AddExpr
	and target_15.getArrayBase().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_50.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_16(Function func) {
exists(AddExpr target_16 |
	target_16.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getType().hasName("u32")
	and target_16.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="16"
	and target_16.getLeftOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="255"
	and target_16.getRightOperand().(Literal).getValue()="1"
	and target_16.getParent().(AssignExpr).getRValue() = target_16
	and target_16.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_16.getEnclosingFunction() = func)
}

*/
predicate func_17(Variable vblob_71, Parameter vguc_68, ExprStmt target_43, ExprStmt target_7, ExprStmt target_49) {
exists(FunctionCall target_17 |
	target_17.getTarget().hasName("guc_mapping_table_init")
	and target_17.getArgument(0).(FunctionCall).getTarget().hasName("guc_to_gt")
	and target_17.getArgument(0).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vguc_68
	and target_17.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_17.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_17.getArgument(0).(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_18(Variable vblob_71, Variable vbase_73, Parameter vguc_68, ExprStmt target_51, ExprStmt target_52, ExprStmt target_7, PointerFieldAccess target_53, Function func) {
exists(ExprStmt target_18 |
	target_18.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="private_data"
	and target_18.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_18.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_18.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_18.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(FunctionCall).getTarget().hasName("guc_ads_private_data_offset")
	and target_18.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vguc_68
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_18
	and target_18.getLocation().isBefore(target_51.getLocation())
	and target_52.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_18.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_18.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_53.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_19(Variable vbase_73, Parameter vguc_68, ExprStmt target_7, PointerFieldAccess target_53) {
exists(AddExpr target_19 |
	target_19.getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_19.getRightOperand().(FunctionCall).getTarget().hasName("guc_ads_private_data_offset")
	and target_19.getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vguc_68
	and target_19.getParent().(AssignExpr).getRValue() = target_19
	and target_19.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_19.getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_53.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_20(Variable vgt_70, ConditionalExpr target_20) {
	target_20.getCondition().(FunctionCall).getTarget().hasName("__builtin_constant_p")
	and target_20.getCondition().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="slice_mask"
	and target_20.getCondition().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="sseu"
	and target_20.getCondition().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="info"
	and target_20.getCondition().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgt_70
	and target_20.getThen().(AddExpr).getLeftOperand().(AddExpr).getRightOperand().(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="slice_mask"
	and target_20.getThen().(AddExpr).getRightOperand().(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="slice_mask"
	and target_20.getThen().(AddExpr).getRightOperand().(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="sseu"
	and target_20.getThen().(AddExpr).getRightOperand().(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="128"
	and target_20.getElse().(FunctionCall).getTarget().hasName("__arch_hweight8")
	and target_20.getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="slice_mask"
	and target_20.getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="sseu"
	and target_20.getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="info"
	and target_20.getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgt_70
	and target_20.getParent().(AssignExpr).getRValue() = target_20
	and target_20.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
}

predicate func_21(Variable vfirst___106, StmtExpr target_21) {
	target_21.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="engine_mask"
	and target_21.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="info"
	and target_21.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getRightOperand().(AddExpr).getLeftOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_21.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getRightOperand().(AddExpr).getLeftOperand().(SizeofTypeOperator).getValue()="0"
	and target_21.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getRightOperand().(VariableAccess).getTarget()=vfirst___106
	and target_21.getParent().(AssignExpr).getRValue() = target_21
	and target_21.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
}

predicate func_22(Variable vfirst___107, StmtExpr target_22) {
	target_22.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="engine_mask"
	and target_22.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="info"
	and target_22.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getRightOperand().(AddExpr).getLeftOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_22.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getRightOperand().(AddExpr).getLeftOperand().(SizeofTypeOperator).getValue()="0"
	and target_22.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(BinaryBitwiseOperation).getRightOperand().(VariableAccess).getTarget()=vfirst___107
	and target_22.getParent().(AssignExpr).getRValue() = target_22
	and target_22.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
}

predicate func_23(Variable vblob_71, PointerFieldAccess target_23) {
	target_23.getTarget().getName()="system_info"
	and target_23.getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_24(Variable vblob_71, PointerFieldAccess target_24) {
	target_24.getTarget().getName()="system_info"
	and target_24.getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_25(Variable vblob_71, PointerFieldAccess target_25) {
	target_25.getTarget().getName()="system_info"
	and target_25.getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_26(Variable vblob_71, PointerFieldAccess target_26) {
	target_26.getTarget().getName()="system_info"
	and target_26.getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_27(Variable vblob_71, PointerFieldAccess target_27) {
	target_27.getTarget().getName()="system_info"
	and target_27.getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_28(Variable vblob_71, PointerFieldAccess target_28) {
	target_28.getTarget().getName()="system_info"
	and target_28.getQualifier().(VariableAccess).getTarget()=vblob_71
}

predicate func_31(Variable vbase_73, VariableAccess target_31) {
	target_31.getTarget()=vbase_73
}

predicate func_32(Variable vblob_71, VariableAccess target_32) {
	target_32.getTarget()=vblob_71
}

predicate func_33(Variable vblob_71, ValueFieldAccess target_33) {
	target_33.getTarget().getName()="slice_enabled"
	and target_33.getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_33.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_33.getParent().(AssignExpr).getLValue() = target_33
	and target_33.getParent().(AssignExpr).getRValue() instanceof ConditionalExpr
}

predicate func_34(Variable vblob_71, ValueFieldAccess target_34) {
	target_34.getTarget().getName()="rcs_enabled"
	and target_34.getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_34.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_34.getParent().(AssignExpr).getLValue() = target_34
	and target_34.getParent().(AssignExpr).getRValue() instanceof Literal
}

predicate func_35(Variable vblob_71, ValueFieldAccess target_35) {
	target_35.getTarget().getName()="bcs_enabled"
	and target_35.getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_35.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_35.getParent().(AssignExpr).getLValue() = target_35
	and target_35.getParent().(AssignExpr).getRValue() instanceof Literal
}

predicate func_36(Variable vblob_71, ValueFieldAccess target_36) {
	target_36.getTarget().getName()="vdbox_enable_mask"
	and target_36.getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_36.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_36.getParent().(AssignExpr).getLValue() = target_36
	and target_36.getParent().(AssignExpr).getRValue() instanceof StmtExpr
}

predicate func_37(Variable vblob_71, ValueFieldAccess target_37) {
	target_37.getTarget().getName()="vebox_enable_mask"
	and target_37.getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_37.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_37.getParent().(AssignExpr).getLValue() = target_37
	and target_37.getParent().(AssignExpr).getRValue() instanceof StmtExpr
}

predicate func_38(Variable vgt_70, Variable vblob_71, ValueFieldAccess target_38) {
	target_38.getTarget().getName()="vdbox_sfc_support_mask"
	and target_38.getQualifier().(PointerFieldAccess).getTarget().getName()="system_info"
	and target_38.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_38.getParent().(AssignExpr).getLValue() = target_38
	and target_38.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="vdbox_sfc_access"
	and target_38.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="info"
	and target_38.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgt_70
}

predicate func_39(Variable vbase_73, AddExpr target_39) {
	target_39.getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_39.getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="63936"
	and target_39.getParent().(AssignExpr).getRValue() = target_39
	and target_39.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
}

predicate func_40(Variable vblob_71, Variable vbase_73, ValueFieldAccess target_40) {
	target_40.getTarget().getName()="reg_state_addr"
	and target_40.getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_40.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_40.getParent().(AssignExpr).getLValue() = target_40
	and target_40.getParent().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_40.getParent().(AssignExpr).getRValue().(AddExpr).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="1136"
}

/*predicate func_41(Variable vblob_71, Variable vbase_73, AddExpr target_41) {
	target_41.getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_41.getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="1136"
	and target_41.getParent().(AssignExpr).getRValue() = target_41
	and target_41.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="reg_state_addr"
	and target_41.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_41.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
}

*/
predicate func_42(Function func, ExprStmt target_42) {
	target_42.getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_42.getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_42.getEnclosingFunction() = func
}

predicate func_43(Function func, ExprStmt target_43) {
	target_43.getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_43.getExpr().(AssignExpr).getRValue() instanceof AddExpr
	and target_43.getEnclosingFunction() = func
}

predicate func_48(Variable vblob_71, ExprStmt target_48) {
	target_48.getExpr().(FunctionCall).getTarget().hasName("guc_ct_pool_entries_init")
	and target_48.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ct_pool"
	and target_48.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_48.getExpr().(FunctionCall).getArgument(1).(AddExpr).getValue()="2"
}

predicate func_49(Variable vbase_73, Parameter vguc_68, ExprStmt target_49) {
	target_49.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbase_73
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("intel_guc_ggtt_offset")
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vguc_68
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="ads_vma"
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vguc_68
}

predicate func_50(Variable vblob_71, Variable vbase_73, ExprStmt target_50) {
	target_50.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="gt_system_info"
	and target_50.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_50.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_50.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_50.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand() instanceof BuiltInOperationBuiltInOffsetOf
}

predicate func_51(Variable vblob_71, Variable vbase_73, ExprStmt target_51) {
	target_51.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="clients_info"
	and target_51.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_51.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_51.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_51.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand() instanceof BuiltInOperationBuiltInOffsetOf
}

predicate func_52(Variable vblob_71, Variable vbase_73, ExprStmt target_52) {
	target_52.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="scheduler_policies"
	and target_52.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ads"
	and target_52.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vblob_71
	and target_52.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vbase_73
	and target_52.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand() instanceof BuiltInOperationBuiltInOffsetOf
}

predicate func_53(Parameter vguc_68, PointerFieldAccess target_53) {
	target_53.getTarget().getName()="obj"
	and target_53.getQualifier().(PointerFieldAccess).getTarget().getName()="ads_vma"
	and target_53.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vguc_68
}

from Function func, Variable vgt_70, Variable vblob_71, Variable vbase_73, Variable vfirst___106, Variable vfirst___107, Parameter vguc_68, BuiltInOperationBuiltInOffsetOf target_0, BuiltInOperationBuiltInOffsetOf target_1, ValueFieldAccess target_2, BuiltInOperationBuiltInOffsetOf target_3, BuiltInOperationBuiltInOffsetOf target_4, VariableAccess target_5, ExprStmt target_6, ExprStmt target_7, ConditionalExpr target_20, StmtExpr target_21, StmtExpr target_22, PointerFieldAccess target_23, PointerFieldAccess target_24, PointerFieldAccess target_25, PointerFieldAccess target_26, PointerFieldAccess target_27, PointerFieldAccess target_28, VariableAccess target_31, VariableAccess target_32, ValueFieldAccess target_33, ValueFieldAccess target_34, ValueFieldAccess target_35, ValueFieldAccess target_36, ValueFieldAccess target_37, ValueFieldAccess target_38, AddExpr target_39, ValueFieldAccess target_40, ExprStmt target_42, ExprStmt target_43, ExprStmt target_48, ExprStmt target_49, ExprStmt target_50, ExprStmt target_51, ExprStmt target_52, PointerFieldAccess target_53
where
func_0(func, target_0)
and func_1(func, target_1)
and func_2(vblob_71, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(vbase_73, target_5)
and func_6(target_42, func, target_6)
and func_7(target_43, func, target_7)
and not func_8(vblob_71, target_42)
and not func_9(vblob_71)
and not func_10(vblob_71)
and not func_11(vblob_71)
and not func_12(vblob_71)
and not func_13(vgt_70, vblob_71, target_48)
and not func_14(target_49, func)
and not func_17(vblob_71, vguc_68, target_43, target_7, target_49)
and not func_18(vblob_71, vbase_73, vguc_68, target_51, target_52, target_7, target_53, func)
and func_20(vgt_70, target_20)
and func_21(vfirst___106, target_21)
and func_22(vfirst___107, target_22)
and func_23(vblob_71, target_23)
and func_24(vblob_71, target_24)
and func_25(vblob_71, target_25)
and func_26(vblob_71, target_26)
and func_27(vblob_71, target_27)
and func_28(vblob_71, target_28)
and func_31(vbase_73, target_31)
and func_32(vblob_71, target_32)
and func_33(vblob_71, target_33)
and func_34(vblob_71, target_34)
and func_35(vblob_71, target_35)
and func_36(vblob_71, target_36)
and func_37(vblob_71, target_37)
and func_38(vgt_70, vblob_71, target_38)
and func_39(vbase_73, target_39)
and func_40(vblob_71, vbase_73, target_40)
and func_42(func, target_42)
and func_43(func, target_43)
and func_48(vblob_71, target_48)
and func_49(vbase_73, vguc_68, target_49)
and func_50(vblob_71, vbase_73, target_50)
and func_51(vblob_71, vbase_73, target_51)
and func_52(vblob_71, vbase_73, target_52)
and func_53(vguc_68, target_53)
and vgt_70.getType().hasName("intel_gt *")
and vblob_71.getType().hasName("__guc_ads_blob *")
and vbase_73.getType().hasName("u32")
and vfirst___106.getType().hasName("unsigned int")
and vfirst___107.getType().hasName("unsigned int")
and vguc_68.getType().hasName("intel_guc *")
and vgt_70.(LocalVariable).getFunction() = func
and vblob_71.(LocalVariable).getFunction() = func
and vbase_73.(LocalVariable).getFunction() = func
and vfirst___106.(LocalVariable).getFunction() = func
and vfirst___107.(LocalVariable).getFunction() = func
and vguc_68.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
