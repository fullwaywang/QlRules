/**
 * @name linux-0f2122045b946241a9e549c2a76cea54fa58a7ff-io_init_wq_offload
 * @id cpp/linux/0f2122045b946241a9e549c2a76cea54fa58a7ff/io-init-wq-offload
 * @description linux-0f2122045b946241a9e549c2a76cea54fa58a7ff-fs/io_uring.c-io_init_wq_offload CVE-2020-29534
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vctx_7472, BlockStmt target_49, FunctionCall target_0) {
	target_0.getTarget().hasName("IS_ERR")
	and not target_0.getTarget().hasName("io_async_submit")
	and target_0.getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_0.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_0.getParent().(IfStmt).getThen()=target_49
}

predicate func_1(Variable vret_7479, Parameter vctx_7472, FunctionCall target_1) {
	target_1.getTarget().hasName("PTR_ERR")
	and not target_1.getTarget().hasName("__builtin_expect")
	and target_1.getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_1.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_1.getParent().(AssignExpr).getRValue() = target_1
	and target_1.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
}

predicate func_2(Variable vret_7479, VariableAccess target_2) {
	target_2.getTarget()=vret_7479
}

predicate func_4(Function func) {
exists(AssignExpr target_4 |
	target_4.getLValue().(VariableAccess).getType().hasName("bool")
	and target_4.getRValue().(EqualityOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_4.getRValue().(EqualityOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_4.getRValue().(EqualityOperation).getRightOperand() instanceof Literal
	and target_4.getEnclosingFunction() = func)
}

/*predicate func_5(Function func) {
exists(PointerFieldAccess target_5 |
	target_5.getTarget().getName()="flags"
	and target_5.getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_5.getEnclosingFunction() = func)
}

*/
predicate func_7(ReturnStmt target_50, Function func) {
exists(LogicalAndExpr target_7 |
	target_7.getLeftOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
	and target_7.getRightOperand().(FunctionCall).getTarget().hasName("io_async_submit")
	and target_7.getRightOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ctx"
	and target_7.getRightOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_7.getParent().(NotExpr).getOperand() instanceof ValueFieldAccess
	and target_7.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_50
	and target_7.getEnclosingFunction() = func)
}

/*predicate func_9(Function func) {
exists(PointerFieldAccess target_9 |
	target_9.getTarget().getName()="ctx"
	and target_9.getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_9.getEnclosingFunction() = func)
}

*/
predicate func_10(Function func) {
exists(FunctionCall target_10 |
	target_10.getTarget().hasName("io_file_get")
	and target_10.getArgument(0).(VariableAccess).getType().hasName("io_submit_state *")
	and target_10.getArgument(1).(VariableAccess).getType().hasName("io_kiocb *")
	and target_10.getArgument(2).(VariableAccess).getType().hasName("int")
	and target_10.getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="file"
	and target_10.getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_10.getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_10.getArgument(4).(VariableAccess).getType().hasName("bool")
	and target_10.getEnclosingFunction() = func)
}

predicate func_14(Function func, DeclStmt target_14) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(Function func, DeclStmt target_15) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

predicate func_16(Function func, DeclStmt target_16) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

predicate func_17(Function func, DeclStmt target_17) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_17
}

predicate func_18(Parameter vctx_7472, Variable vdata_7475, Function func, ExprStmt target_18) {
	target_18.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="user"
	and target_18.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vdata_7475
	and target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="user"
	and target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_18
}

predicate func_19(Variable vdata_7475, Function func, ExprStmt target_19) {
	target_19.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="free_work"
	and target_19.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vdata_7475
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_19
}

predicate func_20(Variable vdata_7475, Function func, ExprStmt target_20) {
	target_20.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="do_work"
	and target_20.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vdata_7475
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
}

predicate func_21(Variable vret_7479, Parameter vp_7473, Parameter vctx_7472, Variable vdata_7475, Variable vconcurrency_7478, Function func, IfStmt target_21) {
	target_21.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_21.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vp_7473
	and target_21.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="32"
	and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vconcurrency_7478
	and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(ValueFieldAccess).getTarget().getName()="sq_entries"
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("io_wq_create")
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vconcurrency_7478
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdata_7475
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition() instanceof FunctionCall
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_21.getThen().(BlockStmt).getStmt(3).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_7479
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
}

/*predicate func_22(Parameter vp_7473, PointerFieldAccess target_22) {
	target_22.getTarget().getName()="flags"
	and target_22.getQualifier().(VariableAccess).getTarget()=vp_7473
}

*/
/*predicate func_23(Function func, BinaryBitwiseOperation target_23) {
	target_23.getValue()="32"
	and target_23.getEnclosingFunction() = func
}

*/
/*predicate func_24(Parameter vctx_7472, Variable vconcurrency_7478, NotExpr target_51, ExprStmt target_24) {
	target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vconcurrency_7478
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getTarget().getName()="sq_entries"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(MulExpr).getLeftOperand().(Literal).getValue()="4"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(MulExpr).getRightOperand().(FunctionCall).getTarget().hasName("num_online_cpus")
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(ValueFieldAccess).getTarget().getName()="sq_entries"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(MulExpr).getLeftOperand().(Literal).getValue()="4"
	and target_24.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(MulExpr).getRightOperand().(FunctionCall).getTarget().hasName("num_online_cpus")
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_51
}

*/
/*predicate func_27(Variable v__UNIQUE_ID___x1880_7487, Variable v__UNIQUE_ID___y1881_7487, ExprStmt target_27) {
	target_27.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__UNIQUE_ID___x1880_7487
	and target_27.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=v__UNIQUE_ID___y1881_7487
	and target_27.getExpr().(ConditionalExpr).getThen().(VariableAccess).getTarget()=v__UNIQUE_ID___x1880_7487
	and target_27.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__UNIQUE_ID___y1881_7487
}

*/
/*predicate func_28(Parameter vctx_7472, Variable vdata_7475, Variable vconcurrency_7478, AssignExpr target_28) {
	target_28.getLValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_28.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_28.getRValue().(FunctionCall).getTarget().hasName("io_wq_create")
	and target_28.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vconcurrency_7478
	and target_28.getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdata_7475
}

*/
predicate func_29(Parameter vctx_7472, ExprStmt target_30, VariableAccess target_29) {
	target_29.getTarget()=vctx_7472
	and target_29.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
}

predicate func_30(Variable vret_7479, ExprStmt target_30) {
	target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
	and target_30.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_31(Parameter vctx_7472, FunctionCall target_0, ExprStmt target_32, VariableAccess target_31) {
	target_31.getTarget()=vctx_7472
	and target_31.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_0.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_31.getLocation())
	and target_31.getLocation().isBefore(target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_32(Parameter vctx_7472, ExprStmt target_32) {
	target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_32.getExpr().(AssignExpr).getRValue() instanceof Literal
}

predicate func_33(Parameter vp_7473, Variable vf_7476, Function func, ExprStmt target_33) {
	target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vf_7476
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("fdget")
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="wq_fd"
	and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vp_7473
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_33
}

predicate func_34(Variable vf_7476, Function func, IfStmt target_34) {
	target_34.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="file"
	and target_34.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vf_7476
	and target_34.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-9"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_34
}

/*predicate func_35(Variable vf_7476, ReturnStmt target_50, ExprStmt target_33, ValueFieldAccess target_35) {
	target_35.getTarget().getName()="file"
	and target_35.getQualifier().(VariableAccess).getTarget()=vf_7476
	and target_35.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_50
	and target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_35.getQualifier().(VariableAccess).getLocation())
}

*/
predicate func_36(Variable vret_7479, Variable vio_uring_fops, Variable vf_7476, Function func, IfStmt target_36) {
	target_36.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="f_op"
	and target_36.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
	and target_36.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vf_7476
	and target_36.getCondition().(EqualityOperation).getRightOperand().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vio_uring_fops
	and target_36.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
	and target_36.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-22"
	and target_36.getThen().(BlockStmt).getStmt(1).(GotoStmt).getName() ="out_fput"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
}

/*predicate func_37(Variable vf_7476, PointerFieldAccess target_37) {
	target_37.getTarget().getName()="f_op"
	and target_37.getQualifier().(ValueFieldAccess).getTarget().getName()="file"
	and target_37.getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vf_7476
}

*/
/*predicate func_38(Variable vio_uring_fops, Variable vf_7476, BlockStmt target_54, AddressOfExpr target_38) {
	target_38.getOperand().(VariableAccess).getTarget()=vio_uring_fops
	and target_38.getParent().(NEExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="f_op"
	and target_38.getParent().(NEExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
	and target_38.getParent().(NEExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vf_7476
	and target_38.getParent().(NEExpr).getParent().(IfStmt).getThen()=target_54
}

*/
predicate func_39(Variable vret_7479, EqualityOperation target_55, ReturnStmt target_56, ExprStmt target_39) {
	target_39.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
	and target_39.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-22"
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_55
	and target_56.getExpr().(VariableAccess).getLocation().isBefore(target_39.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

/*predicate func_40(EqualityOperation target_55, Function func, GotoStmt target_40) {
	target_40.getName() ="out_fput"
	and target_40.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_55
	and target_40.getEnclosingFunction() = func
}

*/
predicate func_41(Variable vf_7476, Variable vctx_attach_7477, Function func, ExprStmt target_41) {
	target_41.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vctx_attach_7477
	and target_41.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="private_data"
	and target_41.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
	and target_41.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vf_7476
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_41
}

predicate func_42(Variable vret_7479, Variable vdata_7475, Variable vctx_attach_7477, Function func, IfStmt target_42) {
	target_42.getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("io_wq_get")
	and target_42.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_42.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_attach_7477
	and target_42.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdata_7475
	and target_42.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
	and target_42.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-22"
	and target_42.getThen().(BlockStmt).getStmt(1).(GotoStmt).getName() ="out_fput"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_42
}

/*predicate func_43(Variable vdata_7475, Variable vctx_attach_7477, BlockStmt target_57, FunctionCall target_43) {
	target_43.getTarget().hasName("io_wq_get")
	and target_43.getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_43.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_attach_7477
	and target_43.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdata_7475
	and target_43.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_57
}

*/
/*predicate func_44(Variable vret_7479, NotExpr target_58, ExprStmt target_39, ReturnStmt target_48, ExprStmt target_44) {
	target_44.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7479
	and target_44.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-22"
	and target_44.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_58
	and target_39.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_44.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_44.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_48.getExpr().(VariableAccess).getLocation())
}

*/
/*predicate func_45(NotExpr target_58, Function func, GotoStmt target_45) {
	target_45.getName() ="out_fput"
	and target_45.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_58
	and target_45.getEnclosingFunction() = func
}

*/
predicate func_46(Parameter vctx_7472, Variable vctx_attach_7477, Function func, ExprStmt target_46) {
	target_46.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_46.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_7472
	and target_46.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_46.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_attach_7477
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

predicate func_47(Variable vf_7476, Function func, ExprStmt target_47) {
	target_47.getExpr().(FunctionCall).getTarget().hasName("fdput")
	and target_47.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vf_7476
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_47
}

predicate func_48(Variable vret_7479, Function func, ReturnStmt target_48) {
	target_48.getExpr().(VariableAccess).getTarget()=vret_7479
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Function func, BlockStmt target_49) {
	target_49.getStmt(0) instanceof ExprStmt
	and target_49.getStmt(1) instanceof ExprStmt
	and target_49.getEnclosingFunction() = func
}

predicate func_50(Function func, ReturnStmt target_50) {
	target_50.getExpr().(UnaryMinusExpr).getValue()="-9"
	and target_50.getEnclosingFunction() = func
}

predicate func_51(Parameter vp_7473, NotExpr target_51) {
	target_51.getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_51.getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vp_7473
	and target_51.getOperand().(BitwiseAndExpr).getRightOperand() instanceof BinaryBitwiseOperation
}

predicate func_54(EqualityOperation target_55, Function func, BlockStmt target_54) {
	target_54.getStmt(0) instanceof ExprStmt
	and target_54.getStmt(1) instanceof GotoStmt
	and target_54.getParent().(IfStmt).getCondition()=target_55
	and target_54.getEnclosingFunction() = func
}

predicate func_55(Function func, EqualityOperation target_55) {
	target_55.getLeftOperand().(PointerFieldAccess).getTarget().getName()="f_op"
	and target_55.getLeftOperand().(PointerFieldAccess).getQualifier() instanceof ValueFieldAccess
	and target_55.getRightOperand() instanceof AddressOfExpr
	and target_55.getEnclosingFunction() = func
}

predicate func_56(Variable vret_7479, ReturnStmt target_56) {
	target_56.getExpr().(VariableAccess).getTarget()=vret_7479
}

predicate func_57(NotExpr target_58, Function func, BlockStmt target_57) {
	target_57.getStmt(0) instanceof ExprStmt
	and target_57.getStmt(1) instanceof GotoStmt
	and target_57.getParent().(IfStmt).getCondition()=target_58
	and target_57.getEnclosingFunction() = func
}

predicate func_58(Function func, NotExpr target_58) {
	target_58.getOperand() instanceof FunctionCall
	and target_58.getEnclosingFunction() = func
}

from Function func, Variable vret_7479, Variable v__UNIQUE_ID___x1880_7487, Variable v__UNIQUE_ID___y1881_7487, Variable vio_uring_fops, Parameter vp_7473, Parameter vctx_7472, Variable vdata_7475, Variable vf_7476, Variable vctx_attach_7477, Variable vconcurrency_7478, FunctionCall target_0, FunctionCall target_1, VariableAccess target_2, DeclStmt target_14, DeclStmt target_15, DeclStmt target_16, DeclStmt target_17, ExprStmt target_18, ExprStmt target_19, ExprStmt target_20, IfStmt target_21, VariableAccess target_29, ExprStmt target_30, VariableAccess target_31, ExprStmt target_32, ExprStmt target_33, IfStmt target_34, IfStmt target_36, ExprStmt target_39, ExprStmt target_41, IfStmt target_42, ExprStmt target_46, ExprStmt target_47, ReturnStmt target_48, BlockStmt target_49, ReturnStmt target_50, NotExpr target_51, BlockStmt target_54, EqualityOperation target_55, ReturnStmt target_56, BlockStmt target_57, NotExpr target_58
where
func_0(vctx_7472, target_49, target_0)
and func_1(vret_7479, vctx_7472, target_1)
and func_2(vret_7479, target_2)
and not func_4(func)
and not func_7(target_50, func)
and not func_10(func)
and func_14(func, target_14)
and func_15(func, target_15)
and func_16(func, target_16)
and func_17(func, target_17)
and func_18(vctx_7472, vdata_7475, func, target_18)
and func_19(vdata_7475, func, target_19)
and func_20(vdata_7475, func, target_20)
and func_21(vret_7479, vp_7473, vctx_7472, vdata_7475, vconcurrency_7478, func, target_21)
and func_29(vctx_7472, target_30, target_29)
and func_30(vret_7479, target_30)
and func_31(vctx_7472, target_0, target_32, target_31)
and func_32(vctx_7472, target_32)
and func_33(vp_7473, vf_7476, func, target_33)
and func_34(vf_7476, func, target_34)
and func_36(vret_7479, vio_uring_fops, vf_7476, func, target_36)
and func_39(vret_7479, target_55, target_56, target_39)
and func_41(vf_7476, vctx_attach_7477, func, target_41)
and func_42(vret_7479, vdata_7475, vctx_attach_7477, func, target_42)
and func_46(vctx_7472, vctx_attach_7477, func, target_46)
and func_47(vf_7476, func, target_47)
and func_48(vret_7479, func, target_48)
and func_49(func, target_49)
and func_50(func, target_50)
and func_51(vp_7473, target_51)
and func_54(target_55, func, target_54)
and func_55(func, target_55)
and func_56(vret_7479, target_56)
and func_57(target_58, func, target_57)
and func_58(func, target_58)
and vret_7479.getType().hasName("int")
and v__UNIQUE_ID___x1880_7487.getType().hasName("unsigned int")
and v__UNIQUE_ID___y1881_7487.getType().hasName("unsigned int")
and vio_uring_fops.getType().hasName("const file_operations")
and vp_7473.getType().hasName("io_uring_params *")
and vctx_7472.getType().hasName("io_ring_ctx *")
and vdata_7475.getType().hasName("io_wq_data")
and vf_7476.getType().hasName("fd")
and vctx_attach_7477.getType().hasName("io_ring_ctx *")
and vconcurrency_7478.getType().hasName("unsigned int")
and vret_7479.(LocalVariable).getFunction() = func
and v__UNIQUE_ID___x1880_7487.(LocalVariable).getFunction() = func
and v__UNIQUE_ID___y1881_7487.(LocalVariable).getFunction() = func
and not vio_uring_fops.getParentScope+() = func
and vp_7473.getFunction() = func
and vctx_7472.getFunction() = func
and vdata_7475.(LocalVariable).getFunction() = func
and vf_7476.(LocalVariable).getFunction() = func
and vctx_attach_7477.(LocalVariable).getFunction() = func
and vconcurrency_7478.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
