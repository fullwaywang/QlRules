commit b5c7d4c4e03333ac16b5cfb11acaaeaa493334f8	b5c7d4c4e03333ac16b5cfb11acaaeaa493334f8
Author: Su_Laus <sulau@freenet.de>
Date:   Fri May 5 19:43:46 2023 +0200

    Consider error return of writeSelections().
    Fixes #553

diff --git a/tools/tiffcrop.c b/tools/tiffcrop.c
index 24d0ca84..05a7c5f1 100644
--- a/tools/tiffcrop.c
+++ b/tools/tiffcrop.c
@@ -2822,9 +2822,14 @@ int main(int argc, char *argv[])
             { /* Whole image or sections not based on output page size */
                 if (crop.selections > 0)
                 {
-                    writeSelections(in, &out, &crop, &image, &dump, seg_buffs,
-                                    mp, argv[argc - 1], &next_page,
-                                    total_pages);
+                    if (writeSelections(in, &out, &crop, &image, &dump,
+                                        seg_buffs, mp, argv[argc - 1],
+                                        &next_page, total_pages))
+                    {
+                        TIFFError("main",
+                                  "Unable to write new image selections");
+                        exit(EXIT_FAILURE);
+                    }
                 }
                 else /* One file all images and sections */
                 {
@@ -8785,7 +8790,7 @@ static int createCroppedImage(struct image_data *image, struct crop_mask *crop,
     /* Memory is freed before crop_buff_ptr is overwritten */
     if (*crop_buff_ptr != NULL)
     {
-	_TIFFfree(*crop_buff_ptr);
+        _TIFFfree(*crop_buff_ptr);
     }
 
     /* process full image, no crop buffer needed */
