/**
 * @name linux-d59c4d0eb6adc24c2201f153ccb7fd0a335b0d3d-apple_nvme_probe
 * @id cpp/linux/d59c4d0eb6adc24c2201f153ccb7fd0a335b0d3d/apple-nvme-probe
 * @description linux-d59c4d0eb6adc24c2201f153ccb7fd0a335b0d3d-drivers/nvme/host/apple.c-apple_nvme_probe CVE-2024-43913
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vpdev_1391, Variable vanv_1394, FunctionCall target_0) {
	target_0.getTarget().hasName("platform_set_drvdata")
	and not target_0.getTarget().hasName("nvme_uninit_ctrl")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vpdev_1391
	and target_0.getArgument(1).(VariableAccess).getTarget()=vanv_1394
}

predicate func_1(Function func, FunctionCall target_1) {
	target_1.getTarget().hasName("__init_work")
	and not target_1.getTarget().hasName("nvme_put_ctrl")
	and target_1.getArgument(0).(AddressOfExpr).getOperand() instanceof ValueFieldAccess
	and target_1.getArgument(1).(Literal).getValue()="0"
	and target_1.getEnclosingFunction() = func
}

predicate func_2(ExprStmt target_23, Function func, ExprStmt target_2) {
	target_2.getExpr() instanceof AssignExpr
	and target_2.getLocation().isBefore(target_23.getLocation())
	and target_2.getEnclosingFunction() = func
}

predicate func_3(IfStmt target_32, Function func, ExprStmt target_3) {
	target_3.getExpr() instanceof AssignExpr
	and target_3.getLocation().isBefore(target_32.getLocation())
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Parameter vpdev_1391, Variable vanv_1394, ExprStmt target_3) {
exists(FunctionCall target_4 |
	exists(AssignExpr obj_0 | obj_0=target_4.getParent() |
		obj_0.getRValue() = target_4
		and obj_0.getLValue().(VariableAccess).getTarget()=vanv_1394
	)
	and target_4.getTarget().hasName("apple_nvme_alloc")
	and target_4.getArgument(0).(VariableAccess).getTarget()=vpdev_1391
)
}

predicate func_5(Variable vanv_1394) {
exists(AssignExpr target_5 |
	exists(ValueFieldAccess obj_0 | obj_0=target_5.getLValue() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getQualifier() |
			obj_1.getTarget().getName()="ctrl"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().getName()="admin_q"
	)
	and target_5.getRValue() instanceof Literal
)
}

predicate func_7(Variable vret_1395, AssignExpr target_7) {
	target_7.getLValue().(VariableAccess).getTarget()=vret_1395
	and target_7.getRValue().(UnaryMinusExpr).getValue()="-12"
}

/*predicate func_8(Variable vanv_1394, PointerFieldAccess target_8) {
	target_8.getTarget().getName()="ctrl"
	and target_8.getQualifier().(VariableAccess).getTarget()=vanv_1394
	and target_8.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

*/
predicate func_9(Variable vanv_1394, PointerFieldAccess target_9) {
	target_9.getTarget().getName()="ctrl"
	and target_9.getQualifier().(VariableAccess).getTarget()=vanv_1394
	and target_9.getParent().(ValueFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_10(Variable vanv_1394, PointerFieldAccess target_10) {
	target_10.getTarget().getName()="ctrl"
	and target_10.getQualifier().(VariableAccess).getTarget()=vanv_1394
}

predicate func_11(Variable vanv_1394, PointerFieldAccess target_11) {
	target_11.getTarget().getName()="ctrl"
	and target_11.getQualifier().(VariableAccess).getTarget()=vanv_1394
	and target_11.getParent().(ValueFieldAccess).getParent().(AddressOfExpr).getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_12(Variable vanv_1394, AddressOfExpr target_12) {
	exists(PointerFieldAccess obj_0 | obj_0=target_12.getOperand() |
		obj_0.getTarget().getName()="ctrl"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_12.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_13(Parameter vpdev_1391, VariableAccess target_13) {
	target_13.getTarget()=vpdev_1391
	and target_13.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_14(Variable vanv_1394, VariableAccess target_14) {
	target_14.getTarget()=vanv_1394
	and target_14.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_15(Variable vanv_1394, VariableAccess target_15) {
	target_15.getTarget()=vanv_1394
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_17(RelationalOperation target_131, Function func, GotoStmt target_17) {
	target_17.getName() ="put_dev"
	and target_17.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_131
	and target_17.getEnclosingFunction() = func
}

predicate func_18(Function func, DeclStmt target_18) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_18
}

predicate func_19(Variable vdev_1393, Variable vanv_1394, FunctionCall target_19) {
	exists(AssignExpr obj_0 | obj_0=target_19.getParent() |
		obj_0.getRValue() = target_19
		and obj_0.getLValue().(VariableAccess).getTarget()=vanv_1394
	)
	and target_19.getTarget().hasName("devm_kzalloc")
	and target_19.getArgument(0).(VariableAccess).getTarget()=vdev_1393
	and target_19.getArgument(1).(SizeofExprOperator).getValue()="6496"
	and target_19.getArgument(2).(BitwiseOrExpr).getValue()="3264"
}

predicate func_20(Variable vanv_1394, Function func, IfStmt target_20) {
	target_20.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vanv_1394
	and target_20.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-12"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
}

/*predicate func_21(Function func, UnaryMinusExpr target_21) {
	target_21.getValue()="-12"
	and target_21.getEnclosingFunction() = func
}

*/
predicate func_22(Variable vdev_1393, Variable vanv_1394, AssignExpr target_22) {
	exists(PointerFieldAccess obj_0 | obj_0=target_22.getLValue() |
		obj_0.getTarget().getName()="dev"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and exists(FunctionCall obj_1 | obj_1=target_22.getRValue() |
		obj_1.getTarget().hasName("get_device")
		and obj_1.getArgument(0).(VariableAccess).getTarget()=vdev_1393
	)
}

predicate func_23(Variable vanv_1394, Function func, ExprStmt target_23) {
	exists(AssignExpr obj_0 | obj_0=target_23.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				obj_2.getTarget().getName()="adminq"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().getName()="is_adminq"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

predicate func_24(Function func, ExprStmt target_24) {
	target_24.getExpr() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
}

predicate func_25(Variable vanv_1394, Variable vret_1395, Function func, ExprStmt target_25) {
	exists(AssignExpr obj_0 | obj_0=target_25.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			obj_1.getTarget().hasName("apple_nvme_attach_genpd")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
}

predicate func_26(Variable vdev_1393, Variable vret_1395, Function func, IfStmt target_26) {
	exists(RelationalOperation obj_0 | obj_0=target_26.getCondition() |
		obj_0.getLesserOperand().(VariableAccess).getTarget()=vret_1395
		and obj_0.getGreaterOperand() instanceof Literal
	)
	and exists(BlockStmt obj_1 | obj_1=target_26.getThen() |
		exists(ExprStmt obj_2 | obj_2=obj_1.getStmt(0) |
			exists(FunctionCall obj_3 | obj_3=obj_2.getExpr() |
				obj_3.getTarget().hasName("dev_err_probe")
				and obj_3.getArgument(0).(VariableAccess).getTarget()=vdev_1393
				and obj_3.getArgument(1).(VariableAccess).getTarget()=vret_1395
				and obj_3.getArgument(2).(StringLiteral).getValue()="Failed to attach power domains"
			)
		)
		and obj_1.getStmt(1) instanceof GotoStmt
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_26
}

predicate func_27(Variable vdev_1393, Variable vret_1395, RelationalOperation target_131, ExprStmt target_27) {
	exists(FunctionCall obj_0 | obj_0=target_27.getExpr() |
		obj_0.getTarget().hasName("dev_err_probe")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vdev_1393
		and obj_0.getArgument(1).(VariableAccess).getTarget()=vret_1395
		and obj_0.getArgument(2).(StringLiteral).getValue()="Failed to attach power domains"
	)
	and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_131
}

predicate func_28(Variable vdev_1393, Variable vret_1395, Function func, IfStmt target_28) {
	exists(FunctionCall obj_0 | obj_0=target_28.getCondition() |
		obj_0.getTarget().hasName("dma_set_mask_and_coherent")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vdev_1393
		and obj_0.getArgument(1).(ConditionalExpr).getValue()="18446744073709551615"
	)
	and exists(BlockStmt obj_1 | obj_1=target_28.getThen() |
		exists(ExprStmt obj_2 | obj_2=obj_1.getStmt(0) |
			exists(AssignExpr obj_3 | obj_3=obj_2.getExpr() |
				obj_3.getLValue().(VariableAccess).getTarget()=vret_1395
				and obj_3.getRValue().(UnaryMinusExpr).getValue()="-6"
			)
		)
		and obj_1.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

/*predicate func_29(Variable vret_1395, FunctionCall target_132, ExprStmt target_27, ExprStmt target_29) {
	exists(AssignExpr obj_0 | obj_0=target_29.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
		and obj_0.getRValue().(UnaryMinusExpr).getValue()="-6"
	)
	and target_29.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_132
	and target_27.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_29.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

*/
/*predicate func_30(FunctionCall target_132, Function func, GotoStmt target_30) {
	target_30.getName() ="put_dev"
	and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_132
	and target_30.getEnclosingFunction() = func
}

*/
predicate func_31(Parameter vpdev_1391, Variable vanv_1394, AssignExpr target_31) {
	exists(PointerFieldAccess obj_0 | obj_0=target_31.getLValue() |
		obj_0.getTarget().getName()="irq"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and exists(FunctionCall obj_1 | obj_1=target_31.getRValue() |
		obj_1.getTarget().hasName("platform_get_irq")
		and obj_1.getArgument(0).(VariableAccess).getTarget()=vpdev_1391
		and obj_1.getArgument(1).(Literal).getValue()="0"
	)
}

predicate func_32(Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_32) {
	exists(RelationalOperation obj_0 | obj_0=target_32.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLesserOperand() |
			obj_1.getTarget().getName()="irq"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getGreaterOperand().(Literal).getValue()="0"
	)
	and exists(BlockStmt obj_2 | obj_2=target_32.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(PointerFieldAccess obj_5 | obj_5=obj_4.getRValue() |
					obj_5.getTarget().getName()="irq"
					and obj_5.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
				and obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_32
}

predicate func_33(Variable vanv_1394, Variable vret_1395, RelationalOperation target_133, ExprStmt target_33) {
	exists(AssignExpr obj_0 | obj_0=target_33.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getRValue() |
			obj_1.getTarget().getName()="irq"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and target_33.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_133
}

/*predicate func_34(RelationalOperation target_133, Function func, GotoStmt target_34) {
	target_34.getName() ="put_dev"
	and target_34.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_133
	and target_34.getEnclosingFunction() = func
}

*/
predicate func_35(Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_35) {
	exists(NotExpr obj_0 | obj_0=target_35.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			obj_1.getTarget().getName()="irq"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
	)
	and exists(BlockStmt obj_2 | obj_2=target_35.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
				and obj_4.getRValue().(UnaryMinusExpr).getValue()="-6"
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
}

/*predicate func_36(Variable vret_1395, NotExpr target_134, ExprStmt target_33, ExprStmt target_36) {
	exists(AssignExpr obj_0 | obj_0=target_36.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
		and obj_0.getRValue().(UnaryMinusExpr).getValue()="-6"
	)
	and target_36.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_134
	and target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_36.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

*/
/*predicate func_37(NotExpr target_134, Function func, GotoStmt target_37) {
	target_37.getName() ="put_dev"
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_134
	and target_37.getEnclosingFunction() = func
}

*/
predicate func_38(Parameter vpdev_1391, Variable vanv_1394, Function func, ExprStmt target_38) {
	exists(AssignExpr obj_0 | obj_0=target_38.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="mmio_coproc"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			obj_2.getTarget().hasName("devm_platform_ioremap_resource_byname")
			and obj_2.getArgument(0).(VariableAccess).getTarget()=vpdev_1391
			and obj_2.getArgument(1).(StringLiteral).getValue()="ans"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

predicate func_39(Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_39) {
	exists(FunctionCall obj_0 | obj_0=target_39.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(0) |
			obj_1.getTarget().getName()="mmio_coproc"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().hasName("IS_ERR")
	)
	and exists(BlockStmt obj_2 | obj_2=target_39.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(FunctionCall obj_5 | obj_5=obj_4.getRValue() |
					exists(PointerFieldAccess obj_6 | obj_6=obj_5.getArgument(0) |
						obj_6.getTarget().getName()="mmio_coproc"
						and obj_6.getQualifier().(VariableAccess).getTarget()=vanv_1394
					)
					and obj_5.getTarget().hasName("PTR_ERR")
				)
				and obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_39
}

/*predicate func_40(Variable vanv_1394, ExprStmt target_38, ExprStmt target_41, PointerFieldAccess target_40) {
	target_40.getTarget().getName()="mmio_coproc"
	and target_40.getQualifier().(VariableAccess).getTarget()=vanv_1394
	and target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_40.getQualifier().(VariableAccess).getLocation())
	and target_40.getQualifier().(VariableAccess).getLocation().isBefore(target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
predicate func_41(Variable vanv_1394, Variable vret_1395, ExprStmt target_41) {
	exists(AssignExpr obj_0 | obj_0=target_41.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getArgument(0) |
				obj_2.getTarget().getName()="mmio_coproc"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().hasName("PTR_ERR")
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
}

/*predicate func_42(Variable vanv_1394, FunctionCall target_135, ExprStmt target_44, PointerFieldAccess target_42) {
	target_42.getTarget().getName()="mmio_coproc"
	and target_42.getQualifier().(VariableAccess).getTarget()=vanv_1394
	and target_135.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_42.getQualifier().(VariableAccess).getLocation())
	and target_42.getQualifier().(VariableAccess).getLocation().isBefore(target_44.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
/*predicate func_43(FunctionCall target_135, Function func, GotoStmt target_43) {
	target_43.getName() ="put_dev"
	and target_43.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_135
	and target_43.getEnclosingFunction() = func
}

*/
predicate func_44(Parameter vpdev_1391, Variable vanv_1394, Function func, ExprStmt target_44) {
	exists(AssignExpr obj_0 | obj_0=target_44.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="mmio_nvme"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			obj_2.getTarget().hasName("devm_platform_ioremap_resource_byname")
			and obj_2.getArgument(0).(VariableAccess).getTarget()=vpdev_1391
			and obj_2.getArgument(1).(StringLiteral).getValue()="nvme"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_44
}

predicate func_45(Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_45) {
	exists(FunctionCall obj_0 | obj_0=target_45.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(0) |
			obj_1.getTarget().getName()="mmio_nvme"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().hasName("IS_ERR")
	)
	and exists(BlockStmt obj_2 | obj_2=target_45.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(FunctionCall obj_5 | obj_5=obj_4.getRValue() |
					exists(PointerFieldAccess obj_6 | obj_6=obj_5.getArgument(0) |
						obj_6.getTarget().getName()="mmio_nvme"
						and obj_6.getQualifier().(VariableAccess).getTarget()=vanv_1394
					)
					and obj_5.getTarget().hasName("PTR_ERR")
				)
				and obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_45
}

/*predicate func_46(Variable vanv_1394, Variable vret_1395, FunctionCall target_136, ExprStmt target_46) {
	exists(AssignExpr obj_0 | obj_0=target_46.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getArgument(0) |
				obj_2.getTarget().getName()="mmio_nvme"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().hasName("PTR_ERR")
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and target_46.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_136
}

*/
/*predicate func_47(FunctionCall target_136, Function func, GotoStmt target_47) {
	target_47.getName() ="put_dev"
	and target_47.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_136
	and target_47.getEnclosingFunction() = func
}

*/
predicate func_48(Variable vanv_1394, Function func, ExprStmt target_48) {
	exists(AssignExpr obj_0 | obj_0=target_48.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				obj_2.getTarget().getName()="adminq"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().getName()="sq_db"
		)
		and exists(PointerArithmeticOperation obj_3 | obj_3=obj_0.getRValue() |
			exists(PointerFieldAccess obj_4 | obj_4=obj_3.getLeftOperand() |
				obj_4.getTarget().getName()="mmio_nvme"
				and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_3.getRightOperand().(Literal).getValue()="149772"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Variable vanv_1394, Function func, ExprStmt target_49) {
	exists(AssignExpr obj_0 | obj_0=target_49.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				obj_2.getTarget().getName()="adminq"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().getName()="cq_db"
		)
		and exists(PointerArithmeticOperation obj_3 | obj_3=obj_0.getRValue() |
			exists(PointerFieldAccess obj_4 | obj_4=obj_3.getLeftOperand() |
				obj_4.getTarget().getName()="mmio_nvme"
				and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_3.getRightOperand().(Literal).getValue()="4100"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
}

predicate func_50(Variable vanv_1394, Function func, ExprStmt target_50) {
	exists(AssignExpr obj_0 | obj_0=target_50.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				obj_2.getTarget().getName()="ioq"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().getName()="sq_db"
		)
		and exists(PointerArithmeticOperation obj_3 | obj_3=obj_0.getRValue() |
			exists(PointerFieldAccess obj_4 | obj_4=obj_3.getLeftOperand() |
				obj_4.getTarget().getName()="mmio_nvme"
				and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_3.getRightOperand().(Literal).getValue()="149776"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_50
}

predicate func_51(Variable vanv_1394, Function func, ExprStmt target_51) {
	exists(AssignExpr obj_0 | obj_0=target_51.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				obj_2.getTarget().getName()="ioq"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().getName()="cq_db"
		)
		and exists(PointerArithmeticOperation obj_3 | obj_3=obj_0.getRValue() |
			exists(PointerFieldAccess obj_4 | obj_4=obj_3.getLeftOperand() |
				obj_4.getTarget().getName()="mmio_nvme"
				and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_3.getRightOperand().(Literal).getValue()="4108"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
}

predicate func_52(Variable vdev_1393, Variable vanv_1394, Function func, ExprStmt target_52) {
	exists(AssignExpr obj_0 | obj_0=target_52.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="sart"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			obj_2.getTarget().hasName("devm_apple_sart_get")
			and obj_2.getArgument(0).(VariableAccess).getTarget()=vdev_1393
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_52
}

predicate func_53(Variable vdev_1393, Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_53) {
	exists(FunctionCall obj_0 | obj_0=target_53.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(0) |
			obj_1.getTarget().getName()="sart"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().hasName("IS_ERR")
	)
	and exists(BlockStmt obj_2 | obj_2=target_53.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(FunctionCall obj_5 | obj_5=obj_4.getRValue() |
					exists(FunctionCall obj_6 | obj_6=obj_5.getArgument(1) |
						obj_6.getTarget().hasName("PTR_ERR")
						and obj_6.getArgument(0).(PointerFieldAccess).getTarget().getName()="sart"
					)
					and obj_5.getTarget().hasName("dev_err_probe")
					and obj_5.getArgument(0).(VariableAccess).getTarget()=vdev_1393
					and obj_5.getArgument(2).(StringLiteral).getValue()="Failed to initialize SART"
				)
				and obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_53
}

/*predicate func_54(Variable vdev_1393, Variable vanv_1394, Variable vret_1395, FunctionCall target_137, ExprStmt target_54) {
	exists(AssignExpr obj_0 | obj_0=target_54.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getArgument(1) |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getTarget().getName()="sart"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
				and obj_2.getTarget().hasName("PTR_ERR")
			)
			and obj_1.getTarget().hasName("dev_err_probe")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vdev_1393
			and obj_1.getArgument(2).(StringLiteral).getValue()="Failed to initialize SART"
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and target_54.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_137
}

*/
/*predicate func_55(FunctionCall target_137, Function func, GotoStmt target_55) {
	target_55.getName() ="put_dev"
	and target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_137
	and target_55.getEnclosingFunction() = func
}

*/
predicate func_56(Variable vanv_1394, Function func, ExprStmt target_56) {
	exists(AssignExpr obj_0 | obj_0=target_56.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="reset"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArgument(0) |
				obj_3.getTarget().getName()="dev"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_2.getTarget().hasName("devm_reset_control_array_get_exclusive")
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_56
}

predicate func_57(Variable vdev_1393, Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_57) {
	exists(FunctionCall obj_0 | obj_0=target_57.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(0) |
			obj_1.getTarget().getName()="reset"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().hasName("IS_ERR")
	)
	and exists(BlockStmt obj_2 | obj_2=target_57.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(FunctionCall obj_5 | obj_5=obj_4.getRValue() |
					exists(FunctionCall obj_6 | obj_6=obj_5.getArgument(1) |
						obj_6.getTarget().hasName("PTR_ERR")
						and obj_6.getArgument(0).(PointerFieldAccess).getTarget().getName()="reset"
					)
					and obj_5.getTarget().hasName("dev_err_probe")
					and obj_5.getArgument(0).(VariableAccess).getTarget()=vdev_1393
					and obj_5.getArgument(2).(StringLiteral).getValue()="Failed to get reset control"
				)
				and obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_57
}

/*predicate func_58(Variable vdev_1393, Variable vanv_1394, Variable vret_1395, FunctionCall target_138, ExprStmt target_58) {
	exists(AssignExpr obj_0 | obj_0=target_58.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getArgument(1) |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getTarget().getName()="reset"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
				and obj_2.getTarget().hasName("PTR_ERR")
			)
			and obj_1.getTarget().hasName("dev_err_probe")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vdev_1393
			and obj_1.getArgument(2).(StringLiteral).getValue()="Failed to get reset control"
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and target_58.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_138
}

*/
/*predicate func_59(FunctionCall target_138, Function func, GotoStmt target_59) {
	target_59.getName() ="put_dev"
	and target_59.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_138
	and target_59.getEnclosingFunction() = func
}

*/
predicate func_60(Function func, DoStmt target_60) {
	exists(BlockStmt obj_0 | obj_0=target_60.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(1) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(2) |
					exists(FunctionCall obj_4 | obj_4=obj_3.getExpr() |
						obj_4.getTarget().hasName("lockdep_init_map")
						and obj_4.getArgument(1).(StringLiteral).getValue()="(work_completion)(&anv->ctrl.reset_work)"
						and obj_4.getArgument(3).(Literal).getValue()="0"
					)
				)
				and obj_2.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
				and obj_2.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="data"
				and obj_2.getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("INIT_LIST_HEAD")
				and obj_2.getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="func"
			)
			and obj_1.getCondition().(Literal).getValue()="0"
		)
	)
	and target_60.getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_60
}

/*predicate func_62(Variable v__key_1455, DoStmt target_62) {
	exists(BlockStmt obj_0 | obj_0=target_62.getStmt() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getStmt(1) |
			exists(AssignExpr obj_2 | obj_2=obj_1.getExpr() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getLValue() |
					obj_3.getTarget().getName()="data"
					and obj_3.getQualifier().(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="reset_work"
				)
				and obj_2.getRValue().(ClassAggregateLiteral).getAFieldExpr(counter).(BinaryBitwiseOperation).getValue()="9007199250546688"
			)
		)
		and exists(ExprStmt obj_4 | obj_4=obj_0.getStmt(2) |
			exists(FunctionCall obj_5 | obj_5=obj_4.getExpr() |
				obj_5.getTarget().hasName("lockdep_init_map")
				and obj_5.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lockdep_map"
				and obj_5.getArgument(1).(StringLiteral).getValue()="(work_completion)(&anv->ctrl.reset_work)"
				and obj_5.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_1455
				and obj_5.getArgument(3).(Literal).getValue()="0"
			)
		)
		and exists(ExprStmt obj_6 | obj_6=obj_0.getStmt(3) |
			exists(FunctionCall obj_7 | obj_7=obj_6.getExpr() |
				obj_7.getTarget().hasName("INIT_LIST_HEAD")
				and obj_7.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="entry"
			)
		)
		and exists(ExprStmt obj_8 | obj_8=obj_0.getStmt(4) |
			exists(AssignExpr obj_9 | obj_9=obj_8.getExpr() |
				exists(PointerFieldAccess obj_10 | obj_10=obj_9.getLValue() |
					obj_10.getTarget().getName()="func"
					and obj_10.getQualifier().(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="reset_work"
				)
			)
		)
		and obj_0.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	)
	and target_62.getCondition().(Literal).getValue()="0"
}

*/
/*predicate func_63(Function func, ExprStmt target_63) {
	target_63.getExpr() instanceof FunctionCall
	and target_63.getEnclosingFunction() = func
}

*/
predicate func_64(Variable vanv_1394, ValueFieldAccess target_64) {
	exists(PointerFieldAccess obj_0 | obj_0=target_64.getQualifier() |
		obj_0.getTarget().getName()="ctrl"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_64.getTarget().getName()="reset_work"
	and target_64.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

/*predicate func_65(Variable vanv_1394, AssignExpr target_65) {
	exists(PointerFieldAccess obj_0 | obj_0=target_65.getLValue() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getQualifier() |
			exists(ValueFieldAccess obj_2 | obj_2=obj_1.getOperand() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
					obj_3.getTarget().getName()="ctrl"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
				and obj_2.getTarget().getName()="reset_work"
			)
		)
		and obj_0.getTarget().getName()="data"
	)
	and target_65.getRValue().(ClassAggregateLiteral).getAFieldExpr(counter).(BinaryBitwiseOperation).getValue()="9007199250546688"
}

*/
/*predicate func_66(Variable v__key_1455, ExprStmt target_66) {
	exists(FunctionCall obj_0 | obj_0=target_66.getExpr() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getArgument(0) |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getOperand() |
				exists(AddressOfExpr obj_3 | obj_3=obj_2.getQualifier() |
					exists(ValueFieldAccess obj_4 | obj_4=obj_3.getOperand() |
						obj_4.getTarget().getName()="reset_work"
						and obj_4.getQualifier().(PointerFieldAccess).getTarget().getName()="ctrl"
					)
				)
				and obj_2.getTarget().getName()="lockdep_map"
			)
		)
		and obj_0.getTarget().hasName("lockdep_init_map")
		and obj_0.getArgument(1).(StringLiteral).getValue()="(work_completion)(&anv->ctrl.reset_work)"
		and obj_0.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_1455
		and obj_0.getArgument(3).(Literal).getValue()="0"
	)
}

*/
/*predicate func_67(Function func, ExprStmt target_67) {
	exists(FunctionCall obj_0 | obj_0=target_67.getExpr() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getArgument(0) |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getOperand() |
				exists(AddressOfExpr obj_3 | obj_3=obj_2.getQualifier() |
					exists(ValueFieldAccess obj_4 | obj_4=obj_3.getOperand() |
						obj_4.getTarget().getName()="reset_work"
						and obj_4.getQualifier().(PointerFieldAccess).getTarget().getName()="ctrl"
					)
				)
				and obj_2.getTarget().getName()="entry"
			)
		)
		and obj_0.getTarget().hasName("INIT_LIST_HEAD")
	)
	and target_67.getEnclosingFunction() = func
}

*/
/*predicate func_68(Variable vanv_1394, ExprStmt target_68) {
	exists(AssignExpr obj_0 | obj_0=target_68.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(AddressOfExpr obj_2 | obj_2=obj_1.getQualifier() |
				exists(ValueFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					exists(PointerFieldAccess obj_4 | obj_4=obj_3.getQualifier() |
						obj_4.getTarget().getName()="ctrl"
						and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
					)
					and obj_3.getTarget().getName()="reset_work"
				)
			)
			and obj_1.getTarget().getName()="func"
		)
	)
}

*/
predicate func_69(Function func, DoStmt target_69) {
	exists(BlockStmt obj_0 | obj_0=target_69.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(1) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
					exists(FunctionCall obj_4 | obj_4=obj_3.getExpr() |
						obj_4.getTarget().hasName("__init_work")
						and obj_4.getArgument(1).(Literal).getValue()="0"
					)
				)
				and exists(ExprStmt obj_5 | obj_5=obj_2.getStmt(2) |
					exists(FunctionCall obj_6 | obj_6=obj_5.getExpr() |
						obj_6.getTarget().hasName("lockdep_init_map")
						and obj_6.getArgument(1).(StringLiteral).getValue()="(work_completion)(&anv->remove_work)"
						and obj_6.getArgument(3).(Literal).getValue()="0"
					)
				)
				and obj_2.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="data"
				and obj_2.getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("INIT_LIST_HEAD")
				and obj_2.getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="func"
			)
			and obj_1.getCondition().(Literal).getValue()="0"
		)
	)
	and target_69.getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_69
}

/*predicate func_71(Variable vanv_1394, Variable v__key_1456, DoStmt target_71) {
	exists(BlockStmt obj_0 | obj_0=target_71.getStmt() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getStmt(0) |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				exists(AddressOfExpr obj_3 | obj_3=obj_2.getArgument(0) |
					exists(PointerFieldAccess obj_4 | obj_4=obj_3.getOperand() |
						obj_4.getTarget().getName()="remove_work"
						and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
					)
				)
				and obj_2.getTarget().hasName("__init_work")
				and obj_2.getArgument(1).(Literal).getValue()="0"
			)
		)
		and exists(ExprStmt obj_5 | obj_5=obj_0.getStmt(1) |
			exists(AssignExpr obj_6 | obj_6=obj_5.getExpr() |
				exists(PointerFieldAccess obj_7 | obj_7=obj_6.getLValue() |
					obj_7.getTarget().getName()="data"
					and obj_7.getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="remove_work"
				)
				and obj_6.getRValue().(ClassAggregateLiteral).getAFieldExpr(counter).(BinaryBitwiseOperation).getValue()="9007199250546688"
			)
		)
		and exists(ExprStmt obj_8 | obj_8=obj_0.getStmt(2) |
			exists(FunctionCall obj_9 | obj_9=obj_8.getExpr() |
				obj_9.getTarget().hasName("lockdep_init_map")
				and obj_9.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lockdep_map"
				and obj_9.getArgument(1).(StringLiteral).getValue()="(work_completion)(&anv->remove_work)"
				and obj_9.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_1456
				and obj_9.getArgument(3).(Literal).getValue()="0"
			)
		)
		and exists(ExprStmt obj_10 | obj_10=obj_0.getStmt(3) |
			exists(FunctionCall obj_11 | obj_11=obj_10.getExpr() |
				obj_11.getTarget().hasName("INIT_LIST_HEAD")
				and obj_11.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="entry"
			)
		)
		and exists(ExprStmt obj_12 | obj_12=obj_0.getStmt(4) |
			exists(AssignExpr obj_13 | obj_13=obj_12.getExpr() |
				exists(PointerFieldAccess obj_14 | obj_14=obj_13.getLValue() |
					obj_14.getTarget().getName()="func"
					and obj_14.getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="remove_work"
				)
			)
		)
	)
	and target_71.getCondition().(Literal).getValue()="0"
}

*/
/*predicate func_72(Variable vanv_1394, ExprStmt target_72) {
	exists(FunctionCall obj_0 | obj_0=target_72.getExpr() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getArgument(0) |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getOperand() |
				obj_2.getTarget().getName()="remove_work"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
		)
		and obj_0.getTarget().hasName("__init_work")
		and obj_0.getArgument(1).(Literal).getValue()="0"
	)
}

*/
/*predicate func_73(Variable vanv_1394, ExprStmt target_73) {
	exists(AssignExpr obj_0 | obj_0=target_73.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(AddressOfExpr obj_2 | obj_2=obj_1.getQualifier() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					obj_3.getTarget().getName()="remove_work"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
			)
			and obj_1.getTarget().getName()="data"
		)
		and obj_0.getRValue().(ClassAggregateLiteral).getAFieldExpr(counter).(BinaryBitwiseOperation).getValue()="9007199250546688"
	)
}

*/
/*predicate func_74(Variable vanv_1394, Variable v__key_1456, ExprStmt target_74) {
	exists(FunctionCall obj_0 | obj_0=target_74.getExpr() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getArgument(0) |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getOperand() |
				exists(AddressOfExpr obj_3 | obj_3=obj_2.getQualifier() |
					exists(PointerFieldAccess obj_4 | obj_4=obj_3.getOperand() |
						obj_4.getTarget().getName()="remove_work"
						and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
					)
				)
				and obj_2.getTarget().getName()="lockdep_map"
			)
		)
		and obj_0.getTarget().hasName("lockdep_init_map")
		and obj_0.getArgument(1).(StringLiteral).getValue()="(work_completion)(&anv->remove_work)"
		and obj_0.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_1456
		and obj_0.getArgument(3).(Literal).getValue()="0"
	)
}

*/
/*predicate func_75(Variable vanv_1394, ExprStmt target_75) {
	exists(FunctionCall obj_0 | obj_0=target_75.getExpr() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getArgument(0) |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getOperand() |
				exists(AddressOfExpr obj_3 | obj_3=obj_2.getQualifier() |
					exists(PointerFieldAccess obj_4 | obj_4=obj_3.getOperand() |
						obj_4.getTarget().getName()="remove_work"
						and obj_4.getQualifier().(VariableAccess).getTarget()=vanv_1394
					)
				)
				and obj_2.getTarget().getName()="entry"
			)
		)
		and obj_0.getTarget().hasName("INIT_LIST_HEAD")
	)
}

*/
/*predicate func_76(Variable vanv_1394, ExprStmt target_76) {
	exists(AssignExpr obj_0 | obj_0=target_76.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			exists(AddressOfExpr obj_2 | obj_2=obj_1.getQualifier() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					obj_3.getTarget().getName()="remove_work"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
			)
			and obj_1.getTarget().getName()="func"
		)
	)
}

*/
predicate func_77(Variable v__key_1457, Function func, DoStmt target_77) {
	exists(BlockStmt obj_0 | obj_0=target_77.getStmt() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getStmt(1) |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				exists(FunctionCall obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getTarget().hasName("spinlock_check")
					and obj_3.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
				)
				and obj_2.getTarget().hasName("__raw_spin_lock_init")
				and obj_2.getArgument(1).(StringLiteral).getValue()="&anv->lock"
				and obj_2.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_1457
			)
		)
	)
	and target_77.getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_77
}

/*predicate func_79(Variable vanv_1394, Variable v__key_1457, ExprStmt target_79) {
	exists(FunctionCall obj_0 | obj_0=target_79.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getArgument(0) |
			exists(AddressOfExpr obj_2 | obj_2=obj_1.getArgument(0) |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					obj_3.getTarget().getName()="lock"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
			)
			and obj_1.getTarget().hasName("spinlock_check")
		)
		and obj_0.getTarget().hasName("__raw_spin_lock_init")
		and obj_0.getArgument(1).(StringLiteral).getValue()="&anv->lock"
		and obj_0.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_1457
	)
}

*/
predicate func_80(Variable vanv_1394, Variable vret_1395, Function func, ExprStmt target_80) {
	exists(AssignExpr obj_0 | obj_0=target_80.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(AddressOfExpr obj_2 | obj_2=obj_1.getArgument(1) |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					obj_3.getTarget().getName()="adminq"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
			)
			and obj_1.getTarget().hasName("apple_nvme_queue_alloc")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_80
}

predicate func_81(Variable vret_1395, ExprStmt target_80, Function func, IfStmt target_81) {
	target_81.getCondition().(VariableAccess).getTarget()=vret_1395
	and target_81.getThen().(GotoStmt).getName() ="put_dev"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_81
	and target_80.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_81.getCondition().(VariableAccess).getLocation())
}

predicate func_82(Variable vanv_1394, Variable vret_1395, Function func, ExprStmt target_82) {
	exists(AssignExpr obj_0 | obj_0=target_82.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(AddressOfExpr obj_2 | obj_2=obj_1.getArgument(1) |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					obj_3.getTarget().getName()="ioq"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
			)
			and obj_1.getTarget().hasName("apple_nvme_queue_alloc")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_82
}

predicate func_83(Variable vret_1395, ExprStmt target_82, Function func, IfStmt target_83) {
	target_83.getCondition().(VariableAccess).getTarget()=vret_1395
	and target_83.getThen().(GotoStmt).getName() ="put_dev"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_83
	and target_82.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_83.getCondition().(VariableAccess).getLocation())
}

predicate func_84(Variable vanv_1394, Function func, ExprStmt target_84) {
	exists(AssignExpr obj_0 | obj_0=target_84.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="prp_page_pool"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArgument(1) |
				obj_3.getTarget().getName()="dev"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_2.getTarget().hasName("dmam_pool_create")
			and obj_2.getArgument(0).(StringLiteral).getValue()="prp list page"
			and obj_2.getArgument(2).(BinaryBitwiseOperation).getValue()="4096"
			and obj_2.getArgument(3).(BinaryBitwiseOperation).getValue()="4096"
			and obj_2.getArgument(4).(Literal).getValue()="0"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_84
}

predicate func_85(Variable vanv_1394, Function func, IfStmt target_85) {
	exists(NotExpr obj_0 | obj_0=target_85.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			obj_1.getTarget().getName()="prp_page_pool"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
	)
	and exists(BlockStmt obj_2 | obj_2=target_85.getThen() |
		obj_2.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_85
}

predicate func_86(NotExpr target_139, Function func, ExprStmt target_86) {
	target_86.getExpr() instanceof AssignExpr
	and target_86.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_139
	and target_86.getEnclosingFunction() = func
}

/*predicate func_87(NotExpr target_139, Function func, GotoStmt target_87) {
	target_87.getName() ="put_dev"
	and target_87.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_139
	and target_87.getEnclosingFunction() = func
}

*/
predicate func_88(Variable vanv_1394, Function func, ExprStmt target_88) {
	exists(AssignExpr obj_0 | obj_0=target_88.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="prp_small_pool"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArgument(1) |
				obj_3.getTarget().getName()="dev"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_2.getTarget().hasName("dmam_pool_create")
			and obj_2.getArgument(0).(StringLiteral).getValue()="prp list 256"
			and obj_2.getArgument(2).(Literal).getValue()="256"
			and obj_2.getArgument(3).(Literal).getValue()="256"
			and obj_2.getArgument(4).(Literal).getValue()="0"
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_88
}

predicate func_89(Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_89) {
	exists(NotExpr obj_0 | obj_0=target_89.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			obj_1.getTarget().getName()="prp_small_pool"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
	)
	and exists(BlockStmt obj_2 | obj_2=target_89.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
				and obj_4.getRValue().(UnaryMinusExpr).getValue()="-12"
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_89
}

predicate func_90(Variable vret_1395, NotExpr target_140, ExprStmt target_86, ExprStmt target_90) {
	exists(AssignExpr obj_0 | obj_0=target_90.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
		and obj_0.getRValue().(UnaryMinusExpr).getValue()="-12"
	)
	and target_90.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_140
}

/*predicate func_91(NotExpr target_140, Function func, GotoStmt target_91) {
	target_91.getName() ="put_dev"
	and target_91.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_140
	and target_91.getEnclosingFunction() = func
}

*/
predicate func_92(Function func, ExprStmt target_92) {
	exists(StmtExpr obj_0 | obj_0=target_92.getExpr() |
		exists(BlockStmt obj_1 | obj_1=obj_0.getStmt() |
			exists(IfStmt obj_2 | obj_2=obj_1.getStmt(1) |
				exists(FunctionCall obj_3 | obj_3=obj_2.getCondition() |
					obj_3.getTarget().hasName("__builtin_expect")
					and obj_3.getArgument(1) instanceof Literal
				)
				and obj_2.getThen().(DoStmt).getCondition() instanceof Literal
			)
			and exists(ExprStmt obj_4 | obj_4=obj_1.getStmt(2) |
				exists(FunctionCall obj_5 | obj_5=obj_4.getExpr() |
					obj_5.getTarget().hasName("__builtin_expect")
					and obj_5.getArgument(1) instanceof Literal
				)
			)
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_92
}

/*predicate func_94(Variable v__ret_warn_on_1481, Variable v__flags_1481, IfStmt target_94) {
	exists(FunctionCall obj_0 | obj_0=target_94.getCondition() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1481
		and obj_0.getArgument(1) instanceof Literal
	)
	and exists(DoStmt obj_1 | obj_1=target_94.getThen() |
		exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
			exists(DoStmt obj_3 | obj_3=obj_2.getStmt(2) |
				exists(BlockStmt obj_4 | obj_4=obj_3.getStmt() |
					exists(AsmStmt obj_5 | obj_5=obj_4.getStmt(0) |
						exists(SizeofTypeOperator obj_6 | obj_6=obj_5.getChild(3) |
							obj_6.getType() instanceof LongType
							and obj_6.getValue()="12"
						)
						and obj_5.getChild(0) instanceof StringLiteral
						and obj_5.getChild(1) instanceof Literal
						and obj_5.getChild(2).(VariableAccess).getTarget()=v__flags_1481
					)
				)
				and obj_3.getCondition() instanceof Literal
			)
		)
		and obj_1.getCondition() instanceof Literal
	)
}

*/
/*predicate func_96(Function func, ExprStmt target_96) {
	target_96.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0).(Literal).getValue()="1632"
	and target_96.getEnclosingFunction() = func
}

*/
/*predicate func_97(Function func, AsmStmt target_97) {
	target_97.getChild(0).(Literal).getValue()="1632"
	and target_97.getEnclosingFunction() = func
}

*/
/*predicate func_98(Variable v__flags_1481, DoStmt target_98) {
	exists(BlockStmt obj_0 | obj_0=target_98.getStmt() |
		exists(AsmStmt obj_1 | obj_1=obj_0.getStmt(0) |
			exists(SizeofTypeOperator obj_2 | obj_2=obj_1.getChild(3) |
				obj_2.getType() instanceof LongType
				and obj_2.getValue()="12"
			)
			and obj_1.getChild(0) instanceof StringLiteral
			and obj_1.getChild(1) instanceof Literal
			and obj_1.getChild(2).(VariableAccess).getTarget()=v__flags_1481
		)
	)
	and target_98.getCondition() instanceof Literal
}

*/
/*predicate func_99(Variable v__flags_1481, AsmStmt target_99) {
	exists(SizeofTypeOperator obj_0 | obj_0=target_99.getChild(3) |
		obj_0.getType() instanceof LongType
		and obj_0.getValue()="12"
	)
	and target_99.getChild(0) instanceof StringLiteral
	and target_99.getChild(1) instanceof Literal
	and target_99.getChild(2).(VariableAccess).getTarget()=v__flags_1481
}

*/
/*predicate func_100(Function func, ExprStmt target_100) {
	target_100.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0).(Literal).getValue()="1633"
	and target_100.getEnclosingFunction() = func
}

*/
/*predicate func_101(Function func, AsmStmt target_101) {
	target_101.getChild(0).(Literal).getValue()="1633"
	and target_101.getEnclosingFunction() = func
}

*/
/*predicate func_102(Variable v__ret_warn_on_1481, ExprStmt target_102) {
	exists(FunctionCall obj_0 | obj_0=target_102.getExpr() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1481
		and obj_0.getArgument(1) instanceof Literal
	)
}

*/
predicate func_103(Variable vanv_1394, Function func, ExprStmt target_103) {
	exists(AssignExpr obj_0 | obj_0=target_103.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="iod_mempool"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_103
}

/*predicate func_105(Variable v_res_1483, ExprStmt target_105) {
	exists(StmtExpr obj_0 | obj_0=target_105.getExpr() |
		exists(BlockStmt obj_1 | obj_1=obj_0.getStmt() |
			obj_1.getStmt(2).(DoStmt).getCondition().(Literal).getValue()="0"
			and obj_1.getStmt(3).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_res_1483
		)
	)
}

*/
/*predicate func_108(Function func, DoStmt target_108) {
	target_108.getCondition().(Literal).getValue()="0"
	and target_108.getEnclosingFunction() = func
}

*/
/*predicate func_109(Variable v_res_1483, ExprStmt target_109) {
	target_109.getExpr().(VariableAccess).getTarget()=v_res_1483
}

*/
predicate func_110(Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_110) {
	exists(NotExpr obj_0 | obj_0=target_110.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			obj_1.getTarget().getName()="iod_mempool"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
	)
	and exists(BlockStmt obj_2 | obj_2=target_110.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
				and obj_4.getRValue().(UnaryMinusExpr).getValue()="-12"
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_110
}

/*predicate func_111(Variable vret_1395, NotExpr target_141, ExprStmt target_90, ExprStmt target_111) {
	exists(AssignExpr obj_0 | obj_0=target_111.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
		and obj_0.getRValue().(UnaryMinusExpr).getValue()="-12"
	)
	and target_111.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_141
	and target_90.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_111.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

*/
/*predicate func_112(NotExpr target_141, Function func, GotoStmt target_112) {
	target_112.getName() ="put_dev"
	and target_112.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_141
	and target_112.getEnclosingFunction() = func
}

*/
predicate func_113(Variable vanv_1394, Variable vret_1395, Function func, ExprStmt target_113) {
	exists(AssignExpr obj_0 | obj_0=target_113.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getArgument(0) |
				obj_2.getTarget().getName()="dev"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and exists(PointerFieldAccess obj_3 | obj_3=obj_1.getArgument(2) |
				obj_3.getTarget().getName()="iod_mempool"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().hasName("__devm_add_action_or_reset")
			and obj_1.getArgument(3).(StringLiteral).getValue()="devm_apple_nvme_mempool_destroy"
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_113
}

predicate func_114(Variable vret_1395, ExprStmt target_113, Function func, IfStmt target_114) {
	target_114.getCondition().(VariableAccess).getTarget()=vret_1395
	and target_114.getThen().(GotoStmt).getName() ="put_dev"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_114
	and target_113.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_114.getCondition().(VariableAccess).getLocation())
}

predicate func_115(Variable vanv_1394, Variable vret_1395, Function func, ExprStmt target_115) {
	exists(AssignExpr obj_0 | obj_0=target_115.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			obj_1.getTarget().hasName("apple_nvme_alloc_tagsets")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_115
}

predicate func_116(Variable vret_1395, ExprStmt target_115, Function func, IfStmt target_116) {
	target_116.getCondition().(VariableAccess).getTarget()=vret_1395
	and target_116.getThen().(GotoStmt).getName() ="put_dev"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_116
	and target_115.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_116.getCondition().(VariableAccess).getLocation())
}

predicate func_117(Variable vanv_1394, Variable vret_1395, Function func, ExprStmt target_117) {
	exists(AssignExpr obj_0 | obj_0=target_117.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getArgument(0) |
				obj_2.getTarget().getName()="dev"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and exists(PointerFieldAccess obj_3 | obj_3=obj_1.getArgument(1) |
				obj_3.getTarget().getName()="irq"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().hasName("devm_request_irq")
			and obj_1.getArgument(3).(Literal).getValue()="0"
			and obj_1.getArgument(4).(StringLiteral).getValue()="nvme-apple"
			and obj_1.getArgument(5).(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_117
}

predicate func_118(Variable vdev_1393, Variable vret_1395, Function func, IfStmt target_118) {
	exists(BlockStmt obj_0 | obj_0=target_118.getThen() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getStmt(0) |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				obj_2.getTarget().hasName("dev_err_probe")
				and obj_2.getArgument(0).(VariableAccess).getTarget()=vdev_1393
				and obj_2.getArgument(1).(VariableAccess).getTarget()=vret_1395
				and obj_2.getArgument(2).(StringLiteral).getValue()="Failed to request IRQ"
			)
		)
		and obj_0.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and target_118.getCondition().(VariableAccess).getTarget()=vret_1395
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_118
}

/*predicate func_119(Variable vdev_1393, Variable vret_1395, VariableAccess target_142, ExprStmt target_119) {
	exists(FunctionCall obj_0 | obj_0=target_119.getExpr() |
		obj_0.getTarget().hasName("dev_err_probe")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vdev_1393
		and obj_0.getArgument(1).(VariableAccess).getTarget()=vret_1395
		and obj_0.getArgument(2).(StringLiteral).getValue()="Failed to request IRQ"
	)
	and target_119.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_142
}

*/
/*predicate func_120(VariableAccess target_142, Function func, GotoStmt target_120) {
	target_120.getName() ="put_dev"
	and target_120.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_142
	and target_120.getEnclosingFunction() = func
}

*/
predicate func_121(Variable vdev_1393, Variable vanv_1394, Variable vapple_nvme_rtkit_ops, Function func, ExprStmt target_121) {
	exists(AssignExpr obj_0 | obj_0=target_121.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="rtk"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and exists(FunctionCall obj_2 | obj_2=obj_0.getRValue() |
			obj_2.getTarget().hasName("devm_apple_rtkit_init")
			and obj_2.getArgument(0).(VariableAccess).getTarget()=vdev_1393
			and obj_2.getArgument(1).(VariableAccess).getTarget()=vanv_1394
			and obj_2.getArgument(2).(Literal).getValue()="0"
			and obj_2.getArgument(3).(Literal).getValue()="0"
			and obj_2.getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vapple_nvme_rtkit_ops
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_121
}

predicate func_122(Variable vdev_1393, Variable vanv_1394, Variable vret_1395, Function func, IfStmt target_122) {
	exists(FunctionCall obj_0 | obj_0=target_122.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(0) |
			obj_1.getTarget().getName()="rtk"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().hasName("IS_ERR")
	)
	and exists(BlockStmt obj_2 | obj_2=target_122.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(FunctionCall obj_5 | obj_5=obj_4.getRValue() |
					exists(FunctionCall obj_6 | obj_6=obj_5.getArgument(1) |
						obj_6.getTarget().hasName("PTR_ERR")
						and obj_6.getArgument(0).(PointerFieldAccess).getTarget().getName()="rtk"
					)
					and obj_5.getTarget().hasName("dev_err_probe")
					and obj_5.getArgument(0).(VariableAccess).getTarget()=vdev_1393
					and obj_5.getArgument(2).(StringLiteral).getValue()="Failed to initialize RTKit"
				)
				and obj_4.getLValue().(VariableAccess).getTarget()=vret_1395
			)
		)
		and obj_2.getStmt(1).(GotoStmt).getName() ="put_dev"
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_122
}

/*predicate func_123(Variable vdev_1393, Variable vanv_1394, Variable vret_1395, FunctionCall target_143, ExprStmt target_123) {
	exists(AssignExpr obj_0 | obj_0=target_123.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getArgument(1) |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getTarget().getName()="rtk"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vanv_1394
				)
				and obj_2.getTarget().hasName("PTR_ERR")
			)
			and obj_1.getTarget().hasName("dev_err_probe")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vdev_1393
			and obj_1.getArgument(2).(StringLiteral).getValue()="Failed to initialize RTKit"
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and target_123.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_143
}

*/
/*predicate func_124(FunctionCall target_143, Function func, GotoStmt target_124) {
	target_124.getName() ="put_dev"
	and target_124.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_143
	and target_124.getEnclosingFunction() = func
}

*/
predicate func_125(Variable vanv_1394, Variable vret_1395, Variable vnvme_ctrl_ops, Function func, ExprStmt target_125) {
	exists(AssignExpr obj_0 | obj_0=target_125.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getArgument(1) |
				obj_2.getTarget().getName()="dev"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vanv_1394
			)
			and obj_1.getTarget().hasName("nvme_init_ctrl")
			and obj_1.getArgument(0) instanceof AddressOfExpr
			and obj_1.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vnvme_ctrl_ops
			and obj_1.getArgument(3).(BitwiseOrExpr).getValue()="131074"
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1395
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_125
}

predicate func_126(Variable vret_1395, BlockStmt target_144, ExprStmt target_125, ExprStmt target_127, VariableAccess target_126) {
	target_126.getTarget()=vret_1395
	and target_126.getParent().(IfStmt).getThen()=target_144
	and target_125.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_126.getLocation())
	and target_126.getLocation().isBefore(target_127.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
}

predicate func_127(Variable vdev_1393, Variable vret_1395, VariableAccess target_126, ExprStmt target_127) {
	exists(FunctionCall obj_0 | obj_0=target_127.getExpr() |
		obj_0.getTarget().hasName("dev_err_probe")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vdev_1393
		and obj_0.getArgument(1).(VariableAccess).getTarget()=vret_1395
		and obj_0.getArgument(2).(StringLiteral).getValue()="Failed to initialize nvme_ctrl"
	)
	and target_127.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_126
}

predicate func_128(VariableAccess target_126, Function func, GotoStmt target_128) {
	target_128.getName() ="put_dev"
	and target_128.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_126
	and target_128.getEnclosingFunction() = func
}

predicate func_129(FunctionCall target_145, Function func, GotoStmt target_129) {
	target_129.getName() ="put_dev"
	and target_129.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_145
	and target_129.getEnclosingFunction() = func
}

predicate func_130(Variable vanv_1394, Function func, ExprStmt target_130) {
	exists(FunctionCall obj_0 | obj_0=target_130.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(0) |
			obj_1.getTarget().getName()="dev"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().hasName("put_device")
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_130
}

predicate func_131(Variable vret_1395, RelationalOperation target_131) {
	 (target_131 instanceof GTExpr or target_131 instanceof LTExpr)
	and target_131.getLesserOperand().(VariableAccess).getTarget()=vret_1395
	and target_131.getGreaterOperand() instanceof Literal
}

predicate func_132(Variable vdev_1393, FunctionCall target_132) {
	target_132.getTarget().hasName("dma_set_mask_and_coherent")
	and target_132.getArgument(0).(VariableAccess).getTarget()=vdev_1393
	and target_132.getArgument(1) instanceof ConditionalExpr
}

predicate func_133(Variable vanv_1394, RelationalOperation target_133) {
	exists(PointerFieldAccess obj_0 | obj_0=target_133.getLesserOperand() |
		obj_0.getTarget().getName()="irq"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and  (target_133 instanceof GTExpr or target_133 instanceof LTExpr)
	and target_133.getGreaterOperand() instanceof Literal
}

predicate func_134(Variable vanv_1394, NotExpr target_134) {
	exists(PointerFieldAccess obj_0 | obj_0=target_134.getOperand() |
		obj_0.getTarget().getName()="irq"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
}

predicate func_135(Variable vanv_1394, FunctionCall target_135) {
	exists(PointerFieldAccess obj_0 | obj_0=target_135.getArgument(0) |
		obj_0.getTarget().getName()="mmio_coproc"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_135.getTarget().hasName("IS_ERR")
}

predicate func_136(Variable vanv_1394, FunctionCall target_136) {
	exists(PointerFieldAccess obj_0 | obj_0=target_136.getArgument(0) |
		obj_0.getTarget().getName()="mmio_nvme"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_136.getTarget().hasName("IS_ERR")
}

predicate func_137(Variable vanv_1394, FunctionCall target_137) {
	exists(PointerFieldAccess obj_0 | obj_0=target_137.getArgument(0) |
		obj_0.getTarget().getName()="sart"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_137.getTarget().hasName("IS_ERR")
}

predicate func_138(Variable vanv_1394, FunctionCall target_138) {
	exists(PointerFieldAccess obj_0 | obj_0=target_138.getArgument(0) |
		obj_0.getTarget().getName()="reset"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_138.getTarget().hasName("IS_ERR")
}

predicate func_139(Variable vanv_1394, NotExpr target_139) {
	exists(PointerFieldAccess obj_0 | obj_0=target_139.getOperand() |
		obj_0.getTarget().getName()="prp_page_pool"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
}

predicate func_140(Variable vanv_1394, NotExpr target_140) {
	exists(PointerFieldAccess obj_0 | obj_0=target_140.getOperand() |
		obj_0.getTarget().getName()="prp_small_pool"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
}

predicate func_141(Variable vanv_1394, NotExpr target_141) {
	exists(PointerFieldAccess obj_0 | obj_0=target_141.getOperand() |
		obj_0.getTarget().getName()="iod_mempool"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
}

predicate func_142(Variable vret_1395, BlockStmt target_146, VariableAccess target_142) {
	target_142.getTarget()=vret_1395
	and target_142.getParent().(IfStmt).getThen()=target_146
}

predicate func_143(Variable vanv_1394, FunctionCall target_143) {
	exists(PointerFieldAccess obj_0 | obj_0=target_143.getArgument(0) |
		obj_0.getTarget().getName()="rtk"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vanv_1394
	)
	and target_143.getTarget().hasName("IS_ERR")
}

predicate func_144(Function func, BlockStmt target_144) {
	target_144.getStmt(0) instanceof ExprStmt
	and target_144.getStmt(1) instanceof GotoStmt
	and target_144.getEnclosingFunction() = func
}

predicate func_145(Variable vanv_1394, FunctionCall target_145) {
	exists(ValueFieldAccess obj_0 | obj_0=target_145.getArgument(0) |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getQualifier() |
			obj_1.getTarget().getName()="ctrl"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vanv_1394
		)
		and obj_0.getTarget().getName()="admin_q"
	)
	and target_145.getTarget().hasName("IS_ERR")
}

predicate func_146(Function func, BlockStmt target_146) {
	target_146.getStmt(0) instanceof ExprStmt
	and target_146.getStmt(1) instanceof GotoStmt
	and target_146.getEnclosingFunction() = func
}

from Function func, Parameter vpdev_1391, Variable vdev_1393, Variable vanv_1394, Variable vret_1395, Variable v__key_1455, Variable v__key_1456, Variable v__key_1457, Variable v__ret_warn_on_1481, Variable v__flags_1481, Variable v_res_1483, Variable vapple_nvme_rtkit_ops, Variable vnvme_ctrl_ops, FunctionCall target_0, FunctionCall target_1, ExprStmt target_2, ExprStmt target_3, AssignExpr target_7, PointerFieldAccess target_9, PointerFieldAccess target_10, PointerFieldAccess target_11, AddressOfExpr target_12, VariableAccess target_13, VariableAccess target_14, VariableAccess target_15, GotoStmt target_17, DeclStmt target_18, FunctionCall target_19, IfStmt target_20, AssignExpr target_22, ExprStmt target_23, ExprStmt target_24, ExprStmt target_25, IfStmt target_26, ExprStmt target_27, IfStmt target_28, AssignExpr target_31, IfStmt target_32, ExprStmt target_33, IfStmt target_35, ExprStmt target_38, IfStmt target_39, ExprStmt target_41, ExprStmt target_44, IfStmt target_45, ExprStmt target_48, ExprStmt target_49, ExprStmt target_50, ExprStmt target_51, ExprStmt target_52, IfStmt target_53, ExprStmt target_56, IfStmt target_57, DoStmt target_60, ValueFieldAccess target_64, DoStmt target_69, DoStmt target_77, ExprStmt target_80, IfStmt target_81, ExprStmt target_82, IfStmt target_83, ExprStmt target_84, IfStmt target_85, ExprStmt target_86, ExprStmt target_88, IfStmt target_89, ExprStmt target_90, ExprStmt target_92, ExprStmt target_103, IfStmt target_110, ExprStmt target_113, IfStmt target_114, ExprStmt target_115, IfStmt target_116, ExprStmt target_117, IfStmt target_118, ExprStmt target_121, IfStmt target_122, ExprStmt target_125, VariableAccess target_126, ExprStmt target_127, GotoStmt target_128, GotoStmt target_129, ExprStmt target_130, RelationalOperation target_131, FunctionCall target_132, RelationalOperation target_133, NotExpr target_134, FunctionCall target_135, FunctionCall target_136, FunctionCall target_137, FunctionCall target_138, NotExpr target_139, NotExpr target_140, NotExpr target_141, VariableAccess target_142, FunctionCall target_143, BlockStmt target_144, FunctionCall target_145, BlockStmt target_146
where
func_0(vpdev_1391, vanv_1394, target_0)
and func_1(func, target_1)
and func_2(target_23, func, target_2)
and func_3(target_32, func, target_3)
and not func_4(vpdev_1391, vanv_1394, target_3)
and not func_5(vanv_1394)
and func_7(vret_1395, target_7)
and func_9(vanv_1394, target_9)
and func_10(vanv_1394, target_10)
and func_11(vanv_1394, target_11)
and func_12(vanv_1394, target_12)
and func_13(vpdev_1391, target_13)
and func_14(vanv_1394, target_14)
and func_15(vanv_1394, target_15)
and func_17(target_131, func, target_17)
and func_18(func, target_18)
and func_19(vdev_1393, vanv_1394, target_19)
and func_20(vanv_1394, func, target_20)
and func_22(vdev_1393, vanv_1394, target_22)
and func_23(vanv_1394, func, target_23)
and func_24(func, target_24)
and func_25(vanv_1394, vret_1395, func, target_25)
and func_26(vdev_1393, vret_1395, func, target_26)
and func_27(vdev_1393, vret_1395, target_131, target_27)
and func_28(vdev_1393, vret_1395, func, target_28)
and func_31(vpdev_1391, vanv_1394, target_31)
and func_32(vanv_1394, vret_1395, func, target_32)
and func_33(vanv_1394, vret_1395, target_133, target_33)
and func_35(vanv_1394, vret_1395, func, target_35)
and func_38(vpdev_1391, vanv_1394, func, target_38)
and func_39(vanv_1394, vret_1395, func, target_39)
and func_41(vanv_1394, vret_1395, target_41)
and func_44(vpdev_1391, vanv_1394, func, target_44)
and func_45(vanv_1394, vret_1395, func, target_45)
and func_48(vanv_1394, func, target_48)
and func_49(vanv_1394, func, target_49)
and func_50(vanv_1394, func, target_50)
and func_51(vanv_1394, func, target_51)
and func_52(vdev_1393, vanv_1394, func, target_52)
and func_53(vdev_1393, vanv_1394, vret_1395, func, target_53)
and func_56(vanv_1394, func, target_56)
and func_57(vdev_1393, vanv_1394, vret_1395, func, target_57)
and func_60(func, target_60)
and func_64(vanv_1394, target_64)
and func_69(func, target_69)
and func_77(v__key_1457, func, target_77)
and func_80(vanv_1394, vret_1395, func, target_80)
and func_81(vret_1395, target_80, func, target_81)
and func_82(vanv_1394, vret_1395, func, target_82)
and func_83(vret_1395, target_82, func, target_83)
and func_84(vanv_1394, func, target_84)
and func_85(vanv_1394, func, target_85)
and func_86(target_139, func, target_86)
and func_88(vanv_1394, func, target_88)
and func_89(vanv_1394, vret_1395, func, target_89)
and func_90(vret_1395, target_140, target_86, target_90)
and func_92(func, target_92)
and func_103(vanv_1394, func, target_103)
and func_110(vanv_1394, vret_1395, func, target_110)
and func_113(vanv_1394, vret_1395, func, target_113)
and func_114(vret_1395, target_113, func, target_114)
and func_115(vanv_1394, vret_1395, func, target_115)
and func_116(vret_1395, target_115, func, target_116)
and func_117(vanv_1394, vret_1395, func, target_117)
and func_118(vdev_1393, vret_1395, func, target_118)
and func_121(vdev_1393, vanv_1394, vapple_nvme_rtkit_ops, func, target_121)
and func_122(vdev_1393, vanv_1394, vret_1395, func, target_122)
and func_125(vanv_1394, vret_1395, vnvme_ctrl_ops, func, target_125)
and func_126(vret_1395, target_144, target_125, target_127, target_126)
and func_127(vdev_1393, vret_1395, target_126, target_127)
and func_128(target_126, func, target_128)
and func_129(target_145, func, target_129)
and func_130(vanv_1394, func, target_130)
and func_131(vret_1395, target_131)
and func_132(vdev_1393, target_132)
and func_133(vanv_1394, target_133)
and func_134(vanv_1394, target_134)
and func_135(vanv_1394, target_135)
and func_136(vanv_1394, target_136)
and func_137(vanv_1394, target_137)
and func_138(vanv_1394, target_138)
and func_139(vanv_1394, target_139)
and func_140(vanv_1394, target_140)
and func_141(vanv_1394, target_141)
and func_142(vret_1395, target_146, target_142)
and func_143(vanv_1394, target_143)
and func_144(func, target_144)
and func_145(vanv_1394, target_145)
and func_146(func, target_146)
and vpdev_1391.getType().hasName("platform_device *")
and vdev_1393.getType().hasName("device *")
and vanv_1394.getType().hasName("apple_nvme *")
and vret_1395.getType().hasName("int")
and v__key_1455.getType().hasName("lock_class_key")
and v__key_1456.getType().hasName("lock_class_key")
and v__key_1457.getType().hasName("lock_class_key")
and v__ret_warn_on_1481.getType().hasName("int")
and v__flags_1481.getType().hasName("int")
and v_res_1483.getType().hasName("mempool_t *")
and vapple_nvme_rtkit_ops.getType().hasName("const apple_rtkit_ops")
and vnvme_ctrl_ops.getType().hasName("const nvme_ctrl_ops")
and vpdev_1391.getFunction() = func
and vdev_1393.(LocalVariable).getFunction() = func
and vanv_1394.(LocalVariable).getFunction() = func
and vret_1395.(LocalVariable).getFunction() = func
and v__key_1455.(LocalVariable).getFunction() = func
and v__key_1456.(LocalVariable).getFunction() = func
and v__key_1457.(LocalVariable).getFunction() = func
and v__ret_warn_on_1481.(LocalVariable).getFunction() = func
and v__flags_1481.(LocalVariable).getFunction() = func
and v_res_1483.(LocalVariable).getFunction() = func
and not vapple_nvme_rtkit_ops.getParentScope+() = func
and not vnvme_ctrl_ops.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
