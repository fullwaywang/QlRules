/**
 * @name linux-ad7f402ae4f466647c3a669b8a6f3e5d4271c84a-xenvif_tx_check_gop
 * @id cpp/linux/ad7f402ae4f466647c3a669b8a6f3e5d4271c84a/xenvif-tx-check-gop
 * @description linux-ad7f402ae4f466647c3a669b8a6f3e5d4271c84a-drivers/net/xen-netback/netback.c-xenvif_tx_check_gop CVE-2022-3643
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vgopp_copy_451, Variable verr_466, PointerFieldAccess target_19, NotExpr target_9, VariableAccess target_0) {
	target_0.getTarget()=verr_466
	and target_0.getParent().(AssignExpr).getLValue() = target_0
	and target_0.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="status"
	and target_0.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
	and target_0.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getLocation().isBefore(target_19.getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getLocation())
	and target_0.getLocation().isBefore(target_9.getOperand().(NotExpr).getOperand().(VariableAccess).getLocation())
}

predicate func_1(Parameter vskb_449, LogicalAndExpr target_21) {
exists(ArrayExpr target_1 |
	target_1.getArrayBase().(PointerFieldAccess).getTarget().getName()="copy_pending_idx"
	and target_1.getArrayBase().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_1.getArrayBase().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_1.getArrayOffset().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="copy_count"
	and target_1.getArrayOffset().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_1.getArrayOffset().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_1.getArrayOffset().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_1.getArrayBase().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_21.getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_2(Parameter vskb_449, Parameter vgopp_copy_451, Variable vpending_idx_454, Variable vi_466, Variable verr_466, ExprStmt target_22, FunctionCall target_23, PointerFieldAccess target_19, LogicalAndExpr target_24, ExprStmt target_25, NotExpr target_9, NotExpr target_27, Function func) {
exists(ForStmt target_2 |
	target_2.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vi_466
	and target_2.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_2.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vi_466
	and target_2.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="copy_count"
	and target_2.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_2.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_2.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vi_466
	and target_2.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpending_idx_454
	and target_2.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="copy_pending_idx"
	and target_2.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_2.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_466
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="status"
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="1"
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand() instanceof NotExpr
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("xenvif_idx_release")
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_466
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("int")
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("net_ratelimit")
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand() instanceof NotExpr
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("xenvif_idx_release")
	and target_2.getStmt().(BlockStmt).getStmt(4) instanceof ExprStmt
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_2
	and target_2.getLocation().isBefore(target_22.getLocation())
	and target_23.getArgument(0).(VariableAccess).getLocation().isBefore(target_2.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getLocation().isBefore(target_19.getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getLocation())
	and target_24.getRightOperand().(EqualityOperation).getRightOperand().(VariableAccess).getLocation().isBefore(target_2.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_2.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_25.getExpr().(FunctionCall).getArgument(4).(VariableAccess).getLocation())
	and target_9.getOperand().(NotExpr).getOperand().(VariableAccess).getLocation().isBefore(target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_2.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_27.getOperand().(NotExpr).getOperand().(VariableAccess).getLocation()))
}

/*predicate func_3(Parameter vskb_449, Variable vpending_idx_454, Variable vi_466, FunctionCall target_28, LogicalAndExpr target_24, ExprStmt target_25) {
exists(ExprStmt target_3 |
	target_3.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpending_idx_454
	and target_3.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="copy_pending_idx"
	and target_3.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_3.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_3.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_466
	and target_3.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_3
	and target_3.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_28
	and target_24.getRightOperand().(EqualityOperation).getRightOperand().(VariableAccess).getLocation().isBefore(target_3.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_3.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_25.getExpr().(FunctionCall).getArgument(4).(VariableAccess).getLocation()))
}

*/
/*predicate func_4(BlockStmt target_29, Function func) {
exists(NotExpr target_4 |
	target_4.getOperand().(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_4.getParent().(FunctionCall).getArgument(0) instanceof NotExpr
	and target_4.getParent().(FunctionCall).getArgument(1) instanceof Literal
	and target_4.getParent().(FunctionCall).getParent().(IfStmt).getThen()=target_29
	and target_4.getEnclosingFunction() = func)
}

*/
/*predicate func_6(Parameter vskb_449, Variable vi_466, ExprStmt target_30, PointerFieldAccess target_18, ExprStmt target_31, RelationalOperation target_32) {
exists(LogicalOrExpr target_6 |
	target_6.getLeftOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vi_466
	and target_6.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="copy_count"
	and target_6.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_6.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_6.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_6.getRightOperand() instanceof NotExpr
	and target_6.getParent().(IfStmt).getThen()=target_30
	and target_6.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_18.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_31.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_6.getLeftOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getLocation())
	and target_6.getLeftOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getLocation().isBefore(target_32.getGreaterOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_7(Variable verr_466, FunctionCall target_28, NotExpr target_9, NotExpr target_27) {
exists(ExprStmt target_7 |
	target_7.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_466
	and target_7.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("int")
	and target_7.getParent().(BlockStmt).getParent().(IfStmt).getElse().(BlockStmt).getStmt(0)=target_7
	and target_7.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_28
	and target_9.getOperand().(NotExpr).getOperand().(VariableAccess).getLocation().isBefore(target_7.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_7.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_27.getOperand().(NotExpr).getOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_8(Parameter vskb_449, Variable vi_466, ExprStmt target_33) {
exists(LogicalOrExpr target_8 |
	target_8.getLeftOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vi_466
	and target_8.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="copy_count"
	and target_8.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_8.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_8.getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_8.getRightOperand() instanceof NotExpr
	and target_8.getParent().(IfStmt).getThen()=target_33)
}

*/
predicate func_9(Variable verr_466, BlockStmt target_29, NotExpr target_9) {
	target_9.getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=verr_466
	and target_9.getParent().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_9.getParent().(FunctionCall).getParent().(IfStmt).getThen()=target_29
}

predicate func_10(Parameter vskb_449, PointerFieldAccess target_10) {
	target_10.getTarget().getName()="cb"
	and target_10.getQualifier().(VariableAccess).getTarget()=vskb_449
}

predicate func_11(Variable vsharedslot_464, ExprStmt target_33, NotExpr target_11) {
	target_11.getOperand().(VariableAccess).getTarget()=vsharedslot_464
	and target_11.getParent().(IfStmt).getThen()=target_33
}

predicate func_12(Parameter vgopp_copy_451, Function func, ExprStmt target_12) {
	target_12.getExpr().(PostfixIncrExpr).getOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_12
}

predicate func_13(Variable vsharedslot_464, ExprStmt target_30, NotExpr target_13) {
	target_13.getOperand().(VariableAccess).getTarget()=vsharedslot_464
	and target_13.getParent().(IfStmt).getThen()=target_30
}

predicate func_14(Parameter vskb_449, PointerFieldAccess target_14) {
	target_14.getTarget().getName()="cb"
	and target_14.getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_14.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("xenvif_idx_release")
	and target_14.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("xenvif_queue *")
	and target_14.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="pending_idx"
	and target_14.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
}

predicate func_15(Variable vpending_idx_454, VariableAccess target_15) {
	target_15.getTarget()=vpending_idx_454
}

predicate func_17(Parameter vskb_449, Initializer target_17) {
	target_17.getExpr().(PointerFieldAccess).getTarget().getName()="pending_idx"
	and target_17.getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_17.getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
}

predicate func_18(Parameter vskb_449, LogicalAndExpr target_21, PointerFieldAccess target_18) {
	target_18.getTarget().getName()="pending_idx"
	and target_18.getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_18.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_18.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_21.getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
}

predicate func_19(Parameter vgopp_copy_451, PointerFieldAccess target_19) {
	target_19.getTarget().getName()="status"
	and target_19.getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
}

predicate func_21(Parameter vskb_449, LogicalAndExpr target_21) {
	target_21.getLeftOperand().(FunctionCall).getTarget().hasName("skb_has_frag_list")
	and target_21.getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_449
	and target_21.getRightOperand().(NotExpr).getOperand().(VariableAccess).getTarget().getType().hasName("skb_shared_info *")
}

predicate func_22(Parameter vgopp_copy_451, Variable verr_466, ExprStmt target_22) {
	target_22.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_466
	and target_22.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="status"
	and target_22.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
}

predicate func_23(Parameter vskb_449, FunctionCall target_23) {
	target_23.getTarget().hasName("skb_end_pointer")
	and target_23.getArgument(0).(VariableAccess).getTarget()=vskb_449
}

predicate func_24(Variable vpending_idx_454, LogicalAndExpr target_24) {
	target_24.getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
	and target_24.getRightOperand().(EqualityOperation).getLeftOperand().(FunctionCall).getTarget().hasName("frag_get_pending_idx")
	and target_24.getRightOperand().(EqualityOperation).getLeftOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="frags"
	and target_24.getRightOperand().(EqualityOperation).getLeftOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("skb_shared_info *")
	and target_24.getRightOperand().(EqualityOperation).getLeftOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_24.getRightOperand().(EqualityOperation).getRightOperand().(VariableAccess).getTarget()=vpending_idx_454
}

predicate func_25(Parameter vgopp_copy_451, Variable vpending_idx_454, ExprStmt target_25) {
	target_25.getExpr().(FunctionCall).getTarget().hasName("__dynamic_netdev_dbg")
	and target_25.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("_ddebug")
	and target_25.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="dev"
	and target_25.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="vif"
	and target_25.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("xenvif_queue *")
	and target_25.getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="Grant copy of header failed! status: %d pending_idx: %u ref: %u\n"
	and target_25.getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getTarget().getName()="status"
	and target_25.getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
	and target_25.getExpr().(FunctionCall).getArgument(4).(VariableAccess).getTarget()=vpending_idx_454
	and target_25.getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getTarget().getName()="ref"
	and target_25.getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="u"
	and target_25.getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="source"
	and target_25.getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vgopp_copy_451
}

predicate func_27(Variable verr_466, NotExpr target_27) {
	target_27.getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=verr_466
}

predicate func_28(Function func, FunctionCall target_28) {
	target_28.getTarget().hasName("__builtin_expect")
	and target_28.getArgument(0) instanceof NotExpr
	and target_28.getArgument(1) instanceof Literal
	and target_28.getEnclosingFunction() = func
}

predicate func_29(Variable vpending_idx_454, BlockStmt target_29) {
	target_29.getStmt(0).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("net_ratelimit")
	and target_29.getStmt(0).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
	and target_29.getStmt(0).(IfStmt).getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_29.getStmt(1).(IfStmt).getCondition() instanceof NotExpr
	and target_29.getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("xenvif_idx_release")
	and target_29.getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("xenvif_queue *")
	and target_29.getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpending_idx_454
	and target_29.getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(UnaryMinusExpr).getValue()="255"
}

predicate func_30(Parameter vskb_449, ExprStmt target_30) {
	target_30.getExpr().(FunctionCall).getTarget().hasName("xenvif_idx_release")
	and target_30.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("xenvif_queue *")
	and target_30.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="pending_idx"
	and target_30.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
	and target_30.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_449
	and target_30.getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
}

predicate func_31(Variable vpending_idx_454, Variable vi_466, ExprStmt target_31) {
	target_31.getExpr().(FunctionCall).getTarget().hasName("__dynamic_netdev_dbg")
	and target_31.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("_ddebug")
	and target_31.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="dev"
	and target_31.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="vif"
	and target_31.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("xenvif_queue *")
	and target_31.getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="Grant map of %d. frag failed! status: %d pending_idx: %u ref: %u\n"
	and target_31.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vi_466
	and target_31.getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="status"
	and target_31.getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("gnttab_map_grant_ref *")
	and target_31.getExpr().(FunctionCall).getArgument(5).(VariableAccess).getTarget()=vpending_idx_454
	and target_31.getExpr().(FunctionCall).getArgument(6).(PointerFieldAccess).getTarget().getName()="ref"
	and target_31.getExpr().(FunctionCall).getArgument(6).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("gnttab_map_grant_ref *")
}

predicate func_32(Variable vi_466, RelationalOperation target_32) {
	 (target_32 instanceof GTExpr or target_32 instanceof LTExpr)
	and target_32.getLesserOperand().(VariableAccess).getTarget().getType().hasName("int")
	and target_32.getGreaterOperand().(VariableAccess).getTarget()=vi_466
}

predicate func_33(Variable vpending_idx_454, NotExpr target_11, ExprStmt target_33) {
	target_33.getExpr().(FunctionCall).getTarget().hasName("xenvif_idx_release")
	and target_33.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("xenvif_queue *")
	and target_33.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpending_idx_454
	and target_33.getExpr().(FunctionCall).getArgument(2).(UnaryMinusExpr).getValue()="255"
	and target_33.getParent().(IfStmt).getCondition()=target_11
}

from Function func, Parameter vskb_449, Parameter vgopp_copy_451, Variable vpending_idx_454, Variable vsharedslot_464, Variable vi_466, Variable verr_466, VariableAccess target_0, NotExpr target_9, PointerFieldAccess target_10, NotExpr target_11, ExprStmt target_12, NotExpr target_13, PointerFieldAccess target_14, VariableAccess target_15, Initializer target_17, PointerFieldAccess target_18, PointerFieldAccess target_19, LogicalAndExpr target_21, ExprStmt target_22, FunctionCall target_23, LogicalAndExpr target_24, ExprStmt target_25, NotExpr target_27, FunctionCall target_28, BlockStmt target_29, ExprStmt target_30, ExprStmt target_31, RelationalOperation target_32, ExprStmt target_33
where
func_0(vgopp_copy_451, verr_466, target_19, target_9, target_0)
and not func_1(vskb_449, target_21)
and not func_2(vskb_449, vgopp_copy_451, vpending_idx_454, vi_466, verr_466, target_22, target_23, target_19, target_24, target_25, target_9, target_27, func)
and func_9(verr_466, target_29, target_9)
and func_10(vskb_449, target_10)
and func_11(vsharedslot_464, target_33, target_11)
and func_12(vgopp_copy_451, func, target_12)
and func_13(vsharedslot_464, target_30, target_13)
and func_14(vskb_449, target_14)
and func_15(vpending_idx_454, target_15)
and func_17(vskb_449, target_17)
and func_18(vskb_449, target_21, target_18)
and func_19(vgopp_copy_451, target_19)
and func_21(vskb_449, target_21)
and func_22(vgopp_copy_451, verr_466, target_22)
and func_23(vskb_449, target_23)
and func_24(vpending_idx_454, target_24)
and func_25(vgopp_copy_451, vpending_idx_454, target_25)
and func_27(verr_466, target_27)
and func_28(func, target_28)
and func_29(vpending_idx_454, target_29)
and func_30(vskb_449, target_30)
and func_31(vpending_idx_454, vi_466, target_31)
and func_32(vi_466, target_32)
and func_33(vpending_idx_454, target_11, target_33)
and vskb_449.getType().hasName("sk_buff *")
and vgopp_copy_451.getType().hasName("gnttab_copy **")
and vpending_idx_454.getType().hasName("u16")
and vsharedslot_464.getType().hasName("const bool")
and vi_466.getType().hasName("int")
and verr_466.getType().hasName("int")
and vskb_449.getFunction() = func
and vgopp_copy_451.getFunction() = func
and vpending_idx_454.(LocalVariable).getFunction() = func
and vsharedslot_464.(LocalVariable).getFunction() = func
and vi_466.(LocalVariable).getFunction() = func
and verr_466.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
