/**
 * @name linux-f4c23a140d80ef5e6d3d1f8f57007649014b60fa-serial8250_isa_init_ports
 * @id cpp/linux/f4c23a140d80ef5e6d3d1f8f57007649014b60fa/serial8250-isa-init-ports
 * @description linux-f4c23a140d80ef5e6d3d1f8f57007649014b60fa-drivers/tty/serial/8250/8250_core.c-serial8250_isa_init_ports CVE-2020-15437
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vup_497, ExprStmt target_0) {
	target_0.getExpr().(FunctionCall).getTarget().hasName("serial8250_set_defaults")
	and target_0.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vup_497
}

from Function func, Variable vup_497, ExprStmt target_0
where
func_0(vup_497, target_0)
and vup_497.getType().hasName("uart_8250_port *")
and vup_497.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
