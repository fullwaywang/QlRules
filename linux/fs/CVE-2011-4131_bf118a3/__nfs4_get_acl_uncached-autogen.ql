/**
 * @name linux-bf118a342f10dafe44b14451a1392c3254629a1f-__nfs4_get_acl_uncached
 * @id cpp/linux/bf118a342f10dafe44b14451a1392c3254629a1f/--nfs4-get-acl-uncached
 * @description linux-bf118a342f10dafe44b14451a1392c3254629a1f-fs/nfs/nfs4proc.c-__nfs4_get_acl_uncached CVE-2011-4131
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Initializer target_0) {
	target_0.getExpr().(Literal).getValue()="0"
	and target_0.getExpr().getEnclosingFunction() = func
}

predicate func_1(Variable vres_3546, ValueFieldAccess target_1) {
	target_1.getTarget().getName()="acl_len"
	and target_1.getQualifier().(VariableAccess).getTarget()=vres_3546
}

predicate func_2(Variable vres_3546, ValueFieldAccess target_2) {
	target_2.getTarget().getName()="acl_len"
	and target_2.getQualifier().(VariableAccess).getTarget()=vres_3546
}

predicate func_3(Variable vres_3546, ValueFieldAccess target_3) {
	target_3.getTarget().getName()="acl_len"
	and target_3.getQualifier().(VariableAccess).getTarget()=vres_3546
}

predicate func_4(Parameter vbuf_3538, Parameter vbuflen_3538, Variable vargs_3541, FunctionCall target_4) {
	target_4.getTarget().hasName("buf_to_pages")
	and not target_4.getTarget().hasName("_copy_from_pages")
	and target_4.getArgument(0).(VariableAccess).getTarget()=vbuf_3538
	and target_4.getArgument(1).(VariableAccess).getTarget()=vbuflen_3538
	and target_4.getArgument(2).(ValueFieldAccess).getTarget().getName()="acl_pages"
	and target_4.getArgument(2).(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_4.getArgument(3).(AddressOfExpr).getOperand() instanceof ValueFieldAccess
}

predicate func_5(Parameter vbuf_3538, Parameter vbuflen_3538, Variable vlocalpage_3555, Variable vret_3556, ExprStmt target_89, IfStmt target_5) {
	target_5.getCondition().(VariableAccess).getTarget()=vbuf_3538
	and target_5.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556
	and target_5.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-34"
	and target_5.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand() instanceof ValueFieldAccess
	and target_5.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_5.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(GotoStmt).getName() ="out_free"
	and target_5.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(VariableAccess).getTarget()=vlocalpage_3555
	and target_5.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_5.getLocation().isBefore(target_89.getLocation())
}

predicate func_6(Function func) {
exists(Initializer target_6 |
	target_6.getExpr().(ArrayAggregateLiteral).getValue()="{...}"
	and target_6.getExpr().(ArrayAggregateLiteral).getElementExpr(0).(Literal).getValue()="0"
	and target_6.getExpr().getEnclosingFunction() = func)
}

predicate func_7(Function func) {
exists(Initializer target_7 |
	target_7.getExpr() instanceof UnaryMinusExpr
	and target_7.getExpr().getEnclosingFunction() = func)
}

predicate func_12(Parameter vbuflen_3538, Variable vret_3556) {
exists(BinaryBitwiseOperation target_12 |
	target_12.getLeftOperand().(SubExpr).getLeftOperand().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_12.getLeftOperand().(SubExpr).getLeftOperand().(AddExpr).getRightOperand() instanceof BinaryBitwiseOperation
	and target_12.getLeftOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_12.getRightOperand().(Literal).getValue()="12"
	and target_12.getParent().(AssignExpr).getRValue() = target_12
	and target_12.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556)
}

predicate func_14(Function func) {
exists(AssignExpr target_14 |
	target_14.getLValue().(VariableAccess).getType().hasName("int")
	and target_14.getRValue().(Literal).getValue()="1"
	and target_14.getEnclosingFunction() = func)
}

predicate func_15(Variable vpages_3540, ExprStmt target_91, Function func) {
exists(ForStmt target_15 |
	target_15.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_15.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_15.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_15.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("int")
	and target_15.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_15.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_15.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_15.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("alloc_pages")
	and target_15.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="208"
	and target_15.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(GotoStmt).getName() ="out_free"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
	and target_15.getLocation().isBefore(target_91.getLocation()))
}

/*predicate func_16(Function func) {
exists(AssignExpr target_16 |
	target_16.getLValue().(VariableAccess).getType().hasName("int")
	and target_16.getRValue().(Literal).getValue()="0"
	and target_16.getEnclosingFunction() = func)
}

*/
/*predicate func_21(Variable vpages_3540) {
exists(NotExpr target_21 |
	target_21.getOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_21.getOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_21.getParent().(IfStmt).getThen() instanceof GotoStmt)
}

*/
predicate func_24(Variable vargs_3541, ExprStmt target_55) {
exists(ValueFieldAccess target_24 |
	target_24.getTarget().getName()="acl_scratch"
	and target_24.getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_24.getQualifier().(VariableAccess).getLocation().isBefore(target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_26(Variable vargs_3541, ExprStmt target_92) {
exists(NotExpr target_26 |
	target_26.getOperand().(ValueFieldAccess).getTarget().getName()="acl_scratch"
	and target_26.getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_26.getParent().(IfStmt).getThen()=target_92)
}

predicate func_27(RelationalOperation target_93, Function func) {
exists(GotoStmt target_27 |
	target_27.getName() ="out_free"
	and target_27.getParent().(IfStmt).getCondition()=target_93
	and target_27.getEnclosingFunction() = func)
}

predicate func_28(Variable vargs_3541) {
exists(MulExpr target_28 |
	target_28.getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_28.getRightOperand() instanceof BinaryBitwiseOperation
	and target_28.getParent().(AssignExpr).getRValue() = target_28
	and target_28.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="acl_len"
	and target_28.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541)
}

predicate func_29(Parameter vbuf_3538, BlockStmt target_94) {
exists(EqualityOperation target_29 |
	target_29.getLeftOperand().(VariableAccess).getTarget()=vbuf_3538
	and target_29.getRightOperand().(Literal).getValue()="0"
	and target_29.getParent().(IfStmt).getThen()=target_94)
}

predicate func_30(Variable vres_3546) {
exists(AssignOrExpr target_30 |
	target_30.getLValue().(ValueFieldAccess).getTarget().getName()="acl_flags"
	and target_30.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_30.getRValue().(Literal).getValue()="1")
}

predicate func_31(Variable vpages_3540, Variable vlocalpage_3555) {
exists(ArrayExpr target_31 |
	target_31.getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_31.getArrayOffset() instanceof Literal
	and target_31.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("lowmem_page_address")
	and target_31.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vlocalpage_3555)
}

predicate func_32(Parameter vbuf_3538, Parameter vbuflen_3538, Variable vargs_3541, IfStmt target_97, IfStmt target_5, RelationalOperation target_98, AddressOfExpr target_99, Function func) {
exists(DoStmt target_32 |
	target_32.getCondition().(Literal).getValue()="0"
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="%s  buf %p buflen %ld npages %d args.acl_len %ld\n"
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("const char[24]")
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vbuf_3538
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vbuflen_3538
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(VariableAccess).getType().hasName("int")
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getTarget().getName()="acl_len"
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_32
	and target_32.getLocation().isBefore(target_97.getLocation())
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_5.getCondition().(VariableAccess).getLocation())
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_98.getLesserOperand().(VariableAccess).getLocation())
	and target_32.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_99.getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_33(Parameter vbuf_3538, Parameter vbuflen_3538, Variable vargs_3541, IfStmt target_5, RelationalOperation target_98, AddressOfExpr target_99) {
exists(FunctionCall target_33 |
	target_33.getTarget().hasName("printk")
	and target_33.getArgument(0).(StringLiteral).getValue()="%s  buf %p buflen %ld npages %d args.acl_len %ld\n"
	and target_33.getArgument(1).(VariableAccess).getType().hasName("const char[24]")
	and target_33.getArgument(2).(VariableAccess).getTarget()=vbuf_3538
	and target_33.getArgument(3).(VariableAccess).getTarget()=vbuflen_3538
	and target_33.getArgument(4).(VariableAccess).getType().hasName("int")
	and target_33.getArgument(5).(ValueFieldAccess).getTarget().getName()="acl_len"
	and target_33.getArgument(5).(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_33.getArgument(2).(VariableAccess).getLocation().isBefore(target_5.getCondition().(VariableAccess).getLocation())
	and target_33.getArgument(3).(VariableAccess).getLocation().isBefore(target_98.getLesserOperand().(VariableAccess).getLocation())
	and target_33.getArgument(5).(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_99.getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_34(Variable vres_3546, ValueFieldAccess target_58, RelationalOperation target_98) {
exists(AssignExpr target_34 |
	target_34.getLValue().(VariableAccess).getType().hasName("int")
	and target_34.getRValue().(SubExpr).getLeftOperand() instanceof ValueFieldAccess
	and target_34.getRValue().(SubExpr).getRightOperand().(ValueFieldAccess).getTarget().getName()="acl_data_offset"
	and target_34.getRValue().(SubExpr).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_58.getQualifier().(VariableAccess).getLocation().isBefore(target_34.getRValue().(SubExpr).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_35(Parameter vinode_3538, Variable vres_3546, Variable vresp_buf_3549, FunctionCall target_100, ValueFieldAccess target_1, ValueFieldAccess target_3, Function func) {
exists(IfStmt target_35 |
	target_35.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("int")
	and target_35.getCondition().(RelationalOperation).getLesserOperand() instanceof ValueFieldAccess
	and target_35.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("nfs4_write_cached_acl")
	and target_35.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_35.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_35.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("int")
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("nfs4_write_cached_acl")
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=vresp_buf_3549
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="acl_data_offset"
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
	and target_100.getArgument(0).(VariableAccess).getLocation().isBefore(target_35.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_1.getQualifier().(VariableAccess).getLocation().isBefore(target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_35.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_3.getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_39(Parameter vinode_3538, Variable vres_3546, Variable vresp_buf_3549, ValueFieldAccess target_1, ValueFieldAccess target_3) {
exists(PointerArithmeticOperation target_39 |
	target_39.getLeftOperand().(VariableAccess).getTarget()=vresp_buf_3549
	and target_39.getRightOperand().(ValueFieldAccess).getTarget().getName()="acl_data_offset"
	and target_39.getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("nfs4_write_cached_acl")
	and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vresp_buf_3549
	and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2) instanceof ValueFieldAccess
	and target_1.getQualifier().(VariableAccess).getLocation().isBefore(target_39.getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_39.getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_3.getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_41(Parameter vbuf_3538, Parameter vbuflen_3538, Variable vpages_3540, Variable vres_3546, Variable vret_3556, RelationalOperation target_98, ExprStmt target_89, IfStmt target_103, Function func) {
exists(IfStmt target_41 |
	target_41.getCondition().(VariableAccess).getTarget()=vbuf_3538
	and target_41.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556
	and target_41.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-34"
	and target_41.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("int")
	and target_41.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_41.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(GotoStmt).getName() ="out_free"
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_copy_from_pages")
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vbuf_3538
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpages_3540
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="acl_data_offset"
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(3) instanceof ValueFieldAccess
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_41
	and target_41.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_89.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_103.getCondition().(VariableAccess).getLocation().isBefore(target_41.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation()))
}

/*predicate func_42(Parameter vbuflen_3538, ExprStmt target_104) {
exists(RelationalOperation target_42 |
	 (target_42 instanceof GTExpr or target_42 instanceof LTExpr)
	and target_42.getGreaterOperand().(VariableAccess).getType().hasName("int")
	and target_42.getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_42.getParent().(IfStmt).getThen()=target_104)
}

*/
/*predicate func_43(VariableAccess target_85, Function func) {
exists(GotoStmt target_43 |
	target_43.getName() ="out_free"
	and target_43.getParent().(IfStmt).getCondition()=target_85
	and target_43.getEnclosingFunction() = func)
}

*/
/*predicate func_44(Parameter vbuf_3538, Variable vpages_3540, Variable vres_3546, VariableAccess target_67, RelationalOperation target_98, ExprStmt target_89) {
exists(ExprStmt target_44 |
	target_44.getExpr().(FunctionCall).getTarget().hasName("_copy_from_pages")
	and target_44.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vbuf_3538
	and target_44.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpages_3540
	and target_44.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="acl_data_offset"
	and target_44.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_44.getExpr().(FunctionCall).getArgument(3) instanceof ValueFieldAccess
	and target_44.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_44
	and target_44.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
	and target_44.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_89.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_46(Variable vret_3556, ReturnStmt target_105, Function func) {
exists(ExprStmt target_46 |
	target_46.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556
	and target_46.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
	and target_46.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_105.getExpr().(VariableAccess).getLocation()))
}

predicate func_47(Variable vpages_3540, Function func) {
exists(ForStmt target_47 |
	target_47.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_47.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_47.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_47.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("int")
	and target_47.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_47.getStmt().(IfStmt).getCondition().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_47.getStmt().(IfStmt).getCondition().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_47.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__free_pages")
	and target_47.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_47.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_47.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_47)
}

/*predicate func_48(Variable vpages_3540, Variable vlocalpage_3555) {
exists(ArrayExpr target_48 |
	target_48.getArrayBase().(VariableAccess).getTarget()=vpages_3540
	and target_48.getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_48.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__free_pages")
	and target_48.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vlocalpage_3555
	and target_48.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal)
}

*/
predicate func_50(Variable vargs_3541, RelationalOperation target_93) {
exists(ValueFieldAccess target_50 |
	target_50.getTarget().getName()="acl_scratch"
	and target_50.getQualifier().(VariableAccess).getTarget()=vargs_3541)
}

predicate func_51(Variable vargs_3541, VariableAccess target_87) {
exists(ExprStmt target_51 |
	target_51.getExpr().(FunctionCall).getTarget().hasName("__free_pages")
	and target_51.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="acl_scratch"
	and target_51.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_51.getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_51.getParent().(IfStmt).getCondition()=target_87)
}

predicate func_52(Parameter vbuflen_3538, BlockStmt target_106, BinaryBitwiseOperation target_52) {
	target_52.getValue()="4096"
	and target_52.getParent().(LTExpr).getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_52.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_106
}

predicate func_53(Variable vargs_3541, ValueFieldAccess target_53) {
	target_53.getTarget().getName()="acl_len"
	and target_53.getQualifier().(VariableAccess).getTarget()=vargs_3541
}

predicate func_54(Function func, UnaryMinusExpr target_54) {
	target_54.getValue()="-12"
	and target_54.getEnclosingFunction() = func
}

predicate func_55(Variable vargs_3541, RelationalOperation target_107, ExprStmt target_55) {
	target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="acl_pgbase"
	and target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_55.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_107
}

predicate func_56(Variable vargs_3541, BinaryBitwiseOperation target_56) {
	target_56.getValue()="4096"
	and target_56.getParent().(AssignExpr).getRValue() = target_56
	and target_56.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="acl_len"
	and target_56.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
}

predicate func_57(Variable vres_3546, ValueFieldAccess target_57) {
	target_57.getTarget().getName()="acl_len"
	and target_57.getQualifier().(VariableAccess).getTarget()=vres_3546
}

predicate func_58(Variable vres_3546, ValueFieldAccess target_58) {
	target_58.getTarget().getName()="acl_len"
	and target_58.getQualifier().(VariableAccess).getTarget()=vres_3546
}

/*predicate func_59(Parameter vbuflen_3538, BlockStmt target_106, VariableAccess target_59) {
	target_59.getTarget()=vbuflen_3538
	and target_59.getParent().(LTExpr).getGreaterOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_59.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_106
}

*/
predicate func_60(Variable vargs_3541, VariableAccess target_60) {
	target_60.getTarget()=vargs_3541
}

predicate func_62(Parameter vbuf_3538, VariableAccess target_62) {
	target_62.getTarget()=vbuf_3538
	and target_62.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_63(Parameter vbuflen_3538, VariableAccess target_63) {
	target_63.getTarget()=vbuflen_3538
	and target_63.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_64(Variable vargs_3541, VariableAccess target_64) {
	target_64.getTarget()=vargs_3541
	and target_64.getParent().(ValueFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_65(Variable vargs_3541, VariableAccess target_65) {
	target_65.getTarget()=vargs_3541
	and target_65.getParent().(ValueFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_67(Parameter vbuf_3538, BlockStmt target_94, VariableAccess target_67) {
	target_67.getTarget()=vbuf_3538
	and target_67.getParent().(IfStmt).getThen()=target_94
}

predicate func_68(Parameter vbuflen_3538, VariableAccess target_68) {
	target_68.getTarget()=vbuflen_3538
	and target_68.getParent().(GTExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_69(Parameter vbuf_3538, VariableAccess target_69) {
	target_69.getTarget()=vbuf_3538
	and target_69.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_70(Variable vres_3546, Variable vret_3556, VariableAccess target_70) {
	target_70.getTarget()=vret_3556
	and target_70.getParent().(AssignExpr).getLValue() = target_70
	and target_70.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="acl_len"
	and target_70.getParent().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
}

/*predicate func_71(Variable vres_3546, VariableAccess target_71) {
	target_71.getTarget()=vres_3546
}

*/
predicate func_73(Parameter vbuf_3538, Variable vresp_buf_3549, VariableAccess target_73) {
	target_73.getTarget()=vbuf_3538
	and target_73.getParent().(AssignExpr).getRValue() = target_73
	and target_73.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresp_buf_3549
}

predicate func_74(Parameter vinode_3538, Variable vresp_buf_3549, VariableAccess target_74) {
	target_74.getTarget()=vresp_buf_3549
	and target_74.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("nfs4_write_cached_acl")
	and target_74.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_74.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2) instanceof ValueFieldAccess
}

predicate func_76(Function func, DeclStmt target_76) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_76
}

predicate func_77(Variable vlocalpage_3555, VariableAccess target_77) {
	target_77.getTarget()=vlocalpage_3555
	and target_77.getParent().(AssignExpr).getLValue() = target_77
	and target_77.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("alloc_pages")
	and target_77.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="208"
	and target_77.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
}

predicate func_78(Variable vlocalpage_3555, ExprStmt target_108, EqualityOperation target_109, VariableAccess target_78) {
	target_78.getTarget()=vlocalpage_3555
	and target_78.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("lowmem_page_address")
	and target_108.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_78.getLocation())
	and target_78.getLocation().isBefore(target_109.getLeftOperand().(VariableAccess).getLocation())
}

predicate func_79(Variable vlocalpage_3555, ReturnStmt target_80, ExprStmt target_110, ExprStmt target_111, VariableAccess target_79) {
	target_79.getTarget()=vlocalpage_3555
	and target_79.getParent().(EQExpr).getRightOperand().(Literal).getValue()="0"
	and target_79.getParent().(EQExpr).getParent().(IfStmt).getThen()=target_80
	and target_110.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_79.getLocation())
	and target_79.getLocation().isBefore(target_111.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
}

predicate func_80(EqualityOperation target_109, Function func, ReturnStmt target_80) {
	target_80.getExpr() instanceof UnaryMinusExpr
	and target_80.getParent().(IfStmt).getCondition()=target_109
	and target_80.getEnclosingFunction() = func
}

/*predicate func_81(Variable vargs_3541, ExprStmt target_55, ValueFieldAccess target_81) {
	target_81.getTarget().getName()="acl_pages"
	and target_81.getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_81.getParent().(ArrayExpr).getArrayOffset() instanceof Literal
	and target_81.getQualifier().(VariableAccess).getLocation().isBefore(target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
predicate func_82(Variable vargs_3541, Variable vlocalpage_3555, ExprStmt target_55, EqualityOperation target_109, IfStmt target_112, VariableAccess target_82) {
	target_82.getTarget()=vlocalpage_3555
	and target_82.getParent().(AssignExpr).getRValue() = target_82
	and target_82.getParent().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getTarget().getName()="acl_pages"
	and target_82.getParent().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_82.getParent().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset() instanceof Literal
	and target_82.getParent().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_109.getLeftOperand().(VariableAccess).getLocation().isBefore(target_82.getLocation())
	and target_82.getLocation().isBefore(target_112.getCondition().(VariableAccess).getLocation())
}

predicate func_83(Parameter vbuf_3538, Variable vresp_buf_3549, AssignExpr target_83) {
	target_83.getLValue().(VariableAccess).getTarget()=vresp_buf_3549
	and target_83.getRValue().(VariableAccess).getTarget()=vbuf_3538
}

predicate func_84(Variable vargs_3541, ValueFieldAccess target_84) {
	target_84.getTarget().getName()="acl_pgbase"
	and target_84.getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_84.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_85(Variable vlocalpage_3555, ExprStmt target_104, ExprStmt target_111, IfStmt target_97, VariableAccess target_85) {
	target_85.getTarget()=vlocalpage_3555
	and target_85.getParent().(IfStmt).getThen()=target_104
	and target_111.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_85.getLocation())
	and target_85.getLocation().isBefore(target_97.getCondition().(VariableAccess).getLocation())
}

predicate func_86(Parameter vbuf_3538, Variable vresp_buf_3549, FunctionCall target_86) {
	target_86.getTarget().hasName("memcpy")
	and target_86.getArgument(0).(VariableAccess).getTarget()=vbuf_3538
	and target_86.getArgument(1).(VariableAccess).getTarget()=vresp_buf_3549
	and target_86.getArgument(2) instanceof ValueFieldAccess
}

predicate func_87(Variable vlocalpage_3555, ExprStmt target_113, IfStmt target_112, VariableAccess target_87) {
	target_87.getTarget()=vlocalpage_3555
	and target_87.getParent().(IfStmt).getThen()=target_113
	and target_112.getCondition().(VariableAccess).getLocation().isBefore(target_87.getLocation())
}

predicate func_88(Variable vlocalpage_3555, IfStmt target_97, VariableAccess target_88) {
	target_88.getTarget()=vlocalpage_3555
	and target_88.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__free_pages")
	and target_88.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_97.getCondition().(VariableAccess).getLocation().isBefore(target_88.getLocation())
}

predicate func_89(Variable vres_3546, Variable vret_3556, ExprStmt target_89) {
	target_89.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556
	and target_89.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="acl_len"
	and target_89.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
}

predicate func_91(Parameter vinode_3538, Variable vargs_3541, Variable vres_3546, Variable vret_3556, ExprStmt target_91) {
	target_91.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("nfs4_call_sync")
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("NFS_SERVER")
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(FunctionCall).getTarget().hasName("NFS_SERVER")
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("rpc_message")
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="seq_args"
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="seq_res"
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(Literal).getValue()="0"
}

predicate func_92(Parameter vinode_3538, ExprStmt target_92) {
	target_92.getExpr().(FunctionCall).getTarget().hasName("nfs4_write_cached_acl")
	and target_92.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_92.getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_92.getExpr().(FunctionCall).getArgument(2) instanceof ValueFieldAccess
}

predicate func_93(Function func, RelationalOperation target_93) {
	 (target_93 instanceof GTExpr or target_93 instanceof LTExpr)
	and target_93.getGreaterOperand() instanceof ValueFieldAccess
	and target_93.getLesserOperand() instanceof ValueFieldAccess
	and target_93.getEnclosingFunction() = func
}

predicate func_94(Parameter vbuflen_3538, Variable vret_3556, BlockStmt target_94) {
	target_94.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3556
	and target_94.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-34"
	and target_94.getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand() instanceof ValueFieldAccess
	and target_94.getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_94.getStmt(1).(IfStmt).getThen().(GotoStmt).getName() ="out_free"
}

predicate func_97(Variable vlocalpage_3555, IfStmt target_97) {
	target_97.getCondition().(VariableAccess).getTarget()=vlocalpage_3555
	and target_97.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__free_pages")
	and target_97.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vlocalpage_3555
	and target_97.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

predicate func_98(Parameter vbuflen_3538, RelationalOperation target_98) {
	 (target_98 instanceof GTExpr or target_98 instanceof LTExpr)
	and target_98.getGreaterOperand() instanceof ValueFieldAccess
	and target_98.getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
}

predicate func_99(Variable vargs_3541, AddressOfExpr target_99) {
	target_99.getOperand().(ValueFieldAccess).getTarget().getName()="seq_args"
	and target_99.getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
}

predicate func_100(Parameter vinode_3538, Variable vargs_3541, Variable vres_3546, FunctionCall target_100) {
	target_100.getTarget().hasName("NFS_SERVER")
	and target_100.getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("nfs4_call_sync")
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("NFS_SERVER")
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_3538
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("rpc_message")
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="seq_args"
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vargs_3541
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="seq_res"
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vres_3546
	and target_100.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(Literal).getValue()="0"
}

predicate func_103(Variable vret_3556, IfStmt target_103) {
	target_103.getCondition().(VariableAccess).getTarget()=vret_3556
	and target_103.getThen().(GotoStmt).getName() ="out_free"
}

predicate func_104(Function func, ExprStmt target_104) {
	target_104.getExpr() instanceof FunctionCall
	and target_104.getEnclosingFunction() = func
}

predicate func_105(Variable vret_3556, ReturnStmt target_105) {
	target_105.getExpr().(VariableAccess).getTarget()=vret_3556
}

predicate func_106(Variable vresp_buf_3549, Variable vlocalpage_3555, BlockStmt target_106) {
	target_106.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlocalpage_3555
	and target_106.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("alloc_pages")
	and target_106.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="208"
	and target_106.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_106.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresp_buf_3549
	and target_106.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("lowmem_page_address")
	and target_106.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vlocalpage_3555
}

predicate func_107(Parameter vbuflen_3538, RelationalOperation target_107) {
	 (target_107 instanceof GTExpr or target_107 instanceof LTExpr)
	and target_107.getLesserOperand().(VariableAccess).getTarget()=vbuflen_3538
	and target_107.getGreaterOperand() instanceof BinaryBitwiseOperation
}

predicate func_108(Variable vlocalpage_3555, ExprStmt target_108) {
	target_108.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlocalpage_3555
	and target_108.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("alloc_pages")
	and target_108.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="208"
	and target_108.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
}

predicate func_109(Variable vlocalpage_3555, EqualityOperation target_109) {
	target_109.getLeftOperand().(VariableAccess).getTarget()=vlocalpage_3555
	and target_109.getRightOperand().(Literal).getValue()="0"
}

predicate func_110(Variable vresp_buf_3549, Variable vlocalpage_3555, ExprStmt target_110) {
	target_110.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresp_buf_3549
	and target_110.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("lowmem_page_address")
	and target_110.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vlocalpage_3555
}

predicate func_111(Variable vlocalpage_3555, ExprStmt target_111) {
	target_111.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase() instanceof ValueFieldAccess
	and target_111.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset() instanceof Literal
	and target_111.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlocalpage_3555
}

predicate func_112(Variable vlocalpage_3555, IfStmt target_112) {
	target_112.getCondition().(VariableAccess).getTarget()=vlocalpage_3555
	and target_112.getThen().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_113(Variable vlocalpage_3555, ExprStmt target_113) {
	target_113.getExpr().(FunctionCall).getTarget().hasName("__free_pages")
	and target_113.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vlocalpage_3555
	and target_113.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

from Function func, Parameter vinode_3538, Parameter vbuf_3538, Parameter vbuflen_3538, Variable vpages_3540, Variable vargs_3541, Variable vres_3546, Variable vresp_buf_3549, Variable vlocalpage_3555, Variable vret_3556, Initializer target_0, ValueFieldAccess target_1, ValueFieldAccess target_2, ValueFieldAccess target_3, FunctionCall target_4, IfStmt target_5, BinaryBitwiseOperation target_52, ValueFieldAccess target_53, UnaryMinusExpr target_54, ExprStmt target_55, BinaryBitwiseOperation target_56, ValueFieldAccess target_57, ValueFieldAccess target_58, VariableAccess target_60, VariableAccess target_62, VariableAccess target_63, VariableAccess target_64, VariableAccess target_65, VariableAccess target_67, VariableAccess target_68, VariableAccess target_69, VariableAccess target_70, VariableAccess target_73, VariableAccess target_74, DeclStmt target_76, VariableAccess target_77, VariableAccess target_78, VariableAccess target_79, ReturnStmt target_80, VariableAccess target_82, AssignExpr target_83, ValueFieldAccess target_84, VariableAccess target_85, FunctionCall target_86, VariableAccess target_87, VariableAccess target_88, ExprStmt target_89, ExprStmt target_91, ExprStmt target_92, RelationalOperation target_93, BlockStmt target_94, IfStmt target_97, RelationalOperation target_98, AddressOfExpr target_99, FunctionCall target_100, IfStmt target_103, ExprStmt target_104, ReturnStmt target_105, BlockStmt target_106, RelationalOperation target_107, ExprStmt target_108, EqualityOperation target_109, ExprStmt target_110, ExprStmt target_111, IfStmt target_112, ExprStmt target_113
where
func_0(func, target_0)
and func_1(vres_3546, target_1)
and func_2(vres_3546, target_2)
and func_3(vres_3546, target_3)
and func_4(vbuf_3538, vbuflen_3538, vargs_3541, target_4)
and func_5(vbuf_3538, vbuflen_3538, vlocalpage_3555, vret_3556, target_89, target_5)
and not func_6(func)
and not func_7(func)
and not func_12(vbuflen_3538, vret_3556)
and not func_14(func)
and not func_15(vpages_3540, target_91, func)
and not func_24(vargs_3541, target_55)
and not func_26(vargs_3541, target_92)
and not func_27(target_93, func)
and not func_28(vargs_3541)
and not func_29(vbuf_3538, target_94)
and not func_30(vres_3546)
and not func_31(vpages_3540, vlocalpage_3555)
and not func_32(vbuf_3538, vbuflen_3538, vargs_3541, target_97, target_5, target_98, target_99, func)
and not func_34(vres_3546, target_58, target_98)
and not func_35(vinode_3538, vres_3546, vresp_buf_3549, target_100, target_1, target_3, func)
and not func_41(vbuf_3538, vbuflen_3538, vpages_3540, vres_3546, vret_3556, target_98, target_89, target_103, func)
and not func_46(vret_3556, target_105, func)
and not func_47(vpages_3540, func)
and not func_50(vargs_3541, target_93)
and not func_51(vargs_3541, target_87)
and func_52(vbuflen_3538, target_106, target_52)
and func_53(vargs_3541, target_53)
and func_54(func, target_54)
and func_55(vargs_3541, target_107, target_55)
and func_56(vargs_3541, target_56)
and func_57(vres_3546, target_57)
and func_58(vres_3546, target_58)
and func_60(vargs_3541, target_60)
and func_62(vbuf_3538, target_62)
and func_63(vbuflen_3538, target_63)
and func_64(vargs_3541, target_64)
and func_65(vargs_3541, target_65)
and func_67(vbuf_3538, target_94, target_67)
and func_68(vbuflen_3538, target_68)
and func_69(vbuf_3538, target_69)
and func_70(vres_3546, vret_3556, target_70)
and func_73(vbuf_3538, vresp_buf_3549, target_73)
and func_74(vinode_3538, vresp_buf_3549, target_74)
and func_76(func, target_76)
and func_77(vlocalpage_3555, target_77)
and func_78(vlocalpage_3555, target_108, target_109, target_78)
and func_79(vlocalpage_3555, target_80, target_110, target_111, target_79)
and func_80(target_109, func, target_80)
and func_82(vargs_3541, vlocalpage_3555, target_55, target_109, target_112, target_82)
and func_83(vbuf_3538, vresp_buf_3549, target_83)
and func_84(vargs_3541, target_84)
and func_85(vlocalpage_3555, target_104, target_111, target_97, target_85)
and func_86(vbuf_3538, vresp_buf_3549, target_86)
and func_87(vlocalpage_3555, target_113, target_112, target_87)
and func_88(vlocalpage_3555, target_97, target_88)
and func_89(vres_3546, vret_3556, target_89)
and func_91(vinode_3538, vargs_3541, vres_3546, vret_3556, target_91)
and func_92(vinode_3538, target_92)
and func_93(func, target_93)
and func_94(vbuflen_3538, vret_3556, target_94)
and func_97(vlocalpage_3555, target_97)
and func_98(vbuflen_3538, target_98)
and func_99(vargs_3541, target_99)
and func_100(vinode_3538, vargs_3541, vres_3546, target_100)
and func_103(vret_3556, target_103)
and func_104(func, target_104)
and func_105(vret_3556, target_105)
and func_106(vresp_buf_3549, vlocalpage_3555, target_106)
and func_107(vbuflen_3538, target_107)
and func_108(vlocalpage_3555, target_108)
and func_109(vlocalpage_3555, target_109)
and func_110(vresp_buf_3549, vlocalpage_3555, target_110)
and func_111(vlocalpage_3555, target_111)
and func_112(vlocalpage_3555, target_112)
and func_113(vlocalpage_3555, target_113)
and vinode_3538.getType().hasName("inode *")
and vbuf_3538.getType().hasName("void *")
and vbuflen_3538.getType().hasName("size_t")
and vpages_3540.getType().hasName("page *[16]")
and vargs_3541.getType().hasName("nfs_getaclargs")
and vres_3546.getType().hasName("nfs_getaclres")
and vresp_buf_3549.getType().hasName("void *")
and vlocalpage_3555.getType().hasName("page *")
and vret_3556.getType().hasName("int")
and vinode_3538.getFunction() = func
and vbuf_3538.getFunction() = func
and vbuflen_3538.getFunction() = func
and vpages_3540.(LocalVariable).getFunction() = func
and vargs_3541.(LocalVariable).getFunction() = func
and vres_3546.(LocalVariable).getFunction() = func
and vresp_buf_3549.(LocalVariable).getFunction() = func
and vlocalpage_3555.(LocalVariable).getFunction() = func
and vret_3556.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
