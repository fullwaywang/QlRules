commit ba775a54bc2136ec5da85385a923b05ee6fab159	ba775a54bc2136ec5da85385a923b05ee6fab159
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Mar 24 02:05:50 2012 +0100

    indeo3: fix out of picture write.
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/indeo3.c b/libavcodec/indeo3.c
index 7038cac3c6..b6ae2eaf03 100644
--- a/libavcodec/indeo3.c
+++ b/libavcodec/indeo3.c
@@ -419,8 +419,8 @@ static int decode_cell_data(Cell *cell, uint8_t *block, uint8_t *ref_block,
     blk_row_offset = (row_offset << (2 + v_zoom)) - (cell->width << 2);
     line_offset    = v_zoom ? row_offset : 0;
 
-    for (y = 0; y < cell->height; is_first_row = 0, y += 1 + v_zoom) {
-        for (x = 0; x < cell->width; x += 1 + h_zoom) {
+    for (y = 0; y + v_zoom < cell->height; is_first_row = 0, y += 1 + v_zoom) {
+        for (x = 0; x + h_zoom < cell->width; x += 1 + h_zoom) {
             ref = ref_block;
             dst = block;
 
