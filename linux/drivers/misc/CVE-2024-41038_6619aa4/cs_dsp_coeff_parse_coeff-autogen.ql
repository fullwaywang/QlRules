/**
 * @name linux-6619aa48a011364e9f29083cc76368e6acfe5b11-cs_dsp_coeff_parse_coeff
 * @id cpp/linux/6619aa48a011364e9f29083cc76368e6acfe5b11/cs-dsp-coeff-parse-coeff
 * @description linux-6619aa48a011364e9f29083cc76368e6acfe5b11-drivers/firmware/cirrus/cs_dsp.c-cs_dsp_coeff_parse_coeff CVE-2024-41038
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vraw_1093, ExprStmt target_60, ExprStmt target_0) {
	exists(AssignExpr obj_0 | obj_0=target_0.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vraw_1093
		and obj_0.getRValue() instanceof PointerDereferenceExpr
	)
	and target_0.getLocation().isBefore(target_60.getLocation())
}

predicate func_1(Function func, ExprStmt target_1) {
	target_1.getExpr() instanceof AssignExpr
	and target_1.getFollowingStmt() instanceof BreakStmt
	and target_1.getEnclosingFunction() = func
}

predicate func_2(BlockStmt target_61, Function func, DeclStmt target_2) {
	target_2.getLocation().isBefore(target_61.getLocation())
	and target_2.getEnclosingFunction() = func
}

predicate func_5(Variable vraw_1093, BlockStmt target_61, ExprStmt target_60, Function func) {
exists(ExprStmt target_5 |
	exists(AssignExpr obj_0 | obj_0=target_5.getExpr() |
		exists(AddressOfExpr obj_1 | obj_1=obj_0.getRValue() |
			exists(ArrayExpr obj_2 | obj_2=obj_1.getOperand() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getArrayBase() |
					obj_3.getTarget().getName()="data"
					and obj_3.getQualifier().(VariableAccess).getType().hasName("const wmfw_region *")
				)
				and obj_2.getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
			)
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vraw_1093
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_5
	and target_5.getLocation().isBefore(target_61.getLocation())
)
}

/*predicate func_6(Variable vraw_1093) {
exists(AddressOfExpr target_6 |
	exists(ArrayExpr obj_0 | obj_0=target_6.getOperand() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArrayBase() |
			obj_1.getTarget().getName()="data"
			and obj_1.getQualifier().(VariableAccess).getType().hasName("const wmfw_region *")
		)
		and obj_0.getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
	)
	and exists(AssignExpr obj_2 | obj_2=target_6.getParent() |
		obj_2.getRValue() = target_6
		and obj_2.getLValue().(VariableAccess).getTarget()=vraw_1093
	)
)
}

*/
predicate func_7(BlockStmt target_61, Function func) {
exists(IfStmt target_7 |
	exists(RelationalOperation obj_0 | obj_0=target_7.getCondition() |
		exists(SubExpr obj_1 | obj_1=obj_0.getLesserOperand() |
			obj_1.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
			and obj_1.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
		)
		and obj_0.getGreaterOperand() instanceof SizeofExprOperator
	)
	and target_7.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_7
	and target_7.getLocation().isBefore(target_61.getLocation())
)
}

predicate func_8(BlockStmt target_61, Function func) {
exists(ExprStmt target_8 |
	exists(AssignExpr obj_0 | obj_0=target_8.getExpr() |
		obj_0.getLValue().(VariableAccess).getType().hasName("unsigned int")
		and obj_0.getRValue() instanceof ValueFieldAccess
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_8
	and target_8.getLocation().isBefore(target_61.getLocation())
)
}

predicate func_9(BlockStmt target_61, Function func) {
exists(IfStmt target_9 |
	exists(RelationalOperation obj_0 | obj_0=target_9.getCondition() |
		obj_0.getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
		and obj_0.getLesserOperand().(BinaryBitwiseOperation).getValue()="2147483647"
	)
	and target_9.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_9
	and target_9.getLocation().isBefore(target_61.getLocation())
)
}

predicate func_10(BlockStmt target_61, Function func) {
exists(IfStmt target_10 |
	exists(RelationalOperation obj_0 | obj_0=target_10.getCondition() |
		exists(SubExpr obj_1 | obj_1=obj_0.getLesserOperand() |
			exists(SubExpr obj_2 | obj_2=obj_1.getLeftOperand() |
				obj_2.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
				and obj_2.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
			)
			and obj_1.getRightOperand() instanceof SizeofExprOperator
		)
		and obj_0.getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	)
	and target_10.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_10
	and target_10.getLocation().isBefore(target_61.getLocation())
)
}

predicate func_11(Function func) {
exists(AssignExpr target_11 |
	exists(AddExpr obj_0 | obj_0=target_11.getRValue() |
		exists(AddExpr obj_1 | obj_1=obj_0.getLeftOperand() |
			obj_1.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
			and obj_1.getRightOperand().(SizeofExprOperator).getValue()="8"
		)
		and obj_0.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
	)
	and target_11.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getEnclosingFunction() = func
)
}

predicate func_12(PointerFieldAccess target_62, Function func) {
exists(IfStmt target_12 |
	exists(RelationalOperation obj_0 | obj_0=target_12.getCondition() |
		exists(SubExpr obj_1 | obj_1=obj_0.getLesserOperand() |
			obj_1.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
			and obj_1.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
		)
		and obj_0.getGreaterOperand().(SizeofExprOperator).getValue()="528"
	)
	and target_12.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and target_12.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
	and target_12.getEnclosingFunction() = func
)
}

predicate func_13(Function func) {
exists(AssignAddExpr target_13 |
	target_13.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_13.getRValue().(SizeofExprOperator).getValue()="8"
	and target_13.getEnclosingFunction() = func
)
}

predicate func_14(Function func) {
exists(AddressOfExpr target_14 |
	exists(ArrayExpr obj_0 | obj_0=target_14.getOperand() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArrayBase() |
			obj_1.getTarget().getName()="data"
			and obj_1.getQualifier().(VariableAccess).getType().hasName("const wmfw_region *")
		)
		and obj_0.getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
	)
	and exists(AssignExpr obj_2 | obj_2=target_14.getParent() |
		obj_2.getRValue() = target_14
		and obj_2.getLValue() instanceof PointerDereferenceExpr
	)
	and target_14.getEnclosingFunction() = func
)
}

predicate func_15(Parameter vblk_1091, Variable vtmp_1094) {
exists(SubExpr target_15 |
	exists(FunctionCall obj_0 | obj_0=target_15.getParent() |
		exists(AssignExpr obj_1 | obj_1=obj_0.getParent() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getRValue() |
				exists(SizeofTypeOperator obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getType() instanceof LongType
					and obj_3.getValue()="1"
				)
				and exists(AddressOfExpr obj_4 | obj_4=obj_2.getArgument(2) |
					exists(PointerFieldAccess obj_5 | obj_5=obj_4.getOperand() |
						obj_5.getTarget().getName()="name"
						and obj_5.getQualifier().(VariableAccess).getTarget()=vblk_1091
					)
				)
				and obj_2.getTarget().hasName("cs_dsp_coeff_parse_string")
				and obj_2.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
			)
		)
	)
	and target_15.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_15.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
)
}

predicate func_16(Variable vtmp_1094, PointerFieldAccess target_62) {
exists(IfStmt target_16 |
	target_16.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
	and target_16.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and target_16.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
)
}

predicate func_17(Variable vtmp_1094, AddressOfExpr target_34, AddressOfExpr target_35) {
exists(AssignExpr target_17 |
	exists(PointerArithmeticOperation obj_0 | obj_0=target_17.getRValue() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getRightOperand() |
			obj_1.getTarget().getName()="data"
			and obj_1.getQualifier().(VariableAccess).getType().hasName("const wmfw_region *")
		)
		and obj_0.getLeftOperand().(VariableAccess).getTarget()=vtmp_1094
	)
	and target_17.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_34.getOperand().(VariableAccess).getLocation().isBefore(target_17.getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getLocation())
	and target_17.getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_35.getOperand().(VariableAccess).getLocation())
)
}

predicate func_18(Variable vtmp_1094) {
exists(SubExpr target_18 |
	exists(FunctionCall obj_0 | obj_0=target_18.getParent() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getParent() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				exists(SizeofTypeOperator obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getType() instanceof LongType
					and obj_3.getValue()="1"
				)
				and obj_2.getTarget().hasName("cs_dsp_coeff_parse_string")
				and obj_2.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
				and obj_2.getArgument(2).(Literal).getValue()="0"
			)
		)
	)
	and target_18.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_18.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
)
}

predicate func_19(Variable vtmp_1094, PointerFieldAccess target_62, AddressOfExpr target_34) {
exists(IfStmt target_19 |
	target_19.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
	and target_19.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and target_19.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
	and target_19.getCondition().(NotExpr).getOperand().(VariableAccess).getLocation().isBefore(target_34.getOperand().(VariableAccess).getLocation())
)
}

predicate func_20(Variable vtmp_1094, AddressOfExpr target_36, AddressOfExpr target_65) {
exists(AssignExpr target_20 |
	exists(PointerArithmeticOperation obj_0 | obj_0=target_20.getRValue() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getRightOperand() |
			obj_1.getTarget().getName()="data"
			and obj_1.getQualifier().(VariableAccess).getType().hasName("const wmfw_region *")
		)
		and obj_0.getLeftOperand().(VariableAccess).getTarget()=vtmp_1094
	)
	and target_20.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_36.getOperand().(VariableAccess).getLocation().isBefore(target_20.getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getLocation())
	and target_20.getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_65.getOperand().(VariableAccess).getLocation())
)
}

predicate func_21(Variable vtmp_1094) {
exists(SubExpr target_21 |
	exists(FunctionCall obj_0 | obj_0=target_21.getParent() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getParent() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				exists(SizeofTypeOperator obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getType() instanceof LongType
					and obj_3.getValue()="2"
				)
				and obj_2.getTarget().hasName("cs_dsp_coeff_parse_string")
				and obj_2.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
				and obj_2.getArgument(2).(Literal).getValue()="0"
			)
		)
	)
	and target_21.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_21.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
)
}

predicate func_22(Variable vtmp_1094, PointerFieldAccess target_62, AddressOfExpr target_35, AddressOfExpr target_36) {
exists(IfStmt target_22 |
	target_22.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
	and target_22.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and target_22.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
	and target_35.getOperand().(VariableAccess).getLocation().isBefore(target_22.getCondition().(NotExpr).getOperand().(VariableAccess).getLocation())
	and target_22.getCondition().(NotExpr).getOperand().(VariableAccess).getLocation().isBefore(target_36.getOperand().(VariableAccess).getLocation())
)
}

predicate func_23(Variable vtmp_1094, AddressOfExpr target_66, AddressOfExpr target_67) {
exists(AssignExpr target_23 |
	exists(PointerArithmeticOperation obj_0 | obj_0=target_23.getRValue() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getRightOperand() |
			obj_1.getTarget().getName()="data"
			and obj_1.getQualifier().(VariableAccess).getType().hasName("const wmfw_region *")
		)
		and obj_0.getLeftOperand().(VariableAccess).getTarget()=vtmp_1094
	)
	and target_23.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_66.getOperand().(VariableAccess).getLocation().isBefore(target_23.getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getLocation())
	and target_23.getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_67.getOperand().(VariableAccess).getLocation())
)
}

predicate func_24(PointerFieldAccess target_62, Function func) {
exists(IfStmt target_24 |
	exists(RelationalOperation obj_0 | obj_0=target_24.getCondition() |
		exists(SubExpr obj_1 | obj_1=obj_0.getLesserOperand() |
			obj_1.getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
			and obj_1.getRightOperand().(VariableAccess).getType().hasName("unsigned int")
		)
		and obj_0.getGreaterOperand().(AddExpr).getValue()="8"
	)
	and target_24.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-75"
	and target_24.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
	and target_24.getEnclosingFunction() = func
)
}

predicate func_28(Function func) {
exists(AssignAddExpr target_28 |
	target_28.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_28.getRValue().(SizeofExprOperator).getValue()="2"
	and target_28.getEnclosingFunction() = func
)
}

predicate func_29(PointerFieldAccess target_62, Function func) {
exists(ExprStmt target_29 |
	exists(AssignAddExpr obj_0 | obj_0=target_29.getExpr() |
		obj_0.getLValue().(VariableAccess).getType().hasName("unsigned int")
		and obj_0.getRValue().(SizeofExprOperator).getValue()="2"
	)
	and target_29.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
	and target_29.getEnclosingFunction() = func
)
}

predicate func_31(Variable vraw_1093, PointerFieldAccess target_31) {
	target_31.getTarget().getName()="hdr"
	and target_31.getQualifier().(VariableAccess).getTarget()=vraw_1093
}

predicate func_32(Parameter vblk_1091, Variable vraw_1093, PointerFieldAccess target_62, ExprStmt target_32) {
	exists(AssignExpr obj_0 | obj_0=target_32.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="offset"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vblk_1091
		)
		and exists(ValueFieldAccess obj_2 | obj_2=obj_0.getRValue() |
			exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
				obj_3.getTarget().getName()="hdr"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vraw_1093
			)
			and obj_2.getTarget().getName()="offset"
		)
	)
	and target_32.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
}

predicate func_33(Parameter vblk_1091, Variable vraw_1093, PointerFieldAccess target_62, ExprStmt target_33) {
	exists(AssignExpr obj_0 | obj_0=target_33.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="mem_type"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vblk_1091
		)
		and exists(ValueFieldAccess obj_2 | obj_2=obj_0.getRValue() |
			exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
				obj_3.getTarget().getName()="hdr"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vraw_1093
			)
			and obj_2.getTarget().getName()="type"
		)
	)
	and target_33.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_62
}

predicate func_34(Variable vtmp_1094, AddressOfExpr target_34) {
	target_34.getOperand().(VariableAccess).getTarget()=vtmp_1094
	and target_34.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_35(Variable vtmp_1094, AddressOfExpr target_35) {
	target_35.getOperand().(VariableAccess).getTarget()=vtmp_1094
	and target_35.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_36(Variable vtmp_1094, AddressOfExpr target_36) {
	target_36.getOperand().(VariableAccess).getTarget()=vtmp_1094
	and target_36.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_37(Parameter vblk_1091, Variable vtmp_1094, PointerFieldAccess target_37) {
	exists(AssignExpr obj_0 | obj_0=target_37.getParent() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(SizeofTypeOperator obj_2 | obj_2=obj_1.getArgument(0) |
				obj_2.getType() instanceof LongType
				and obj_2.getValue()="1"
			)
			and exists(AddressOfExpr obj_3 | obj_3=obj_1.getArgument(2) |
				exists(PointerFieldAccess obj_4 | obj_4=obj_3.getOperand() |
					obj_4.getTarget().getName()="name"
					and obj_4.getQualifier().(VariableAccess).getTarget()=vblk_1091
				)
			)
			and obj_1.getTarget().hasName("cs_dsp_coeff_parse_string")
			and obj_1.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
		)
		and obj_0.getLValue() = target_37
	)
	and target_37.getTarget().getName()="name_len"
	and target_37.getQualifier().(VariableAccess).getTarget()=vblk_1091
}

predicate func_38(Variable vraw_1093, PointerFieldAccess target_38) {
	target_38.getTarget().getName()="hdr"
	and target_38.getQualifier().(VariableAccess).getTarget()=vraw_1093
}

predicate func_39(Function func, SizeofExprOperator target_39) {
	target_39.getValue()="8"
	and target_39.getEnclosingFunction() = func
}

predicate func_40(Variable vraw_1093, ValueFieldAccess target_40) {
	exists(PointerFieldAccess obj_0 | obj_0=target_40.getQualifier() |
		obj_0.getTarget().getName()="hdr"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vraw_1093
	)
	and target_40.getTarget().getName()="size"
}

predicate func_41(Variable vraw_1093, PointerFieldAccess target_41) {
	target_41.getTarget().getName()="hdr"
	and target_41.getQualifier().(VariableAccess).getTarget()=vraw_1093
	and target_41.getParent().(ValueFieldAccess).getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_42(Variable vraw_1093, PointerFieldAccess target_42) {
	target_42.getTarget().getName()="hdr"
	and target_42.getQualifier().(VariableAccess).getTarget()=vraw_1093
	and target_42.getParent().(ValueFieldAccess).getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_43(Function func, SizeofExprOperator target_43) {
	target_43.getValue()="8"
	and target_43.getEnclosingFunction() = func
}

predicate func_44(Variable vtmp_1094, VariableAccess target_44) {
	exists(AssignExpr obj_0 | obj_0=target_44.getParent() |
		obj_0.getLValue() = target_44
		and obj_0.getRValue() instanceof PointerDereferenceExpr
	)
	and target_44.getTarget()=vtmp_1094
}

predicate func_45(Variable vraw_1093, VariableAccess target_45) {
	target_45.getTarget()=vraw_1093
	and target_45.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_47(Parameter vdata_1090, Variable vraw_1093, ExprStmt target_60, PointerDereferenceExpr target_47) {
	exists(AssignExpr obj_0 | obj_0=target_47.getParent() |
		obj_0.getRValue() = target_47
		and obj_0.getLValue().(VariableAccess).getTarget()=vraw_1093
	)
	and target_47.getOperand().(VariableAccess).getTarget()=vdata_1090
}

predicate func_48(Parameter vdata_1090, PointerDereferenceExpr target_48) {
	exists(AssignExpr obj_0 | obj_0=target_48.getParent() |
		exists(PointerArithmeticOperation obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerArithmeticOperation obj_2 | obj_2=obj_1.getLeftOperand() |
				obj_2.getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdata_1090
				and obj_2.getRightOperand() instanceof SizeofExprOperator
			)
			and obj_1.getRightOperand() instanceof ValueFieldAccess
		)
		and obj_0.getLValue() = target_48
	)
	and target_48.getOperand().(VariableAccess).getTarget()=vdata_1090
}

/*predicate func_49(Parameter vdata_1090, PointerArithmeticOperation target_49) {
	exists(PointerArithmeticOperation obj_0 | obj_0=target_49.getLeftOperand() |
		obj_0.getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdata_1090
		and obj_0.getRightOperand() instanceof SizeofExprOperator
	)
	and exists(AssignExpr obj_1 | obj_1=target_49.getParent() |
		obj_1.getRValue() = target_49
		and obj_1.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdata_1090
	)
	and target_49.getRightOperand() instanceof ValueFieldAccess
}

*/
predicate func_50(Parameter vdata_1090, Variable vtmp_1094, AssignExpr target_50) {
	target_50.getLValue().(VariableAccess).getTarget()=vtmp_1094
	and target_50.getRValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdata_1090
}

/*predicate func_51(Parameter vblk_1091, PointerFieldAccess target_51) {
	target_51.getTarget().getName()="offset"
	and target_51.getQualifier().(VariableAccess).getTarget()=vblk_1091
}

*/
/*predicate func_52(Parameter vblk_1091, FunctionCall target_52) {
	exists(AssignExpr obj_0 | obj_0=target_52.getParent() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="offset"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vblk_1091
		)
		and obj_0.getRValue() = target_52
	)
	and target_52.getTarget().hasName("cs_dsp_coeff_parse_int")
	and target_52.getArgument(0).(SizeofExprOperator).getValue()="2"
	and target_52.getArgument(1) instanceof AddressOfExpr
}

*/
predicate func_53(Variable vraw_1093, ValueFieldAccess target_53) {
	exists(PointerFieldAccess obj_0 | obj_0=target_53.getQualifier() |
		obj_0.getTarget().getName()="hdr"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vraw_1093
	)
	and exists(SizeofExprOperator obj_1 | obj_1=target_53.getParent() |
		exists(FunctionCall obj_2 | obj_2=obj_1.getParent() |
			exists(AssignExpr obj_3 | obj_3=obj_2.getParent() |
				exists(FunctionCall obj_4 | obj_4=obj_3.getRValue() |
					obj_4.getTarget().hasName("cs_dsp_coeff_parse_int")
					and obj_4.getArgument(0).(SizeofExprOperator).getValue()="2"
					and obj_4.getArgument(1) instanceof AddressOfExpr
				)
			)
		)
	)
	and target_53.getTarget().getName()="offset"
}

predicate func_54(Parameter vblk_1091, AssignExpr target_54) {
	exists(PointerFieldAccess obj_0 | obj_0=target_54.getLValue() |
		obj_0.getTarget().getName()="mem_type"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vblk_1091
	)
	and exists(FunctionCall obj_1 | obj_1=target_54.getRValue() |
		obj_1.getTarget().hasName("cs_dsp_coeff_parse_int")
		and obj_1.getArgument(0).(SizeofExprOperator).getValue()="2"
		and obj_1.getArgument(1) instanceof AddressOfExpr
	)
}

predicate func_55(Variable vraw_1093, ValueFieldAccess target_55) {
	exists(PointerFieldAccess obj_0 | obj_0=target_55.getQualifier() |
		obj_0.getTarget().getName()="hdr"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vraw_1093
	)
	and exists(SizeofExprOperator obj_1 | obj_1=target_55.getParent() |
		exists(FunctionCall obj_2 | obj_2=obj_1.getParent() |
			exists(AssignExpr obj_3 | obj_3=obj_2.getParent() |
				exists(FunctionCall obj_4 | obj_4=obj_3.getRValue() |
					obj_4.getTarget().hasName("cs_dsp_coeff_parse_int")
					and obj_4.getArgument(0).(SizeofExprOperator).getValue()="2"
					and obj_4.getArgument(1) instanceof AddressOfExpr
				)
			)
		)
	)
	and target_55.getTarget().getName()="type"
}

predicate func_56(Variable vlength_1095, AssignExpr target_56) {
	exists(FunctionCall obj_0 | obj_0=target_56.getRValue() |
		obj_0.getTarget().hasName("cs_dsp_coeff_parse_int")
		and obj_0.getArgument(0).(SizeofExprOperator).getValue()="4"
		and obj_0.getArgument(1) instanceof AddressOfExpr
	)
	and target_56.getLValue().(VariableAccess).getTarget()=vlength_1095
}

predicate func_57(Variable vraw_1093, ValueFieldAccess target_57) {
	exists(PointerFieldAccess obj_0 | obj_0=target_57.getQualifier() |
		obj_0.getTarget().getName()="hdr"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vraw_1093
	)
	and exists(SizeofExprOperator obj_1 | obj_1=target_57.getParent() |
		exists(FunctionCall obj_2 | obj_2=obj_1.getParent() |
			exists(AssignExpr obj_3 | obj_3=obj_2.getParent() |
				exists(FunctionCall obj_4 | obj_4=obj_3.getRValue() |
					obj_4.getTarget().hasName("cs_dsp_coeff_parse_int")
					and obj_4.getArgument(0).(SizeofExprOperator).getValue()="4"
					and obj_4.getArgument(1) instanceof AddressOfExpr
				)
			)
		)
	)
	and target_57.getTarget().getName()="size"
}

predicate func_58(Parameter vblk_1091, Variable vtmp_1094, AssignExpr target_58) {
	exists(PointerFieldAccess obj_0 | obj_0=target_58.getLValue() |
		obj_0.getTarget().getName()="name_len"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vblk_1091
	)
	and exists(FunctionCall obj_1 | obj_1=target_58.getRValue() |
		exists(SizeofTypeOperator obj_2 | obj_2=obj_1.getArgument(0) |
			obj_2.getType() instanceof LongType
			and obj_2.getValue()="1"
		)
		and exists(AddressOfExpr obj_3 | obj_3=obj_1.getArgument(2) |
			exists(PointerFieldAccess obj_4 | obj_4=obj_3.getOperand() |
				obj_4.getTarget().getName()="name"
				and obj_4.getQualifier().(VariableAccess).getTarget()=vblk_1091
			)
		)
		and obj_1.getTarget().hasName("cs_dsp_coeff_parse_string")
		and obj_1.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtmp_1094
	)
}

predicate func_59(Parameter vdata_1090, Variable vlength_1095, AssignExpr target_59) {
	exists(PointerArithmeticOperation obj_0 | obj_0=target_59.getRValue() |
		exists(PointerArithmeticOperation obj_1 | obj_1=obj_0.getLeftOperand() |
			obj_1.getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdata_1090
			and obj_1.getRightOperand() instanceof SizeofExprOperator
		)
		and obj_0.getRightOperand().(VariableAccess).getTarget()=vlength_1095
	)
	and target_59.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdata_1090
}

predicate func_60(Function func, ExprStmt target_60) {
	exists(AssignExpr obj_0 | obj_0=target_60.getExpr() |
		obj_0.getLValue() instanceof PointerDereferenceExpr
		and obj_0.getRValue() instanceof PointerArithmeticOperation
	)
	and target_60.getEnclosingFunction() = func
}

predicate func_61(Variable vraw_1093, BlockStmt target_61) {
	exists(SwitchStmt obj_0 | obj_0=target_61.getStmt(0) |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getExpr() |
			obj_1.getTarget().getName()="fw_ver"
			and obj_1.getQualifier().(VariableAccess).getTarget().getType().hasName("cs_dsp *")
		)
		and exists(BlockStmt obj_2 | obj_2=obj_0.getStmt() |
			exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(2) |
				exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
					obj_4.getLValue().(VariableAccess).getTarget()=vraw_1093
					and obj_4.getRValue() instanceof PointerDereferenceExpr
				)
			)
			and exists(ExprStmt obj_5 | obj_5=obj_2.getStmt(3) |
				exists(AssignExpr obj_6 | obj_6=obj_5.getExpr() |
					obj_6.getLValue() instanceof PointerDereferenceExpr
					and obj_6.getRValue() instanceof PointerArithmeticOperation
				)
			)
			and obj_2.getStmt(0).(SwitchCase).getExpr().(Literal).getValue()="0"
			and obj_2.getStmt(1).(SwitchCase).getExpr().(Literal).getValue()="1"
		)
	)
}

predicate func_62(Function func, PointerFieldAccess target_62) {
	target_62.getTarget().getName()="fw_ver"
	and target_62.getQualifier().(VariableAccess).getTarget().getType().hasName("cs_dsp *")
	and target_62.getEnclosingFunction() = func
}

predicate func_65(Parameter vblk_1091, Variable vtmp_1094, AddressOfExpr target_65) {
	exists(FunctionCall obj_0 | obj_0=target_65.getParent() |
		exists(AssignExpr obj_1 | obj_1=obj_0.getParent() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getRValue() |
				exists(SizeofTypeOperator obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getType() instanceof LongType
					and obj_3.getValue()="1"
				)
				and exists(AddressOfExpr obj_4 | obj_4=obj_2.getArgument(2) |
					exists(PointerFieldAccess obj_5 | obj_5=obj_4.getOperand() |
						obj_5.getTarget().getName()="name"
						and obj_5.getQualifier().(VariableAccess).getTarget()=vblk_1091
					)
				)
				and obj_2.getTarget().hasName("cs_dsp_coeff_parse_string")
			)
		)
	)
	and target_65.getOperand().(VariableAccess).getTarget()=vtmp_1094
}

predicate func_66(Variable vtmp_1094, AddressOfExpr target_66) {
	exists(FunctionCall obj_0 | obj_0=target_66.getParent() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getParent() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				exists(SizeofTypeOperator obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getType() instanceof LongType
					and obj_3.getValue()="1"
				)
				and obj_2.getTarget().hasName("cs_dsp_coeff_parse_string")
				and obj_2.getArgument(2).(Literal).getValue()="0"
			)
		)
	)
	and target_66.getOperand().(VariableAccess).getTarget()=vtmp_1094
}

predicate func_67(Variable vtmp_1094, AddressOfExpr target_67) {
	exists(FunctionCall obj_0 | obj_0=target_67.getParent() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getParent() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getExpr() |
				exists(SizeofTypeOperator obj_3 | obj_3=obj_2.getArgument(0) |
					obj_3.getType() instanceof LongType
					and obj_3.getValue()="2"
				)
				and obj_2.getTarget().hasName("cs_dsp_coeff_parse_string")
				and obj_2.getArgument(2).(Literal).getValue()="0"
			)
		)
	)
	and target_67.getOperand().(VariableAccess).getTarget()=vtmp_1094
}

from Function func, Parameter vdata_1090, Parameter vblk_1091, Variable vraw_1093, Variable vtmp_1094, Variable vlength_1095, ExprStmt target_0, ExprStmt target_1, DeclStmt target_2, PointerFieldAccess target_31, ExprStmt target_32, ExprStmt target_33, AddressOfExpr target_34, AddressOfExpr target_35, AddressOfExpr target_36, PointerFieldAccess target_37, PointerFieldAccess target_38, SizeofExprOperator target_39, ValueFieldAccess target_40, PointerFieldAccess target_41, PointerFieldAccess target_42, SizeofExprOperator target_43, VariableAccess target_44, VariableAccess target_45, PointerDereferenceExpr target_47, PointerDereferenceExpr target_48, AssignExpr target_50, ValueFieldAccess target_53, AssignExpr target_54, ValueFieldAccess target_55, AssignExpr target_56, ValueFieldAccess target_57, AssignExpr target_58, AssignExpr target_59, ExprStmt target_60, BlockStmt target_61, PointerFieldAccess target_62, AddressOfExpr target_65, AddressOfExpr target_66, AddressOfExpr target_67
where
func_0(vraw_1093, target_60, target_0)
and func_1(func, target_1)
and func_2(target_61, func, target_2)
and not func_5(vraw_1093, target_61, target_60, func)
and not func_7(target_61, func)
and not func_8(target_61, func)
and not func_9(target_61, func)
and not func_10(target_61, func)
and not func_11(func)
and not func_12(target_62, func)
and not func_13(func)
and not func_14(func)
and not func_15(vblk_1091, vtmp_1094)
and not func_16(vtmp_1094, target_62)
and not func_17(vtmp_1094, target_34, target_35)
and not func_18(vtmp_1094)
and not func_19(vtmp_1094, target_62, target_34)
and not func_20(vtmp_1094, target_36, target_65)
and not func_21(vtmp_1094)
and not func_22(vtmp_1094, target_62, target_35, target_36)
and not func_23(vtmp_1094, target_66, target_67)
and not func_24(target_62, func)
and not func_28(func)
and not func_29(target_62, func)
and func_31(vraw_1093, target_31)
and func_32(vblk_1091, vraw_1093, target_62, target_32)
and func_33(vblk_1091, vraw_1093, target_62, target_33)
and func_34(vtmp_1094, target_34)
and func_35(vtmp_1094, target_35)
and func_36(vtmp_1094, target_36)
and func_37(vblk_1091, vtmp_1094, target_37)
and func_38(vraw_1093, target_38)
and func_39(func, target_39)
and func_40(vraw_1093, target_40)
and func_41(vraw_1093, target_41)
and func_42(vraw_1093, target_42)
and func_43(func, target_43)
and func_44(vtmp_1094, target_44)
and func_45(vraw_1093, target_45)
and func_47(vdata_1090, vraw_1093, target_60, target_47)
and func_48(vdata_1090, target_48)
and func_50(vdata_1090, vtmp_1094, target_50)
and func_53(vraw_1093, target_53)
and func_54(vblk_1091, target_54)
and func_55(vraw_1093, target_55)
and func_56(vlength_1095, target_56)
and func_57(vraw_1093, target_57)
and func_58(vblk_1091, vtmp_1094, target_58)
and func_59(vdata_1090, vlength_1095, target_59)
and func_60(func, target_60)
and func_61(vraw_1093, target_61)
and func_62(func, target_62)
and func_65(vblk_1091, vtmp_1094, target_65)
and func_66(vtmp_1094, target_66)
and func_67(vtmp_1094, target_67)
and vdata_1090.getType().hasName("const u8 **")
and vblk_1091.getType().hasName("cs_dsp_coeff_parsed_coeff *")
and vraw_1093.getType().hasName("const wmfw_adsp_coeff_data *")
and vtmp_1094.getType().hasName("const u8 *")
and vlength_1095.getType().hasName("int")
and vdata_1090.getFunction() = func
and vblk_1091.getFunction() = func
and vraw_1093.(LocalVariable).getFunction() = func
and vtmp_1094.(LocalVariable).getFunction() = func
and vlength_1095.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
