/**
 * @name linux-b2a4df200d570b2c33a57e1ebfa5896e4bc81b69-key_gc_keyring
 * @id cpp/linux/b2a4df200d570b2c33a57e1ebfa5896e4bc81b69/key-gc-keyring
 * @description linux-b2a4df200d570b2c33a57e1ebfa5896e4bc81b69-security/keys/gc.c-key_gc_keyring CVE-2014-3631
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vkeyring_139, PointerFieldAccess target_0) {
		target_0.getTarget().getName()="payload"
		and target_0.getQualifier().(VariableAccess).getTarget()=vkeyring_139
}

predicate func_1(Function func, StringLiteral target_1) {
		target_1.getValue()="7==> %s(%x)\n"
		and not target_1.getValue()="7==> %s(%x{%s})\n"
		and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, FunctionCall target_2) {
		target_2.getTarget().hasName("debug_lockdep_rcu_enabled")
		and not target_2.getTarget().hasName("assoc_array_iterate")
		and target_2.getEnclosingFunction() = func
}

predicate func_3(Variable vloop_142, Variable vklist_141, VariableAccess target_3) {
		target_3.getTarget()=vloop_142
		and target_3.getParent().(AssignExpr).getLValue() = target_3
		and target_3.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_3.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_141
}

predicate func_4(Variable vloop_142, BlockStmt target_44, VariableAccess target_4) {
		target_4.getTarget()=vloop_142
		and target_4.getParent().(GEExpr).getLesserOperand() instanceof Literal
		and target_4.getParent().(GEExpr).getParent().(ForStmt).getStmt()=target_44
}

predicate func_5(Variable v_________p1_159, VariableAccess target_5) {
		target_5.getTarget()=v_________p1_159
}

predicate func_6(Parameter vkeyring_139, BitwiseAndExpr target_45) {
	exists(PointerFieldAccess target_6 |
		target_6.getTarget().getName()="serial"
		and target_6.getQualifier().(VariableAccess).getTarget()=vkeyring_139
		and target_6.getQualifier().(VariableAccess).getLocation().isBefore(target_45.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_7(Variable v__func__, Parameter vkeyring_139, BitwiseAndExpr target_45, ExprStmt target_46) {
	exists(ConditionalExpr target_7 |
		target_7.getCondition().(ValueFieldAccess).getTarget().getName()="description"
		and target_7.getCondition().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="(unknown field)"
		and target_7.getCondition().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_7.getCondition().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_139
		and target_7.getElse().(StringLiteral).getValue()=""
		and target_7.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("no_printk")
		and target_7.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_7.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=v__func__
		and target_7.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2) instanceof FunctionCall
		and target_45.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_7.getCondition().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_7.getCondition().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_46.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_8(Function func) {
	exists(AddressOfExpr target_8 |
		target_8.getOperand().(ValueFieldAccess).getTarget().getName()="keys"
		and target_8.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_8.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("key *")
		and target_8.getParent().(FunctionCall).getParent().(LogicalAndExpr).getAnOperand() instanceof FunctionCall
		and target_8.getEnclosingFunction() = func)
}

predicate func_10(Parameter vlimit_139, FunctionCall target_47) {
	exists(AddressOfExpr target_10 |
		target_10.getOperand().(VariableAccess).getTarget()=vlimit_139
		and target_10.getParent().(FunctionCall).getParent().(LogicalAndExpr).getAnOperand() instanceof FunctionCall
		and target_10.getOperand().(VariableAccess).getLocation().isBefore(target_47.getArgument(1).(VariableAccess).getLocation()))
}

predicate func_11(Function func) {
	exists(EqualityOperation target_11 |
		target_11.getAnOperand().(VariableAccess).getType().hasName("int")
		and target_11.getAnOperand() instanceof EnumConstantAccess
		and target_11.getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_11.getEnclosingFunction() = func)
}

predicate func_12(Parameter vkeyring_139, VariableAccess target_12) {
		target_12.getTarget()=vkeyring_139
		and target_12.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(2) instanceof FunctionCall
}

predicate func_14(Function func, DeclStmt target_14) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(Variable v__func__, Parameter vkeyring_139, Function func, ExprStmt target_15) {
		target_15.getExpr().(FunctionCall).getTarget().hasName("no_printk")
		and target_15.getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_15.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=v__func__
		and target_15.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("key_serial")
		and target_15.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkeyring_139
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

/*predicate func_16(Variable v__func__, Parameter vkeyring_139, FunctionCall target_16) {
		target_16.getTarget().hasName("key_serial")
		and target_16.getArgument(0).(VariableAccess).getTarget()=vkeyring_139
		and target_16.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("no_printk")
		and target_16.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_16.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=v__func__
}

*/
predicate func_17(Variable v_________p1_152, Variable vklist_141, AssignExpr target_17) {
		target_17.getLValue().(VariableAccess).getTarget()=vklist_141
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(DoStmt).getCondition() instanceof Literal
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_________p1_152
}

/*predicate func_19(Variable v__warned_152, DoStmt target_19) {
		target_19.getCondition() instanceof Literal
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand() instanceof FunctionCall
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_152
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_152
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof EnumConstantAccess
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_21(Variable v__warned_152, IfStmt target_21) {
		target_21.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand() instanceof FunctionCall
		and target_21.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_152
		and target_21.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_21.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_152
		and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof EnumConstantAccess
		and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_22(Variable v__warned_152, LogicalAndExpr target_48, ExprStmt target_22) {
		target_22.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_152
		and target_22.getExpr().(AssignExpr).getRValue() instanceof EnumConstantAccess
		and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_48
}

*/
/*predicate func_23(Function func, FunctionCall target_23) {
		target_23.getTarget().hasName("lockdep_rcu_suspicious")
		and target_23.getArgument(0) instanceof StringLiteral
		and target_23.getArgument(1) instanceof Literal
		and target_23.getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
		and target_23.getEnclosingFunction() = func
}

*/
/*predicate func_25(Function func, DoStmt target_25) {
		target_25.getCondition() instanceof Literal
		and target_25.getEnclosingFunction() = func
}

*/
/*predicate func_26(Variable v_________p1_152, ExprStmt target_26) {
		target_26.getExpr().(VariableAccess).getTarget()=v_________p1_152
}

*/
predicate func_27(Variable vklist_141, NotExpr target_27) {
		target_27.getOperand().(VariableAccess).getTarget()=vklist_141
		and target_27.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_28(Variable vloop_142, Variable vklist_141, Function func, ExprStmt target_28) {
		target_28.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vloop_142
		and target_28.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_28.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_141
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

/*predicate func_29(Variable vklist_141, PointerFieldAccess target_29) {
		target_29.getTarget().getName()="nkeys"
		and target_29.getQualifier().(VariableAccess).getTarget()=vklist_141
}

*/
predicate func_30(Function func, AsmStmt target_30) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

predicate func_31(Variable vloop_142, Variable vkey_159, Parameter vlimit_139, Function func, ForStmt target_31) {
		target_31.getInitialization().(ExprStmt).getExpr().(PostfixDecrExpr).getOperand().(VariableAccess).getTarget()=vloop_142
		and target_31.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vloop_142
		and target_31.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="0"
		and target_31.getUpdate().(PostfixDecrExpr).getOperand().(VariableAccess).getTarget()=vloop_142
		and target_31.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("key_is_dead")
		and target_31.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkey_159
		and target_31.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vlimit_139
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_31
}

predicate func_34(Variable v__warned_159, DoStmt target_34) {
		target_34.getCondition() instanceof Literal
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_159
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_159
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

/*predicate func_36(Variable v__warned_159, IfStmt target_36) {
		target_36.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_36.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_159
		and target_36.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_36.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_36.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_159
		and target_36.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_36.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_36.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_36.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_37(Variable v__warned_159, LogicalAndExpr target_49, ExprStmt target_37) {
		target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_159
		and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_49
}

*/
/*predicate func_38(LogicalAndExpr target_49, Function func, ExprStmt target_38) {
		target_38.getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_38.getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_38.getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_38.getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
		and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_49
		and target_38.getEnclosingFunction() = func
}

*/
predicate func_40(Function func, DoStmt target_40) {
		target_40.getCondition() instanceof Literal
		and target_40.getEnclosingFunction() = func
}

predicate func_41(Variable v_________p1_159, ExprStmt target_41) {
		target_41.getExpr().(VariableAccess).getTarget()=v_________p1_159
}

/*predicate func_42(Variable vkey_159, Parameter vlimit_139, IfStmt target_42) {
		target_42.getCondition().(FunctionCall).getTarget().hasName("key_is_dead")
		and target_42.getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkey_159
		and target_42.getCondition().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vlimit_139
}

*/
predicate func_43(Function func, ExprStmt target_43) {
		target_43.getExpr().(FunctionCall).getTarget().hasName("rcu_read_unlock")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_43
}

predicate func_44(Function func, BlockStmt target_44) {
		target_44.getStmt(1) instanceof IfStmt
		and target_44.getEnclosingFunction() = func
}

predicate func_45(Parameter vkeyring_139, BitwiseAndExpr target_45) {
		target_45.getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_45.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_139
		and target_45.getRightOperand().(BitwiseOrExpr).getValue()="132"
}

predicate func_46(Parameter vkeyring_139, Parameter vlimit_139, ExprStmt target_46) {
		target_46.getExpr().(FunctionCall).getTarget().hasName("keyring_gc")
		and target_46.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkeyring_139
		and target_46.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vlimit_139
}

predicate func_47(Variable vkey_159, Parameter vlimit_139, FunctionCall target_47) {
		target_47.getTarget().hasName("key_is_dead")
		and target_47.getArgument(0).(VariableAccess).getTarget()=vkey_159
		and target_47.getArgument(1).(VariableAccess).getTarget()=vlimit_139
}

predicate func_48(Function func, LogicalAndExpr target_48) {
		target_48.getAnOperand() instanceof LogicalAndExpr
		and target_48.getAnOperand() instanceof NotExpr
		and target_48.getEnclosingFunction() = func
}

predicate func_49(Function func, LogicalAndExpr target_49) {
		target_49.getAnOperand() instanceof LogicalAndExpr
		and target_49.getAnOperand() instanceof NotExpr
		and target_49.getEnclosingFunction() = func
}

from Function func, Variable vloop_142, Variable v__func__, Variable v_________p1_152, Variable v__warned_152, Variable vkey_159, Variable v_________p1_159, Variable v__warned_159, Parameter vkeyring_139, Variable vklist_141, Parameter vlimit_139, PointerFieldAccess target_0, StringLiteral target_1, FunctionCall target_2, VariableAccess target_3, VariableAccess target_4, VariableAccess target_5, VariableAccess target_12, DeclStmt target_14, ExprStmt target_15, AssignExpr target_17, NotExpr target_27, ExprStmt target_28, AsmStmt target_30, ForStmt target_31, DoStmt target_34, DoStmt target_40, ExprStmt target_41, ExprStmt target_43, BlockStmt target_44, BitwiseAndExpr target_45, ExprStmt target_46, FunctionCall target_47, LogicalAndExpr target_48, LogicalAndExpr target_49
where
func_0(vkeyring_139, target_0)
and func_1(func, target_1)
and func_2(func, target_2)
and func_3(vloop_142, vklist_141, target_3)
and func_4(vloop_142, target_44, target_4)
and func_5(v_________p1_159, target_5)
and not func_6(vkeyring_139, target_45)
and not func_7(v__func__, vkeyring_139, target_45, target_46)
and not func_8(func)
and not func_10(vlimit_139, target_47)
and not func_11(func)
and func_12(vkeyring_139, target_12)
and func_14(func, target_14)
and func_15(v__func__, vkeyring_139, func, target_15)
and func_17(v_________p1_152, vklist_141, target_17)
and func_27(vklist_141, target_27)
and func_28(vloop_142, vklist_141, func, target_28)
and func_30(func, target_30)
and func_31(vloop_142, vkey_159, vlimit_139, func, target_31)
and func_34(v__warned_159, target_34)
and func_40(func, target_40)
and func_41(v_________p1_159, target_41)
and func_43(func, target_43)
and func_44(func, target_44)
and func_45(vkeyring_139, target_45)
and func_46(vkeyring_139, vlimit_139, target_46)
and func_47(vkey_159, vlimit_139, target_47)
and func_48(func, target_48)
and func_49(func, target_49)
and vloop_142.getType().hasName("int")
and v__func__.getType() instanceof ArrayType
and v_________p1_152.getType().hasName("keyring_list *")
and v__warned_152.getType().hasName("bool")
and vkey_159.getType().hasName("key *")
and v_________p1_159.getType().hasName("key *")
and v__warned_159.getType().hasName("bool")
and vkeyring_139.getType().hasName("key *")
and vklist_141.getType().hasName("keyring_list *")
and vlimit_139.getType().hasName("time_t")
and vloop_142.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
and v_________p1_152.(LocalVariable).getFunction() = func
and v__warned_152.(LocalVariable).getFunction() = func
and vkey_159.(LocalVariable).getFunction() = func
and v_________p1_159.(LocalVariable).getFunction() = func
and v__warned_159.(LocalVariable).getFunction() = func
and vkeyring_139.getFunction() = func
and vklist_141.(LocalVariable).getFunction() = func
and vlimit_139.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
