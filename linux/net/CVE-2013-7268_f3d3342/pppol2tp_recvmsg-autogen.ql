/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-pppol2tp_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/pppol2tp-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/l2tp/l2tp_ppp.c-pppol2tp_recvmsg CVE-2013-7268
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable verr_192, UnaryMinusExpr target_0) {
		target_0.getValue()="-5"
		and target_0.getParent().(AssignExpr).getRValue() = target_0
		and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_192
}

predicate func_1(Variable verr_192, VariableAccess target_1) {
		target_1.getTarget()=verr_192
		and target_1.getParent().(AssignExpr).getLValue() = target_1
		and target_1.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_2(Variable verr_192, Variable vsk_194, VariableAccess target_2) {
		target_2.getTarget()=verr_192
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="-65"
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
}

predicate func_3(Parameter vlen_189, Variable vskb_193, VariableAccess target_3) {
		target_3.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_3.getParent().(AssignExpr).getLValue() = target_3
		and target_3.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_3.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

/*predicate func_4(Parameter vmsg_189, Parameter vlen_189, Variable vskb_193, VariableAccess target_4) {
		target_4.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_4.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_4.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_4.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_4.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_4.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
}

*/
predicate func_5(Variable vskb_193, FunctionCall target_5) {
		target_5.getTarget().hasName("kfree_skb")
		and not target_5.getTarget().hasName("skb_reset_transport_header")
		and target_5.getArgument(0).(VariableAccess).getTarget()=vskb_193
}

predicate func_6(Variable verr_192, VariableAccess target_6) {
		target_6.getTarget()=verr_192
}

/*predicate func_7(Variable verr_192, VariableAccess target_7) {
		target_7.getTarget()=verr_192
		and target_7.getParent().(AssignExpr).getLValue() = target_7
		and target_7.getParent().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-5"
}

*/
predicate func_9(Parameter vlen_189, Variable vskb_193, ExprStmt target_58, VariableAccess target_9) {
		target_9.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_9.getParent().(GTExpr).getLesserOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_9.getParent().(GTExpr).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_9.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_58
}

predicate func_10(Parameter vlen_189, Variable vskb_193, ExprStmt target_45, VariableAccess target_10) {
		target_10.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_10.getParent().(LTExpr).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_10.getParent().(LTExpr).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_10.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_45
}

predicate func_11(Parameter vmsg_189, Parameter vlen_189, Variable verr_192, Variable vskb_193, VariableAccess target_11) {
		target_11.getTarget()=verr_192
		and target_11.getParent().(AssignExpr).getLValue() = target_11
		and target_11.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_11.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_11.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_11.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_11.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_11.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vlen_189
}

predicate func_12(Variable verr_192, VariableAccess target_12) {
		target_12.getTarget()=verr_192
		and target_12.getParent().(EQExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
}

predicate func_13(Parameter vlen_189, Variable verr_192, VariableAccess target_13) {
		target_13.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_13.getParent().(AssignExpr).getRValue() = target_13
		and target_13.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_192
}

predicate func_15(Function func) {
	exists(EqualityOperation target_15 |
		target_15.getAnOperand() instanceof ValueFieldAccess
		and target_15.getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_15.getEnclosingFunction() = func)
}

predicate func_16(BitwiseAndExpr target_59, Function func) {
	exists(ReturnStmt target_16 |
		target_16.getExpr().(UnaryMinusExpr).getValue()="-107"
		and target_16.getParent().(IfStmt).getCondition()=target_59
		and target_16.getEnclosingFunction() = func)
}

predicate func_17(Variable verr_192, Variable vskb_193, NotExpr target_52, ExprStmt target_58) {
	exists(EqualityOperation target_17 |
		target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="data"
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(ArrayExpr).getArrayOffset() instanceof Literal
		and target_17.getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="128"
		and target_17.getAnOperand().(Literal).getValue()="128"
		and target_17.getParent().(AssignExpr).getRValue() = target_17
		and target_17.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_192
		and target_52.getOperand().(VariableAccess).getLocation().isBefore(target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_18(Variable vskb_193, NotExpr target_52, ExprStmt target_58) {
	exists(ArrayExpr target_18 |
		target_18.getArrayBase().(PointerFieldAccess).getTarget().getName()="data"
		and target_18.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_18.getArrayOffset() instanceof Literal
		and target_18.getParent().(BitwiseAndExpr).getLeftOperand() instanceof ValueFieldAccess
		and target_18.getParent().(BitwiseAndExpr).getRightOperand() instanceof EnumConstantAccess
		and target_18.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_52.getOperand().(VariableAccess).getLocation().isBefore(target_18.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_18.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_20(Variable vskb_193, ExprStmt target_60, RelationalOperation target_61) {
	exists(FunctionCall target_20 |
		target_20.getTarget().hasName("skb_pull")
		and target_20.getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_20.getArgument(1).(Literal).getValue()="3"
		and target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_20.getArgument(0).(VariableAccess).getLocation())
		and target_20.getArgument(0).(VariableAccess).getLocation().isBefore(target_61.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_21(Function func) {
	exists(PointerFieldAccess target_21 |
		target_21.getTarget().getName()="qbitincl"
		and target_21.getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_21.getEnclosingFunction() = func)
}

predicate func_22(Variable vskb_193, ExprStmt target_58, ExprStmt target_62) {
	exists(AssignExpr target_22 |
		target_22.getLValue().(VariableAccess).getType().hasName("unsigned char *")
		and target_22.getRValue().(FunctionCall).getTarget().hasName("skb_push")
		and target_22.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_22.getRValue().(FunctionCall).getArgument(1) instanceof Literal
		and target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_22.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
		and target_22.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_23(RelationalOperation target_61, Function func) {
	exists(ExprStmt target_23 |
		target_23.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned char *")
		and target_23.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("int")
		and target_23.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_23
		and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
		and target_23.getEnclosingFunction() = func)
}

predicate func_24(RelationalOperation target_63, Function func) {
	exists(ExprStmt target_24 |
		target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
		and target_24.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("size_t")
		and target_24.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_24
		and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_63
		and target_24.getEnclosingFunction() = func)
}

predicate func_25(Parameter vmsg_189, Variable vskb_193, ExprStmt target_45, RelationalOperation target_63, Function func) {
	exists(ExprStmt target_25 |
		target_25.getExpr().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_25.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_25.getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_25.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_25.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_25.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getType().hasName("size_t")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
		and target_45.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_25.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_63.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_25.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_26(Parameter vmsg_189, ExprStmt target_62) {
	exists(PointerFieldAccess target_26 |
		target_26.getTarget().getName()="msg_name"
		and target_26.getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_26.getQualifier().(VariableAccess).getLocation()))
}

predicate func_27(Parameter vmsg_189, FunctionCall target_56) {
	exists(ExprStmt target_27 |
		target_27.getExpr().(FunctionCall).getTarget().hasName("memset")
		and target_27.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_27.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_27.getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_27.getExpr().(FunctionCall).getArgument(2).(SizeofTypeOperator).getType() instanceof LongType
		and target_27.getExpr().(FunctionCall).getArgument(2).(SizeofTypeOperator).getValue()="64"
		and target_27.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_27
		and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56)
}

predicate func_28(Parameter vmsg_189, FunctionCall target_56) {
	exists(ExprStmt target_28 |
		target_28.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_28.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_28.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_28.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_28
		and target_28.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56)
}

predicate func_29(Function func) {
	exists(AssignExpr target_29 |
		target_29.getLValue().(PointerFieldAccess).getTarget().getName()="srose_family"
		and target_29.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_29.getRValue().(Literal).getValue()="11"
		and target_29.getEnclosingFunction() = func)
}

predicate func_30(FunctionCall target_56, Function func) {
	exists(ExprStmt target_30 |
		target_30.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="srose_addr"
		and target_30.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_30.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="dest_addr"
		and target_30.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_30.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(4)=target_30
		and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
		and target_30.getEnclosingFunction() = func)
}

predicate func_31(Function func) {
	exists(AssignExpr target_31 |
		target_31.getLValue().(PointerFieldAccess).getTarget().getName()="srose_call"
		and target_31.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_31.getRValue().(PointerFieldAccess).getTarget().getName()="dest_call"
		and target_31.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_31.getEnclosingFunction() = func)
}

predicate func_32(FunctionCall target_56, Function func) {
	exists(ExprStmt target_32 |
		target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="srose_ndigis"
		and target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_32.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="dest_ndigis"
		and target_32.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_32.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(6)=target_32
		and target_32.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
		and target_32.getEnclosingFunction() = func)
}

/*predicate func_33(Function func) {
	exists(PointerFieldAccess target_33 |
		target_33.getTarget().getName()="srose_ndigis"
		and target_33.getQualifier().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_33.getEnclosingFunction() = func)
}

*/
/*predicate func_34(Function func) {
	exists(PointerFieldAccess target_34 |
		target_34.getTarget().getName()="dest_ndigis"
		and target_34.getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_34.getEnclosingFunction() = func)
}

*/
predicate func_35(Parameter vmsg_189, FunctionCall target_56) {
	exists(IfStmt target_35 |
		target_35.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_35.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_35.getCondition().(RelationalOperation).getLesserOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_35.getCondition().(RelationalOperation).getLesserOperand().(SizeofTypeOperator).getValue()="64"
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="dest_ndigis"
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="srose_digis"
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="dest_digis"
		and target_35.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
		and target_35.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_35.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_35.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getType() instanceof LongType
		and target_35.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getValue()="64"
		and target_35.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="dest_ndigis"
		and target_35.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_35.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_35.getElse().(BlockStmt).getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="srose_ndigis"
		and target_35.getElse().(BlockStmt).getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_35.getElse().(BlockStmt).getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="srose_digi"
		and target_35.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_35.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_35.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getType() instanceof LongType
		and target_35.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getValue()="28"
		and target_35.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(7)=target_35
		and target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56)
}

/*predicate func_37(Function func) {
	exists(PointerFieldAccess target_37 |
		target_37.getTarget().getName()="dest_ndigis"
		and target_37.getQualifier().(VariableAccess).getType().hasName("rose_sock *")
		and target_37.getEnclosingFunction() = func)
}

*/
/*predicate func_38(Function func) {
	exists(SizeofTypeOperator target_38 |
		target_38.getType() instanceof LongType
		and target_38.getValue()="64"
		and target_38.getEnclosingFunction() = func)
}

*/
/*predicate func_39(Function func) {
	exists(PointerFieldAccess target_39 |
		target_39.getTarget().getName()="srose_ndigis"
		and target_39.getQualifier().(VariableAccess).getType().hasName("sockaddr_rose *")
		and target_39.getEnclosingFunction() = func)
}

*/
predicate func_41(Variable vskb_193, Variable vsk_194, ExprStmt target_62, ExprStmt target_60, Function func) {
	exists(ExprStmt target_41 |
		target_41.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_41.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and target_41.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_193
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_41
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_41.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_41.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_42(Function func) {
	exists(ReturnStmt target_42 |
		target_42.getExpr().(VariableAccess).getType().hasName("size_t")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_42)
}

predicate func_43(Parameter vmsg_189, PointerFieldAccess target_43) {
		target_43.getTarget().getName()="msg_namelen"
		and target_43.getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_43.getParent().(AssignExpr).getLValue() = target_43
		and target_43.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_44(Variable vsk_194, ValueFieldAccess target_44) {
		target_44.getTarget().getName()="skc_state"
		and target_44.getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
		and target_44.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_194
}

predicate func_45(Parameter vmsg_189, RelationalOperation target_61, ExprStmt target_45) {
		target_45.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_45.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_45.getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
		and target_45.getParent().(IfStmt).getParent().(IfStmt).getCondition()=target_61
}

predicate func_46(Variable vskb_193, VariableAccess target_46) {
		target_46.getTarget()=vskb_193
}

predicate func_49(Variable vskb_193, VariableAccess target_49) {
		target_49.getTarget()=vskb_193
		and target_49.getParent().(NotExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_50(Variable vskb_193, VariableAccess target_50) {
		target_50.getTarget()=vskb_193
}

predicate func_51(BitwiseAndExpr target_59, Function func, GotoStmt target_51) {
		target_51.getParent().(IfStmt).getCondition()=target_59
		and target_51.getEnclosingFunction() = func
}

predicate func_52(Variable vskb_193, NotExpr target_52) {
		target_52.getOperand().(VariableAccess).getTarget()=vskb_193
		and target_52.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_53(NotExpr target_52, Function func, GotoStmt target_53) {
		target_53.getParent().(IfStmt).getCondition()=target_52
		and target_53.getEnclosingFunction() = func
}

predicate func_54(Variable vskb_193, NotExpr target_52, ExprStmt target_58, PointerFieldAccess target_54) {
		target_54.getTarget().getName()="len"
		and target_54.getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_52.getOperand().(VariableAccess).getLocation().isBefore(target_54.getQualifier().(VariableAccess).getLocation())
		and target_54.getQualifier().(VariableAccess).getLocation().isBefore(target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_55(Variable vskb_193, ExprStmt target_58, ExprStmt target_62, PointerFieldAccess target_55) {
		target_55.getTarget().getName()="len"
		and target_55.getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_55.getQualifier().(VariableAccess).getLocation())
		and target_55.getQualifier().(VariableAccess).getLocation().isBefore(target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
}

predicate func_56(Variable verr_192, ExprStmt target_65, FunctionCall target_56) {
		target_56.getTarget().hasName("__builtin_expect")
		and target_56.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=verr_192
		and target_56.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_56.getArgument(1) instanceof Literal
		and target_56.getParent().(IfStmt).getThen()=target_65
}

predicate func_57(Parameter vlen_189, Variable verr_192, ExprStmt target_62, ReturnStmt target_67, VariableAccess target_57) {
		target_57.getTarget()=verr_192
		and target_57.getParent().(AssignExpr).getLValue() = target_57
		and target_57.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_189
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_57.getParent().(AssignExpr).getRValue().(VariableAccess).getLocation())
		and target_57.getLocation().isBefore(target_67.getExpr().(VariableAccess).getLocation())
}

predicate func_58(Parameter vlen_189, Variable vskb_193, ExprStmt target_58) {
		target_58.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlen_189
		and target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_59(Function func, BitwiseAndExpr target_59) {
		target_59.getLeftOperand() instanceof ValueFieldAccess
		and target_59.getRightOperand() instanceof EnumConstantAccess
		and target_59.getEnclosingFunction() = func
}

predicate func_60(Variable verr_192, Variable vskb_193, Variable vsk_194, ExprStmt target_60) {
		target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vskb_193
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="-65"
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
		and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_192
}

predicate func_61(Parameter vlen_189, Variable vskb_193, RelationalOperation target_61) {
		 (target_61 instanceof GTExpr or target_61 instanceof LTExpr)
		and target_61.getGreaterOperand().(VariableAccess).getTarget()=vlen_189
		and target_61.getLesserOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_61.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_62(Parameter vmsg_189, Parameter vlen_189, Variable verr_192, Variable vskb_193, ExprStmt target_62) {
		target_62.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_192
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vlen_189
}

predicate func_63(Parameter vlen_189, Variable vskb_193, RelationalOperation target_63) {
		 (target_63 instanceof GTExpr or target_63 instanceof LTExpr)
		and target_63.getLesserOperand().(VariableAccess).getTarget()=vlen_189
		and target_63.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_63.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_65(Parameter vlen_189, Variable verr_192, ExprStmt target_65) {
		target_65.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_192
		and target_65.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_189
}

predicate func_67(Variable verr_192, ReturnStmt target_67) {
		target_67.getExpr().(VariableAccess).getTarget()=verr_192
}

from Function func, Parameter vmsg_189, Parameter vlen_189, Variable verr_192, Variable vskb_193, Variable vsk_194, UnaryMinusExpr target_0, VariableAccess target_1, VariableAccess target_2, VariableAccess target_3, FunctionCall target_5, VariableAccess target_6, VariableAccess target_9, VariableAccess target_10, VariableAccess target_11, VariableAccess target_12, VariableAccess target_13, PointerFieldAccess target_43, ValueFieldAccess target_44, ExprStmt target_45, VariableAccess target_46, VariableAccess target_49, VariableAccess target_50, GotoStmt target_51, NotExpr target_52, GotoStmt target_53, PointerFieldAccess target_54, PointerFieldAccess target_55, FunctionCall target_56, VariableAccess target_57, ExprStmt target_58, BitwiseAndExpr target_59, ExprStmt target_60, RelationalOperation target_61, ExprStmt target_62, RelationalOperation target_63, ExprStmt target_65, ReturnStmt target_67
where
func_0(verr_192, target_0)
and func_1(verr_192, target_1)
and func_2(verr_192, vsk_194, target_2)
and func_3(vlen_189, vskb_193, target_3)
and func_5(vskb_193, target_5)
and func_6(verr_192, target_6)
and func_9(vlen_189, vskb_193, target_58, target_9)
and func_10(vlen_189, vskb_193, target_45, target_10)
and func_11(vmsg_189, vlen_189, verr_192, vskb_193, target_11)
and func_12(verr_192, target_12)
and func_13(vlen_189, verr_192, target_13)
and not func_15(func)
and not func_16(target_59, func)
and not func_17(verr_192, vskb_193, target_52, target_58)
and not func_20(vskb_193, target_60, target_61)
and not func_21(func)
and not func_22(vskb_193, target_58, target_62)
and not func_23(target_61, func)
and not func_24(target_63, func)
and not func_25(vmsg_189, vskb_193, target_45, target_63, func)
and not func_26(vmsg_189, target_62)
and not func_27(vmsg_189, target_56)
and not func_28(vmsg_189, target_56)
and not func_29(func)
and not func_30(target_56, func)
and not func_31(func)
and not func_32(target_56, func)
and not func_35(vmsg_189, target_56)
and not func_41(vskb_193, vsk_194, target_62, target_60, func)
and not func_42(func)
and func_43(vmsg_189, target_43)
and func_44(vsk_194, target_44)
and func_45(vmsg_189, target_61, target_45)
and func_46(vskb_193, target_46)
and func_49(vskb_193, target_49)
and func_50(vskb_193, target_50)
and func_51(target_59, func, target_51)
and func_52(vskb_193, target_52)
and func_53(target_52, func, target_53)
and func_54(vskb_193, target_52, target_58, target_54)
and func_55(vskb_193, target_58, target_62, target_55)
and func_56(verr_192, target_65, target_56)
and func_57(vlen_189, verr_192, target_62, target_67, target_57)
and func_58(vlen_189, vskb_193, target_58)
and func_59(func, target_59)
and func_60(verr_192, vskb_193, vsk_194, target_60)
and func_61(vlen_189, vskb_193, target_61)
and func_62(vmsg_189, vlen_189, verr_192, vskb_193, target_62)
and func_63(vlen_189, vskb_193, target_63)
and func_65(vlen_189, verr_192, target_65)
and func_67(verr_192, target_67)
and vmsg_189.getType().hasName("msghdr *")
and vlen_189.getType().hasName("size_t")
and verr_192.getType().hasName("int")
and vskb_193.getType().hasName("sk_buff *")
and vsk_194.getType().hasName("sock *")
and vmsg_189.getFunction() = func
and vlen_189.getFunction() = func
and verr_192.(LocalVariable).getFunction() = func
and vskb_193.(LocalVariable).getFunction() = func
and vsk_194.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
