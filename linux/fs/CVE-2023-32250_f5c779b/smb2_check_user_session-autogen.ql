/**
 * @name linux-f5c779b7ddbda30866cf2a27c63e34158f858c73-smb2_check_user_session
 * @id cpp/linux/f5c779b7ddbda30866cf2a27c63e34158f858c73/smb2-check-user-session
 * @description linux-f5c779b7ddbda30866cf2a27c63e34158f858c73-fs/ksmbd/smb2pdu.c-smb2_check_user_session CVE-2023-32252
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vwork_547, Initializer target_0) {
		target_0.getExpr().(FunctionCall).getTarget().hasName("smb2_get_msg")
		and target_0.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="request_buf"
		and target_0.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
}

predicate func_1(Function func, StringLiteral target_1) {
		target_1.getValue()="6ksmbd: Invalid user session, Uid %llu\n"
		and not target_1.getValue()="6ksmbd: Received negotiate request\n"
		and target_1.getEnclosingFunction() = func
}

predicate func_2(Parameter vwork_547, Variable vconn_550, Initializer target_2) {
		target_2.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="get_cmd_val"
		and target_2.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ops"
		and target_2.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_2.getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vwork_547
}

/*predicate func_3(Variable vcmd_551, VariableAccess target_3) {
		target_3.getTarget()=vcmd_551
}

*/
predicate func_4(Variable vcmd_551, Literal target_4) {
		target_4.getValue()="13"
		and not target_4.getValue()="1052"
		and target_4.getParent().(EQExpr).getParent().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vcmd_551
}

predicate func_5(Variable vcmd_551, VariableAccess target_5) {
		target_5.getTarget()=vcmd_551
}

predicate func_6(Variable vcmd_551, VariableAccess target_6) {
		target_6.getTarget()=vcmd_551
}

predicate func_7(Function func, StringLiteral target_7) {
		target_7.getValue()="6ksmbd: Invalid user session, Uid %llu\n"
		and not target_7.getValue()="6ksmbd: Received negotiate request\n"
		and target_7.getEnclosingFunction() = func
}

predicate func_9(Parameter vwork_547, VariableCall target_90, NotExpr target_91) {
	exists(FunctionCall target_9 |
		target_9.getTarget().hasName("smb2_get_msg")
		and target_9.getArgument(0).(PointerFieldAccess).getTarget().getName()="response_buf"
		and target_9.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and target_90.getArgument(0).(VariableAccess).getLocation().isBefore(target_9.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_9.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_91.getOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_12(Variable vconn_550) {
	exists(AssignExpr target_12 |
		target_12.getLValue().(PointerFieldAccess).getTarget().getName()="need_neg"
		and target_12.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550)
}

predicate func_13(LogicalOrExpr target_81, Function func) {
	exists(ExprStmt target_13 |
		target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
		and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_printk")
		and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="3ksmbd: conn->tcp_status is already in CifsGood State\n"
		and target_13.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_13
		and target_13.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_81
		and target_13.getEnclosingFunction() = func)
}

predicate func_15(Parameter vwork_547, LogicalOrExpr target_81, IfStmt target_93) {
	exists(ExprStmt target_15 |
		target_15.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="send_no_response"
		and target_15.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and target_15.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_15.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_15
		and target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_81
		and target_15.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_93.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_17(Function func) {
	exists(PointerFieldAccess target_17 |
		target_17.getTarget().getName()="DialectCount"
		and target_17.getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_req *")
		and target_17.getEnclosingFunction() = func)
}

predicate func_18(PointerFieldAccess target_84, Function func) {
	exists(ExprStmt target_18 |
		target_18.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
		and target_18.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_printk")
		and target_18.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="3ksmbd: malformed packet\n"
		and target_18.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_18
		and target_18.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_84
		and target_18.getEnclosingFunction() = func)
}

predicate func_19(PointerFieldAccess target_84, Function func) {
	exists(ExprStmt target_19 |
		target_19.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_19.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="hdr"
		and target_19.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_19.getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_19.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_19
		and target_19.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_84
		and target_19.getEnclosingFunction() = func)
}

predicate func_20(PointerFieldAccess target_84, Function func) {
	exists(ExprStmt target_20 |
		target_20.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_20.getExpr().(AssignExpr).getRValue() instanceof UnaryMinusExpr
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_20
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_84
		and target_20.getEnclosingFunction() = func)
}

predicate func_21(PointerFieldAccess target_84, Function func) {
	exists(GotoStmt target_21 |
		target_21.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_21
		and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_84
		and target_21.getEnclosingFunction() = func)
}

predicate func_22(Parameter vwork_547, Function func) {
	exists(ExprStmt target_22 |
		target_22.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
		and target_22.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("get_rfc1002_len")
		and target_22.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="request_buf"
		and target_22.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_22)
}

predicate func_23(Function func) {
	exists(ExprStmt target_23 |
		target_23.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
		and target_23.getExpr().(AssignExpr).getRValue().(BuiltInOperationBuiltInOffsetOf).getValue()="100"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_23)
}

predicate func_24(Function func) {
	exists(IfStmt target_24 |
		target_24.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_24.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_24.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_24.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="hdr"
		and target_24.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_24.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_24.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_24.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof UnaryMinusExpr
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_24)
}

predicate func_25(Variable vconn_550, Function func) {
	exists(IfStmt target_25 |
		target_25.getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="dialect"
		and target_25.getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_25.getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="785"
		and target_25.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_25.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_25.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_25.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_25.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_25.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="DialectCount"
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="2"
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_25.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="DialectCount"
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="2"
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_25.getElse().(BlockStmt).getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_25)
}

predicate func_26(Variable vconn_550, Function func) {
	exists(ExprStmt target_26 |
		target_26.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="cli_cap"
		and target_26.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_26.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="Capabilities"
		and target_26.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_req *")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_26)
}

predicate func_27(Variable vconn_550) {
	exists(PointerFieldAccess target_27 |
		target_27.getTarget().getName()="preauth_info"
		and target_27.getQualifier().(VariableAccess).getTarget()=vconn_550)
}

predicate func_28(Variable vconn_550, PointerFieldAccess target_78) {
	exists(AssignExpr target_28 |
		target_28.getLValue().(PointerFieldAccess).getTarget().getName()="preauth_info"
		and target_28.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_28.getRValue() instanceof Literal
		and target_78.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_28.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_29(ReturnStmt target_95, Function func) {
	exists(RelationalOperation target_29 |
		 (target_29 instanceof GTExpr or target_29 instanceof LTExpr)
		and target_29.getLesserOperand().(VariableAccess).getType().hasName("int")
		and target_29.getGreaterOperand().(Literal).getValue()="0"
		and target_29.getParent().(IfStmt).getThen()=target_95
		and target_29.getEnclosingFunction() = func)
}

predicate func_30(NotExpr target_91, Function func) {
	exists(ExprStmt target_30 |
		target_30.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="Status"
		and target_30.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="hdr"
		and target_30.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_30.getExpr().(AssignExpr).getRValue().(Literal).getValue()="3221225485"
		and target_30.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_30
		and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_91
		and target_30.getEnclosingFunction() = func)
}

predicate func_31(Variable vconn_550, NotExpr target_91) {
	exists(ExprStmt target_31 |
		target_31.getExpr().(FunctionCall).getTarget().hasName("kfree")
		and target_31.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="preauth_info"
		and target_31.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_31.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_31
		and target_31.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_91)
}

predicate func_32(Variable vconn_550, NotExpr target_91) {
	exists(ExprStmt target_32 |
		target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="preauth_info"
		and target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_32.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_32.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_32
		and target_32.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_91)
}

predicate func_33(NotExpr target_91, Function func) {
	exists(GotoStmt target_33 |
		target_33.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_33
		and target_33.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_91
		and target_33.getEnclosingFunction() = func)
}

predicate func_34(Function func) {
	exists(AssignExpr target_34 |
		target_34.getLValue().(PointerFieldAccess).getTarget().getName()="NegotiateContextOffset"
		and target_34.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_34.getRValue().(Literal).getValue()="224"
		and target_34.getEnclosingFunction() = func)
}

predicate func_35(Variable vconn_550, Function func) {
	exists(ExprStmt target_35 |
		target_35.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="Capabilities"
		and target_35.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_35.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="capabilities"
		and target_35.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="vals"
		and target_35.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_35)
}

predicate func_36(Variable vconn_550, Function func) {
	exists(ExprStmt target_36 |
		target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="connection_type"
		and target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_36.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="dialect"
		and target_36.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_36)
}

predicate func_37(Variable vconn_550, Function func) {
	exists(ExprStmt target_37 |
		target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="MaxTransactSize"
		and target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_37.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="max_trans_size"
		and target_37.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="vals"
		and target_37.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_37)
}

predicate func_38(Variable vconn_550, Function func) {
	exists(ExprStmt target_38 |
		target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="MaxReadSize"
		and target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_38.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="max_read_size"
		and target_38.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="vals"
		and target_38.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_38)
}

predicate func_39(Variable vconn_550, Function func) {
	exists(ExprStmt target_39 |
		target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="MaxWriteSize"
		and target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_39.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="max_write_size"
		and target_39.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="vals"
		and target_39.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_39)
}

predicate func_40(Variable vconn_550, Function func) {
	exists(ExprStmt target_40 |
		target_40.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_memcpy")
		and target_40.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ClientGUID"
		and target_40.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_40.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="ClientGUID"
		and target_40.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_req *")
		and target_40.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("size_t")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_40)
}

predicate func_41(Variable vconn_550, Function func) {
	exists(ExprStmt target_41 |
		target_41.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="cli_sec_mode"
		and target_41.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_41.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="SecurityMode"
		and target_41.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_req *")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_41)
}

predicate func_42(Function func) {
	exists(ExprStmt target_42 |
		target_42.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="StructureSize"
		and target_42.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_42.getExpr().(AssignExpr).getRValue().(Literal).getValue()="65"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_42)
}

predicate func_43(Variable vconn_550, Function func) {
	exists(ExprStmt target_43 |
		target_43.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="DialectRevision"
		and target_43.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_43.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="dialect"
		and target_43.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_43)
}

predicate func_44(Function func) {
	exists(ExprStmt target_44 |
		target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("fortify_memset_chk")
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("size_t")
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(1).(FunctionCall).getTarget().hasName("__builtin_object_size")
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("__builtin_object_size")
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("__builtin_memset")
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ServerGUID"
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("size_t")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_44)
}

predicate func_45(Function func) {
	exists(ExprStmt target_45 |
		target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="SystemTime"
		and target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_45.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ksmbd_systime")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_45)
}

predicate func_46(Function func) {
	exists(ExprStmt target_46 |
		target_46.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ServerStartTime"
		and target_46.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_46.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_46)
}

predicate func_48(Function func) {
	exists(ExprStmt target_48 |
		target_48.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="SecurityBufferOffset"
		and target_48.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_48.getExpr().(AssignExpr).getRValue().(Literal).getValue()="128"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_48)
}

predicate func_49(Function func) {
	exists(ExprStmt target_49 |
		target_49.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="SecurityBufferLength"
		and target_49.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_49.getExpr().(AssignExpr).getRValue().(Literal).getValue()="96"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_49)
}

predicate func_50(Function func) {
	exists(ExprStmt target_50 |
		target_50.getExpr().(FunctionCall).getTarget().hasName("ksmbd_copy_gss_neg_header")
		and target_50.getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="hdr"
		and target_50.getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_50.getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="SecurityBufferOffset"
		and target_50.getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_50)
}

predicate func_51(Parameter vwork_547, NotExpr target_91, Function func) {
	exists(ExprStmt target_51 |
		target_51.getExpr().(FunctionCall).getTarget().hasName("inc_rfc1001_len")
		and target_51.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="response_buf"
		and target_51.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and target_51.getExpr().(FunctionCall).getArgument(1).(AddExpr).getValue()="160"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
		and target_91.getOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_51.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_52(Function func) {
	exists(ExprStmt target_52 |
		target_52.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="SecurityMode"
		and target_52.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_52.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_52)
}

predicate func_53(Variable vconn_550, Function func) {
	exists(ExprStmt target_53 |
		target_53.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="use_spnego"
		and target_53.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_53)
}

predicate func_54(Variable vconn_550, Function func) {
	exists(IfStmt target_54 |
		target_54.getCondition().(LogicalAndExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="signing"
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ksmbd_server_config")
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="2"
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="signing"
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ksmbd_server_config")
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="SecurityMode"
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_req *")
		and target_54.getCondition().(LogicalAndExpr).getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="2"
		and target_54.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sign"
		and target_54.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_54.getElse().(IfStmt).getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="signing"
		and target_54.getElse().(IfStmt).getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ksmbd_server_config")
		and target_54.getElse().(IfStmt).getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="3"
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="enforced_signing"
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ksmbd_server_config")
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="SecurityMode"
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="2"
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sign"
		and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_54)
}

/*predicate func_55(Function func) {
	exists(ValueFieldAccess target_55 |
		target_55.getTarget().getName()="signing"
		and target_55.getQualifier().(VariableAccess).getType().hasName("ksmbd_server_config")
		and target_55.getEnclosingFunction() = func)
}

*/
/*predicate func_57(Function func) {
	exists(ValueFieldAccess target_57 |
		target_57.getTarget().getName()="signing"
		and target_57.getQualifier().(VariableAccess).getType().hasName("ksmbd_server_config")
		and target_57.getEnclosingFunction() = func)
}

*/
predicate func_59(Variable vconn_550, Function func) {
	exists(ExprStmt target_59 |
		target_59.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="srv_sec_mode"
		and target_59.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_59.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="SecurityMode"
		and target_59.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("smb2_negotiate_rsp *")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_59)
}

predicate func_60(Variable vconn_550, Function func) {
	exists(ExprStmt target_60 |
		target_60.getExpr().(FunctionCall).getTarget().hasName("ksmbd_conn_set_need_negotiate")
		and target_60.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vconn_550
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_60)
}

predicate func_61(Parameter vwork_547, Function func) {
	exists(IfStmt target_61 |
		target_61.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
		and target_61.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
		and target_61.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("smb2_set_err_rsp")
		and target_61.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vwork_547
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_61)
}

predicate func_63(Function func, UnaryMinusExpr target_63) {
		target_63.getValue()="-22"
		and target_63.getEnclosingFunction() = func
}

predicate func_64(Function func, UnaryMinusExpr target_64) {
		target_64.getValue()="-22"
		and target_64.getEnclosingFunction() = func
}

/*predicate func_65(Variable vconn_550, VariableAccess target_65) {
		target_65.getTarget()=vconn_550
}

*/
predicate func_66(Parameter vwork_547, Variable vconn_550, VariableAccess target_66) {
		target_66.getTarget()=vwork_547
		and target_66.getParent().(VariableCall).getParent().(Initializer).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="get_cmd_val"
		and target_66.getParent().(VariableCall).getParent().(Initializer).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ops"
		and target_66.getParent().(VariableCall).getParent().(Initializer).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
}

predicate func_67(Parameter vwork_547, VariableAccess target_67) {
		target_67.getTarget()=vwork_547
}

predicate func_72(Parameter vwork_547, VariableAccess target_72) {
		target_72.getTarget()=vwork_547
}

predicate func_73(Variable vconn_550, VariableAccess target_73) {
		target_73.getTarget()=vconn_550
		and target_73.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_74(Parameter vwork_547, ReturnStmt target_85, VariableAccess target_74) {
		target_74.getTarget()=vwork_547
		and target_74.getParent().(PointerFieldAccess).getParent().(IfStmt).getThen()=target_85
}

predicate func_75(Parameter vwork_547, VariableAccess target_75) {
		target_75.getTarget()=vwork_547
		and target_75.getParent().(FunctionCall).getParent().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("ksmbd_conn_good")
}

predicate func_78(Variable vconn_550, PointerFieldAccess target_78) {
		target_78.getTarget().getName()="get_cmd_val"
		and target_78.getQualifier().(PointerFieldAccess).getTarget().getName()="ops"
		and target_78.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
}

predicate func_80(Parameter vwork_547, AssignExpr target_80) {
		target_80.getLValue().(PointerFieldAccess).getTarget().getName()="sess"
		and target_80.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and target_80.getRValue() instanceof Literal
}

predicate func_81(Variable vcmd_551, ReturnStmt target_99, LogicalOrExpr target_81) {
		target_81.getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vcmd_551
		and target_81.getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_81.getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vcmd_551
		and target_81.getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_81.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vcmd_551
		and target_81.getAnOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_81.getParent().(IfStmt).getThen()=target_99
}

predicate func_82(Variable vreq_hdr_549, Variable vsess_id_552, AssignExpr target_82) {
		target_82.getLValue().(VariableAccess).getTarget()=vsess_id_552
		and target_82.getRValue().(PointerFieldAccess).getTarget().getName()="SessionId"
		and target_82.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_hdr_549
}

predicate func_83(Parameter vwork_547, Variable vconn_550, Variable vsess_id_552, AssignExpr target_83) {
		target_83.getLValue().(PointerFieldAccess).getTarget().getName()="sess"
		and target_83.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and target_83.getRValue().(FunctionCall).getTarget().hasName("ksmbd_session_lookup_all")
		and target_83.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vconn_550
		and target_83.getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsess_id_552
}

predicate func_84(Parameter vwork_547, PointerFieldAccess target_84) {
		target_84.getTarget().getName()="sess"
		and target_84.getQualifier().(VariableAccess).getTarget()=vwork_547
}

predicate func_85(PointerFieldAccess target_84, Function func, ReturnStmt target_85) {
		target_85.getExpr() instanceof Literal
		and target_85.getParent().(IfStmt).getCondition()=target_84
		and target_85.getEnclosingFunction() = func
}

predicate func_87(Variable vsess_id_552, VariableAccess target_87) {
		target_87.getTarget()=vsess_id_552
		and target_87.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_printk")
		and target_87.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
}

predicate func_88(Function func, ReturnStmt target_88) {
		target_88.getExpr() instanceof UnaryMinusExpr
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_88
}

predicate func_90(Parameter vwork_547, Variable vconn_550, VariableCall target_90) {
		target_90.getExpr().(PointerFieldAccess).getTarget().getName()="get_cmd_val"
		and target_90.getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ops"
		and target_90.getExpr().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vconn_550
		and target_90.getArgument(0).(VariableAccess).getTarget()=vwork_547
}

predicate func_91(Parameter vwork_547, NotExpr target_91) {
		target_91.getOperand().(FunctionCall).getTarget().hasName("ksmbd_conn_good")
		and target_91.getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vwork_547
}

predicate func_93(Parameter vwork_547, IfStmt target_93) {
		target_93.getCondition().(PointerFieldAccess).getTarget().getName()="sess"
		and target_93.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vwork_547
		and target_93.getThen() instanceof ReturnStmt
}

predicate func_95(Function func, ReturnStmt target_95) {
		target_95.getExpr() instanceof UnaryMinusExpr
		and target_95.getEnclosingFunction() = func
}

predicate func_99(Function func, ReturnStmt target_99) {
		target_99.getExpr() instanceof Literal
		and target_99.getEnclosingFunction() = func
}

from Function func, Parameter vwork_547, Variable vreq_hdr_549, Variable vconn_550, Variable vcmd_551, Variable vsess_id_552, Initializer target_0, StringLiteral target_1, Initializer target_2, Literal target_4, VariableAccess target_5, VariableAccess target_6, StringLiteral target_7, UnaryMinusExpr target_63, UnaryMinusExpr target_64, VariableAccess target_66, VariableAccess target_67, VariableAccess target_72, VariableAccess target_73, VariableAccess target_74, VariableAccess target_75, PointerFieldAccess target_78, AssignExpr target_80, LogicalOrExpr target_81, AssignExpr target_82, AssignExpr target_83, PointerFieldAccess target_84, ReturnStmt target_85, VariableAccess target_87, ReturnStmt target_88, VariableCall target_90, NotExpr target_91, IfStmt target_93, ReturnStmt target_95, ReturnStmt target_99
where
func_0(vwork_547, target_0)
and func_1(func, target_1)
and func_2(vwork_547, vconn_550, target_2)
and func_4(vcmd_551, target_4)
and func_5(vcmd_551, target_5)
and func_6(vcmd_551, target_6)
and func_7(func, target_7)
and not func_9(vwork_547, target_90, target_91)
and not func_12(vconn_550)
and not func_13(target_81, func)
and not func_15(vwork_547, target_81, target_93)
and not func_17(func)
and not func_18(target_84, func)
and not func_19(target_84, func)
and not func_20(target_84, func)
and not func_21(target_84, func)
and not func_22(vwork_547, func)
and not func_23(func)
and not func_24(func)
and not func_25(vconn_550, func)
and not func_26(vconn_550, func)
and not func_27(vconn_550)
and not func_28(vconn_550, target_78)
and not func_29(target_95, func)
and not func_30(target_91, func)
and not func_31(vconn_550, target_91)
and not func_32(vconn_550, target_91)
and not func_33(target_91, func)
and not func_34(func)
and not func_35(vconn_550, func)
and not func_36(vconn_550, func)
and not func_37(vconn_550, func)
and not func_38(vconn_550, func)
and not func_39(vconn_550, func)
and not func_40(vconn_550, func)
and not func_41(vconn_550, func)
and not func_42(func)
and not func_43(vconn_550, func)
and not func_44(func)
and not func_45(func)
and not func_46(func)
and not func_48(func)
and not func_49(func)
and not func_50(func)
and not func_51(vwork_547, target_91, func)
and not func_52(func)
and not func_53(vconn_550, func)
and not func_54(vconn_550, func)
and not func_59(vconn_550, func)
and not func_60(vconn_550, func)
and not func_61(vwork_547, func)
and func_63(func, target_63)
and func_64(func, target_64)
and func_66(vwork_547, vconn_550, target_66)
and func_67(vwork_547, target_67)
and func_72(vwork_547, target_72)
and func_73(vconn_550, target_73)
and func_74(vwork_547, target_85, target_74)
and func_75(vwork_547, target_75)
and func_78(vconn_550, target_78)
and func_80(vwork_547, target_80)
and func_81(vcmd_551, target_99, target_81)
and func_82(vreq_hdr_549, vsess_id_552, target_82)
and func_83(vwork_547, vconn_550, vsess_id_552, target_83)
and func_84(vwork_547, target_84)
and func_85(target_84, func, target_85)
and func_87(vsess_id_552, target_87)
and func_88(func, target_88)
and func_90(vwork_547, vconn_550, target_90)
and func_91(vwork_547, target_91)
and func_93(vwork_547, target_93)
and func_95(func, target_95)
and func_99(func, target_99)
and vwork_547.getType().hasName("ksmbd_work *")
and vreq_hdr_549.getType().hasName("smb2_hdr *")
and vconn_550.getType().hasName("ksmbd_conn *")
and vcmd_551.getType().hasName("unsigned int")
and vsess_id_552.getType().hasName("unsigned long long")
and vwork_547.getFunction() = func
and vreq_hdr_549.(LocalVariable).getFunction() = func
and vconn_550.(LocalVariable).getFunction() = func
and vcmd_551.(LocalVariable).getFunction() = func
and vsess_id_552.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
