/**
 * @name linux-4379bf8bd70b5de6bba7d53015b0c36c57a634ee-io_uring_show_cred
 * @id cpp/linux/4379bf8bd70b5de6bba7d53015b0c36c57a634ee/io-uring-show-cred
 * @description linux-4379bf8bd70b5de6bba7d53015b0c36c57a634ee-fs/io_uring.c-io_uring_show_cred CVE-2022-1786
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable viod_9303, PointerFieldAccess target_0) {
	target_0.getTarget().getName()="creds"
	and target_0.getQualifier().(VariableAccess).getTarget()=viod_9303
}

predicate func_1(Variable vm_9305, Parameter vid_9301, FunctionCall target_1) {
	target_1.getTarget().hasName("seq_printf")
	and not target_1.getTarget().hasName("hlist_nulls_add_head_rcu")
	and target_1.getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_1.getArgument(1).(StringLiteral).getValue()="%5d\n"
	and target_1.getArgument(2).(VariableAccess).getTarget()=vid_9301
}

predicate func_2(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, FunctionCall target_2) {
	target_2.getTarget().hasName("seq_put_decimal_ull")
	and not target_2.getTarget().hasName("revert_creds")
	and target_2.getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_2.getArgument(1).(StringLiteral).getValue()="\tUid:\t"
	and target_2.getArgument(2).(FunctionCall).getTarget().hasName("from_kuid_munged")
	and target_2.getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_2.getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="uid"
	and target_2.getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
}

predicate func_3(Function func) {
exists(IfStmt target_3 |
	target_3.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_3.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_3.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_3.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_3.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("hlist_nulls_add_head_rcu")
	and target_3.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="nulls_node"
	and target_3.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_3.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="free_list"
	and target_3.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_wqe *")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_3
	and target_3.getFollowingStmt() instanceof DeclStmt)
}

/*predicate func_4(Function func) {
exists(AssignOrExpr target_4 |
	target_4.getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_4.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_4.getEnclosingFunction() = func)
}

*/
/*predicate func_5(Function func) {
exists(AddressOfExpr target_5 |
	target_5.getOperand().(PointerFieldAccess).getTarget().getName()="nulls_node"
	and target_5.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_5.getEnclosingFunction() = func)
}

*/
/*predicate func_6(Function func) {
exists(AddressOfExpr target_6 |
	target_6.getOperand().(PointerFieldAccess).getTarget().getName()="free_list"
	and target_6.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_wqe *")
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_6.getEnclosingFunction() = func)
}

*/
predicate func_7(Function func) {
exists(IfStmt target_7 |
	target_7.getCondition().(PointerFieldAccess).getTarget().getName()="saved_creds"
	and target_7.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_7.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("revert_creds")
	and target_7.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="saved_creds"
	and target_7.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="cur_creds"
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="saved_creds"
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue() instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_7
	and target_7.getFollowingStmt() instanceof DeclStmt)
}

/*predicate func_9(Function func) {
exists(PointerFieldAccess target_9 |
	target_9.getTarget().getName()="saved_creds"
	and target_9.getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_9.getEnclosingFunction() = func)
}

*/
/*predicate func_10(Function func) {
exists(AssignExpr target_10 |
	target_10.getLValue().(PointerFieldAccess).getTarget().getName()="cur_creds"
	and target_10.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_10.getRValue().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="saved_creds"
	and target_10.getRValue().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_worker *")
	and target_10.getRValue().(AssignExpr).getRValue() instanceof Literal
	and target_10.getEnclosingFunction() = func)
}

*/
predicate func_12(Function func, DeclStmt target_12) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_12
}

predicate func_13(Function func, DeclStmt target_13) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_13
}

predicate func_14(Function func, DeclStmt target_14) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(Function func, DeclStmt target_15) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

predicate func_16(Function func, DeclStmt target_16) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

predicate func_17(Function func, DeclStmt target_17) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_17
}

predicate func_18(Function func, DeclStmt target_18) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_18
}

predicate func_19(Function func, DeclStmt target_19) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_19
}

predicate func_20(Variable vcred_9304, Variable vuns_9306, DeclStmt target_13, FunctionCall target_38, DeclStmt target_15, VariableAccess target_20) {
	target_20.getTarget()=vuns_9306
	and target_20.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kuid_munged")
	and target_20.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="uid"
	and target_20.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and target_20.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_38.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

/*predicate func_21(Variable vcred_9304, PointerFieldAccess target_21) {
	target_21.getTarget().getName()="uid"
	and target_21.getQualifier().(VariableAccess).getTarget()=vcred_9304
}

*/
predicate func_22(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, FunctionCall target_22) {
	target_22.getTarget().hasName("seq_put_decimal_ull")
	and target_22.getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_22.getArgument(1).(StringLiteral).getValue()="\t\t"
	and target_22.getArgument(2).(FunctionCall).getTarget().hasName("from_kuid_munged")
	and target_22.getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_22.getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="euid"
	and target_22.getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
}

predicate func_23(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Function func, ExprStmt target_23) {
	target_23.getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_23.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_23.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\t\t"
	and target_23.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kuid_munged")
	and target_23.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_23.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="suid"
	and target_23.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

predicate func_24(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Function func, ExprStmt target_24) {
	target_24.getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_24.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_24.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\t\t"
	and target_24.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kuid_munged")
	and target_24.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_24.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="fsuid"
	and target_24.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
}

predicate func_25(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Function func, ExprStmt target_25) {
	target_25.getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_25.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_25.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\n\tGid:\t"
	and target_25.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_25.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_25.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="gid"
	and target_25.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
}

predicate func_26(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Function func, ExprStmt target_26) {
	target_26.getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_26.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_26.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\t\t"
	and target_26.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_26.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_26.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="egid"
	and target_26.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_26
}

predicate func_27(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Function func, ExprStmt target_27) {
	target_27.getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_27.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_27.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\t\t"
	and target_27.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_27.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_27.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="sgid"
	and target_27.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
}

predicate func_28(Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Function func, ExprStmt target_28) {
	target_28.getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_28.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_28.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\t\t"
	and target_28.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_28.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_28.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="fsgid"
	and target_28.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

predicate func_29(Variable vm_9305, Function func, ExprStmt target_29) {
	target_29.getExpr().(FunctionCall).getTarget().hasName("seq_puts")
	and target_29.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_29.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\n\tGroups:\t"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

predicate func_30(Variable vcred_9304, Variable vgi_9307, Function func, ExprStmt target_30) {
	target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vgi_9307
	and target_30.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="group_info"
	and target_30.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

predicate func_31(Variable vm_9305, Variable vuns_9306, Variable vgi_9307, Variable vg_9310, Function func, ForStmt target_31) {
	target_31.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vg_9310
	and target_31.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_31.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vg_9310
	and target_31.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="ngroups"
	and target_31.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgi_9307
	and target_31.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vg_9310
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ConditionalExpr).getCondition().(VariableAccess).getTarget()=vg_9310
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ConditionalExpr).getThen().(StringLiteral).getValue()=" "
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ConditionalExpr).getElse().(StringLiteral).getValue()=""
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="gid"
	and target_31.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vg_9310
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_31
}

/*predicate func_32(Variable vm_9305, Variable vuns_9306, Variable vgi_9307, Variable vg_9310, FunctionCall target_32) {
	target_32.getTarget().hasName("seq_put_decimal_ull")
	and target_32.getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_32.getArgument(1).(ConditionalExpr).getCondition().(VariableAccess).getTarget()=vg_9310
	and target_32.getArgument(1).(ConditionalExpr).getThen().(StringLiteral).getValue()=" "
	and target_32.getArgument(1).(ConditionalExpr).getElse().(StringLiteral).getValue()=""
	and target_32.getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_32.getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_32.getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="gid"
	and target_32.getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgi_9307
	and target_32.getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vg_9310
}

*/
predicate func_33(Variable vm_9305, Function func, ExprStmt target_33) {
	target_33.getExpr().(FunctionCall).getTarget().hasName("seq_puts")
	and target_33.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_33.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="\n\tCapEff:\t"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_33
}

predicate func_34(Variable vcred_9304, Variable vcap_9308, Function func, ExprStmt target_34) {
	target_34.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcap_9308
	and target_34.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="cap_effective"
	and target_34.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_34
}

predicate func_35(Variable vm_9305, Variable vcap_9308, Variable v__capi_9309, Function func, ForStmt target_35) {
	target_35.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__capi_9309
	and target_35.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_35.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__capi_9309
	and target_35.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="2"
	and target_35.getUpdate().(PrefixIncrExpr).getOperand().(VariableAccess).getTarget()=v__capi_9309
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("seq_put_hex_ll")
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayBase().(ValueFieldAccess).getTarget().getName()="cap"
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vcap_9308
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayOffset().(SubExpr).getLeftOperand().(SubExpr).getValue()="1"
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayOffset().(SubExpr).getRightOperand().(VariableAccess).getTarget()=v__capi_9309
	and target_35.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(Literal).getValue()="8"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
}

predicate func_36(Variable vm_9305, Function func, ExprStmt target_36) {
	target_36.getExpr().(FunctionCall).getTarget().hasName("seq_putc")
	and target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_9305
	and target_36.getExpr().(FunctionCall).getArgument(1).(CharLiteral).getValue()="10"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
}

predicate func_38(Variable vcred_9304, Variable vuns_9306, FunctionCall target_38) {
	target_38.getTarget().hasName("from_kuid_munged")
	and target_38.getArgument(0).(VariableAccess).getTarget()=vuns_9306
	and target_38.getArgument(1).(PointerFieldAccess).getTarget().getName()="euid"
	and target_38.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcred_9304
}

from Function func, Variable viod_9303, Variable vcred_9304, Variable vm_9305, Variable vuns_9306, Variable vgi_9307, Variable vcap_9308, Variable v__capi_9309, Variable vg_9310, Parameter vid_9301, PointerFieldAccess target_0, FunctionCall target_1, FunctionCall target_2, DeclStmt target_12, DeclStmt target_13, DeclStmt target_14, DeclStmt target_15, DeclStmt target_16, DeclStmt target_17, DeclStmt target_18, DeclStmt target_19, VariableAccess target_20, FunctionCall target_22, ExprStmt target_23, ExprStmt target_24, ExprStmt target_25, ExprStmt target_26, ExprStmt target_27, ExprStmt target_28, ExprStmt target_29, ExprStmt target_30, ForStmt target_31, ExprStmt target_33, ExprStmt target_34, ForStmt target_35, ExprStmt target_36, FunctionCall target_38
where
func_0(viod_9303, target_0)
and func_1(vm_9305, vid_9301, target_1)
and func_2(vcred_9304, vm_9305, vuns_9306, target_2)
and not func_3(func)
and not func_7(func)
and func_12(func, target_12)
and func_13(func, target_13)
and func_14(func, target_14)
and func_15(func, target_15)
and func_16(func, target_16)
and func_17(func, target_17)
and func_18(func, target_18)
and func_19(func, target_19)
and func_20(vcred_9304, vuns_9306, target_13, target_38, target_15, target_20)
and func_22(vcred_9304, vm_9305, vuns_9306, target_22)
and func_23(vcred_9304, vm_9305, vuns_9306, func, target_23)
and func_24(vcred_9304, vm_9305, vuns_9306, func, target_24)
and func_25(vcred_9304, vm_9305, vuns_9306, func, target_25)
and func_26(vcred_9304, vm_9305, vuns_9306, func, target_26)
and func_27(vcred_9304, vm_9305, vuns_9306, func, target_27)
and func_28(vcred_9304, vm_9305, vuns_9306, func, target_28)
and func_29(vm_9305, func, target_29)
and func_30(vcred_9304, vgi_9307, func, target_30)
and func_31(vm_9305, vuns_9306, vgi_9307, vg_9310, func, target_31)
and func_33(vm_9305, func, target_33)
and func_34(vcred_9304, vcap_9308, func, target_34)
and func_35(vm_9305, vcap_9308, v__capi_9309, func, target_35)
and func_36(vm_9305, func, target_36)
and func_38(vcred_9304, vuns_9306, target_38)
and viod_9303.getType().hasName("io_identity *")
and vcred_9304.getType().hasName("const cred *")
and vm_9305.getType().hasName("seq_file *")
and vuns_9306.getType().hasName("user_namespace *")
and vgi_9307.getType().hasName("group_info *")
and vcap_9308.getType().hasName("kernel_cap_t")
and v__capi_9309.getType().hasName("unsigned int")
and vg_9310.getType().hasName("int")
and vid_9301.getType().hasName("int")
and viod_9303.(LocalVariable).getFunction() = func
and vcred_9304.(LocalVariable).getFunction() = func
and vm_9305.(LocalVariable).getFunction() = func
and vuns_9306.(LocalVariable).getFunction() = func
and vgi_9307.(LocalVariable).getFunction() = func
and vcap_9308.(LocalVariable).getFunction() = func
and v__capi_9309.(LocalVariable).getFunction() = func
and vg_9310.(LocalVariable).getFunction() = func
and vid_9301.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
