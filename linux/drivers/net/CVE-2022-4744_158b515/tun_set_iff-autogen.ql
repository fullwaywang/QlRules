/**
 * @name linux-158b515f703e75e7d68289bf4d98c664e1d632df-tun_set_iff
 * @id cpp/linux/158b515f703e75e7d68289bf4d98c664e1d632df/tun-set-iff
 * @description linux-158b515f703e75e7d68289bf4d98c664e1d632df-tun_set_iff CVE-2022-4744
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, SizeofTypeOperator target_0) {
		target_0.getType() instanceof LongType
		and target_0.getValue()="10712"
		and target_0.getEnclosingFunction() = func
}

predicate func_1(Variable vdev_2613, FunctionCall target_1) {
		target_1.getTarget().hasName("tun_net_init")
		and not target_1.getTarget().hasName("tun_net_initialize")
		and target_1.getArgument(0).(VariableAccess).getTarget()=vdev_2613
}

predicate func_2(Parameter vifr_2609, Variable vtun_2611, ExprStmt target_49, ExprStmt target_51, AddressOfExpr target_52) {
	exists(AssignExpr target_2 |
		target_2.getLValue().(PointerFieldAccess).getTarget().getName()="ifr"
		and target_2.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_2.getRValue().(VariableAccess).getTarget()=vifr_2609
		and target_49.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_2.getRValue().(VariableAccess).getLocation())
		and target_51.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_2.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_2.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_52.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_3(Parameter vfile_2609, Variable vtun_2611, ExprStmt target_53, AddressOfExpr target_54, ExprStmt target_35) {
	exists(AssignExpr target_3 |
		target_3.getLValue().(PointerFieldAccess).getTarget().getName()="file"
		and target_3.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_3.getRValue().(VariableAccess).getTarget()=vfile_2609
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_3.getRValue().(VariableAccess).getLocation())
		and target_54.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_3.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_3.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_35.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_4(Variable verr_2614, RelationalOperation target_4) {
		 (target_4 instanceof GTExpr or target_4 instanceof LTExpr)
		and target_4.getLesserOperand().(VariableAccess).getTarget()=verr_2614
		and target_4.getGreaterOperand().(Literal).getValue()="0"
		and target_4.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_5(Variable vdev_2613, Function func, ExprStmt target_5) {
		target_5.getExpr().(FunctionCall).getTarget().hasName("free_netdev")
		and target_5.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdev_2613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_5
}

predicate func_6(Variable verr_2614, Function func, ReturnStmt target_6) {
		target_6.getExpr().(VariableAccess).getTarget()=verr_2614
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_6
}

predicate func_7(Variable vtun_2611, VariableAccess target_7) {
		target_7.getTarget()=vtun_2611
		and target_7.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(FunctionCall).getArgument(0) instanceof FunctionCall
}

predicate func_8(Variable vtun_2611, VariableAccess target_8) {
		target_8.getTarget()=vtun_2611
		and target_8.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_9(Parameter vifr_2609, VariableAccess target_9) {
		target_9.getTarget()=vifr_2609
}

predicate func_10(Parameter vfile_2609, VariableAccess target_10) {
		target_10.getTarget()=vfile_2609
		and target_10.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_11(Variable vdev_2613, Variable vpcpu_stats_2719, AssignExpr target_11) {
		target_11.getLValue().(ValueFieldAccess).getTarget().getName()="tstats"
		and target_11.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_11.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_11.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getTarget()=vpcpu_stats_2719
		and target_11.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=vpcpu_stats_2719
}

/*predicate func_13(Variable vpcpu_stats_2719, Variable v__cpu_2719, Variable vnr_cpu_ids, Variable vstat_2719, IfStmt target_13) {
		target_13.getCondition().(VariableAccess).getTarget()=vpcpu_stats_2719
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cpumask_next")
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=v__cpu_2719
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__cpu_2719
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vnr_cpu_ids
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstat_2719
		and target_13.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
}

*/
predicate func_14(VariableAccess target_55, Function func, DeclStmt target_14) {
		target_14.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_55
		and target_14.getEnclosingFunction() = func
}

/*predicate func_15(Variable v__cpu_2719, Variable v__cpu_possible_mask, Variable vnr_cpu_ids, Variable vstat_2719, VariableAccess target_55, ForStmt target_15) {
		target_15.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
		and target_15.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
		and target_15.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
		and target_15.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cpumask_next")
		and target_15.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=v__cpu_2719
		and target_15.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__cpu_possible_mask
		and target_15.getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__cpu_2719
		and target_15.getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vnr_cpu_ids
		and target_15.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstat_2719
		and target_15.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
		and target_15.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="syncp"
		and target_15.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vstat_2719
		and target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_55
}

*/
/*predicate func_17(Variable vstat_2719, ExprStmt target_17) {
		target_17.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstat_2719
		and target_17.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
}

*/
/*predicate func_18(Variable v__vpp_verify_2719, DoStmt target_18) {
		target_18.getCondition().(Literal).getValue()="0"
		and target_18.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__vpp_verify_2719
}

*/
/*predicate func_20(Variable v__vpp_verify_2719, ExprStmt target_20) {
		target_20.getExpr().(VariableAccess).getTarget()=v__vpp_verify_2719
}

*/
/*predicate func_21(Variable vpcpu_stats_2719, Variable v__cpu_2719, Variable v__ptr_2719, Variable v__per_cpu_offset, ExprStmt target_21) {
		target_21.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ptr_2719
		and target_21.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(VariableAccess).getTarget()=vpcpu_stats_2719
		and target_21.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getAnOperand().(VariableAccess).getTarget()=v__ptr_2719
		and target_21.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
		and target_21.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=v__cpu_2719
}

*/
/*predicate func_23(Variable vpcpu_stats_2719, Variable v__ptr_2719, AsmStmt target_23) {
		target_23.getChild(0).(VariableAccess).getTarget()=v__ptr_2719
		and target_23.getChild(1).(VariableAccess).getTarget()=vpcpu_stats_2719
}

*/
/*predicate func_24(Variable v__cpu_2719, Variable v__ptr_2719, Variable v__per_cpu_offset, ExprStmt target_24) {
		target_24.getExpr().(AddExpr).getAnOperand().(VariableAccess).getTarget()=v__ptr_2719
		and target_24.getExpr().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
		and target_24.getExpr().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=v__cpu_2719
}

*/
/*predicate func_25(Variable vstat_2719, ExprStmt target_25) {
		target_25.getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
		and target_25.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="syncp"
		and target_25.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vstat_2719
}

*/
/*predicate func_26(Variable vpcpu_stats_2719, ExprStmt target_26) {
		target_26.getExpr().(VariableAccess).getTarget()=vpcpu_stats_2719
}

*/
predicate func_27(Variable vdev_2613, BlockStmt target_56, NotExpr target_27) {
		target_27.getOperand().(ValueFieldAccess).getTarget().getName()="tstats"
		and target_27.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_27.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_27.getParent().(IfStmt).getThen()=target_56
}

predicate func_28(Variable verr_2614, NotExpr target_27, ExprStmt target_28) {
		target_28.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_2614
		and target_28.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-12"
		and target_28.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_27
}

predicate func_29(NotExpr target_27, Function func, GotoStmt target_29) {
		target_29.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_27
		and target_29.getEnclosingFunction() = func
}

predicate func_30(Variable v__key_2725, VariableAccess target_59, DoStmt target_30) {
		target_30.getCondition().(Literal).getValue()="0"
		and target_30.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__raw_spin_lock_init")
		and target_30.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
		and target_30.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
		and target_30.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="&tun->lock"
		and target_30.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_2725
		and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

/*predicate func_32(Variable vtun_2611, Variable v__key_2725, ExprStmt target_32) {
		target_32.getExpr().(FunctionCall).getTarget().hasName("__raw_spin_lock_init")
		and target_32.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
		and target_32.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
		and target_32.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_32.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="&tun->lock"
		and target_32.getExpr().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_2725
}

*/
predicate func_33(Variable vtun_2611, Variable verr_2614, AssignExpr target_33) {
		target_33.getLValue().(VariableAccess).getTarget()=verr_2614
		and target_33.getRValue().(FunctionCall).getTarget().hasName("security_tun_dev_alloc_security")
		and target_33.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="security"
		and target_33.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_34(VariableAccess target_59, Function func, IfStmt target_34) {
		target_34.getCondition() instanceof RelationalOperation
		and target_34.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
		and target_34.getEnclosingFunction() = func
}

predicate func_35(Variable vtun_2611, VariableAccess target_59, ExprStmt target_35) {
		target_35.getExpr().(FunctionCall).getTarget().hasName("tun_flow_init")
		and target_35.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
		and target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_36(Variable vdev_2613, VariableAccess target_59, ExprStmt target_36) {
		target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="hw_features"
		and target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_36.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="35184373465289"
		and target_36.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_37(Variable vdev_2613, VariableAccess target_59, ExprStmt target_37) {
		target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="features"
		and target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_37.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="hw_features"
		and target_37.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_37.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="4096"
		and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_38(Variable vdev_2613, VariableAccess target_59, ExprStmt target_38) {
		target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vlan_features"
		and target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_38.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="features"
		and target_38.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and target_38.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446708889337462655"
		and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_39(Parameter vifr_2609, Variable vtun_2611, VariableAccess target_59, ExprStmt target_49, ExprStmt target_35, AddressOfExpr target_61, ExprStmt target_39) {
		target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
		and target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294938319"
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="28976"
		and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
		and target_49.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_39.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_35.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_61.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_40(Variable vtun_2611, VariableAccess target_59, ExprStmt target_40) {
		target_40.getExpr().(FunctionCall).getTarget().hasName("INIT_LIST_HEAD")
		and target_40.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="disabled"
		and target_40.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_40.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_41(Parameter vfile_2609, Parameter vifr_2609, Variable vtun_2611, Variable verr_2614, VariableAccess target_59, ExprStmt target_41) {
		target_41.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_2614
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("tun_attach")
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vfile_2609
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="16"
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_41.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32"
		and target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_42(Variable verr_2614, VariableAccess target_59, IfStmt target_42) {
		target_42.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=verr_2614
		and target_42.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
		and target_42.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_43(Variable verr_2614, VariableAccess target_59, IfStmt target_43) {
		target_43.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=verr_2614
		and target_43.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
		and target_43.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_44(Variable vdev_2613, Function func, ExprStmt target_44) {
		target_44.getExpr().(FunctionCall).getTarget().hasName("tun_detach_all")
		and target_44.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdev_2613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_44
}

predicate func_45(Variable vdev_2613, Function func, IfStmt target_45) {
		target_45.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="tstats"
		and target_45.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_45.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_45
}

predicate func_46(Variable vtun_2611, Function func, ExprStmt target_46) {
		target_46.getExpr().(FunctionCall).getTarget().hasName("tun_flow_uninit")
		and target_46.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

predicate func_47(Variable vtun_2611, Function func, ExprStmt target_47) {
		target_47.getExpr().(FunctionCall).getTarget().hasName("security_tun_dev_free_security")
		and target_47.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="security"
		and target_47.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_47
}

predicate func_48(Variable vdev_2613, Function func, ExprStmt target_48) {
		target_48.getExpr().(FunctionCall).getTarget().hasName("free_percpu")
		and target_48.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="tstats"
		and target_48.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_48.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Parameter vifr_2609, ExprStmt target_49) {
		target_49.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("char *")
		and target_49.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="ifrn_name"
		and target_49.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifrn"
		and target_49.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
}

predicate func_51(Variable vtun_2611, ExprStmt target_51) {
		target_51.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="steering_prog"
		and target_51.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
		and target_51.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_52(Variable vtun_2611, AddressOfExpr target_52) {
		target_52.getOperand().(PointerFieldAccess).getTarget().getName()="security"
		and target_52.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_53(Parameter vfile_2609, Parameter vifr_2609, Variable vtun_2611, Variable verr_2614, ExprStmt target_53) {
		target_53.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_2614
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("tun_attach")
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vfile_2609
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="4096"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="16"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32"
}

predicate func_54(Variable vtun_2611, AddressOfExpr target_54) {
		target_54.getOperand().(PointerFieldAccess).getTarget().getName()="lock"
		and target_54.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_55(Variable vpcpu_stats_2719, BlockStmt target_62, VariableAccess target_55) {
		target_55.getTarget()=vpcpu_stats_2719
		and target_55.getParent().(IfStmt).getThen()=target_62
}

predicate func_56(Function func, BlockStmt target_56) {
		target_56.getStmt(0) instanceof ExprStmt
		and target_56.getStmt(1) instanceof GotoStmt
		and target_56.getEnclosingFunction() = func
}

predicate func_59(Variable vdev_2613, BlockStmt target_63, VariableAccess target_59) {
		target_59.getTarget()=vdev_2613
		and target_59.getParent().(IfStmt).getThen()=target_63
}

predicate func_61(Variable vtun_2611, AddressOfExpr target_61) {
		target_61.getOperand().(PointerFieldAccess).getTarget().getName()="disabled"
		and target_61.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_62(Function func, BlockStmt target_62) {
		target_62.getStmt(1) instanceof ForStmt
		and target_62.getEnclosingFunction() = func
}

predicate func_63(Parameter vifr_2609, BlockStmt target_63) {
		target_63.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
		and target_63.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
		and target_63.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
		and target_63.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32768"
		and target_63.getStmt(0).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-16"
}

from Function func, Parameter vfile_2609, Parameter vifr_2609, Variable vtun_2611, Variable vdev_2613, Variable verr_2614, Variable vpcpu_stats_2719, Variable v__cpu_2719, Variable v__cpu_possible_mask, Variable vnr_cpu_ids, Variable vstat_2719, Variable v__vpp_verify_2719, Variable v__ptr_2719, Variable v__per_cpu_offset, Variable v__key_2725, SizeofTypeOperator target_0, FunctionCall target_1, RelationalOperation target_4, ExprStmt target_5, ReturnStmt target_6, VariableAccess target_7, VariableAccess target_8, VariableAccess target_9, VariableAccess target_10, AssignExpr target_11, DeclStmt target_14, NotExpr target_27, ExprStmt target_28, GotoStmt target_29, DoStmt target_30, AssignExpr target_33, IfStmt target_34, ExprStmt target_35, ExprStmt target_36, ExprStmt target_37, ExprStmt target_38, ExprStmt target_39, ExprStmt target_40, ExprStmt target_41, IfStmt target_42, IfStmt target_43, ExprStmt target_44, IfStmt target_45, ExprStmt target_46, ExprStmt target_47, ExprStmt target_48, ExprStmt target_49, ExprStmt target_51, AddressOfExpr target_52, ExprStmt target_53, AddressOfExpr target_54, VariableAccess target_55, BlockStmt target_56, VariableAccess target_59, AddressOfExpr target_61, BlockStmt target_62, BlockStmt target_63
where
func_0(func, target_0)
and func_1(vdev_2613, target_1)
and not func_2(vifr_2609, vtun_2611, target_49, target_51, target_52)
and not func_3(vfile_2609, vtun_2611, target_53, target_54, target_35)
and func_4(verr_2614, target_4)
and func_5(vdev_2613, func, target_5)
and func_6(verr_2614, func, target_6)
and func_7(vtun_2611, target_7)
and func_8(vtun_2611, target_8)
and func_9(vifr_2609, target_9)
and func_10(vfile_2609, target_10)
and func_11(vdev_2613, vpcpu_stats_2719, target_11)
and func_14(target_55, func, target_14)
and func_27(vdev_2613, target_56, target_27)
and func_28(verr_2614, target_27, target_28)
and func_29(target_27, func, target_29)
and func_30(v__key_2725, target_59, target_30)
and func_33(vtun_2611, verr_2614, target_33)
and func_34(target_59, func, target_34)
and func_35(vtun_2611, target_59, target_35)
and func_36(vdev_2613, target_59, target_36)
and func_37(vdev_2613, target_59, target_37)
and func_38(vdev_2613, target_59, target_38)
and func_39(vifr_2609, vtun_2611, target_59, target_49, target_35, target_61, target_39)
and func_40(vtun_2611, target_59, target_40)
and func_41(vfile_2609, vifr_2609, vtun_2611, verr_2614, target_59, target_41)
and func_42(verr_2614, target_59, target_42)
and func_43(verr_2614, target_59, target_43)
and func_44(vdev_2613, func, target_44)
and func_45(vdev_2613, func, target_45)
and func_46(vtun_2611, func, target_46)
and func_47(vtun_2611, func, target_47)
and func_48(vdev_2613, func, target_48)
and func_49(vifr_2609, target_49)
and func_51(vtun_2611, target_51)
and func_52(vtun_2611, target_52)
and func_53(vfile_2609, vifr_2609, vtun_2611, verr_2614, target_53)
and func_54(vtun_2611, target_54)
and func_55(vpcpu_stats_2719, target_62, target_55)
and func_56(func, target_56)
and func_59(vdev_2613, target_63, target_59)
and func_61(vtun_2611, target_61)
and func_62(func, target_62)
and func_63(vifr_2609, target_63)
and vfile_2609.getType().hasName("file *")
and vifr_2609.getType().hasName("ifreq *")
and vtun_2611.getType().hasName("tun_struct *")
and vdev_2613.getType().hasName("net_device *")
and verr_2614.getType().hasName("int")
and vpcpu_stats_2719.getType().hasName("pcpu_sw_netstats *")
and v__cpu_2719.getType().hasName("int")
and v__cpu_possible_mask.getType().hasName("cpumask")
and vnr_cpu_ids.getType().hasName("unsigned int")
and vstat_2719.getType().hasName("pcpu_sw_netstats *")
and v__vpp_verify_2719.getType().hasName("const void *")
and v__ptr_2719.getType().hasName("unsigned long")
and v__per_cpu_offset.getType() instanceof ArrayType
and v__key_2725.getType().hasName("lock_class_key")
and vfile_2609.getFunction() = func
and vifr_2609.getFunction() = func
and vtun_2611.(LocalVariable).getFunction() = func
and vdev_2613.(LocalVariable).getFunction() = func
and verr_2614.(LocalVariable).getFunction() = func
and vpcpu_stats_2719.(LocalVariable).getFunction() = func
and v__cpu_2719.(LocalVariable).getFunction() = func
and not v__cpu_possible_mask.getParentScope+() = func
and not vnr_cpu_ids.getParentScope+() = func
and vstat_2719.(LocalVariable).getFunction() = func
and v__vpp_verify_2719.(LocalVariable).getFunction() = func
and v__ptr_2719.(LocalVariable).getFunction() = func
and not v__per_cpu_offset.getParentScope+() = func
and v__key_2725.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
