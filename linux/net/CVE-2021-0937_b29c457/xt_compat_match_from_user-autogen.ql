/**
 * @name linux-b29c457a6511435960115c0f548c4360d5f4801d-xt_compat_match_from_user
 * @id cpp/linux/b29c457a6511435960115c0f548c4360d5f4801d/xt-compat-match-from-user
 * @description linux-b29c457a6511435960115c0f548c4360d5f4801d-net/netfilter/x_tables.c-xt_compat_match_from_user CVE-2021-0937
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vmsize_737, VariableAccess target_0) {
		target_0.getTarget()=vmsize_737
		and target_0.getParent().(AssignAddExpr).getLValue() = target_0
		and target_0.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_1(Variable vmsize_737, VariableAccess target_1) {
		target_1.getTarget()=vmsize_737
}

predicate func_2(Parameter vm_731, Initializer target_2) {
		target_2.getExpr().(ValueFieldAccess).getTarget().getName()="match"
		and target_2.getExpr().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="kernel"
		and target_2.getExpr().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_2.getExpr().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
}

predicate func_3(Parameter vm_731, Initializer target_3) {
		target_3.getExpr().(VariableAccess).getTarget()=vm_731
}

predicate func_4(Variable vmatch_734, FunctionCall target_4) {
		target_4.getTarget().hasName("xt_compat_match_offset")
		and not target_4.getTarget().hasName("xt_compat_target_offset")
		and target_4.getArgument(0).(VariableAccess).getTarget()=vmatch_734
}

predicate func_5(Variable vcm_735, Initializer target_5) {
		target_5.getExpr().(ValueFieldAccess).getTarget().getName()="match_size"
		and target_5.getExpr().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
		and target_5.getExpr().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_5.getExpr().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
}

predicate func_6(Parameter vm_731, Variable vcm_735, Variable vmsize_737, VariableAccess target_6) {
		target_6.getTarget()=vmsize_737
		and target_6.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_6.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_6.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_6.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_6.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_6.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
}

/*predicate func_7(Parameter vm_731, ValueFieldAccess target_7) {
		target_7.getTarget().getName()="match_size"
		and target_7.getQualifier().(ValueFieldAccess).getTarget().getName()="user"
		and target_7.getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_7.getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
}

*/
predicate func_8(Parameter vm_731, Variable vmsize_737, VariableAccess target_8) {
		target_8.getTarget()=vmsize_737
		and target_8.getParent().(AssignExpr).getRValue() = target_8
		and target_8.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="match_size"
		and target_8.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
		and target_8.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_8.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
}

predicate func_10(Function func) {
	exists(ValueFieldAccess target_10 |
		target_10.getTarget().getName()="target"
		and target_10.getQualifier().(ValueFieldAccess).getTarget().getName()="kernel"
		and target_10.getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_10.getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("xt_entry_target *")
		and target_10.getEnclosingFunction() = func)
}

predicate func_16(Function func) {
	exists(AssignExpr target_16 |
		target_16.getLValue().(VariableAccess).getType().hasName("xt_entry_target *")
		and target_16.getRValue() instanceof PointerDereferenceExpr
		and target_16.getEnclosingFunction() = func)
}

predicate func_19(Parameter vm_731, Variable vcm_735) {
	exists(PointerDereferenceExpr target_19 |
		target_19.getOperand().(VariableAccess).getType().hasName("compat_xt_entry_target *")
		and target_19.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_19.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_731
		and target_19.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vcm_735
		and target_19.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="32")
}

predicate func_26(Parameter vm_731, Variable vcm_735, Variable vmsize_737) {
	exists(PointerDereferenceExpr target_26 |
		target_26.getOperand().(VariableAccess).getType().hasName("compat_xt_entry_target *")
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vmsize_737
		and target_26.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32")
}

predicate func_32(Parameter vm_731, Parameter vdstptr_731, PointerDereferenceExpr target_32) {
		target_32.getOperand().(VariableAccess).getTarget()=vdstptr_731
		and target_32.getParent().(AssignExpr).getRValue() = target_32
		and target_32.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vm_731
}

predicate func_34(Parameter vm_731, VariableAccess target_34) {
		target_34.getTarget()=vm_731
}

predicate func_37(Variable vcm_735, ExprStmt target_60, VariableAccess target_37) {
		target_37.getTarget()=vcm_735
		and target_37.getLocation().isBefore(target_60.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
}

predicate func_38(Parameter vm_731, AssignExpr target_38) {
		target_38.getLValue().(VariableAccess).getTarget()=vm_731
		and target_38.getRValue() instanceof PointerDereferenceExpr
}

/*predicate func_39(Parameter vm_731, Variable vcm_735, ExprStmt target_62, ValueFieldAccess target_63, VariableAccess target_39) {
		target_39.getTarget()=vm_731
		and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vcm_735
		and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="32"
		and target_39.getLocation().isBefore(target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_63.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
}

*/
/*predicate func_40(Parameter vm_731, Variable vcm_735, ExprStmt target_62, ValueFieldAccess target_63, VariableAccess target_40) {
		target_40.getTarget()=vcm_735
		and target_40.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_40.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_731
		and target_40.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="32"
		and target_40.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_63.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_40.getLocation())
}

*/
predicate func_41(Parameter vm_731, Variable vcm_735, ExprStmt target_62, PointerDereferenceExpr target_41) {
		target_41.getOperand().(VariableAccess).getTarget()=vcm_735
		and target_41.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_41.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_731
		and target_41.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vcm_735
		and target_41.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="32"
		and target_41.getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_42(Variable vmatch_734, ExprStmt target_62, FunctionCall target_4, VariableAccess target_42) {
		target_42.getTarget()=vmatch_734
		and target_42.getParent().(PointerFieldAccess).getParent().(IfStmt).getThen()=target_62
		and target_4.getArgument(0).(VariableAccess).getLocation().isBefore(target_42.getLocation())
}

/*predicate func_43(Variable vmatch_734, IfStmt target_66, VariableAccess target_43) {
		target_43.getTarget()=vmatch_734
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_43.getLocation())
}

*/
predicate func_44(Parameter vm_731, Variable vmatch_734, Variable vcm_735, ExprStmt target_60, ExprStmt target_68, IfStmt target_66, PointerDereferenceExpr target_41, VariableAccess target_44) {
		target_44.getTarget()=vm_731
		and target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="compat_from_user"
		and target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_60.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_44.getLocation())
		and target_44.getLocation().isBefore(target_68.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_41.getOperand().(VariableAccess).getLocation().isBefore(target_44.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

/*predicate func_45(Parameter vm_731, Variable vmatch_734, Variable vcm_735, ExprStmt target_60, ExprStmt target_68, IfStmt target_66, PointerDereferenceExpr target_41, VariableAccess target_45) {
		target_45.getTarget()=vcm_735
		and target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="compat_from_user"
		and target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_60.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_68.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_45.getParent().(PointerFieldAccess).getParent().(VariableCall).getParent().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_41.getOperand().(VariableAccess).getLocation().isBefore(target_45.getLocation())
}

*/
/*predicate func_46(Parameter vm_731, Variable vcm_735, Variable vmsize_737, ExprStmt target_62, PointerArithmeticOperation target_71, ExprStmt target_73, VariableAccess target_46) {
		target_46.getTarget()=vm_731
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vmsize_737
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
		and target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_46.getLocation())
		and target_46.getLocation().isBefore(target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_46.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_73.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation())
}

*/
/*predicate func_47(Parameter vm_731, Variable vcm_735, Variable vmsize_737, ExprStmt target_62, PointerArithmeticOperation target_71, ExprStmt target_73, VariableAccess target_47) {
		target_47.getTarget()=vcm_735
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vmsize_737
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
		and target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_47.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_73.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation())
}

*/
predicate func_48(Parameter vm_731, Variable vcm_735, Variable vmsize_737, ExprStmt target_62, PointerArithmeticOperation target_71, ExprStmt target_73, PointerDereferenceExpr target_48) {
		target_48.getOperand().(VariableAccess).getTarget()=vcm_735
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vmsize_737
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
		and target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_48.getParent().(SizeofExprOperator).getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_73.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation())
}

predicate func_49(Variable vmatch_734, Variable vpad_736, AssignExpr target_49) {
		target_49.getLValue().(VariableAccess).getTarget()=vpad_736
		and target_49.getRValue().(SubExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getTarget().getName()="matchsize"
		and target_49.getRValue().(SubExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_49.getRValue().(SubExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(SubExpr).getValue()="7"
		and target_49.getRValue().(SubExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294967288"
		and target_49.getRValue().(SubExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="matchsize"
		and target_49.getRValue().(SubExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
}

predicate func_50(Parameter vm_731, Variable vmatch_734, Variable vpad_736, Function func, IfStmt target_50) {
		target_50.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vpad_736
		and target_50.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="0"
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memset")
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="data"
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="matchsize"
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_50.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vpad_736
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_50
}

/*predicate func_51(Parameter vm_731, Variable vmatch_734, Variable vpad_736, FunctionCall target_51) {
		target_51.getTarget().hasName("__memset")
		and target_51.getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="data"
		and target_51.getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_51.getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="matchsize"
		and target_51.getArgument(0).(PointerArithmeticOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_51.getArgument(1).(Literal).getValue()="0"
		and target_51.getArgument(2).(VariableAccess).getTarget()=vpad_736
}

*/
predicate func_52(Parameter vm_731, PointerArithmeticOperation target_71, ValueFieldAccess target_76, VariableAccess target_52) {
		target_52.getTarget()=vm_731
		and target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_52.getLocation())
		and target_52.getLocation().isBefore(target_76.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_53(Variable vmatch_734, Variable vname_738, PointerArithmeticOperation target_71, ExprStmt target_54, VariableAccess target_53) {
		target_53.getTarget()=vmatch_734
		and target_53.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("strlcpy")
		and target_53.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vname_738
		and target_53.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="name"
		and target_53.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="29"
		and target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_53.getLocation())
		and target_53.getLocation().isBefore(target_54.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_54(Variable vmatch_734, Function func, ExprStmt target_54) {
		target_54.getExpr().(FunctionCall).getTarget().hasName("module_put")
		and target_54.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="me"
		and target_54.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_54
}

/*predicate func_55(Variable vmatch_734, ExprStmt target_78, VariableAccess target_55) {
		target_55.getTarget()=vmatch_734
		and target_55.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("module_put")
		and target_55.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="me"
		and target_78.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_55.getLocation())
}

*/
predicate func_56(Parameter vm_731, Variable vname_738, Function func, ExprStmt target_56) {
		target_56.getExpr().(FunctionCall).getTarget().hasName("strncpy")
		and target_56.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="name"
		and target_56.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
		and target_56.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_56.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_56.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vname_738
		and target_56.getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="29"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_56
}

/*predicate func_57(Parameter vm_731, Variable vname_738, ValueFieldAccess target_79, VariableAccess target_57) {
		target_57.getTarget()=vm_731
		and target_57.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("strncpy")
		and target_57.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="name"
		and target_57.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
		and target_57.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vname_738
		and target_57.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="29"
		and target_79.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_57.getLocation())
}

*/
predicate func_58(Parameter vm_731, Variable vname_738, VariableAccess target_58) {
		target_58.getTarget()=vm_731
		and target_58.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("strncpy")
		and target_58.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="name"
		and target_58.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(SizeofExprOperator).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vname_738
}

predicate func_60(Parameter vm_731, Variable vcm_735, ExprStmt target_60) {
		target_60.getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_60.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vm_731
		and target_60.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vcm_735
		and target_60.getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="32"
}

predicate func_62(Parameter vm_731, Variable vmatch_734, Variable vcm_735, ExprStmt target_62) {
		target_62.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="compat_from_user"
		and target_62.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_62.getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_62.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_62.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
}

predicate func_63(Variable vcm_735, ValueFieldAccess target_63) {
		target_63.getTarget().getName()="user"
		and target_63.getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_63.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
}

predicate func_66(Parameter vm_731, Variable vmatch_734, Variable vcm_735, Variable vmsize_737, IfStmt target_66) {
		target_66.getCondition().(PointerFieldAccess).getTarget().getName()="compat_from_user"
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_66.getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="compat_from_user"
		and target_66.getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_66.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_66.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_66.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_66.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vmsize_737
		and target_66.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
}

predicate func_68(Parameter vm_731, Variable vcm_735, Variable vmsize_737, ExprStmt target_68) {
		target_68.getExpr().(FunctionCall).getTarget().hasName("__memcpy")
		and target_68.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
		and target_68.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_68.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
		and target_68.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcm_735
		and target_68.getExpr().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vmsize_737
		and target_68.getExpr().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
}

predicate func_71(Parameter vm_731, Variable vmatch_734, PointerArithmeticOperation target_71) {
		target_71.getAnOperand().(PointerFieldAccess).getTarget().getName()="data"
		and target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
		and target_71.getAnOperand().(PointerFieldAccess).getTarget().getName()="matchsize"
		and target_71.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
}

predicate func_73(Variable vmsize_737, ExprStmt target_73) {
		target_73.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vmsize_737
		and target_73.getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_76(Parameter vm_731, ValueFieldAccess target_76) {
		target_76.getTarget().getName()="user"
		and target_76.getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_76.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
}

predicate func_78(Variable vmatch_734, Variable vname_738, ExprStmt target_78) {
		target_78.getExpr().(FunctionCall).getTarget().hasName("strlcpy")
		and target_78.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vname_738
		and target_78.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="name"
		and target_78.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmatch_734
		and target_78.getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="29"
}

predicate func_79(Parameter vm_731, ValueFieldAccess target_79) {
		target_79.getTarget().getName()="user"
		and target_79.getQualifier().(PointerFieldAccess).getTarget().getName()="u"
		and target_79.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_731
}

from Function func, Parameter vm_731, Parameter vdstptr_731, Variable vmatch_734, Variable vcm_735, Variable vpad_736, Variable vmsize_737, Variable vname_738, VariableAccess target_0, VariableAccess target_1, Initializer target_2, Initializer target_3, FunctionCall target_4, Initializer target_5, VariableAccess target_6, VariableAccess target_8, PointerDereferenceExpr target_32, VariableAccess target_34, VariableAccess target_37, AssignExpr target_38, PointerDereferenceExpr target_41, VariableAccess target_42, VariableAccess target_44, PointerDereferenceExpr target_48, AssignExpr target_49, IfStmt target_50, VariableAccess target_52, VariableAccess target_53, ExprStmt target_54, ExprStmt target_56, VariableAccess target_58, ExprStmt target_60, ExprStmt target_62, ValueFieldAccess target_63, IfStmt target_66, ExprStmt target_68, PointerArithmeticOperation target_71, ExprStmt target_73, ValueFieldAccess target_76, ExprStmt target_78, ValueFieldAccess target_79
where
func_0(vmsize_737, target_0)
and func_1(vmsize_737, target_1)
and func_2(vm_731, target_2)
and func_3(vm_731, target_3)
and func_4(vmatch_734, target_4)
and func_5(vcm_735, target_5)
and func_6(vm_731, vcm_735, vmsize_737, target_6)
and func_8(vm_731, vmsize_737, target_8)
and not func_10(func)
and not func_16(func)
and not func_19(vm_731, vcm_735)
and not func_26(vm_731, vcm_735, vmsize_737)
and func_32(vm_731, vdstptr_731, target_32)
and func_34(vm_731, target_34)
and func_37(vcm_735, target_60, target_37)
and func_38(vm_731, target_38)
and func_41(vm_731, vcm_735, target_62, target_41)
and func_42(vmatch_734, target_62, target_4, target_42)
and func_44(vm_731, vmatch_734, vcm_735, target_60, target_68, target_66, target_41, target_44)
and func_48(vm_731, vcm_735, vmsize_737, target_62, target_71, target_73, target_48)
and func_49(vmatch_734, vpad_736, target_49)
and func_50(vm_731, vmatch_734, vpad_736, func, target_50)
and func_52(vm_731, target_71, target_76, target_52)
and func_53(vmatch_734, vname_738, target_71, target_54, target_53)
and func_54(vmatch_734, func, target_54)
and func_56(vm_731, vname_738, func, target_56)
and func_58(vm_731, vname_738, target_58)
and func_60(vm_731, vcm_735, target_60)
and func_62(vm_731, vmatch_734, vcm_735, target_62)
and func_63(vcm_735, target_63)
and func_66(vm_731, vmatch_734, vcm_735, vmsize_737, target_66)
and func_68(vm_731, vcm_735, vmsize_737, target_68)
and func_71(vm_731, vmatch_734, target_71)
and func_73(vmsize_737, target_73)
and func_76(vm_731, target_76)
and func_78(vmatch_734, vname_738, target_78)
and func_79(vm_731, target_79)
and vm_731.getType().hasName("xt_entry_match *")
and vdstptr_731.getType().hasName("void **")
and vmatch_734.getType().hasName("const xt_match *")
and vcm_735.getType().hasName("compat_xt_entry_match *")
and vpad_736.getType().hasName("int")
and vmsize_737.getType().hasName("u_int16_t")
and vname_738.getType().hasName("char[29]")
and vm_731.getFunction() = func
and vdstptr_731.getFunction() = func
and vmatch_734.(LocalVariable).getFunction() = func
and vcm_735.(LocalVariable).getFunction() = func
and vpad_736.(LocalVariable).getFunction() = func
and vmsize_737.(LocalVariable).getFunction() = func
and vname_738.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
