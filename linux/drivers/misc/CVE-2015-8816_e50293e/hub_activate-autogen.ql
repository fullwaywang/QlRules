/**
 * @name linux-e50293ef9775c5f1cf3fcc093037dd6a8c5684ea-hub_activate
 * @id cpp/linux/e50293ef9775c5f1cf3fcc093037dd6a8c5684ea/hub-activate
 * @description linux-e50293ef9775c5f1cf3fcc093037dd6a8c5684ea-drivers/usb/core/hub.c-hub_activate CVE-2015-8816
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vtype_1027, EqualityOperation target_18, EqualityOperation target_13) {
exists(LogicalOrExpr target_0 |
	target_0.getLeftOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vtype_1027
	and target_0.getRightOperand() instanceof EqualityOperation
	and target_0.getParent().(IfStmt).getThen() instanceof GotoStmt
	and target_18.getLeftOperand().(VariableAccess).getLocation().isBefore(target_0.getLeftOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getLocation())
	and target_0.getLeftOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_13.getLeftOperand().(VariableAccess).getLocation()))
}

predicate func_1(Parameter vhub_1027, EqualityOperation target_13, ExprStmt target_19) {
exists(ExprStmt target_1 |
	target_1.getExpr().(FunctionCall).getTarget().hasName("device_lock")
	and target_1.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="intfdev"
	and target_1.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_1.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_1
	and target_1.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
	and target_1.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_19.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_2(Parameter vhub_1027, ExprStmt target_20) {
exists(PointerFieldAccess target_2 |
	target_2.getTarget().getName()="disconnected"
	and target_2.getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_20.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_2.getQualifier().(VariableAccess).getLocation()))
}

predicate func_3(Parameter vhub_1027, EqualityOperation target_11) {
exists(ExprStmt target_3 |
	target_3.getExpr().(FunctionCall).getTarget().hasName("device_unlock")
	and target_3.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="intfdev"
	and target_3.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_3.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_3
	and target_3.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11)
}

predicate func_4(Parameter vhub_1027, EqualityOperation target_11, AddressOfExpr target_21) {
exists(ExprStmt target_4 |
	target_4.getExpr().(FunctionCall).getTarget().hasName("kref_put")
	and target_4.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="kref"
	and target_4.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_4.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_4
	and target_4.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
	and target_4.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_21.getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_5(Parameter vhub_1027, IfStmt target_22, Function func) {
exists(ExprStmt target_5 |
	target_5.getExpr().(FunctionCall).getTarget().hasName("kref_get")
	and target_5.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="kref"
	and target_5.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_5
	and target_5.getLocation().isBefore(target_22.getLocation()))
}

predicate func_6(Parameter vhub_1027, Variable vdelay_1035, Variable vsystem_power_efficient_wq, VariableAccess target_23, ExprStmt target_24, ExprStmt target_25, ExprStmt target_26, ExprStmt target_27, ExprStmt target_28, ExprStmt target_29) {
exists(IfStmt target_6 |
	target_6.getCondition() instanceof EqualityOperation
	and target_6.getThen().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_6.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_6.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("queue_delayed_work")
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsystem_power_efficient_wq
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="init_work"
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("msecs_to_jiffies")
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdelay_1035
	and target_6.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("device_unlock")
	and target_6.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="intfdev"
	and target_6.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_6.getThen().(BlockStmt).getStmt(3) instanceof ReturnStmt
	and target_6.getElse() instanceof BlockStmt
	and target_6.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_6
	and target_6.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_23
	and target_24.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_25.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_26.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_27.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_28.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_6.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_29.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

/*predicate func_7(Parameter vhub_1027, EqualityOperation target_11, AddressOfExpr target_30, ExprStmt target_25) {
exists(ExprStmt target_7 |
	target_7.getExpr().(FunctionCall).getTarget().hasName("device_unlock")
	and target_7.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="intfdev"
	and target_7.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_7.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_7
	and target_7.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
	and target_30.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_7.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_7.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_25.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_8(Parameter vtype_1027, Parameter vhub_1027, IfStmt target_31, EqualityOperation target_11, RelationalOperation target_32, ExprStmt target_33, Function func) {
exists(IfStmt target_8 |
	target_8.getCondition().(LogicalOrExpr).getLeftOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vtype_1027
	and target_8.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vtype_1027
	and target_8.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("device_unlock")
	and target_8.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="intfdev"
	and target_8.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_8
	and target_8.getLocation().isBefore(target_31.getLocation())
	and target_11.getLeftOperand().(VariableAccess).getLocation().isBefore(target_8.getCondition().(LogicalOrExpr).getLeftOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getLocation())
	and target_8.getCondition().(LogicalOrExpr).getLeftOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_32.getLesserOperand().(VariableAccess).getLocation())
	and target_33.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_8.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_9(Parameter vhub_1027, IfStmt target_31, Function func) {
exists(ExprStmt target_9 |
	target_9.getExpr().(FunctionCall).getTarget().hasName("kref_put")
	and target_9.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="kref"
	and target_9.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_9
	and target_9.getLocation().isBefore(target_31.getLocation()))
}

predicate func_10(IfStmt target_31, Function func) {
exists(ReturnStmt target_10 |
	func.getEntryPoint().(BlockStmt).getAStmt()=target_10
	and target_10.getLocation().isBefore(target_31.getLocation()))
}

predicate func_11(Parameter vtype_1027, BlockStmt target_34, EqualityOperation target_11) {
	target_11.getLeftOperand().(VariableAccess).getTarget()=vtype_1027
	and target_11.getParent().(IfStmt).getThen()=target_34
}

predicate func_12(Parameter vtype_1027, Function func, IfStmt target_12) {
	target_12.getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vtype_1027
	and target_12.getThen().(GotoStmt).getName() ="init2"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_12
}

predicate func_13(Parameter vtype_1027, EqualityOperation target_13) {
	target_13.getLeftOperand().(VariableAccess).getTarget()=vtype_1027
	and target_13.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_14(Variable vdelay_1035, EqualityOperation target_11, BlockStmt target_14) {
	target_14.getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("msleep")
	and target_14.getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdelay_1035
	and target_14.getParent().(IfStmt).getCondition()=target_11
}

predicate func_15(EqualityOperation target_11, Function func, ReturnStmt target_15) {
	target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
	and target_15.getEnclosingFunction() = func
}

predicate func_16(EqualityOperation target_13, Function func, GotoStmt target_16) {
	target_16.getName() ="init3"
	and target_16.getParent().(IfStmt).getCondition()=target_13
	and target_16.getEnclosingFunction() = func
}

predicate func_17(Function func, ReturnStmt target_17) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_17
}

predicate func_18(Parameter vtype_1027, EqualityOperation target_18) {
	target_18.getLeftOperand().(VariableAccess).getTarget()=vtype_1027
}

predicate func_19(Parameter vhub_1027, ExprStmt target_19) {
	target_19.getExpr().(FunctionCall).getTarget().hasName("dev_err")
	and target_19.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="intfdev"
	and target_19.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_19.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="set hub depth failed\n"
}

predicate func_20(Parameter vhub_1027, PointerFieldAccess target_35, ExprStmt target_20) {
	target_20.getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_20.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("int")
	and target_20.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="change_bits"
	and target_20.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_35
}

predicate func_21(Parameter vhub_1027, AddressOfExpr target_21) {
	target_21.getOperand().(PointerFieldAccess).getTarget().getName()="work"
	and target_21.getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="init_work"
	and target_21.getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_21.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__init_work")
	and target_21.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
}

predicate func_22(Function func, IfStmt target_22) {
	target_22.getCondition() instanceof EqualityOperation
	and target_22.getThen() instanceof GotoStmt
	and target_22.getEnclosingFunction() = func
}

predicate func_23(Variable vneed_debounce_delay_1034, VariableAccess target_23) {
	target_23.getTarget()=vneed_debounce_delay_1034
}

predicate func_24(Parameter vhub_1027, ExprStmt target_24) {
	target_24.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="data"
	and target_24.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="timer"
	and target_24.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="init_work"
	and target_24.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="init_work"
	and target_24.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
}

predicate func_25(Parameter vhub_1027, ExprStmt target_25) {
	target_25.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="quiescing"
	and target_25.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_25.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_26(Variable vdelay_1035, ExprStmt target_26) {
	target_26.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vdelay_1035
	and target_26.getExpr().(AssignExpr).getRValue().(Literal).getValue()="100"
}

predicate func_27(Variable vdelay_1035, ExprStmt target_27) {
	target_27.getExpr().(FunctionCall).getTarget().hasName("msleep")
	and target_27.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdelay_1035
}

predicate func_28(Parameter vhub_1027, Variable vdelay_1035, Variable vsystem_power_efficient_wq, EqualityOperation target_36, ExprStmt target_28) {
	target_28.getExpr().(FunctionCall).getTarget().hasName("queue_delayed_work")
	and target_28.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsystem_power_efficient_wq
	and target_28.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="init_work"
	and target_28.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_28.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("msecs_to_jiffies")
	and target_28.getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdelay_1035
	and target_28.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_36
}

predicate func_29(Parameter vhub_1027, Variable vsystem_power_efficient_wq, ExprStmt target_29) {
	target_29.getExpr().(FunctionCall).getTarget().hasName("queue_delayed_work")
	and target_29.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsystem_power_efficient_wq
	and target_29.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="leds"
	and target_29.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_29.getExpr().(FunctionCall).getArgument(2).(DivExpr).getValue()="166"
}

predicate func_30(Parameter vhub_1027, Variable vdelay_1035, Variable vsystem_power_efficient_wq, AddressOfExpr target_30) {
	target_30.getOperand().(PointerFieldAccess).getTarget().getName()="init_work"
	and target_30.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vhub_1027
	and target_30.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("queue_delayed_work")
	and target_30.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsystem_power_efficient_wq
	and target_30.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("msecs_to_jiffies")
	and target_30.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdelay_1035
}

predicate func_31(Parameter vtype_1027, IfStmt target_31) {
	target_31.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vtype_1027
	and target_31.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("usb_autopm_put_interface_async")
}

predicate func_32(Parameter vtype_1027, RelationalOperation target_32) {
	 (target_32 instanceof GEExpr or target_32 instanceof LEExpr)
	and target_32.getLesserOperand().(VariableAccess).getTarget()=vtype_1027
}

predicate func_33(Parameter vhub_1027, ExprStmt target_33) {
	target_33.getExpr().(FunctionCall).getTarget().hasName("kick_hub_wq")
	and target_33.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vhub_1027
}

predicate func_34(Function func, BlockStmt target_34) {
	target_34.getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_34.getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_34.getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__init_work")
	and target_34.getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_init_map")
	and target_34.getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("INIT_LIST_HEAD")
	and target_34.getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_34.getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_34.getEnclosingFunction() = func
}

predicate func_35(Function func, PointerFieldAccess target_35) {
	target_35.getTarget().getName()="persist_enabled"
	and target_35.getQualifier().(VariableAccess).getTarget().getType().hasName("usb_device *")
	and target_35.getEnclosingFunction() = func
}

predicate func_36(Parameter vtype_1027, EqualityOperation target_36) {
	target_36.getLeftOperand().(VariableAccess).getTarget()=vtype_1027
}

from Function func, Parameter vtype_1027, Parameter vhub_1027, Variable vneed_debounce_delay_1034, Variable vdelay_1035, Variable vsystem_power_efficient_wq, EqualityOperation target_11, IfStmt target_12, EqualityOperation target_13, BlockStmt target_14, ReturnStmt target_15, GotoStmt target_16, ReturnStmt target_17, EqualityOperation target_18, ExprStmt target_19, ExprStmt target_20, AddressOfExpr target_21, IfStmt target_22, VariableAccess target_23, ExprStmt target_24, ExprStmt target_25, ExprStmt target_26, ExprStmt target_27, ExprStmt target_28, ExprStmt target_29, AddressOfExpr target_30, IfStmt target_31, RelationalOperation target_32, ExprStmt target_33, BlockStmt target_34, PointerFieldAccess target_35, EqualityOperation target_36
where
not func_0(vtype_1027, target_18, target_13)
and not func_1(vhub_1027, target_13, target_19)
and not func_2(vhub_1027, target_20)
and not func_3(vhub_1027, target_11)
and not func_4(vhub_1027, target_11, target_21)
and not func_5(vhub_1027, target_22, func)
and not func_6(vhub_1027, vdelay_1035, vsystem_power_efficient_wq, target_23, target_24, target_25, target_26, target_27, target_28, target_29)
and not func_8(vtype_1027, vhub_1027, target_31, target_11, target_32, target_33, func)
and not func_9(vhub_1027, target_31, func)
and not func_10(target_31, func)
and func_11(vtype_1027, target_34, target_11)
and func_12(vtype_1027, func, target_12)
and func_13(vtype_1027, target_13)
and func_14(vdelay_1035, target_11, target_14)
and func_15(target_11, func, target_15)
and func_16(target_13, func, target_16)
and func_17(func, target_17)
and func_18(vtype_1027, target_18)
and func_19(vhub_1027, target_19)
and func_20(vhub_1027, target_35, target_20)
and func_21(vhub_1027, target_21)
and func_22(func, target_22)
and func_23(vneed_debounce_delay_1034, target_23)
and func_24(vhub_1027, target_24)
and func_25(vhub_1027, target_25)
and func_26(vdelay_1035, target_26)
and func_27(vdelay_1035, target_27)
and func_28(vhub_1027, vdelay_1035, vsystem_power_efficient_wq, target_36, target_28)
and func_29(vhub_1027, vsystem_power_efficient_wq, target_29)
and func_30(vhub_1027, vdelay_1035, vsystem_power_efficient_wq, target_30)
and func_31(vtype_1027, target_31)
and func_32(vtype_1027, target_32)
and func_33(vhub_1027, target_33)
and func_34(func, target_34)
and func_35(func, target_35)
and func_36(vtype_1027, target_36)
and vtype_1027.getType().hasName("hub_activation_type")
and vhub_1027.getType().hasName("usb_hub *")
and vneed_debounce_delay_1034.getType().hasName("bool")
and vdelay_1035.getType().hasName("unsigned int")
and vsystem_power_efficient_wq.getType().hasName("workqueue_struct *")
and vtype_1027.getFunction() = func
and vhub_1027.getFunction() = func
and vneed_debounce_delay_1034.(LocalVariable).getFunction() = func
and vdelay_1035.(LocalVariable).getFunction() = func
and not vsystem_power_efficient_wq.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
