/**
 * @name openssl-c42165b5706e42f67ef8ef4c351a9a4c5d21639a-ossl_a2ulabel
 * @id cpp/openssl/c42165b5706e42f67ef8ef4c351a9a4c5d21639a/ossl-a2ulabel
 * @description openssl-c42165b5706e42f67ef8ef4c351a9a4c5d21639a-crypto/punycode.c-ossl_a2ulabel CVE-2022-3786
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
		target_0.getValue()="1"
		and not target_0.getValue()="0"
		and target_0.getParent().(SubExpr).getParent().(GEExpr).getLesserOperand() instanceof SubExpr
		and target_0.getEnclosingFunction() = func
}

predicate func_1(Variable vdelta_267, VariableAccess target_1) {
		target_1.getTarget()=vdelta_267
		and target_1.getParent().(AddExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_2(Function func, Literal target_2) {
		target_2.getValue()="1"
		and not target_2.getValue()="0"
		and target_2.getParent().(AddExpr).getParent().(FunctionCall).getArgument(2) instanceof AddExpr
		and target_2.getEnclosingFunction() = func
}

predicate func_3(Variable vdelta_267, VariableAccess target_3) {
		target_3.getTarget()=vdelta_267
}

predicate func_4(Function func, Literal target_4) {
		target_4.getValue()="1"
		and not target_4.getValue()="0"
		and target_4.getParent().(AddExpr).getParent().(AssignPointerAddExpr).getRValue() instanceof AddExpr
		and target_4.getEnclosingFunction() = func
}

predicate func_5(Variable vsize_258, ExprStmt target_29, VariableAccess target_5) {
		target_5.getTarget()=vsize_258
		and target_5.getParent().(GEExpr).getLesserOperand() instanceof SubExpr
		and target_5.getParent().(GEExpr).getParent().(IfStmt).getThen()=target_29
}

predicate func_6(Function func, Literal target_6) {
		target_6.getValue()="1"
		and not target_6.getValue()="0"
		and target_6.getParent().(SubExpr).getParent().(GEExpr).getLesserOperand() instanceof SubExpr
		and target_6.getEnclosingFunction() = func
}

predicate func_7(Function func, Literal target_7) {
		target_7.getValue()="1"
		and not target_7.getValue()="0"
		and target_7.getParent().(SubExpr).getParent().(GEExpr).getLesserOperand() instanceof SubExpr
		and target_7.getEnclosingFunction() = func
}

predicate func_10(Function func) {
	exists(AssignExpr target_10 |
		target_10.getLValue().(VariableAccess).getType().hasName("size_t")
		and target_10.getRValue() instanceof Literal
		and target_10.getEnclosingFunction() = func)
}

predicate func_11(Function func) {
	exists(AssignExpr target_11 |
		target_11.getLValue().(VariableAccess).getType().hasName("size_t")
		and target_11.getRValue() instanceof PointerDereferenceExpr
		and target_11.getEnclosingFunction() = func)
}

predicate func_12(Variable vinptr_257, Variable vresult_259, Variable vi_281, EqualityOperation target_61, PointerArithmeticOperation target_62, ExprStmt target_24, RelationalOperation target_48, ArrayExpr target_63) {
	exists(ForStmt target_12 |
		target_12.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
		and target_12.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
		and target_12.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_12.getCondition().(RelationalOperation).getGreaterOperand() instanceof AddExpr
		and target_12.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_12.getStmt().(DoStmt).getCondition().(Literal).getValue()="0"
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getCondition().(RelationalOperation).getLesserOperand() instanceof PostfixIncrExpr
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand() instanceof PostfixIncrExpr
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vinptr_257
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_281
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_259
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_12.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_12
		and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_62.getAnOperand().(VariableAccess).getLocation())
		and target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_12.getStmt().(DoStmt).getStmt().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
		and target_12.getStmt().(DoStmt).getStmt().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_48.getGreaterOperand().(VariableAccess).getLocation())
		and target_63.getArrayOffset().(VariableAccess).getLocation().isBefore(target_12.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getLocation()))
}

/*predicate func_14(ExprStmt target_64, Function func) {
	exists(RelationalOperation target_14 |
		 (target_14 instanceof GTExpr or target_14 instanceof LTExpr)
		and target_14.getLesserOperand() instanceof PostfixIncrExpr
		and target_14.getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_14.getParent().(IfStmt).getThen()=target_64
		and target_14.getEnclosingFunction() = func)
}

*/
/*predicate func_15(Variable voutptr_256, Variable vinptr_257, Variable vi_281, EqualityOperation target_61, PointerArithmeticOperation target_62, ArrayExpr target_63) {
	exists(ArrayExpr target_15 |
		target_15.getArrayBase().(VariableAccess).getTarget()=vinptr_257
		and target_15.getArrayOffset().(VariableAccess).getTarget()=vi_281
		and target_15.getParent().(AssignExpr).getRValue() = target_15
		and target_15.getParent().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_61.getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_15.getArrayBase().(VariableAccess).getLocation())
		and target_15.getArrayBase().(VariableAccess).getLocation().isBefore(target_62.getAnOperand().(VariableAccess).getLocation())
		and target_63.getArrayOffset().(VariableAccess).getLocation().isBefore(target_15.getArrayOffset().(VariableAccess).getLocation()))
}

*/
predicate func_16(Variable vsize_258, Variable vseed_287, Variable vutfsize_288, RelationalOperation target_47, FunctionCall target_66, EqualityOperation target_67) {
	exists(ForStmt target_16 |
		target_16.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
		and target_16.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_16.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_16.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vutfsize_288
		and target_16.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("unsigned int")
		and target_16.getStmt().(DoStmt).getCondition().(Literal).getValue()="0"
		and target_16.getStmt().(DoStmt).getStmt().(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsize_258
		and target_16.getStmt().(DoStmt).getStmt().(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_16.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vseed_287
		and target_16.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
		and target_16.getStmt().(DoStmt).getStmt().(IfStmt).getElse() instanceof ExprStmt
		and target_16.getStmt().(DoStmt).getStmt().(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation().isBefore(target_47.getGreaterOperand().(VariableAccess).getLocation())
		and target_66.getArgument(0).(VariableAccess).getLocation().isBefore(target_16.getStmt().(DoStmt).getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(VariableAccess).getLocation())
		and target_67.getAnOperand().(VariableAccess).getLocation().isBefore(target_16.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getLocation()))
}

/*predicate func_17(Function func) {
	exists(AssignExpr target_17 |
		target_17.getLValue().(VariableAccess).getType().hasName("unsigned int")
		and target_17.getRValue().(Literal).getValue()="0"
		and target_17.getEnclosingFunction() = func)
}

*/
/*predicate func_18(Variable vsize_258, BlockStmt target_69, RelationalOperation target_47) {
	exists(RelationalOperation target_18 |
		 (target_18 instanceof GTExpr or target_18 instanceof LTExpr)
		and target_18.getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsize_258
		and target_18.getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_18.getParent().(IfStmt).getThen()=target_69
		and target_18.getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation().isBefore(target_47.getGreaterOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_19(Variable voutptr_256, Variable vseed_287, FunctionCall target_66) {
	exists(AssignExpr target_19 |
		target_19.getLValue().(PointerDereferenceExpr).getOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_19.getRValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vseed_287
		and target_19.getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
		and target_66.getArgument(0).(VariableAccess).getLocation().isBefore(target_19.getRValue().(ArrayExpr).getArrayBase().(VariableAccess).getLocation()))
}

*/
predicate func_20(Variable voutptr_256, Variable vsize_258, Variable vtmpptr_266, RelationalOperation target_73, ExprStmt target_75, RelationalOperation target_47, RelationalOperation target_52) {
	exists(DoStmt target_20 |
		target_20.getCondition().(Literal).getValue()="0"
		and target_20.getStmt().(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsize_258
		and target_20.getStmt().(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_20.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_20.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vtmpptr_266
		and target_20.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_20.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getThen().(Literal).getValue()="46"
		and target_20.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getElse().(Literal).getValue()="0"
		and target_20.getStmt().(IfStmt).getElse() instanceof ExprStmt
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_20
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_73
		and target_20.getStmt().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation().isBefore(target_75.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getLocation())
		and target_47.getGreaterOperand().(VariableAccess).getLocation().isBefore(target_20.getStmt().(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation())
		and target_20.getStmt().(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation().isBefore(target_52.getGreaterOperand().(VariableAccess).getLocation()))
}

/*predicate func_21(Variable vsize_258, ExprStmt target_29, RelationalOperation target_47, RelationalOperation target_52) {
	exists(RelationalOperation target_21 |
		 (target_21 instanceof GTExpr or target_21 instanceof LTExpr)
		and target_21.getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsize_258
		and target_21.getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_21.getParent().(IfStmt).getThen()=target_29
		and target_47.getGreaterOperand().(VariableAccess).getLocation().isBefore(target_21.getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation())
		and target_21.getLesserOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation().isBefore(target_52.getGreaterOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_22(Variable voutptr_256, Variable vtmpptr_266, ExprStmt target_75) {
	exists(AssignExpr target_22 |
		target_22.getLValue().(PointerDereferenceExpr).getOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_22.getRValue().(ConditionalExpr).getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vtmpptr_266
		and target_22.getRValue().(ConditionalExpr).getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_22.getRValue().(ConditionalExpr).getThen().(Literal).getValue()="46"
		and target_22.getRValue().(ConditionalExpr).getElse().(Literal).getValue()="0"
		and target_22.getLValue().(PointerDereferenceExpr).getOperand().(PostfixIncrExpr).getOperand().(VariableAccess).getLocation().isBefore(target_75.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getLocation()))
}

*/
predicate func_23(Parameter voutlen_248, Variable vsize_258, RelationalOperation target_47) {
	exists(AssignExpr target_23 |
		target_23.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutlen_248
		and target_23.getRValue().(VariableAccess).getTarget()=vsize_258)
}

predicate func_24(Variable vresult_259, EqualityOperation target_82, ExprStmt target_24) {
		target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_259
		and target_24.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_24.getParent().(IfStmt).getCondition()=target_82
}

predicate func_25(Variable vsize_258, Variable vdelta_267, AddExpr target_25) {
		target_25.getAnOperand().(VariableAccess).getTarget()=vdelta_267
		and target_25.getAnOperand().(Literal).getValue()="1"
		and target_25.getParent().(AssignAddExpr).getRValue() = target_25
		and target_25.getParent().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vsize_258
}

predicate func_26(Parameter voutlen_248, PointerDereferenceExpr target_26) {
		target_26.getOperand().(VariableAccess).getTarget()=voutlen_248
}

predicate func_27(EqualityOperation target_61, Function func, DeclStmt target_27) {
		target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
		and target_27.getEnclosingFunction() = func
}

predicate func_28(Variable vinptr_257, Variable vbuf_261, Variable vdelta_267, Variable vbufsize_280, EqualityOperation target_61, IfStmt target_28) {
		target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getTarget().hasName("ossl_punycode_decode")
		and target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(VariableAccess).getTarget()=vinptr_257
		and target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(Literal).getValue()="4"
		and target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(1).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vdelta_267
		and target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(1).(SubExpr).getRightOperand().(Literal).getValue()="4"
		and target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vbuf_261
		and target_28.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vbufsize_280
		and target_28.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
		and target_28.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-1"
		and target_28.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

predicate func_29(Variable vresult_259, RelationalOperation target_52, ExprStmt target_29) {
		target_29.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_259
		and target_29.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_29.getParent().(IfStmt).getCondition()=target_52
}

predicate func_30(Variable vtmpptr_266, BlockStmt target_83, EqualityOperation target_30) {
		target_30.getAnOperand().(VariableAccess).getTarget()=vtmpptr_266
		and target_30.getAnOperand().(Literal).getValue()="0"
		and target_30.getParent().(IfStmt).getThen()=target_83
}

predicate func_31(Variable voutptr_256, PostfixIncrExpr target_31) {
		target_31.getOperand().(VariableAccess).getTarget()=voutptr_256
}

predicate func_32(Variable vsize_258, PostfixIncrExpr target_32) {
		target_32.getOperand().(VariableAccess).getTarget()=vsize_258
}

predicate func_33(Variable vresult_259, RelationalOperation target_84, ExprStmt target_33) {
		target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_259
		and target_33.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_33.getParent().(IfStmt).getCondition()=target_84
}

predicate func_34(Parameter voutlen_248, VariableAccess target_34) {
		target_34.getTarget()=voutlen_248
}

predicate func_35(Variable vtmpptr_266, VariableAccess target_35) {
		target_35.getTarget()=vtmpptr_266
}

/*predicate func_36(Variable vsize_258, Variable vdelta_267, VariableAccess target_36) {
		target_36.getTarget()=vsize_258
		and target_36.getParent().(AssignAddExpr).getLValue() = target_36
		and target_36.getParent().(AssignAddExpr).getRValue().(AddExpr).getAnOperand().(VariableAccess).getTarget()=vdelta_267
		and target_36.getParent().(AssignAddExpr).getRValue().(AddExpr).getAnOperand().(Literal).getValue()="1"
}

*/
predicate func_37(Variable vsize_258, ExprStmt target_64, VariableAccess target_37) {
		target_37.getTarget()=vsize_258
		and target_37.getParent().(GEExpr).getLesserOperand() instanceof SubExpr
		and target_37.getParent().(GEExpr).getParent().(IfStmt).getThen()=target_64
}

predicate func_39(Variable vinptr_257, VariableAccess target_39) {
		target_39.getTarget()=vinptr_257
		and target_39.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_40(Variable voutptr_256, VariableAccess target_40) {
		target_40.getTarget()=voutptr_256
}

predicate func_41(Variable vsize_258, Variable vutfsize_288, VariableAccess target_41) {
		target_41.getTarget()=vsize_258
		and target_41.getParent().(AssignAddExpr).getLValue() = target_41
		and target_41.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vutfsize_288
}

/*predicate func_42(Variable vsize_258, Variable vutfsize_288, VariableAccess target_42) {
		target_42.getTarget()=vutfsize_288
		and target_42.getParent().(AssignAddExpr).getRValue() = target_42
		and target_42.getParent().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vsize_258
}

*/
predicate func_44(Variable vseed_287, VariableAccess target_44) {
		target_44.getTarget()=vseed_287
		and target_44.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_45(Variable voutptr_256, VariableAccess target_45) {
		target_45.getTarget()=voutptr_256
}

predicate func_46(Variable vsize_258, AssignAddExpr target_46) {
		target_46.getLValue().(VariableAccess).getTarget()=vsize_258
		and target_46.getRValue() instanceof AddExpr
}

predicate func_47(Variable vsize_258, ExprStmt target_64, RelationalOperation target_47) {
		 (target_47 instanceof GEExpr or target_47 instanceof LEExpr)
		and target_47.getGreaterOperand().(VariableAccess).getTarget()=vsize_258
		and target_47.getLesserOperand().(SubExpr).getLeftOperand() instanceof PointerDereferenceExpr
		and target_47.getLesserOperand().(SubExpr).getRightOperand() instanceof Literal
		and target_47.getParent().(IfStmt).getThen()=target_64
}

predicate func_48(Variable vresult_259, BlockStmt target_69, ExprStmt target_64, RelationalOperation target_48) {
		 (target_48 instanceof GTExpr or target_48 instanceof LTExpr)
		and target_48.getGreaterOperand().(VariableAccess).getTarget()=vresult_259
		and target_48.getLesserOperand() instanceof Literal
		and target_48.getParent().(IfStmt).getThen()=target_69
		and target_64.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_48.getGreaterOperand().(VariableAccess).getLocation())
}

predicate func_49(Variable voutptr_256, Variable vinptr_257, Variable vdelta_267, FunctionCall target_49) {
		target_49.getTarget().hasName("memcpy")
		and target_49.getArgument(0).(VariableAccess).getTarget()=voutptr_256
		and target_49.getArgument(1).(VariableAccess).getTarget()=vinptr_257
		and target_49.getArgument(2).(AddExpr).getAnOperand().(VariableAccess).getTarget()=vdelta_267
		and target_49.getArgument(2).(AddExpr).getAnOperand() instanceof Literal
}

predicate func_50(Variable voutptr_256, Variable vdelta_267, AssignPointerAddExpr target_50) {
		target_50.getLValue().(VariableAccess).getTarget()=voutptr_256
		and target_50.getRValue().(AddExpr).getAnOperand().(VariableAccess).getTarget()=vdelta_267
		and target_50.getRValue().(AddExpr).getAnOperand() instanceof Literal
}

predicate func_51(Variable vsize_258, Variable vutfsize_288, AssignAddExpr target_51) {
		target_51.getLValue().(VariableAccess).getTarget()=vsize_258
		and target_51.getRValue().(VariableAccess).getTarget()=vutfsize_288
}

predicate func_52(Parameter voutlen_248, Variable vsize_258, ExprStmt target_29, RelationalOperation target_47, RelationalOperation target_84, ExprStmt target_59, RelationalOperation target_52) {
		 (target_52 instanceof GEExpr or target_52 instanceof LEExpr)
		and target_52.getGreaterOperand().(VariableAccess).getTarget()=vsize_258
		and target_52.getLesserOperand().(SubExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutlen_248
		and target_52.getLesserOperand().(SubExpr).getRightOperand() instanceof Literal
		and target_52.getParent().(IfStmt).getThen()=target_29
}

predicate func_53(Variable voutptr_256, Variable vresult_259, Variable vseed_287, Variable vutfsize_288, IfStmt target_53) {
		target_53.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vresult_259
		and target_53.getCondition().(RelationalOperation).getLesserOperand() instanceof Literal
		and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("memcpy")
		and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=voutptr_256
		and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vseed_287
		and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vutfsize_288
		and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getTarget()=voutptr_256
		and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vutfsize_288
}

/*predicate func_54(Variable voutptr_256, Variable vseed_287, Variable vutfsize_288, FunctionCall target_54) {
		target_54.getTarget().hasName("memcpy")
		and target_54.getArgument(0).(VariableAccess).getTarget()=voutptr_256
		and target_54.getArgument(1).(VariableAccess).getTarget()=vseed_287
		and target_54.getArgument(2).(VariableAccess).getTarget()=vutfsize_288
}

*/
/*predicate func_55(Variable voutptr_256, Variable vutfsize_288, AssignPointerAddExpr target_55) {
		target_55.getLValue().(VariableAccess).getTarget()=voutptr_256
		and target_55.getRValue().(VariableAccess).getTarget()=vutfsize_288
}

*/
predicate func_56(Parameter voutlen_248, Variable voutptr_256, Variable vsize_258, EqualityOperation target_61, IfStmt target_56) {
		target_56.getCondition() instanceof EqualityOperation
		and target_56.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_56.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(CharLiteral).getValue()="46"
		and target_56.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof PostfixIncrExpr
		and target_56.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr() instanceof PostfixIncrExpr
		and target_56.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vsize_258
		and target_56.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(SubExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutlen_248
		and target_56.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(SubExpr).getRightOperand() instanceof Literal
		and target_56.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen() instanceof ExprStmt
		and target_56.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

/*predicate func_57(Variable voutptr_256, VariableAccess target_57) {
		target_57.getTarget()=voutptr_256
}

*/
predicate func_59(Function func, ExprStmt target_59) {
		target_59.getExpr() instanceof PostfixIncrExpr
		and target_59.getEnclosingFunction() = func
}

/*predicate func_60(Parameter voutlen_248, Variable vsize_258, EqualityOperation target_30, IfStmt target_60) {
		target_60.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vsize_258
		and target_60.getCondition().(RelationalOperation).getLesserOperand().(SubExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutlen_248
		and target_60.getCondition().(RelationalOperation).getLesserOperand().(SubExpr).getRightOperand() instanceof Literal
		and target_60.getThen() instanceof ExprStmt
		and target_60.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_30
}

*/
predicate func_61(Variable vinptr_257, EqualityOperation target_61) {
		target_61.getAnOperand().(FunctionCall).getTarget().hasName("strncmp")
		and target_61.getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinptr_257
		and target_61.getAnOperand().(FunctionCall).getArgument(1).(StringLiteral).getValue()="xn--"
		and target_61.getAnOperand().(FunctionCall).getArgument(2).(Literal).getValue()="4"
		and target_61.getAnOperand().(Literal).getValue()="0"
}

predicate func_62(Variable vinptr_257, PointerArithmeticOperation target_62) {
		target_62.getAnOperand().(VariableAccess).getTarget()=vinptr_257
		and target_62.getAnOperand().(Literal).getValue()="4"
}

predicate func_63(Variable vbuf_261, Variable vi_281, ArrayExpr target_63) {
		target_63.getArrayBase().(VariableAccess).getTarget()=vbuf_261
		and target_63.getArrayOffset().(VariableAccess).getTarget()=vi_281
}

predicate func_64(Variable vresult_259, RelationalOperation target_47, ExprStmt target_64) {
		target_64.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_259
		and target_64.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_64.getParent().(IfStmt).getCondition()=target_47
}

predicate func_66(Variable vbuf_261, Variable vi_281, Variable vseed_287, FunctionCall target_66) {
		target_66.getTarget().hasName("codepoint2utf8")
		and target_66.getArgument(0).(VariableAccess).getTarget()=vseed_287
		and target_66.getArgument(1).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vbuf_261
		and target_66.getArgument(1).(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_281
}

predicate func_67(Variable vutfsize_288, EqualityOperation target_67) {
		target_67.getAnOperand().(VariableAccess).getTarget()=vutfsize_288
		and target_67.getAnOperand().(Literal).getValue()="0"
}

predicate func_69(Function func, BlockStmt target_69) {
		target_69.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
		and target_69.getStmt(1).(ExprStmt).getExpr() instanceof AssignPointerAddExpr
		and target_69.getEnclosingFunction() = func
}

predicate func_73(Variable vresult_259, BlockStmt target_90, RelationalOperation target_73) {
		 (target_73 instanceof GTExpr or target_73 instanceof LTExpr)
		and target_73.getGreaterOperand().(VariableAccess).getTarget()=vresult_259
		and target_73.getLesserOperand() instanceof Literal
		and target_73.getParent().(IfStmt).getThen()=target_90
}

predicate func_75(Variable voutptr_256, ExprStmt target_75) {
		target_75.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_75.getExpr().(AssignExpr).getRValue() instanceof CharLiteral
}

predicate func_82(Function func, EqualityOperation target_82) {
		target_82.getAnOperand().(VariableAccess).getTarget().getType().hasName("char *")
		and target_82.getAnOperand().(Literal).getValue()="0"
		and target_82.getEnclosingFunction() = func
}

predicate func_83(Variable voutptr_256, BlockStmt target_83) {
		target_83.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=voutptr_256
		and target_83.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof CharLiteral
		and target_83.getStmt(1).(ExprStmt).getExpr() instanceof PostfixIncrExpr
		and target_83.getStmt(2) instanceof ExprStmt
		and target_83.getStmt(3) instanceof IfStmt
}

predicate func_84(Variable vsize_258, ExprStmt target_33, RelationalOperation target_84) {
		 (target_84 instanceof GEExpr or target_84 instanceof LEExpr)
		and target_84.getGreaterOperand().(VariableAccess).getTarget()=vsize_258
		and target_84.getLesserOperand() instanceof SubExpr
		and target_84.getParent().(IfStmt).getThen()=target_33
}

predicate func_90(Function func, BlockStmt target_90) {
		target_90.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
		and target_90.getStmt(1).(ExprStmt).getExpr() instanceof AssignPointerAddExpr
		and target_90.getEnclosingFunction() = func
}

from Function func, Parameter voutlen_248, Variable voutptr_256, Variable vinptr_257, Variable vsize_258, Variable vresult_259, Variable vbuf_261, Variable vtmpptr_266, Variable vdelta_267, Variable vbufsize_280, Variable vi_281, Variable vseed_287, Variable vutfsize_288, Literal target_0, VariableAccess target_1, Literal target_2, VariableAccess target_3, Literal target_4, VariableAccess target_5, Literal target_6, Literal target_7, ExprStmt target_24, AddExpr target_25, PointerDereferenceExpr target_26, DeclStmt target_27, IfStmt target_28, ExprStmt target_29, EqualityOperation target_30, PostfixIncrExpr target_31, PostfixIncrExpr target_32, ExprStmt target_33, VariableAccess target_34, VariableAccess target_35, VariableAccess target_37, VariableAccess target_39, VariableAccess target_40, VariableAccess target_41, VariableAccess target_44, VariableAccess target_45, AssignAddExpr target_46, RelationalOperation target_47, RelationalOperation target_48, FunctionCall target_49, AssignPointerAddExpr target_50, AssignAddExpr target_51, RelationalOperation target_52, IfStmt target_53, IfStmt target_56, ExprStmt target_59, EqualityOperation target_61, PointerArithmeticOperation target_62, ArrayExpr target_63, ExprStmt target_64, FunctionCall target_66, EqualityOperation target_67, BlockStmt target_69, RelationalOperation target_73, ExprStmt target_75, EqualityOperation target_82, BlockStmt target_83, RelationalOperation target_84, BlockStmt target_90
where
func_0(func, target_0)
and func_1(vdelta_267, target_1)
and func_2(func, target_2)
and func_3(vdelta_267, target_3)
and func_4(func, target_4)
and func_5(vsize_258, target_29, target_5)
and func_6(func, target_6)
and func_7(func, target_7)
and not func_10(func)
and not func_11(func)
and not func_12(vinptr_257, vresult_259, vi_281, target_61, target_62, target_24, target_48, target_63)
and not func_16(vsize_258, vseed_287, vutfsize_288, target_47, target_66, target_67)
and not func_20(voutptr_256, vsize_258, vtmpptr_266, target_73, target_75, target_47, target_52)
and not func_23(voutlen_248, vsize_258, target_47)
and func_24(vresult_259, target_82, target_24)
and func_25(vsize_258, vdelta_267, target_25)
and func_26(voutlen_248, target_26)
and func_27(target_61, func, target_27)
and func_28(vinptr_257, vbuf_261, vdelta_267, vbufsize_280, target_61, target_28)
and func_29(vresult_259, target_52, target_29)
and func_30(vtmpptr_266, target_83, target_30)
and func_31(voutptr_256, target_31)
and func_32(vsize_258, target_32)
and func_33(vresult_259, target_84, target_33)
and func_34(voutlen_248, target_34)
and func_35(vtmpptr_266, target_35)
and func_37(vsize_258, target_64, target_37)
and func_39(vinptr_257, target_39)
and func_40(voutptr_256, target_40)
and func_41(vsize_258, vutfsize_288, target_41)
and func_44(vseed_287, target_44)
and func_45(voutptr_256, target_45)
and func_46(vsize_258, target_46)
and func_47(vsize_258, target_64, target_47)
and func_48(vresult_259, target_69, target_64, target_48)
and func_49(voutptr_256, vinptr_257, vdelta_267, target_49)
and func_50(voutptr_256, vdelta_267, target_50)
and func_51(vsize_258, vutfsize_288, target_51)
and func_52(voutlen_248, vsize_258, target_29, target_47, target_84, target_59, target_52)
and func_53(voutptr_256, vresult_259, vseed_287, vutfsize_288, target_53)
and func_56(voutlen_248, voutptr_256, vsize_258, target_61, target_56)
and func_59(func, target_59)
and func_61(vinptr_257, target_61)
and func_62(vinptr_257, target_62)
and func_63(vbuf_261, vi_281, target_63)
and func_64(vresult_259, target_47, target_64)
and func_66(vbuf_261, vi_281, vseed_287, target_66)
and func_67(vutfsize_288, target_67)
and func_69(func, target_69)
and func_73(vresult_259, target_90, target_73)
and func_75(voutptr_256, target_75)
and func_82(func, target_82)
and func_83(voutptr_256, target_83)
and func_84(vsize_258, target_33, target_84)
and func_90(func, target_90)
and voutlen_248.getType().hasName("size_t *")
and voutptr_256.getType().hasName("char *")
and vinptr_257.getType().hasName("const char *")
and vsize_258.getType().hasName("size_t")
and vresult_259.getType().hasName("int")
and vbuf_261.getType().hasName("unsigned int[512]")
and vtmpptr_266.getType().hasName("char *")
and vdelta_267.getType().hasName("size_t")
and vbufsize_280.getType().hasName("unsigned int")
and vi_281.getType().hasName("unsigned int")
and vseed_287.getType().hasName("unsigned char[6]")
and vutfsize_288.getType().hasName("size_t")
and voutlen_248.getFunction() = func
and voutptr_256.(LocalVariable).getFunction() = func
and vinptr_257.(LocalVariable).getFunction() = func
and vsize_258.(LocalVariable).getFunction() = func
and vresult_259.(LocalVariable).getFunction() = func
and vbuf_261.(LocalVariable).getFunction() = func
and vtmpptr_266.(LocalVariable).getFunction() = func
and vdelta_267.(LocalVariable).getFunction() = func
and vbufsize_280.(LocalVariable).getFunction() = func
and vi_281.(LocalVariable).getFunction() = func
and vseed_287.(LocalVariable).getFunction() = func
and vutfsize_288.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
