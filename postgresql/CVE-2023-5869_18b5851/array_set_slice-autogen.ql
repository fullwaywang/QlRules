/**
 * @name postgresql-18b585155a891784ca8985f595ebc0dde94e0d43-array_set_slice
 * @id cpp/postgresql/18b585155a891784ca8985f595ebc0dde94e0d43/array-set-slice
 * @description postgresql-18b585155a891784ca8985f595ebc0dde94e0d43-src/backend/utils/adt/arrayfuncs.c-array_set_slice CVE-2023-5869
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vlb_2796, RelationalOperation target_35, VariableAccess target_0) {
		target_0.getTarget()=vlb_2796
		and target_0.getParent().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_35.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_0.getLocation())
}

predicate func_1(Variable vaddedbefore_2807, ExprStmt target_37, ExprStmt target_38) {
	exists(LogicalOrExpr target_1 |
		target_1.getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_1.getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_1.getAnOperand().(FunctionCall).getArgument(1) instanceof ArrayExpr
		and target_1.getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedbefore_2807
		and target_1.getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_1.getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("int[6]")
		and target_1.getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_1.getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedbefore_2807
		and target_1.getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_1.getParent().(IfStmt).getThen()=target_37
		and target_38.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_1.getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getLocation()))
}

predicate func_2(Variable v__func__, RelationalOperation target_29, ExprStmt target_39) {
	exists(DoStmt target_2 |
		target_2.getCondition() instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getCondition().(LogicalAndExpr).getValue()="1"
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_2.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getValue()="1"
		and target_2.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
		and target_2.getParent().(IfStmt).getCondition()=target_29
		and target_39.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

/*predicate func_3(Variable v__func__, ExprStmt target_39) {
	exists(CommaExpr target_3 |
		target_3.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_3.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="261"
		and target_3.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_3.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array size exceeds the maximum allowed (%d)"
		and target_3.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(DivExpr).getValue()="134217727"
		and target_3.getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_3.getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_3.getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_3.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_39.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_3.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

*/
predicate func_5(Variable vnewhasnulls_2798, Variable vaddedbefore_2807, RelationalOperation target_35, ExprStmt target_40, ExprStmt target_42) {
	exists(IfStmt target_5 |
		target_5.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vaddedbefore_2807
		and target_5.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_5.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2798
		and target_5.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_5.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_5
		and target_5.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_35
		and target_40.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_5.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
		and target_5.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getLocation().isBefore(target_42.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

predicate func_8(Variable vdim_2795, Variable vaddedafter_2808, ExprStmt target_43, RelationalOperation target_44) {
	exists(LogicalOrExpr target_8 |
		target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof AddExpr
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedafter_2808
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddedafter_2808
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(Literal).getValue()="1"
		and target_8.getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedafter_2808
		and target_8.getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_8.getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_8.getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_8.getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedafter_2808
		and target_8.getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_8.getParent().(IfStmt).getThen()=target_43
		and target_44.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_8.getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getLocation()))
}

predicate func_9(Variable v__func__, RelationalOperation target_46, ExprStmt target_47) {
	exists(DoStmt target_9 |
		target_9.getCondition() instanceof Literal
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getCondition().(LogicalAndExpr).getValue()="1"
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_9.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getValue()="1"
		and target_9.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
		and target_9.getParent().(IfStmt).getCondition()=target_46
		and target_9.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_47.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

/*predicate func_10(Variable v__func__, ExprStmt target_47) {
	exists(CommaExpr target_10 |
		target_10.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_10.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="261"
		and target_10.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_10.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array size exceeds the maximum allowed (%d)"
		and target_10.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(DivExpr).getValue()="134217727"
		and target_10.getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_10.getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_10.getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_10.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_10.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_47.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

*/
predicate func_12(Variable vnewhasnulls_2798, Variable vaddedafter_2808, RelationalOperation target_44, ExprStmt target_37, IfStmt target_48) {
	exists(IfStmt target_12 |
		target_12.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vaddedafter_2808
		and target_12.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2798
		and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_12.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_12
		and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_44
		and target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
		and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_48.getCondition().(VariableAccess).getLocation()))
}

predicate func_13(Parameter vupperIndx_2779, ExprStmt target_37, ArrayExpr target_13) {
		target_13.getArrayBase().(VariableAccess).getTarget()=vupperIndx_2779
		and target_13.getArrayOffset().(Literal).getValue()="0"
		and target_13.getParent().(LTExpr).getGreaterOperand() instanceof SubExpr
		and target_13.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_37
}

predicate func_14(Variable vlb_2796, ArrayExpr target_14) {
		target_14.getArrayBase().(VariableAccess).getTarget()=vlb_2796
		and target_14.getArrayOffset().(Literal).getValue()="0"
}

predicate func_15(Parameter vlowerIndx_2780, ArrayExpr target_15) {
		target_15.getArrayBase().(VariableAccess).getTarget()=vlowerIndx_2780
		and target_15.getArrayOffset().(Literal).getValue()="0"
}

predicate func_16(Parameter vlowerIndx_2780, ExprStmt target_43, ArrayExpr target_16) {
		target_16.getArrayBase().(VariableAccess).getTarget()=vlowerIndx_2780
		and target_16.getArrayOffset().(Literal).getValue()="0"
		and target_16.getParent().(GTExpr).getLesserOperand() instanceof AddExpr
		and target_16.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_43
}

predicate func_17(Variable vdim_2795, ArrayExpr target_17) {
		target_17.getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_17.getArrayOffset().(Literal).getValue()="0"
}

predicate func_18(Variable vlb_2796, ArrayExpr target_18) {
		target_18.getArrayBase().(VariableAccess).getTarget()=vlb_2796
		and target_18.getArrayOffset().(Literal).getValue()="0"
}

predicate func_19(Parameter vupperIndx_2779, ArrayExpr target_19) {
		target_19.getArrayBase().(VariableAccess).getTarget()=vupperIndx_2779
		and target_19.getArrayOffset().(Literal).getValue()="0"
}

predicate func_20(Variable vdim_2795, Variable vlb_2796, AddExpr target_20) {
		target_20.getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_20.getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_20.getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2796
		and target_20.getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_21(Variable vdim_2795, Variable vaddedbefore_2807, ArrayExpr target_21) {
		target_21.getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_21.getArrayOffset().(Literal).getValue()="0"
		and target_21.getParent().(AssignAddExpr).getLValue() = target_21
		and target_21.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vaddedbefore_2807
}

predicate func_22(Variable vdim_2795, Variable vaddedafter_2808, ArrayExpr target_22) {
		target_22.getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_22.getArrayOffset().(Literal).getValue()="0"
		and target_22.getParent().(AssignAddExpr).getLValue() = target_22
		and target_22.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vaddedafter_2808
}

predicate func_24(Variable vaddedbefore_2807, VariableAccess target_24) {
		target_24.getTarget()=vaddedbefore_2807
		and target_24.getParent().(AssignExpr).getLValue() = target_24
		and target_24.getParent().(AssignExpr).getRValue() instanceof SubExpr
}

/*predicate func_25(Variable vdim_2795, Variable vaddedbefore_2807, VariableAccess target_25) {
		target_25.getTarget()=vaddedbefore_2807
		and target_25.getParent().(AssignAddExpr).getRValue() = target_25
		and target_25.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_25.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

*/
predicate func_26(Variable vaddedafter_2808, VariableAccess target_26) {
		target_26.getTarget()=vaddedafter_2808
		and target_26.getParent().(AssignExpr).getLValue() = target_26
		and target_26.getParent().(AssignExpr).getRValue() instanceof AddExpr
}

/*predicate func_28(Variable vdim_2795, Variable vaddedafter_2808, VariableAccess target_28) {
		target_28.getTarget()=vaddedafter_2808
		and target_28.getParent().(AssignAddExpr).getRValue() = target_28
		and target_28.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_28.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

*/
predicate func_29(Variable vlb_2796, ExprStmt target_37, RelationalOperation target_29) {
		 (target_29 instanceof GTExpr or target_29 instanceof LTExpr)
		and target_29.getLesserOperand() instanceof ArrayExpr
		and target_29.getGreaterOperand().(SubExpr).getLeftOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2796
		and target_29.getGreaterOperand().(SubExpr).getLeftOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_29.getGreaterOperand().(SubExpr).getRightOperand() instanceof Literal
		and target_29.getParent().(IfStmt).getThen()=target_37
}

predicate func_30(Variable vaddedbefore_2807, AssignExpr target_30) {
		target_30.getLValue().(VariableAccess).getTarget()=vaddedbefore_2807
		and target_30.getRValue().(SubExpr).getLeftOperand() instanceof ArrayExpr
		and target_30.getRValue().(SubExpr).getRightOperand() instanceof ArrayExpr
}

predicate func_31(Variable vaddedbefore_2807, AssignAddExpr target_31) {
		target_31.getLValue() instanceof ArrayExpr
		and target_31.getRValue().(VariableAccess).getTarget()=vaddedbefore_2807
}

predicate func_32(ExprStmt target_43, Function func, AddExpr target_32) {
		target_32.getAnOperand() instanceof ArrayExpr
		and target_32.getAnOperand() instanceof ArrayExpr
		and target_32.getParent().(GTExpr).getGreaterOperand() instanceof ArrayExpr
		and target_32.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_43
		and target_32.getEnclosingFunction() = func
}

predicate func_33(Variable vaddedafter_2808, AssignExpr target_33) {
		target_33.getLValue().(VariableAccess).getTarget()=vaddedafter_2808
		and target_33.getRValue().(AddExpr).getAnOperand().(SubExpr).getLeftOperand() instanceof ArrayExpr
		and target_33.getRValue().(AddExpr).getAnOperand().(SubExpr).getRightOperand() instanceof AddExpr
		and target_33.getRValue().(AddExpr).getAnOperand() instanceof Literal
}

predicate func_34(Variable vaddedafter_2808, AssignAddExpr target_34) {
		target_34.getLValue() instanceof ArrayExpr
		and target_34.getRValue().(VariableAccess).getTarget()=vaddedafter_2808
}

predicate func_35(Parameter vlowerIndx_2780, Variable vlb_2796, RelationalOperation target_35) {
		 (target_35 instanceof GTExpr or target_35 instanceof LTExpr)
		and target_35.getLesserOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlowerIndx_2780
		and target_35.getLesserOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_35.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2796
		and target_35.getGreaterOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_37(Variable vnewhasnulls_2798, RelationalOperation target_29, ExprStmt target_37) {
		target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2798
		and target_37.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_37.getParent().(IfStmt).getCondition()=target_29
}

predicate func_38(Variable vaddedbefore_2807, Variable vaddedafter_2808, ExprStmt target_38) {
		target_38.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddedbefore_2807
		and target_38.getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddedafter_2808
		and target_38.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_39(Variable v__func__, ConditionalExpr target_49, ExprStmt target_39) {
		target_39.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_39.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="352845954"
		and target_39.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_39.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="upper bound cannot be less than lower bound"
		and target_39.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_39.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_39.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_39.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_39.getParent().(IfStmt).getCondition()=target_49
}

predicate func_40(Variable vnewhasnulls_2798, ExprStmt target_40) {
		target_40.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2798
		and target_40.getExpr().(AssignExpr).getRValue().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="dataoffset"
		and target_40.getExpr().(AssignExpr).getRValue().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("ArrayType *")
		and target_40.getExpr().(AssignExpr).getRValue().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_40.getExpr().(AssignExpr).getRValue().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="dataoffset"
		and target_40.getExpr().(AssignExpr).getRValue().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("ArrayType *")
		and target_40.getExpr().(AssignExpr).getRValue().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
}

predicate func_42(Variable vaddedbefore_2807, ExprStmt target_42) {
		target_42.getExpr().(FunctionCall).getTarget().hasName("array_bitmap_copy")
		and target_42.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("bits8 *")
		and target_42.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedbefore_2807
		and target_42.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget().getType().hasName("bits8 *")
		and target_42.getExpr().(FunctionCall).getArgument(3).(Literal).getValue()="0"
		and target_42.getExpr().(FunctionCall).getArgument(4).(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_43(Variable vnewhasnulls_2798, RelationalOperation target_46, ExprStmt target_43) {
		target_43.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2798
		and target_43.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_43.getParent().(IfStmt).getCondition()=target_46
}

predicate func_44(Parameter vupperIndx_2779, Variable vdim_2795, Variable vlb_2796, RelationalOperation target_44) {
		 (target_44 instanceof GEExpr or target_44 instanceof LEExpr)
		and target_44.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vupperIndx_2779
		and target_44.getGreaterOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_44.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2795
		and target_44.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_44.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2796
		and target_44.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_46(Function func, RelationalOperation target_46) {
		 (target_46 instanceof GTExpr or target_46 instanceof LTExpr)
		and target_46.getGreaterOperand() instanceof ArrayExpr
		and target_46.getLesserOperand() instanceof AddExpr
		and target_46.getEnclosingFunction() = func
}

predicate func_47(Variable v__func__, ConditionalExpr target_50, ExprStmt target_47) {
		target_47.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_47.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="352845954"
		and target_47.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_47.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="upper bound cannot be less than lower bound"
		and target_47.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_47.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_47.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_47.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_47.getParent().(IfStmt).getCondition()=target_50
}

predicate func_48(Variable vnewhasnulls_2798, IfStmt target_48) {
		target_48.getCondition().(VariableAccess).getTarget()=vnewhasnulls_2798
		and target_48.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_48.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(SubExpr).getValue()="7"
		and target_48.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446744073709551608"
		and target_48.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_48.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(AddExpr).getAnOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_48.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(AddExpr).getAnOperand().(SizeofTypeOperator).getValue()="16"
		and target_48.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(SubExpr).getValue()="7"
		and target_48.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446744073709551608"
}

predicate func_49(ExprStmt target_39, Function func, ConditionalExpr target_49) {
		target_49.getCondition().(LogicalAndExpr).getValue()="1"
		and target_49.getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_49.getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_49.getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_49.getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_49.getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_49.getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_49.getParent().(IfStmt).getThen()=target_39
		and target_49.getEnclosingFunction() = func
}

predicate func_50(ExprStmt target_47, Function func, ConditionalExpr target_50) {
		target_50.getCondition().(LogicalAndExpr).getValue()="1"
		and target_50.getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_50.getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_50.getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_50.getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_50.getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_50.getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_50.getParent().(IfStmt).getThen()=target_47
		and target_50.getEnclosingFunction() = func
}

from Function func, Parameter vupperIndx_2779, Parameter vlowerIndx_2780, Variable vdim_2795, Variable vlb_2796, Variable vnewhasnulls_2798, Variable vaddedbefore_2807, Variable vaddedafter_2808, Variable v__func__, VariableAccess target_0, ArrayExpr target_13, ArrayExpr target_14, ArrayExpr target_15, ArrayExpr target_16, ArrayExpr target_17, ArrayExpr target_18, ArrayExpr target_19, AddExpr target_20, ArrayExpr target_21, ArrayExpr target_22, VariableAccess target_24, VariableAccess target_26, RelationalOperation target_29, AssignExpr target_30, AssignAddExpr target_31, AddExpr target_32, AssignExpr target_33, AssignAddExpr target_34, RelationalOperation target_35, ExprStmt target_37, ExprStmt target_38, ExprStmt target_39, ExprStmt target_40, ExprStmt target_42, ExprStmt target_43, RelationalOperation target_44, RelationalOperation target_46, ExprStmt target_47, IfStmt target_48, ConditionalExpr target_49, ConditionalExpr target_50
where
func_0(vlb_2796, target_35, target_0)
and not func_1(vaddedbefore_2807, target_37, target_38)
and not func_2(v__func__, target_29, target_39)
and not func_5(vnewhasnulls_2798, vaddedbefore_2807, target_35, target_40, target_42)
and not func_8(vdim_2795, vaddedafter_2808, target_43, target_44)
and not func_9(v__func__, target_46, target_47)
and not func_12(vnewhasnulls_2798, vaddedafter_2808, target_44, target_37, target_48)
and func_13(vupperIndx_2779, target_37, target_13)
and func_14(vlb_2796, target_14)
and func_15(vlowerIndx_2780, target_15)
and func_16(vlowerIndx_2780, target_43, target_16)
and func_17(vdim_2795, target_17)
and func_18(vlb_2796, target_18)
and func_19(vupperIndx_2779, target_19)
and func_20(vdim_2795, vlb_2796, target_20)
and func_21(vdim_2795, vaddedbefore_2807, target_21)
and func_22(vdim_2795, vaddedafter_2808, target_22)
and func_24(vaddedbefore_2807, target_24)
and func_26(vaddedafter_2808, target_26)
and func_29(vlb_2796, target_37, target_29)
and func_30(vaddedbefore_2807, target_30)
and func_31(vaddedbefore_2807, target_31)
and func_32(target_43, func, target_32)
and func_33(vaddedafter_2808, target_33)
and func_34(vaddedafter_2808, target_34)
and func_35(vlowerIndx_2780, vlb_2796, target_35)
and func_37(vnewhasnulls_2798, target_29, target_37)
and func_38(vaddedbefore_2807, vaddedafter_2808, target_38)
and func_39(v__func__, target_49, target_39)
and func_40(vnewhasnulls_2798, target_40)
and func_42(vaddedbefore_2807, target_42)
and func_43(vnewhasnulls_2798, target_46, target_43)
and func_44(vupperIndx_2779, vdim_2795, vlb_2796, target_44)
and func_46(func, target_46)
and func_47(v__func__, target_50, target_47)
and func_48(vnewhasnulls_2798, target_48)
and func_49(target_39, func, target_49)
and func_50(target_47, func, target_50)
and vupperIndx_2779.getType().hasName("int *")
and vlowerIndx_2780.getType().hasName("int *")
and vdim_2795.getType().hasName("int[6]")
and vlb_2796.getType().hasName("int[6]")
and vnewhasnulls_2798.getType().hasName("bool")
and vaddedbefore_2807.getType().hasName("int")
and vaddedafter_2808.getType().hasName("int")
and v__func__.getType() instanceof ArrayType
and vupperIndx_2779.getFunction() = func
and vlowerIndx_2780.getFunction() = func
and vdim_2795.(LocalVariable).getFunction() = func
and vlb_2796.(LocalVariable).getFunction() = func
and vnewhasnulls_2798.(LocalVariable).getFunction() = func
and vaddedbefore_2807.(LocalVariable).getFunction() = func
and vaddedafter_2808.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
