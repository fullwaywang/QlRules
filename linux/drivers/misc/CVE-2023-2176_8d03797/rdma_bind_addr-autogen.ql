/**
 * @name linux-8d037973d48c026224ab285e6a06985ccac6f7bf-rdma_bind_addr
 * @id cpp/linux/8d037973d48c026224ab285e6a06985ccac6f7bf/rdma-bind-addr
 * @description linux-8d037973d48c026224ab285e6a06985ccac6f7bf-drivers/infiniband/core/cma.c-rdma_bind_addr CVE-2023-2176
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vid_priv_4063, ReturnStmt target_66, FunctionCall target_0) {
	target_0.getTarget().hasName("cma_comp_exch")
	and not target_0.getTarget().hasName("rdma_bind_addr_dst")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and target_0.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_66
}

predicate func_1(Parameter vaddr_4061, Initializer target_1) {
	target_1.getExpr().(FunctionCall).getTarget().hasName("rdma_addr_size")
	and target_1.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddr_4061
}

predicate func_2(Variable vid_priv_4063, Variable v__mptr_4071, StmtExpr target_2) {
	target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_4071
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="0"
	and target_2.getParent().(AssignExpr).getRValue() = target_2
	and target_2.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vid_priv_4063
}

predicate func_3(Variable vid_priv_4063, Variable vdaddr_4065, FunctionCall target_3) {
	target_3.getTarget().hasName("cma_dst_addr")
	and target_3.getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and target_3.getParent().(AssignExpr).getRValue() = target_3
	and target_3.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vdaddr_4065
}

predicate func_4(Parameter vaddr_4061, VariableAccess target_4) {
	target_4.getTarget()=vaddr_4061
	and target_4.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_5(Function func, DeclStmt target_5) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_5
}

predicate func_6(Function func, DeclStmt target_6) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_6
}

predicate func_7(Parameter vaddr_4061, Function func, IfStmt target_7) {
	target_7.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_7.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_7.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="2"
	and target_7.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_7.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_7.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="10"
	and target_7.getCondition().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_7.getCondition().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_7.getCondition().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="27"
	and target_7.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-97"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_7
}

/*predicate func_8(Function func, UnaryMinusExpr target_8) {
	target_8.getValue()="-97"
	and target_8.getEnclosingFunction() = func
}

*/
predicate func_9(Variable vid_priv_4063, Function func, ExprStmt target_9) {
	target_9.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vid_priv_4063
	and target_9.getExpr().(AssignExpr).getRValue() instanceof StmtExpr
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_9
}

predicate func_10(Function func, IfStmt target_10) {
	target_10.getCondition().(NotExpr).getOperand() instanceof FunctionCall
	and target_10.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_10
}

predicate func_11(Variable vret_4064, Parameter vaddr_4061, Function func, ExprStmt target_11) {
	target_11.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_4064
	and target_11.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cma_check_linklocal")
	and target_11.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="dev_addr"
	and target_11.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="addr"
	and target_11.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="route"
	and target_11.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_4061
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_11
}

predicate func_12(Variable vret_4064, ExprStmt target_11, Function func, IfStmt target_12) {
	target_12.getCondition().(VariableAccess).getTarget()=vret_4064
	and target_12.getThen().(GotoStmt).getName() ="err1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_12
	and target_11.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_12.getCondition().(VariableAccess).getLocation())
}

predicate func_13(Variable vid_priv_4063, Variable v__fortify_size_4079, Parameter vaddr_4061, Function func, ExprStmt target_13) {
	target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_memcpy")
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("cma_src_addr")
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_4061
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__fortify_size_4079
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_13
}

predicate func_15(Parameter vaddr_4061, ExprStmt target_11, VariableAccess target_15) {
	target_15.getTarget()=vaddr_4061
	and target_15.getParent().(FunctionCall).getParent().(Initializer).getExpr().(FunctionCall).getTarget().hasName("rdma_addr_size")
	and target_11.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_15.getLocation())
}

/*predicate func_20(Function func, ExprStmt target_20) {
	target_20.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_20.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_20.getEnclosingFunction() = func
}

*/
/*predicate func_22(Function func, IfStmt target_22) {
	target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_22.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_22.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_22.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
	and target_22.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_22.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_22.getEnclosingFunction() = func
}

*/
/*predicate func_26(Variable v__already_done_4079, Variable v__ret_cond_4079, Variable v__ret_once_4079, IfStmt target_26) {
	target_26.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_26.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=v__ret_cond_4079
	and target_26.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__already_done_4079
	and target_26.getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_26.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__already_done_4079
	and target_26.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__ret_once_4079
}

*/
/*predicate func_27(Variable v__already_done_4079, FunctionCall target_67, ExprStmt target_27) {
	target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__already_done_4079
	and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
}

*/
/*predicate func_28(Variable v__ret_once_4079, FunctionCall target_67, ExprStmt target_28) {
	target_28.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__ret_once_4079
	and target_28.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
}

*/
/*predicate func_29(Variable v__ret_once_4079, ExprStmt target_29) {
	target_29.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_29.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_once_4079
	and target_29.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_31(Variable v__ret_warn_on_4079, IfStmt target_31) {
	target_31.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_31.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_4079
	and target_31.getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_31.getThen().(DoStmt).getCondition() instanceof Literal
	and target_31.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(DoStmt).getCondition() instanceof Literal
	and target_31.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(2).(DoStmt).getCondition() instanceof Literal
}

*/
/*predicate func_32(Function func, ExprStmt target_32) {
	target_32.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_32.getEnclosingFunction() = func
}

*/
/*predicate func_33(Function func, AsmStmt target_33) {
	target_33.getChild(0) instanceof Literal
	and target_33.getEnclosingFunction() = func
}

*/
/*predicate func_35(Variable v__flags_4079, DoStmt target_35) {
	target_35.getCondition() instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(2).(DoStmt).getCondition() instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof StringLiteral
	and target_35.getStmt().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(1) instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__flags_4079
	and target_35.getStmt().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_35.getStmt().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getValue()="12"
	and target_35.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
}

*/
/*predicate func_37(Function func, ExprStmt target_37) {
	target_37.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_37.getEnclosingFunction() = func
}

*/
/*predicate func_38(Function func, AsmStmt target_38) {
	target_38.getChild(0) instanceof Literal
	and target_38.getEnclosingFunction() = func
}

*/
/*predicate func_39(Variable v__flags_4079, DoStmt target_39) {
	target_39.getCondition() instanceof Literal
	and target_39.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof StringLiteral
	and target_39.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(1) instanceof Literal
	and target_39.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__flags_4079
	and target_39.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_39.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getValue()="12"
}

*/
/*predicate func_40(Variable v__flags_4079, AsmStmt target_40) {
	target_40.getChild(0) instanceof StringLiteral
	and target_40.getChild(1) instanceof Literal
	and target_40.getChild(2).(VariableAccess).getTarget()=v__flags_4079
	and target_40.getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_40.getChild(3).(SizeofTypeOperator).getValue()="12"
}

*/
/*predicate func_41(Function func, ExprStmt target_41) {
	target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_41.getEnclosingFunction() = func
}

*/
/*predicate func_42(Function func, AsmStmt target_42) {
	target_42.getChild(0) instanceof Literal
	and target_42.getEnclosingFunction() = func
}

*/
/*predicate func_43(Function func, ExprStmt target_43) {
	target_43.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_43.getEnclosingFunction() = func
}

*/
/*predicate func_44(Function func, AsmStmt target_44) {
	target_44.getChild(0) instanceof Literal
	and target_44.getEnclosingFunction() = func
}

*/
/*predicate func_45(Variable v__ret_warn_on_4079, ExprStmt target_45) {
	target_45.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_45.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_4079
	and target_45.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_46(Variable v__ret_do_once_4079, ExprStmt target_46) {
	target_46.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_46.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_do_once_4079
	and target_46.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_47(Variable vid_priv_4063, Variable v__fortify_size_4079, Parameter vaddr_4061, ExprStmt target_47) {
	target_47.getExpr().(FunctionCall).getTarget().hasName("__builtin_memcpy")
	and target_47.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("cma_src_addr")
	and target_47.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and target_47.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_4061
	and target_47.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__fortify_size_4079
}

*/
predicate func_48(Variable vid_priv_4063, Variable vret_4064, Parameter vaddr_4061, Function func, IfStmt target_48) {
	target_48.getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("cma_any_addr")
	and target_48.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddr_4061
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_4064
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cma_translate_addr")
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddr_4061
	and target_48.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="dev_addr"
	and target_48.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_4064
	and target_48.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(GotoStmt).getName() ="err1"
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_4064
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cma_acquire_dev_by_src_ip")
	and target_48.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and target_48.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_4064
	and target_48.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(GotoStmt).getName() ="err1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Variable vret_4064, Parameter vaddr_4061, NotExpr target_68, ExprStmt target_49) {
	target_49.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_4064
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cma_translate_addr")
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddr_4061
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="dev_addr"
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="addr"
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="route"
	and target_49.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_68
}

/*predicate func_50(Variable vret_4064, NotExpr target_68, ExprStmt target_49, IfStmt target_50) {
	target_50.getCondition().(VariableAccess).getTarget()=vret_4064
	and target_50.getThen().(GotoStmt).getName() ="err1"
	and target_50.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_68
	and target_49.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_50.getCondition().(VariableAccess).getLocation())
}

*/
predicate func_51(Variable vid_priv_4063, Variable vret_4064, NotExpr target_68, ExprStmt target_51) {
	target_51.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_4064
	and target_51.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cma_acquire_dev_by_src_ip")
	and target_51.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and target_51.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_68
}

/*predicate func_52(Variable vret_4064, NotExpr target_68, ExprStmt target_51, IfStmt target_52) {
	target_52.getCondition().(VariableAccess).getTarget()=vret_4064
	and target_52.getThen().(GotoStmt).getName() ="err1"
	and target_52.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_68
	and target_51.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_52.getCondition().(VariableAccess).getLocation())
}

*/
predicate func_53(Variable vid_priv_4063, Parameter vaddr_4061, Function func, IfStmt target_53) {
	target_53.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="options"
	and target_53.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and target_53.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(EqualityOperation).getRightOperand().(Literal).getValue()="2"
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="afonly"
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_53.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getRightOperand().(Literal).getValue()="10"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_53
}

/*predicate func_54(Variable vid_priv_4063, Parameter vaddr_4061, NotExpr target_69, IfStmt target_54) {
	target_54.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_54.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_54.getCondition().(EqualityOperation).getRightOperand().(Literal).getValue()="2"
	and target_54.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="afonly"
	and target_54.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and target_54.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_54.getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_54.getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_54.getElse().(IfStmt).getCondition().(EqualityOperation).getRightOperand().(Literal).getValue()="10"
	and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="afonly"
	and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="bindv6only"
	and target_54.getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="sysctl"
	and target_54.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_69
}

*/
predicate func_55(EqualityOperation target_70, Function func, DeclStmt target_55) {
	target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_70
	and target_55.getEnclosingFunction() = func
}

/*predicate func_56(Variable vid_priv_4063, Variable vnet_4095, EqualityOperation target_70, ExprStmt target_56) {
	target_56.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="afonly"
	and target_56.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and target_56.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="bindv6only"
	and target_56.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="sysctl"
	and target_56.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ipv6"
	and target_56.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnet_4095
	and target_56.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_70
}

*/
predicate func_57(Variable vdaddr_4065, Function func, ExprStmt target_57) {
	target_57.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vdaddr_4065
	and target_57.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_57
}

predicate func_58(Variable vdaddr_4065, Parameter vaddr_4061, Function func, ExprStmt target_58) {
	target_58.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_58.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdaddr_4065
	and target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_58.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_58
}

predicate func_59(Variable vid_priv_4063, Variable vret_4064, Function func, ExprStmt target_59) {
	target_59.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_4064
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cma_get_port")
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_59
}

predicate func_60(Variable vret_4064, Function func, IfStmt target_60) {
	target_60.getCondition().(VariableAccess).getTarget()=vret_4064
	and target_60.getThen().(GotoStmt).getName() ="err2"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_60
}

predicate func_61(Variable vid_priv_4063, Parameter vaddr_4061, Function func, IfStmt target_61) {
	target_61.getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("cma_any_addr")
	and target_61.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddr_4061
	and target_61.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("rdma_restrack_add")
	and target_61.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="res"
	and target_61.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_61
}

predicate func_62(Function func, ReturnStmt target_62) {
	target_62.getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_62
}

predicate func_63(Variable vid_priv_4063, Function func, IfStmt target_63) {
	target_63.getCondition().(PointerFieldAccess).getTarget().getName()="cma_dev"
	and target_63.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vid_priv_4063
	and target_63.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("cma_release_dev")
	and target_63.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_63
}

predicate func_64(Variable vid_priv_4063, Function func, ExprStmt target_64) {
	target_64.getExpr().(FunctionCall).getTarget().hasName("cma_comp_exch")
	and target_64.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vid_priv_4063
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_64
}

predicate func_65(Variable vret_4064, Function func, ReturnStmt target_65) {
	target_65.getExpr().(VariableAccess).getTarget()=vret_4064
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_65
}

predicate func_66(Function func, ReturnStmt target_66) {
	target_66.getExpr() instanceof UnaryMinusExpr
	and target_66.getEnclosingFunction() = func
}

predicate func_67(Function func, FunctionCall target_67) {
	target_67.getTarget().hasName("__builtin_expect")
	and target_67.getArgument(0) instanceof NotExpr
	and target_67.getArgument(1) instanceof Literal
	and target_67.getEnclosingFunction() = func
}

predicate func_68(BlockStmt target_71, Function func, NotExpr target_68) {
	target_68.getOperand() instanceof FunctionCall
	and target_68.getParent().(IfStmt).getThen()=target_71
	and target_68.getEnclosingFunction() = func
}

predicate func_69(Function func, NotExpr target_69) {
	target_69.getOperand() instanceof BitwiseAndExpr
	and target_69.getEnclosingFunction() = func
}

predicate func_70(Parameter vaddr_4061, EqualityOperation target_70) {
	target_70.getLeftOperand().(PointerFieldAccess).getTarget().getName()="sa_family"
	and target_70.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaddr_4061
	and target_70.getRightOperand() instanceof Literal
}

predicate func_71(Function func, BlockStmt target_71) {
	target_71.getStmt(0) instanceof ExprStmt
	and target_71.getStmt(1) instanceof IfStmt
	and target_71.getStmt(2) instanceof ExprStmt
	and target_71.getStmt(3) instanceof IfStmt
	and target_71.getEnclosingFunction() = func
}

from Function func, Variable vid_priv_4063, Variable vret_4064, Variable vdaddr_4065, Variable v__mptr_4071, Variable v__fortify_size_4079, Variable v__ret_do_once_4079, Variable v__already_done_4079, Variable v__ret_cond_4079, Variable v__ret_once_4079, Variable v__ret_warn_on_4079, Variable v__flags_4079, Variable vnet_4095, Parameter vaddr_4061, FunctionCall target_0, Initializer target_1, StmtExpr target_2, FunctionCall target_3, VariableAccess target_4, DeclStmt target_5, DeclStmt target_6, IfStmt target_7, ExprStmt target_9, IfStmt target_10, ExprStmt target_11, IfStmt target_12, ExprStmt target_13, VariableAccess target_15, IfStmt target_48, ExprStmt target_49, ExprStmt target_51, IfStmt target_53, DeclStmt target_55, ExprStmt target_57, ExprStmt target_58, ExprStmt target_59, IfStmt target_60, IfStmt target_61, ReturnStmt target_62, IfStmt target_63, ExprStmt target_64, ReturnStmt target_65, ReturnStmt target_66, FunctionCall target_67, NotExpr target_68, NotExpr target_69, EqualityOperation target_70, BlockStmt target_71
where
func_0(vid_priv_4063, target_66, target_0)
and func_1(vaddr_4061, target_1)
and func_2(vid_priv_4063, v__mptr_4071, target_2)
and func_3(vid_priv_4063, vdaddr_4065, target_3)
and func_4(vaddr_4061, target_4)
and func_5(func, target_5)
and func_6(func, target_6)
and func_7(vaddr_4061, func, target_7)
and func_9(vid_priv_4063, func, target_9)
and func_10(func, target_10)
and func_11(vret_4064, vaddr_4061, func, target_11)
and func_12(vret_4064, target_11, func, target_12)
and func_13(vid_priv_4063, v__fortify_size_4079, vaddr_4061, func, target_13)
and func_15(vaddr_4061, target_11, target_15)
and func_48(vid_priv_4063, vret_4064, vaddr_4061, func, target_48)
and func_49(vret_4064, vaddr_4061, target_68, target_49)
and func_51(vid_priv_4063, vret_4064, target_68, target_51)
and func_53(vid_priv_4063, vaddr_4061, func, target_53)
and func_55(target_70, func, target_55)
and func_57(vdaddr_4065, func, target_57)
and func_58(vdaddr_4065, vaddr_4061, func, target_58)
and func_59(vid_priv_4063, vret_4064, func, target_59)
and func_60(vret_4064, func, target_60)
and func_61(vid_priv_4063, vaddr_4061, func, target_61)
and func_62(func, target_62)
and func_63(vid_priv_4063, func, target_63)
and func_64(vid_priv_4063, func, target_64)
and func_65(vret_4064, func, target_65)
and func_66(func, target_66)
and func_67(func, target_67)
and func_68(target_71, func, target_68)
and func_69(func, target_69)
and func_70(vaddr_4061, target_70)
and func_71(func, target_71)
and vid_priv_4063.getType().hasName("rdma_id_private *")
and vret_4064.getType().hasName("int")
and vdaddr_4065.getType().hasName("sockaddr *")
and v__mptr_4071.getType().hasName("void *")
and v__fortify_size_4079.getType().hasName("const size_t")
and v__ret_do_once_4079.getType().hasName("bool")
and v__already_done_4079.getType().hasName("bool")
and v__ret_cond_4079.getType().hasName("bool")
and v__ret_once_4079.getType().hasName("bool")
and v__ret_warn_on_4079.getType().hasName("int")
and v__flags_4079.getType().hasName("int")
and vnet_4095.getType().hasName("net *")
and vaddr_4061.getType().hasName("sockaddr *")
and vid_priv_4063.(LocalVariable).getFunction() = func
and vret_4064.(LocalVariable).getFunction() = func
and vdaddr_4065.(LocalVariable).getFunction() = func
and v__mptr_4071.(LocalVariable).getFunction() = func
and v__fortify_size_4079.(LocalVariable).getFunction() = func
and v__ret_do_once_4079.(LocalVariable).getFunction() = func
and v__already_done_4079.(LocalVariable).getFunction() = func
and v__ret_cond_4079.(LocalVariable).getFunction() = func
and v__ret_once_4079.(LocalVariable).getFunction() = func
and v__ret_warn_on_4079.(LocalVariable).getFunction() = func
and v__flags_4079.(LocalVariable).getFunction() = func
and vnet_4095.(LocalVariable).getFunction() = func
and vaddr_4061.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
