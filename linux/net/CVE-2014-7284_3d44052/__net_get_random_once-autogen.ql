/**
 * @name linux-3d4405226d27b3a215e4d03cfa51f536244e5de7-__net_get_random_once
 * @id cpp/linux/3d4405226d27b3a215e4d03cfa51f536244e5de7/--net-get-random-once
 * @description linux-3d4405226d27b3a215e4d03cfa51f536244e5de7-net/core/utils.c-__net_get_random_once CVE-2014-7284
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vdone_key_370, VariableAccess target_0) {
	target_0.getTarget()=vdone_key_370
	and vdone_key_370.getIndex() = 3
	and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__net_random_once_disable_jump")
}

from Function func, Parameter vdone_key_370, VariableAccess target_0
where
func_0(vdone_key_370, target_0)
and vdone_key_370.getType().hasName("static_key *")
and vdone_key_370.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
