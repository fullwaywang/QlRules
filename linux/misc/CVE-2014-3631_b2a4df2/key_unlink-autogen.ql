/**
 * @name linux-b2a4df200d570b2c33a57e1ebfa5896e4bc81b69-key_unlink
 * @id cpp/linux/b2a4df200d570b2c33a57e1ebfa5896e4bc81b69/key-unlink
 * @description linux-b2a4df200d570b2c33a57e1ebfa5896e4bc81b69-security/keys/keyring.c-key_unlink CVE-2014-3631
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vkeyring_1037, AddressOfExpr target_49, PointerFieldAccess target_0) {
		target_0.getTarget().getName()="payload"
		and target_0.getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_0.getQualifier().(VariableAccess).getLocation().isBefore(target_49.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_1(Parameter vkeyring_1037, PointerFieldAccess target_1) {
		target_1.getTarget().getName()="payload"
		and target_1.getQualifier().(VariableAccess).getTarget()=vkeyring_1037
}

predicate func_2(Function func, FunctionCall target_2) {
		target_2.getTarget().hasName("lockdep_rcu_suspicious")
		and not target_2.getTarget().hasName("assoc_array_apply_edit")
		and target_2.getArgument(0) instanceof StringLiteral
		and target_2.getArgument(1) instanceof Literal
		and target_2.getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_protected() usage"
		and target_2.getEnclosingFunction() = func
}

predicate func_4(EqualityOperation target_50, Function func) {
	exists(ReturnStmt target_4 |
		target_4.getExpr() instanceof UnaryMinusExpr
		and target_4.getParent().(IfStmt).getCondition()=target_50
		and target_4.getEnclosingFunction() = func)
}

predicate func_5(Parameter vkeyring_1037, AddressOfExpr target_51, AddressOfExpr target_49) {
	exists(AssignExpr target_5 |
		target_5.getLValue().(VariableAccess).getType().hasName("assoc_array_edit *")
		and target_5.getRValue().(FunctionCall).getTarget().hasName("assoc_array_delete")
		and target_5.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="keys"
		and target_5.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_5.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_5.getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("const assoc_array_ops")
		and target_5.getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="index_key"
		and target_5.getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_5.getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("key *")
		and target_51.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_5.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_5.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_49.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_6(BlockStmt target_52, Function func) {
	exists(FunctionCall target_6 |
		target_6.getTarget().hasName("IS_ERR")
		and target_6.getArgument(0).(VariableAccess).getType().hasName("assoc_array_edit *")
		and target_6.getParent().(IfStmt).getThen()=target_52
		and target_6.getEnclosingFunction() = func)
}

predicate func_7(Variable vret_1040) {
	exists(FunctionCall target_7 |
		target_7.getTarget().hasName("PTR_ERR")
		and target_7.getArgument(0).(VariableAccess).getType().hasName("assoc_array_edit *")
		and target_7.getParent().(AssignExpr).getRValue() = target_7
		and target_7.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1040)
}

predicate func_10(Parameter vkeyring_1037, PointerFieldAccess target_10) {
		target_10.getTarget().getName()="sem"
		and target_10.getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_10.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(NotExpr).getOperand() instanceof FunctionCall
}

predicate func_11(Variable vret_1040, UnaryMinusExpr target_11) {
		target_11.getValue()="-20"
		and target_11.getParent().(AssignExpr).getRValue() = target_11
		and target_11.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1040
}

predicate func_12(EqualityOperation target_50, Function func, GotoStmt target_12) {
		target_12.getParent().(IfStmt).getCondition()=target_50
		and target_12.getEnclosingFunction() = func
}

predicate func_16(Variable vret_1040, Function func, ExprStmt target_16) {
		target_16.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1040
		and target_16.getExpr().(AssignExpr).getRValue() instanceof UnaryMinusExpr
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

predicate func_17(Variable vklist_1039, Parameter vkeyring_1037, AssignExpr target_17) {
		target_17.getLValue().(VariableAccess).getTarget()=vklist_1039
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ValueFieldAccess).getTarget().getName()="subscriptions"
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="payload"
		and target_17.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
}

/*predicate func_18(Variable v__warned_1051, DoStmt target_18) {
		target_18.getCondition() instanceof Literal
		and target_18.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_18.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_1051
		and target_18.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("rwsem_is_locked")
		and target_18.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_1051
		and target_18.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
}

*/
/*predicate func_20(Variable v__warned_1051, Parameter vkeyring_1037, BlockStmt target_52, LogicalAndExpr target_20) {
		target_20.getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_20.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_1051
		and target_20.getAnOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("rwsem_is_locked")
		and target_20.getAnOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_20.getAnOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_20.getParent().(IfStmt).getThen()=target_52
}

*/
/*predicate func_21(Variable v__warned_1051, AssignExpr target_21) {
		target_21.getLValue().(VariableAccess).getTarget()=v__warned_1051
}

*/
/*predicate func_22(LogicalAndExpr target_20, Function func, ExprStmt target_22) {
		target_22.getExpr() instanceof FunctionCall
		and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_20
		and target_22.getEnclosingFunction() = func
}

*/
/*predicate func_24(Parameter vkeyring_1037, ExprStmt target_24) {
		target_24.getExpr().(ValueFieldAccess).getTarget().getName()="subscriptions"
		and target_24.getExpr().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="payload"
		and target_24.getExpr().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
}

*/
predicate func_25(Variable vklist_1039, BlockStmt target_53, RelationalOperation target_55, VariableAccess target_25) {
		target_25.getTarget()=vklist_1039
		and target_25.getParent().(IfStmt).getThen()=target_53
		and target_25.getLocation().isBefore(target_55.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_26(Parameter vkey_1037, Variable vklist_1039, Variable vloop_1040, Variable v_________p1_1055, VariableAccess target_25, ForStmt target_26) {
		target_26.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vloop_1040
		and target_26.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_26.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vloop_1040
		and target_26.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_26.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and target_26.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vloop_1040
		and target_26.getStmt().(IfStmt).getCondition().(EqualityOperation).getAnOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_________p1_1055
		and target_26.getStmt().(IfStmt).getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vkey_1037
		and target_26.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_25
}

/*predicate func_27(Parameter vkey_1037, Variable v_________p1_1055, StmtExpr target_27) {
		target_27.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_________p1_1055
		and target_27.getParent().(EQExpr).getAnOperand().(VariableAccess).getTarget()=vkey_1037
		and target_27.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

*/
/*predicate func_30(Variable v_________p1_1055, ExprStmt target_30) {
		target_30.getExpr().(VariableAccess).getTarget()=v_________p1_1055
}

*/
/*predicate func_31(Parameter vkey_1037, VariableAccess target_31) {
		target_31.getTarget()=vkey_1037
		and target_31.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

*/
predicate func_32(Function func, GotoStmt target_32) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_32
}

predicate func_33(Variable vklist_1039, Variable vnklist_1039, Function func, ExprStmt target_33) {
		target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnklist_1039
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("kmalloc")
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(SizeofExprOperator).getValue()="24"
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(SizeofTypeOperator).getValue()="8"
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(MulExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="maxkeys"
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(MulExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and target_33.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseOrExpr).getValue()="208"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_33
}

predicate func_34(Variable vnklist_1039, Function func, IfStmt target_34) {
		target_34.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vnklist_1039
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_34
}

predicate func_35(Variable vklist_1039, Variable vnklist_1039, Function func, ExprStmt target_35) {
		target_35.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="maxkeys"
		and target_35.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnklist_1039
		and target_35.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="maxkeys"
		and target_35.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
}

predicate func_36(Variable vklist_1039, Variable vnklist_1039, Function func, ExprStmt target_36) {
		target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnklist_1039
		and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and target_36.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(Literal).getValue()="1"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
}

predicate func_37(Variable vklist_1039, Variable vnklist_1039, Variable vloop_1040, Function func, IfStmt target_37) {
		target_37.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vloop_1040
		and target_37.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="0"
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("memcpy")
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="keys"
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnklist_1039
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="keys"
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(VariableAccess).getTarget()=vloop_1040
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="8"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_37
}

predicate func_38(Variable vklist_1039, Variable vnklist_1039, Variable vloop_1040, Function func, IfStmt target_38) {
		target_38.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vloop_1040
		and target_38.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_38.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnklist_1039
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("memcpy")
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="keys"
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnklist_1039
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vloop_1040
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="keys"
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(AddExpr).getAnOperand().(VariableAccess).getTarget()=vloop_1040
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(AddExpr).getAnOperand().(Literal).getValue()="1"
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnklist_1039
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vloop_1040
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_38.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="8"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

predicate func_39(Parameter vkeyring_1037, Function func, ExprStmt target_39) {
		target_39.getExpr().(FunctionCall).getTarget().hasName("key_payload_reserve")
		and target_39.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkeyring_1037
		and target_39.getExpr().(FunctionCall).getArgument(1).(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="datalen"
		and target_39.getExpr().(FunctionCall).getArgument(1).(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_39.getExpr().(FunctionCall).getArgument(1).(SubExpr).getRightOperand().(Literal).getValue()="4"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_39
}

predicate func_40(Variable vnklist_1039, Parameter vkeyring_1037, Function func, DoStmt target_40) {
		target_40.getCondition().(Literal).getValue()="0"
		and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="subscriptions"
		and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="payload"
		and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnklist_1039
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_40
}

predicate func_42(Variable vnklist_1039, Parameter vkeyring_1037, ExprStmt target_42) {
		target_42.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="subscriptions"
		and target_42.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="payload"
		and target_42.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_42.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnklist_1039
}

predicate func_43(Parameter vkeyring_1037, ExprStmt target_42, AddressOfExpr target_56, Function func, ExprStmt target_43) {
		target_43.getExpr().(FunctionCall).getTarget().hasName("up_write")
		and target_43.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_43.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_43
		and target_42.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_43.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_43.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_56.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_44(Variable vklist_1039, Variable vloop_1040, Function func, ExprStmt target_44) {
		target_44.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="delkey"
		and target_44.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
		and target_44.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vloop_1040
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_44
}

predicate func_45(Variable vklist_1039, FunctionCall target_45) {
		target_45.getTarget().hasName("call_rcu_sched")
		and target_45.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
		and target_45.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
}

predicate func_46(Variable vret_1040, Function func, ExprStmt target_46) {
		target_46.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1040
		and target_46.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-12"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

predicate func_47(Parameter vkeyring_1037, AddressOfExpr target_57, Function func, ExprStmt target_47) {
		target_47.getExpr().(FunctionCall).getTarget().hasName("up_write")
		and target_47.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_47.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_47
		and target_57.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_47.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_48(Function func, GotoStmt target_48) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Parameter vkeyring_1037, AddressOfExpr target_49) {
		target_49.getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_49.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("up_write")
}

predicate func_50(Parameter vkeyring_1037, EqualityOperation target_50) {
		target_50.getAnOperand().(ValueFieldAccess).getTarget().getName()="type"
		and target_50.getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="(unknown field)"
		and target_50.getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_50.getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_50.getAnOperand().(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("key_type")
}

predicate func_51(Parameter vkeyring_1037, AddressOfExpr target_51) {
		target_51.getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_51.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_51.getParent().(FunctionCall).getParent().(NotExpr).getOperand() instanceof FunctionCall
}

predicate func_52(Function func, BlockStmt target_52) {
		target_52.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
		and target_52.getStmt(1) instanceof ExprStmt
		and target_52.getEnclosingFunction() = func
}

predicate func_53(Function func, BlockStmt target_53) {
		target_53.getStmt(0) instanceof ForStmt
		and target_53.getEnclosingFunction() = func
}

predicate func_55(Variable vklist_1039, Variable vloop_1040, RelationalOperation target_55) {
		 (target_55 instanceof GTExpr or target_55 instanceof LTExpr)
		and target_55.getLesserOperand().(VariableAccess).getTarget()=vloop_1040
		and target_55.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_55.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vklist_1039
}

predicate func_56(Parameter vkeyring_1037, AddressOfExpr target_56) {
		target_56.getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_56.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_56.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_57(Parameter vkeyring_1037, AddressOfExpr target_57) {
		target_57.getOperand().(PointerFieldAccess).getTarget().getName()="sem"
		and target_57.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeyring_1037
		and target_57.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

from Function func, Parameter vkey_1037, Variable vklist_1039, Variable vnklist_1039, Variable vloop_1040, Variable vret_1040, Variable v__warned_1051, Variable v_________p1_1055, Parameter vkeyring_1037, PointerFieldAccess target_0, PointerFieldAccess target_1, FunctionCall target_2, PointerFieldAccess target_10, UnaryMinusExpr target_11, GotoStmt target_12, ExprStmt target_16, AssignExpr target_17, VariableAccess target_25, ForStmt target_26, GotoStmt target_32, ExprStmt target_33, IfStmt target_34, ExprStmt target_35, ExprStmt target_36, IfStmt target_37, IfStmt target_38, ExprStmt target_39, DoStmt target_40, ExprStmt target_42, ExprStmt target_43, ExprStmt target_44, FunctionCall target_45, ExprStmt target_46, ExprStmt target_47, GotoStmt target_48, AddressOfExpr target_49, EqualityOperation target_50, AddressOfExpr target_51, BlockStmt target_52, BlockStmt target_53, RelationalOperation target_55, AddressOfExpr target_56, AddressOfExpr target_57
where
func_0(vkeyring_1037, target_49, target_0)
and func_1(vkeyring_1037, target_1)
and func_2(func, target_2)
and not func_4(target_50, func)
and not func_5(vkeyring_1037, target_51, target_49)
and not func_6(target_52, func)
and not func_7(vret_1040)
and func_10(vkeyring_1037, target_10)
and func_11(vret_1040, target_11)
and func_12(target_50, func, target_12)
and func_16(vret_1040, func, target_16)
and func_17(vklist_1039, vkeyring_1037, target_17)
and func_25(vklist_1039, target_53, target_55, target_25)
and func_26(vkey_1037, vklist_1039, vloop_1040, v_________p1_1055, target_25, target_26)
and func_32(func, target_32)
and func_33(vklist_1039, vnklist_1039, func, target_33)
and func_34(vnklist_1039, func, target_34)
and func_35(vklist_1039, vnklist_1039, func, target_35)
and func_36(vklist_1039, vnklist_1039, func, target_36)
and func_37(vklist_1039, vnklist_1039, vloop_1040, func, target_37)
and func_38(vklist_1039, vnklist_1039, vloop_1040, func, target_38)
and func_39(vkeyring_1037, func, target_39)
and func_40(vnklist_1039, vkeyring_1037, func, target_40)
and func_42(vnklist_1039, vkeyring_1037, target_42)
and func_43(vkeyring_1037, target_42, target_56, func, target_43)
and func_44(vklist_1039, vloop_1040, func, target_44)
and func_45(vklist_1039, target_45)
and func_46(vret_1040, func, target_46)
and func_47(vkeyring_1037, target_57, func, target_47)
and func_48(func, target_48)
and func_49(vkeyring_1037, target_49)
and func_50(vkeyring_1037, target_50)
and func_51(vkeyring_1037, target_51)
and func_52(func, target_52)
and func_53(func, target_53)
and func_55(vklist_1039, vloop_1040, target_55)
and func_56(vkeyring_1037, target_56)
and func_57(vkeyring_1037, target_57)
and vkey_1037.getType().hasName("key *")
and vklist_1039.getType().hasName("keyring_list *")
and vnklist_1039.getType().hasName("keyring_list *")
and vloop_1040.getType().hasName("int")
and vret_1040.getType().hasName("int")
and v__warned_1051.getType().hasName("bool")
and v_________p1_1055.getType().hasName("key *")
and vkeyring_1037.getType().hasName("key *")
and vkey_1037.getFunction() = func
and vklist_1039.(LocalVariable).getFunction() = func
and vnklist_1039.(LocalVariable).getFunction() = func
and vloop_1040.(LocalVariable).getFunction() = func
and vret_1040.(LocalVariable).getFunction() = func
and v__warned_1051.(LocalVariable).getFunction() = func
and v_________p1_1055.(LocalVariable).getFunction() = func
and vkeyring_1037.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
