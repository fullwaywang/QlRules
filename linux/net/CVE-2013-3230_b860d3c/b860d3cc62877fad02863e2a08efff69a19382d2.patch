commit b860d3cc62877fad02863e2a08efff69a19382d2
Author: Mathias Krause <minipli@googlemail.com>
Date:   Sun Apr 7 01:51:55 2013 +0000

    l2tp: fix info leak in l2tp_ip6_recvmsg()
    
    The L2TP code for IPv6 fails to initialize the l2tp_conn_id member of
    struct sockaddr_l2tpip6 and therefore leaks four bytes kernel stack
    in l2tp_ip6_recvmsg() in case msg_name is set.
    
    Initialize l2tp_conn_id with 0 to avoid the info leak.
    
    Signed-off-by: Mathias Krause <minipli@googlemail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/l2tp/l2tp_ip6.c b/net/l2tp/l2tp_ip6.c
index c74f5a9..b8a6039 100644
--- a/net/l2tp/l2tp_ip6.c
+++ b/net/l2tp/l2tp_ip6.c
@@ -690,6 +690,7 @@ static int l2tp_ip6_recvmsg(struct kiocb *iocb, struct sock *sk,
 		lsa->l2tp_addr = ipv6_hdr(skb)->saddr;
 		lsa->l2tp_flowinfo = 0;
 		lsa->l2tp_scope_id = 0;
+		lsa->l2tp_conn_id = 0;
 		if (ipv6_addr_type(&lsa->l2tp_addr) & IPV6_ADDR_LINKLOCAL)
 			lsa->l2tp_scope_id = IP6CB(skb)->iif;
 	}
