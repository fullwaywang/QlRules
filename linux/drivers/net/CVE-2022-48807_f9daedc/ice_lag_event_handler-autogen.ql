/**
 * @name linux-f9daedc3ab8f673e3a9374b91a89fbf1174df469-ice_lag_event_handler
 * @id cpp/linux/f9daedc3ab8f673e3a9374b91a89fbf1174df469/ice-lag-event-handler
 * @description linux-f9daedc3ab8f673e3a9374b91a89fbf1174df469-drivers/net/ethernet/intel/ice/ice_lag.c-ice_lag_event_handler CVE-2022-48807
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vptr_285, Variable vlag_288, FunctionCall target_0) {
	target_0.getTarget().hasName("ice_lag_unlink")
	and not target_0.getTarget().hasName("ice_lag_unregister")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vlag_288
	and target_0.getArgument(1).(VariableAccess).getTarget()=vptr_285
}

from Function func, Parameter vptr_285, Variable vlag_288, FunctionCall target_0
where
func_0(vptr_285, vlag_288, target_0)
and vptr_285.getType().hasName("void *")
and vlag_288.getType().hasName("ice_lag *")
and vptr_285.getFunction() = func
and vlag_288.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
