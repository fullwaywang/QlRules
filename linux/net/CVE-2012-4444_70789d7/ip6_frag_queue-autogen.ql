/**
 * @name linux-70789d7052239992824628db8133de08dc78e593-ip6_frag_queue
 * @id cpp/linux/70789d7052239992824628db8133de08dc78e593/ip6-frag-queue
 * @description linux-70789d7052239992824628db8133de08dc78e593-net/ipv6/reassembly.c-ip6_frag_queue CVE-2012-4444
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vfq_259, Variable vfree_it_385, FunctionCall target_0) {
		target_0.getTarget().hasName("frag_kfree_skb")
		and not target_0.getTarget().hasName("fq_kill")
		and target_0.getArgument(0).(ValueFieldAccess).getTarget().getName()="net"
		and target_0.getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_0.getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_0.getArgument(1).(VariableAccess).getTarget()=vfree_it_385
}

predicate func_1(Variable vprev_262, BlockStmt target_29, ExprStmt target_30, SubExpr target_5) {
	exists(LogicalAndExpr target_1 |
		target_1.getAnOperand().(VariableAccess).getTarget()=vprev_262
		and target_1.getAnOperand().(RelationalOperation).getGreaterOperand() instanceof SubExpr
		and target_1.getAnOperand().(RelationalOperation).getLesserOperand().(Literal).getValue()="0"
		and target_1.getParent().(IfStmt).getThen()=target_29
		and target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_1.getAnOperand().(VariableAccess).getLocation())
		and target_1.getAnOperand().(VariableAccess).getLocation().isBefore(target_5.getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_2(Parameter vfq_259, PointerFieldAccess target_2) {
		target_2.getTarget().getName()="q"
		and target_2.getQualifier().(VariableAccess).getTarget()=vfq_259
}

predicate func_3(Variable vprev_262, Variable vnext_262, PointerFieldAccess target_3) {
		target_3.getTarget().getName()="next"
		and target_3.getQualifier().(VariableAccess).getTarget()=vprev_262
		and target_3.getParent().(AssignExpr).getLValue() = target_3
		and target_3.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnext_262
}

predicate func_4(Parameter vfq_259, ValueFieldAccess target_4) {
		target_4.getTarget().getName()="fragments"
		and target_4.getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_4.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
}

predicate func_5(Variable vprev_262, Variable voffset_264, SubExpr target_5) {
		target_5.getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getTarget().getName()="offset"
		and target_5.getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
		and target_5.getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vprev_262
		and target_5.getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_5.getLeftOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vprev_262
		and target_5.getRightOperand().(VariableAccess).getTarget()=voffset_264
}

predicate func_6(Variable vnext_262, Variable vend_264, LogicalAndExpr target_6) {
		target_6.getAnOperand().(VariableAccess).getTarget()=vnext_262
		and target_6.getAnOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="offset"
		and target_6.getAnOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
		and target_6.getAnOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_6.getAnOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vend_264
}

predicate func_7(Variable vprev_262, BlockStmt target_29, VariableAccess target_7) {
		target_7.getTarget()=vprev_262
		and target_7.getParent().(IfStmt).getThen()=target_29
}

predicate func_8(Parameter vfq_259, VariableAccess target_8) {
		target_8.getTarget()=vfq_259
}

predicate func_9(VariableAccess target_7, Function func, DeclStmt target_9) {
		target_9.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_7
		and target_9.getEnclosingFunction() = func
}

predicate func_10(Variable vi_354, BlockStmt target_31, DeclStmt target_9, VariableAccess target_10) {
		target_10.getTarget()=vi_354
		and target_10.getParent().(GTExpr).getLesserOperand().(Literal).getValue()="0"
		and target_10.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_31
}

predicate func_11(Variable voffset_264, Variable vi_354, AssignAddExpr target_11) {
		target_11.getLValue().(VariableAccess).getTarget()=voffset_264
		and target_11.getRValue().(VariableAccess).getTarget()=vi_354
}

predicate func_12(Variable voffset_264, Variable vend_264, RelationalOperation target_33, IfStmt target_12) {
		target_12.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vend_264
		and target_12.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=voffset_264
		and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_33
}

predicate func_13(Variable vi_354, Parameter vskb_259, RelationalOperation target_33, IfStmt target_13) {
		target_13.getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("pskb_pull")
		and target_13.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_259
		and target_13.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vi_354
		and target_13.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_33
}

predicate func_14(Parameter vskb_259, RelationalOperation target_33, IfStmt target_14) {
		target_14.getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_14.getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_259
		and target_14.getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="1"
		and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_259
		and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_14.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_33
}

predicate func_15(Variable vprev_262, Variable vnext_262, Variable vi_371, Function func, WhileStmt target_15) {
		target_15.getCondition() instanceof LogicalAndExpr
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vi_371
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("pskb_pull")
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="offset"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vi_371
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getTarget().getName()="meat"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vi_371
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="1"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnext_262
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="next"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(2).(IfStmt).getCondition().(VariableAccess).getTarget()=vprev_262
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getTarget().getName()="meat"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_15.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(4).(ExprStmt).getExpr() instanceof FunctionCall
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

/*predicate func_17(Variable vprev_262, Variable vnext_262, Parameter vfq_259, Variable vi_371, Variable vfree_it_385, IfStmt target_17) {
		target_17.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vi_371
		and target_17.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_17.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_17.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("pskb_pull")
		and target_17.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnext_262
		and target_17.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vi_371
		and target_17.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="offset"
		and target_17.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
		and target_17.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_17.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vi_371
		and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getTarget().getName()="meat"
		and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vi_371
		and target_17.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_17.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_17.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="1"
		and target_17.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_17.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_17.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_17.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnext_262
		and target_17.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="next"
		and target_17.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_17.getElse().(BlockStmt).getStmt(2).(IfStmt).getCondition().(VariableAccess).getTarget()=vprev_262
		and target_17.getElse().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="next"
		and target_17.getElse().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vprev_262
		and target_17.getElse().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnext_262
		and target_17.getElse().(BlockStmt).getStmt(2).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
		and target_17.getElse().(BlockStmt).getStmt(2).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnext_262
		and target_17.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getTarget().getName()="meat"
		and target_17.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_17.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_17.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_17.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfree_it_385
		and target_17.getElse().(BlockStmt).getStmt(4).(ExprStmt).getExpr() instanceof FunctionCall
}

*/
/*predicate func_18(Variable vnext_262, Variable vi_371, RelationalOperation target_34, IfStmt target_18) {
		target_18.getCondition().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("pskb_pull")
		and target_18.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnext_262
		and target_18.getCondition().(NotExpr).getOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vi_371
		and target_18.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_19(Variable vnext_262, Variable vi_371, RelationalOperation target_34, ExprStmt target_19) {
		target_19.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="offset"
		and target_19.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="cb"
		and target_19.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_19.getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vi_371
		and target_19.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_20(Parameter vfq_259, Variable vi_371, RelationalOperation target_34, ExprStmt target_20) {
		target_20.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getTarget().getName()="meat"
		and target_20.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_20.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_20.getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vi_371
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_21(Variable vnext_262, RelationalOperation target_34, IfStmt target_21) {
		target_21.getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_21.getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_21.getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="1"
		and target_21.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ip_summed"
		and target_21.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_21.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_22(RelationalOperation target_34, Function func, BreakStmt target_22) {
		target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
		and target_22.getEnclosingFunction() = func
}

*/
predicate func_23(RelationalOperation target_34, Function func, DeclStmt target_23) {
		target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
		and target_23.getEnclosingFunction() = func
}

/*predicate func_24(Variable vnext_262, RelationalOperation target_34, ExprStmt target_24) {
		target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnext_262
		and target_24.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="next"
		and target_24.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
		and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_25(Variable vprev_262, Variable vnext_262, RelationalOperation target_34, IfStmt target_25) {
		target_25.getCondition().(VariableAccess).getTarget()=vprev_262
		and target_25.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="next"
		and target_25.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vprev_262
		and target_25.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnext_262
		and target_25.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
		and target_25.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnext_262
		and target_25.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
predicate func_26(Parameter vfq_259, Variable vfree_it_385, RelationalOperation target_34, ExprStmt target_26) {
		target_26.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getTarget().getName()="meat"
		and target_26.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_26.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_26.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_26.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfree_it_385
		and target_26.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

/*predicate func_27(RelationalOperation target_34, Function func, ExprStmt target_27) {
		target_27.getExpr() instanceof FunctionCall
		and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
		and target_27.getEnclosingFunction() = func
}

*/
predicate func_28(Parameter vfq_259, ExprStmt target_26, ExprStmt target_35, PointerFieldAccess target_28) {
		target_28.getTarget().getName()="q"
		and target_28.getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_26.getExpr().(AssignSubExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_28.getQualifier().(VariableAccess).getLocation())
		and target_28.getQualifier().(VariableAccess).getLocation().isBefore(target_35.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_29(Variable vi_354, BlockStmt target_29) {
		target_29.getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vi_354
		and target_29.getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="0"
		and target_29.getStmt(1).(IfStmt).getThen() instanceof BlockStmt
}

predicate func_30(Variable vprev_262, Variable vnext_262, ExprStmt target_30) {
		target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vprev_262
		and target_30.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnext_262
}

predicate func_31(Function func, BlockStmt target_31) {
		target_31.getStmt(0).(ExprStmt).getExpr() instanceof AssignAddExpr
		and target_31.getStmt(1) instanceof IfStmt
		and target_31.getStmt(2) instanceof IfStmt
		and target_31.getStmt(3) instanceof IfStmt
		and target_31.getEnclosingFunction() = func
}

predicate func_33(Variable vi_354, RelationalOperation target_33) {
		 (target_33 instanceof GTExpr or target_33 instanceof LTExpr)
		and target_33.getGreaterOperand().(VariableAccess).getTarget()=vi_354
		and target_33.getLesserOperand().(Literal).getValue()="0"
}

predicate func_34(Variable vnext_262, Variable vi_371, RelationalOperation target_34) {
		 (target_34 instanceof GTExpr or target_34 instanceof LTExpr)
		and target_34.getLesserOperand().(VariableAccess).getTarget()=vi_371
		and target_34.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_34.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnext_262
}

predicate func_35(Parameter vskb_259, Parameter vfq_259, ExprStmt target_35) {
		target_35.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="fragments_tail"
		and target_35.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="q"
		and target_35.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vfq_259
		and target_35.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vskb_259
}

from Function func, Variable vprev_262, Variable vnext_262, Variable voffset_264, Variable vend_264, Variable vi_354, Parameter vskb_259, Parameter vfq_259, Variable vi_371, Variable vfree_it_385, FunctionCall target_0, PointerFieldAccess target_2, PointerFieldAccess target_3, ValueFieldAccess target_4, SubExpr target_5, LogicalAndExpr target_6, VariableAccess target_7, VariableAccess target_8, DeclStmt target_9, VariableAccess target_10, AssignAddExpr target_11, IfStmt target_12, IfStmt target_13, IfStmt target_14, WhileStmt target_15, DeclStmt target_23, ExprStmt target_26, PointerFieldAccess target_28, BlockStmt target_29, ExprStmt target_30, BlockStmt target_31, RelationalOperation target_33, RelationalOperation target_34, ExprStmt target_35
where
func_0(vfq_259, vfree_it_385, target_0)
and not func_1(vprev_262, target_29, target_30, target_5)
and func_2(vfq_259, target_2)
and func_3(vprev_262, vnext_262, target_3)
and func_4(vfq_259, target_4)
and func_5(vprev_262, voffset_264, target_5)
and func_6(vnext_262, vend_264, target_6)
and func_7(vprev_262, target_29, target_7)
and func_8(vfq_259, target_8)
and func_9(target_7, func, target_9)
and func_10(vi_354, target_31, target_9, target_10)
and func_11(voffset_264, vi_354, target_11)
and func_12(voffset_264, vend_264, target_33, target_12)
and func_13(vi_354, vskb_259, target_33, target_13)
and func_14(vskb_259, target_33, target_14)
and func_15(vprev_262, vnext_262, vi_371, func, target_15)
and func_23(target_34, func, target_23)
and func_26(vfq_259, vfree_it_385, target_34, target_26)
and func_28(vfq_259, target_26, target_35, target_28)
and func_29(vi_354, target_29)
and func_30(vprev_262, vnext_262, target_30)
and func_31(func, target_31)
and func_33(vi_354, target_33)
and func_34(vnext_262, vi_371, target_34)
and func_35(vskb_259, vfq_259, target_35)
and vprev_262.getType().hasName("sk_buff *")
and vnext_262.getType().hasName("sk_buff *")
and voffset_264.getType().hasName("int")
and vend_264.getType().hasName("int")
and vi_354.getType().hasName("int")
and vskb_259.getType().hasName("sk_buff *")
and vfq_259.getType().hasName("frag_queue *")
and vi_371.getType().hasName("int")
and vfree_it_385.getType().hasName("sk_buff *")
and vprev_262.(LocalVariable).getFunction() = func
and vnext_262.(LocalVariable).getFunction() = func
and voffset_264.(LocalVariable).getFunction() = func
and vend_264.(LocalVariable).getFunction() = func
and vi_354.(LocalVariable).getFunction() = func
and vskb_259.getFunction() = func
and vfq_259.getFunction() = func
and vi_371.(LocalVariable).getFunction() = func
and vfree_it_385.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
