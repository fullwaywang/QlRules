/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-verify_iovec
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/verify-iovec
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/core/iovec.c-verify_iovec CVE-2013-7271
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vm_38, VariableAccess target_0) {
	target_0.getTarget()=vm_38
	and vm_38.getIndex() = 0
}

/*predicate func_1(Parameter vm_38, VariableAccess target_1) {
	target_1.getTarget()=vm_38
	and vm_38.getIndex() = 0
	and target_1.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
}

*/
predicate func_2(Function func, UnaryMinusExpr target_2) {
	target_2.getValue()="-14"
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Parameter vm_38, BlockStmt target_75, VariableAccess target_3) {
	target_3.getTarget()=vm_38
	and vm_38.getIndex() = 0
	and target_3.getParent().(PointerFieldAccess).getParent().(IfStmt).getThen()=target_75
}

predicate func_4(Parameter vmode_38, BlockStmt target_76, VariableAccess target_4) {
	target_4.getTarget()=vmode_38
	and vmode_38.getIndex() = 3
	and target_4.getParent().(EQExpr).getRightOperand().(Literal).getValue()="0"
	and target_4.getParent().(EQExpr).getParent().(IfStmt).getThen()=target_76
}

/*predicate func_5(Function func, Literal target_5) {
	target_5.getValue()="0"
	and not target_5.getValue()="64"
	and target_5.getParent().(EQExpr).getParent().(IfStmt).getCondition() instanceof EqualityOperation
	and target_5.getEnclosingFunction() = func
}

*/
predicate func_6(Parameter vm_38, Parameter vaddress_38, Variable verr_40, Variable vnamep_44, FunctionCall target_6) {
	target_6.getTarget().hasName("move_addr_to_kernel")
	and not target_6.getTarget().hasName("skb_copy_datagram_iovec")
	and target_6.getArgument(0).(VariableAccess).getTarget()=vnamep_44
	and target_6.getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_6.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_6.getArgument(2).(VariableAccess).getTarget()=vaddress_38
	and target_6.getParent().(AssignExpr).getRValue() = target_6
	and target_6.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_40
}

/*predicate func_7(Parameter vm_38, Parameter vaddress_38, Variable vnamep_44, VariableAccess target_7) {
	target_7.getTarget()=vm_38
	and vm_38.getIndex() = 0
	and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("move_addr_to_kernel")
	and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnamep_44
	and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vaddress_38
}

*/
predicate func_8(Function func, Literal target_8) {
	target_8.getValue()="0"
	and not target_8.getValue()="8192"
	and target_8.getParent().(LTExpr).getParent().(IfStmt).getCondition() instanceof RelationalOperation
	and target_8.getEnclosingFunction() = func
}

predicate func_9(Parameter vm_38, VariableAccess target_9) {
	target_9.getTarget()=vm_38
	and vm_38.getIndex() = 0
}

predicate func_10(Function func, Literal target_10) {
	target_10.getValue()="0"
	and not target_10.getValue()="11"
	and target_10.getParent().(AssignExpr).getParent().(ExprStmt).getExpr() instanceof AssignExpr
	and target_10.getEnclosingFunction() = func
}

predicate func_11(Variable vsize_40, VariableAccess target_11) {
	target_11.getTarget()=vsize_40
	and target_11.getParent().(AssignExpr).getLValue() = target_11
	and target_11.getParent().(AssignExpr).getRValue() instanceof MulExpr
}

predicate func_12(Parameter vm_38, Parameter viov_38, Variable vsize_40, ReturnStmt target_77, VariableAccess target_12) {
	target_12.getTarget()=vsize_40
	and target_12.getParent().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=viov_38
	and target_12.getParent().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_iov"
	and target_12.getParent().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_12.getParent().(FunctionCall).getParent().(IfStmt).getThen()=target_77
}

predicate func_13(Variable vct_40, VariableAccess target_13) {
	target_13.getTarget()=vct_40
	and target_13.getParent().(AssignExpr).getLValue() = target_13
	and target_13.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

/*predicate func_14(Variable vct_40, Literal target_14) {
	target_14.getValue()="0"
	and not target_14.getValue()="22"
	and target_14.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vct_40
}

*/
predicate func_15(Parameter vm_38, Variable vct_40, BlockStmt target_78, VariableAccess target_15) {
	target_15.getTarget()=vct_40
	and target_15.getParent().(LTExpr).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="msg_iovlen"
	and target_15.getParent().(LTExpr).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_15.getParent().(LTExpr).getParent().(ForStmt).getStmt()=target_78
}

predicate func_16(Variable vct_40, VariableAccess target_16) {
	target_16.getTarget()=vct_40
}

predicate func_17(Parameter viov_38, Variable vct_40, VariableAccess target_17) {
	target_17.getTarget()=vct_40
	and target_17.getParent().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=viov_38
}

predicate func_18(Variable vlen_64, VariableAccess target_18) {
	target_18.getTarget()=vlen_64
	and target_18.getParent().(AssignExpr).getLValue() = target_18
	and target_18.getParent().(AssignExpr).getRValue() instanceof SubExpr
}

predicate func_19(Function func, Literal target_19) {
	target_19.getValue()="1"
	and not target_19.getValue()="32"
	and target_19.getParent().(RShiftExpr).getParent().(SubExpr).getLeftOperand() instanceof BinaryBitwiseOperation
	and target_19.getEnclosingFunction() = func
}

predicate func_20(Variable verr_40, VariableAccess target_20) {
	target_20.getTarget()=verr_40
}

predicate func_21(Variable verr_40, Variable vlen_64, VariableAccess target_21) {
	target_21.getTarget()=vlen_64
	and target_21.getParent().(AssignAddExpr).getRValue() = target_21
	and target_21.getParent().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=verr_40
}

predicate func_22(Variable vsize_40, IfStmt target_79, ExprStmt target_22) {
	target_22.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_40
	and target_22.getExpr().(AssignExpr).getRValue() instanceof MulExpr
	and target_22.getLocation().isBefore(target_79.getLocation())
}

predicate func_23(ForStmt target_69, Function func, ExprStmt target_23) {
	target_23.getExpr() instanceof AssignExpr
	and target_23.getLocation().isBefore(target_69.getLocation())
	and target_23.getEnclosingFunction() = func
}

predicate func_24(Variable verr_40, ForStmt target_69, ExprStmt target_24) {
	target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_40
	and target_24.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_24.getLocation().isBefore(target_69.getLocation())
}

predicate func_25(Variable verr_40) {
exists(BitwiseAndExpr target_25 |
	target_25.getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_25.getRightOperand().(Literal).getValue()="64"
	and target_25.getParent().(AssignExpr).getRValue() = target_25
	and target_25.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_40)
}

predicate func_26(BlockStmt target_75, Function func) {
exists(LogicalOrExpr target_26 |
	target_26.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_26.getLeftOperand().(BitwiseAndExpr).getRightOperand() instanceof Literal
	and target_26.getRightOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_26.getRightOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8192"
	and target_26.getParent().(IfStmt).getThen()=target_75
	and target_26.getEnclosingFunction() = func)
}

predicate func_27(Function func) {
exists(AssignExpr target_27 |
	target_27.getLValue().(VariableAccess).getType().hasName("sk_buff *")
	and target_27.getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
	and target_27.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="sk"
	and target_27.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vsock_sock *")
	and target_27.getRValue().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("int")
	and target_27.getRValue().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("int")
	and target_27.getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_27.getEnclosingFunction() = func)
}

predicate func_28(ReturnStmt target_80, Function func) {
exists(NotExpr target_28 |
	target_28.getOperand().(VariableAccess).getType().hasName("sk_buff *")
	and target_28.getParent().(IfStmt).getThen()=target_80
	and target_28.getEnclosingFunction() = func)
}

predicate func_29(RelationalOperation target_63, Function func) {
exists(ReturnStmt target_29 |
	target_29.getExpr().(UnaryMinusExpr).getValue()="-11"
	and target_29.getParent().(IfStmt).getCondition()=target_63
	and target_29.getEnclosingFunction() = func)
}

predicate func_30(Function func) {
exists(AssignExpr target_30 |
	target_30.getLValue().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_30.getRValue().(PointerFieldAccess).getTarget().getName()="data"
	and target_30.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sk_buff *")
	and target_30.getEnclosingFunction() = func)
}

predicate func_31(ReturnStmt target_77, Function func) {
exists(NotExpr target_31 |
	target_31.getOperand().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_31.getParent().(IfStmt).getThen()=target_77
	and target_31.getEnclosingFunction() = func)
}

predicate func_32(FunctionCall target_67, Function func) {
exists(GotoStmt target_32 |
	target_32.getName() ="out"
	and target_32.getParent().(IfStmt).getCondition()=target_67
	and target_32.getEnclosingFunction() = func)
}

predicate func_33(Function func) {
exists(PointerFieldAccess target_33 |
	target_33.getTarget().getName()="payload_size"
	and target_33.getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_33.getEnclosingFunction() = func)
}

predicate func_34(BlockStmt target_81, Function func) {
exists(EqualityOperation target_34 |
	target_34.getLeftOperand().(VariableAccess).getType().hasName("size_t")
	and target_34.getRightOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="len"
	and target_34.getRightOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sk_buff *")
	and target_34.getRightOperand().(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="24"
	and target_34.getParent().(IfStmt).getThen()=target_81
	and target_34.getEnclosingFunction() = func)
}

predicate func_35(Variable vsize_40) {
exists(UnaryMinusExpr target_35 |
	target_35.getValue()="-22"
	and target_35.getParent().(AssignExpr).getRValue() = target_35
	and target_35.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_40)
}

predicate func_36(PointerFieldAccess target_59, Function func) {
exists(GotoStmt target_36 |
	target_36.getName() ="out"
	and target_36.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_36
	and target_36.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
	and target_36.getEnclosingFunction() = func)
}

predicate func_37(Variable vlen_64, Function func) {
exists(IfStmt target_37 |
	target_37.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
	and target_37.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vlen_64
	and target_37.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
	and target_37.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_64
	and target_37.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
	and target_37.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_37.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_37)
}

/*predicate func_39(Variable vlen_64) {
exists(AssignExpr target_39 |
	target_39.getLValue().(VariableAccess).getType().hasName("size_t")
	and target_39.getRValue().(VariableAccess).getTarget()=vlen_64)
}

*/
/*predicate func_40(Function func) {
exists(AssignOrExpr target_40 |
	target_40.getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
	and target_40.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_40.getRValue().(Literal).getValue()="32"
	and target_40.getEnclosingFunction() = func)
}

*/
predicate func_42(Function func) {
exists(SizeofExprOperator target_42 |
	target_42.getValue()="24"
	and target_42.getEnclosingFunction() = func)
}

predicate func_44(Variable verr_40, Function func) {
exists(IfStmt target_44 |
	target_44.getCondition().(VariableAccess).getTarget()=verr_40
	and target_44.getThen().(GotoStmt).getName() ="out"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_44)
}

predicate func_45(Function func) {
exists(IfStmt target_45 |
	target_45.getCondition().(PointerFieldAccess).getTarget().getName()="msg_name"
	and target_45.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_45.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("sockaddr_vm *")
	and target_45.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="msg_name"
	and target_45.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vsock_addr_init")
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("sockaddr_vm *")
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getTarget().getName()="context"
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="src"
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="resource"
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="src"
	and target_45.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_45.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_45.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_45.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofExprOperator).getValue()="16"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_45)
}

/*predicate func_47(Function func) {
exists(AssignExpr target_47 |
	target_47.getLValue().(VariableAccess).getType().hasName("sockaddr_vm *")
	and target_47.getRValue().(PointerFieldAccess).getTarget().getName()="msg_name"
	and target_47.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_47.getEnclosingFunction() = func)
}

*/
/*predicate func_48(Function func) {
exists(FunctionCall target_48 |
	target_48.getTarget().hasName("vsock_addr_init")
	and target_48.getArgument(0).(VariableAccess).getType().hasName("sockaddr_vm *")
	and target_48.getArgument(1).(ValueFieldAccess).getTarget().getName()="context"
	and target_48.getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="src"
	and target_48.getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_48.getArgument(2).(ValueFieldAccess).getTarget().getName()="resource"
	and target_48.getArgument(2).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="src"
	and target_48.getArgument(2).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
	and target_48.getEnclosingFunction() = func)
}

*/
/*predicate func_49(PointerFieldAccess target_59, Function func) {
exists(ExprStmt target_49 |
	target_49.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
	and target_49.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("msghdr *")
	and target_49.getExpr().(AssignExpr).getRValue().(SizeofExprOperator).getValue()="16"
	and target_49.getParent().(BlockStmt).getParent().(IfStmt).getElse().(BlockStmt).getStmt(3)=target_49
	and target_49.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
	and target_49.getEnclosingFunction() = func)
}

*/
predicate func_50(Function func) {
exists(ExprStmt target_50 |
	target_50.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_50.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("size_t")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_50)
}

predicate func_51(Function func) {
exists(ExprStmt target_51 |
	target_51.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
	and target_51.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="sk"
	and target_51.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vsock_sock *")
	and target_51.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("sk_buff *")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_51)
}

predicate func_52(Variable verr_40, VariableAccess target_52) {
	target_52.getTarget()=verr_40
	and target_52.getParent().(AssignExpr).getLValue() = target_52
	and target_52.getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_54(Variable vlen_64, VariableAccess target_54) {
	target_54.getTarget()=vlen_64
	and target_54.getParent().(AssignExpr).getRValue() = target_54
	and target_54.getParent().(AssignExpr).getLValue() instanceof ValueFieldAccess
}

predicate func_55(Variable verr_40, Variable vlen_64, VariableAccess target_55) {
	target_55.getTarget()=verr_40
	and target_55.getParent().(AssignAddExpr).getLValue() = target_55
	and target_55.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vlen_64
}

predicate func_56(Variable verr_40, ReturnStmt target_80, VariableAccess target_56) {
	target_56.getTarget()=verr_40
	and target_56.getParent().(LTExpr).getGreaterOperand() instanceof Literal
	and target_56.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_80
}

predicate func_57(Variable verr_40, VariableAccess target_57) {
	target_57.getTarget()=verr_40
}

predicate func_59(Parameter vm_38, PointerFieldAccess target_59) {
	target_59.getTarget().getName()="msg_namelen"
	and target_59.getQualifier().(VariableAccess).getTarget()=vm_38
}

predicate func_60(Parameter vmode_38, BlockStmt target_76, EqualityOperation target_60) {
	target_60.getLeftOperand().(VariableAccess).getTarget()=vmode_38
	and target_60.getRightOperand() instanceof Literal
	and target_60.getParent().(IfStmt).getThen()=target_76
}

predicate func_62(Parameter vm_38, Variable vnamep_44, AssignExpr target_62) {
	target_62.getLValue().(VariableAccess).getTarget()=vnamep_44
	and target_62.getRValue().(PointerFieldAccess).getTarget().getName()="msg_name"
	and target_62.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
}

predicate func_63(Variable verr_40, ReturnStmt target_80, RelationalOperation target_63) {
	 (target_63 instanceof GTExpr or target_63 instanceof LTExpr)
	and target_63.getLesserOperand().(VariableAccess).getTarget()=verr_40
	and target_63.getGreaterOperand() instanceof Literal
	and target_63.getParent().(IfStmt).getThen()=target_80
}

predicate func_64(Parameter vm_38, Parameter vaddress_38, AssignExpr target_64) {
	target_64.getLValue().(PointerFieldAccess).getTarget().getName()="msg_name"
	and target_64.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_64.getRValue().(VariableAccess).getTarget()=vaddress_38
}

predicate func_65(Parameter vm_38, AssignExpr target_65) {
	target_65.getLValue().(PointerFieldAccess).getTarget().getName()="msg_name"
	and target_65.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_65.getRValue() instanceof Literal
}

predicate func_66(Parameter vm_38, Variable vsize_40, MulExpr target_66) {
	target_66.getLeftOperand().(PointerFieldAccess).getTarget().getName()="msg_iovlen"
	and target_66.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_66.getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_66.getRightOperand().(SizeofTypeOperator).getValue()="16"
	and target_66.getParent().(AssignExpr).getRValue() = target_66
	and target_66.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_40
}

predicate func_67(Parameter vm_38, Parameter viov_38, Variable vsize_40, ReturnStmt target_77, FunctionCall target_67) {
	target_67.getTarget().hasName("copy_from_user")
	and target_67.getArgument(0).(VariableAccess).getTarget()=viov_38
	and target_67.getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_iov"
	and target_67.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_67.getArgument(2).(VariableAccess).getTarget()=vsize_40
	and target_67.getParent().(IfStmt).getThen()=target_77
}

predicate func_68(Parameter vm_38, Parameter viov_38, AssignExpr target_68) {
	target_68.getLValue().(PointerFieldAccess).getTarget().getName()="msg_iov"
	and target_68.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_68.getRValue().(VariableAccess).getTarget()=viov_38
}

predicate func_69(Parameter vm_38, Variable vct_40, Variable verr_40, Variable vlen_64, Function func, ForStmt target_69) {
	target_69.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vct_40
	and target_69.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_69.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vct_40
	and target_69.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="msg_iovlen"
	and target_69.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vm_38
	and target_69.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vct_40
	and target_69.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vlen_64
	and target_69.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(SubExpr).getLeftOperand().(BinaryBitwiseOperation).getValue()="2147483647"
	and target_69.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=verr_40
	and target_69.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlen_64
	and target_69.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="iov_len"
	and target_69.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_64
	and target_69.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=verr_40
	and target_69.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vlen_64
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_69
}

predicate func_70(Parameter viov_38, Variable vct_40, Initializer target_70) {
	target_70.getExpr().(ValueFieldAccess).getTarget().getName()="iov_len"
	and target_70.getExpr().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=viov_38
	and target_70.getExpr().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vct_40
}

/*predicate func_71(Variable verr_40, BlockStmt target_81, SubExpr target_71) {
	target_71.getLeftOperand().(BinaryBitwiseOperation).getValue()="2147483647"
	and target_71.getRightOperand().(VariableAccess).getTarget()=verr_40
	and target_71.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_81
}

*/
/*predicate func_72(Variable verr_40, Variable vlen_64, RelationalOperation target_90, SubExpr target_72) {
	target_72.getLeftOperand().(BinaryBitwiseOperation).getValue()="2147483647"
	and target_72.getRightOperand().(VariableAccess).getTarget()=verr_40
	and target_72.getParent().(AssignExpr).getRValue() = target_72
	and target_72.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlen_64
	and target_90.getGreaterOperand().(VariableAccess).getLocation().isBefore(target_72.getParent().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

*/
/*predicate func_73(Parameter viov_38, Variable vct_40, Variable vlen_64, AssignExpr target_73) {
	target_73.getLValue().(ValueFieldAccess).getTarget().getName()="iov_len"
	and target_73.getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=viov_38
	and target_73.getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vct_40
	and target_73.getRValue().(VariableAccess).getTarget()=vlen_64
}

*/
/*predicate func_74(Variable verr_40, Variable vlen_64, AssignAddExpr target_74) {
	target_74.getLValue().(VariableAccess).getTarget()=verr_40
	and target_74.getRValue().(VariableAccess).getTarget()=vlen_64
}

*/
predicate func_75(Variable verr_40, BlockStmt target_75) {
	target_75.getStmt(0).(IfStmt).getCondition() instanceof EqualityOperation
	and target_75.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof AssignExpr
	and target_75.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_40
	and target_75.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and target_75.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition() instanceof RelationalOperation
	and target_75.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=verr_40
}

predicate func_76(Variable verr_40, BlockStmt target_76) {
	target_76.getStmt(1).(ExprStmt).getExpr() instanceof AssignExpr
	and target_76.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_40
	and target_76.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and target_76.getStmt(3).(IfStmt).getCondition() instanceof RelationalOperation
	and target_76.getStmt(3).(IfStmt).getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=verr_40
}

predicate func_77(Function func, ReturnStmt target_77) {
	target_77.getExpr() instanceof UnaryMinusExpr
	and target_77.getEnclosingFunction() = func
}

predicate func_78(Variable vlen_64, BlockStmt target_78) {
	target_78.getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vlen_64
	and target_78.getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand() instanceof SubExpr
	and target_78.getStmt(1).(IfStmt).getThen() instanceof BlockStmt
	and target_78.getStmt(2).(ExprStmt).getExpr() instanceof AssignAddExpr
}

predicate func_79(Function func, IfStmt target_79) {
	target_79.getCondition() instanceof FunctionCall
	and target_79.getThen().(ReturnStmt).getExpr() instanceof UnaryMinusExpr
	and target_79.getEnclosingFunction() = func
}

predicate func_80(Variable verr_40, RelationalOperation target_63, ReturnStmt target_80) {
	target_80.getExpr().(VariableAccess).getTarget()=verr_40
	and target_80.getParent().(IfStmt).getCondition()=target_63
}

predicate func_81(Variable vlen_64, BlockStmt target_81) {
	target_81.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlen_64
	and target_81.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof SubExpr
	and target_81.getStmt(1).(ExprStmt).getExpr() instanceof AssignExpr
}

predicate func_90(Variable vlen_64, RelationalOperation target_90) {
	 (target_90 instanceof GTExpr or target_90 instanceof LTExpr)
	and target_90.getGreaterOperand().(VariableAccess).getTarget()=vlen_64
	and target_90.getLesserOperand() instanceof SubExpr
}

from Function func, Parameter vm_38, Parameter viov_38, Parameter vaddress_38, Parameter vmode_38, Variable vsize_40, Variable vct_40, Variable verr_40, Variable vnamep_44, Variable vlen_64, VariableAccess target_0, UnaryMinusExpr target_2, VariableAccess target_3, VariableAccess target_4, FunctionCall target_6, Literal target_8, VariableAccess target_9, Literal target_10, VariableAccess target_11, VariableAccess target_12, VariableAccess target_13, VariableAccess target_15, VariableAccess target_16, VariableAccess target_17, VariableAccess target_18, Literal target_19, VariableAccess target_20, VariableAccess target_21, ExprStmt target_22, ExprStmt target_23, ExprStmt target_24, VariableAccess target_52, VariableAccess target_54, VariableAccess target_55, VariableAccess target_56, VariableAccess target_57, PointerFieldAccess target_59, EqualityOperation target_60, AssignExpr target_62, RelationalOperation target_63, AssignExpr target_64, AssignExpr target_65, MulExpr target_66, FunctionCall target_67, AssignExpr target_68, ForStmt target_69, Initializer target_70, BlockStmt target_75, BlockStmt target_76, ReturnStmt target_77, BlockStmt target_78, IfStmt target_79, ReturnStmt target_80, BlockStmt target_81, RelationalOperation target_90
where
func_0(vm_38, target_0)
and func_2(func, target_2)
and func_3(vm_38, target_75, target_3)
and func_4(vmode_38, target_76, target_4)
and func_6(vm_38, vaddress_38, verr_40, vnamep_44, target_6)
and func_8(func, target_8)
and func_9(vm_38, target_9)
and func_10(func, target_10)
and func_11(vsize_40, target_11)
and func_12(vm_38, viov_38, vsize_40, target_77, target_12)
and func_13(vct_40, target_13)
and func_15(vm_38, vct_40, target_78, target_15)
and func_16(vct_40, target_16)
and func_17(viov_38, vct_40, target_17)
and func_18(vlen_64, target_18)
and func_19(func, target_19)
and func_20(verr_40, target_20)
and func_21(verr_40, vlen_64, target_21)
and func_22(vsize_40, target_79, target_22)
and func_23(target_69, func, target_23)
and func_24(verr_40, target_69, target_24)
and not func_25(verr_40)
and not func_26(target_75, func)
and not func_27(func)
and not func_28(target_80, func)
and not func_29(target_63, func)
and not func_30(func)
and not func_31(target_77, func)
and not func_32(target_67, func)
and not func_33(func)
and not func_34(target_81, func)
and not func_35(vsize_40)
and not func_36(target_59, func)
and not func_37(vlen_64, func)
and not func_42(func)
and not func_44(verr_40, func)
and not func_45(func)
and not func_50(func)
and not func_51(func)
and func_52(verr_40, target_52)
and func_54(vlen_64, target_54)
and func_55(verr_40, vlen_64, target_55)
and func_56(verr_40, target_80, target_56)
and func_57(verr_40, target_57)
and func_59(vm_38, target_59)
and func_60(vmode_38, target_76, target_60)
and func_62(vm_38, vnamep_44, target_62)
and func_63(verr_40, target_80, target_63)
and func_64(vm_38, vaddress_38, target_64)
and func_65(vm_38, target_65)
and func_66(vm_38, vsize_40, target_66)
and func_67(vm_38, viov_38, vsize_40, target_77, target_67)
and func_68(vm_38, viov_38, target_68)
and func_69(vm_38, vct_40, verr_40, vlen_64, func, target_69)
and func_70(viov_38, vct_40, target_70)
and func_75(verr_40, target_75)
and func_76(verr_40, target_76)
and func_77(func, target_77)
and func_78(vlen_64, target_78)
and func_79(func, target_79)
and func_80(verr_40, target_63, target_80)
and func_81(vlen_64, target_81)
and func_90(vlen_64, target_90)
and vm_38.getType().hasName("msghdr *")
and viov_38.getType().hasName("iovec *")
and vaddress_38.getType().hasName("__kernel_sockaddr_storage *")
and vmode_38.getType().hasName("int")
and vsize_40.getType().hasName("int")
and vct_40.getType().hasName("int")
and verr_40.getType().hasName("int")
and vnamep_44.getType().hasName("void *")
and vlen_64.getType().hasName("size_t")
and vm_38.getFunction() = func
and viov_38.getFunction() = func
and vaddress_38.getFunction() = func
and vmode_38.getFunction() = func
and vsize_40.(LocalVariable).getFunction() = func
and vct_40.(LocalVariable).getFunction() = func
and verr_40.(LocalVariable).getFunction() = func
and vnamep_44.(LocalVariable).getFunction() = func
and vlen_64.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
