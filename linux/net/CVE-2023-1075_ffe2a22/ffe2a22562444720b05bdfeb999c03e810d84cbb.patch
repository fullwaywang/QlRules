commit ffe2a22562444720b05bdfeb999c03e810d84cbb
Author: Pietro Borrello <borrello@diag.uniroma1.it>
Date:   Sat Jan 28 16:29:17 2023 +0000

    net/tls: tls_is_tx_ready() checked list_entry
    
    tls_is_tx_ready() checks that list_first_entry() does not return NULL.
    This condition can never happen. For empty lists, list_first_entry()
    returns the list_entry() of the head, which is a type confusion.
    Use list_first_entry_or_null() which returns NULL in case of empty
    lists.
    
    Fixes: a42055e8d2c3 ("net/tls: Add support for async encryption of records for performance")
    Signed-off-by: Pietro Borrello <borrello@diag.uniroma1.it>
    Link: https://lore.kernel.org/r/20230128-list-entry-null-check-tls-v1-1-525bbfe6f0d0@diag.uniroma1.it
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

diff --git a/net/tls/tls_sw.c b/net/tls/tls_sw.c
index 9ed978634125..a83d2b4275fa 100644
--- a/net/tls/tls_sw.c
+++ b/net/tls/tls_sw.c
@@ -2427,7 +2427,7 @@ static bool tls_is_tx_ready(struct tls_sw_context_tx *ctx)
 {
 	struct tls_rec *rec;
 
-	rec = list_first_entry(&ctx->tx_list, struct tls_rec, list);
+	rec = list_first_entry_or_null(&ctx->tx_list, struct tls_rec, list);
 	if (!rec)
 		return false;
 
