/**
 * @name openssl-7d56a74a96828985db7354a55227a511615f732b-rc4_hmac_md5_set_ctx_params
 * @id cpp/openssl/7d56a74a96828985db7354a55227a511615f732b/rc4-hmac-md5-set-ctx-params
 * @description openssl-7d56a74a96828985db7354a55227a511615f732b-providers/implementations/ciphers/cipher_rc4_hmac_md5.c-rc4_hmac_md5_set_ctx_params CVE-2022-1434
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func) {
    exists(StringLiteral target_0 |
		target_0.getValue()="tlsaad"
		and target_0.getEnclosingFunction() = func)
}

predicate func_1(Function func, StringLiteral target_1) {
		target_1.getValue()="mackey"
		and target_1.getEnclosingFunction() = func
}

from Function func, StringLiteral target_0
where
not func_0(func)
and func_1(func, target_0)
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
