commit 3f621455d62e46745453568d915badd5b1e5bcd5
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Sun Jan 28 02:46:56 2018 +0100

    avfilter/vf_transpose: Fix regression with packed pixel formats
    
    Regression since: c6939f65a116b1ffed345d29d8621ee4ffb32235
    Found-by: Paul B Mahol <onemda@gmail.com>
    Reviewed-by: Paul B Mahol <onemda@gmail.com>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavfilter/vf_transpose.c b/libavfilter/vf_transpose.c
index 1e1a5c4b89..3ff4cb4249 100644
--- a/libavfilter/vf_transpose.c
+++ b/libavfilter/vf_transpose.c
@@ -217,7 +217,7 @@ static int config_props_output(AVFilterLink *outlink)
 
     s->hsub = desc_in->log2_chroma_w;
     s->vsub = desc_in->log2_chroma_h;
-    s->planes = desc_in->nb_components;
+    s->planes = av_pix_fmt_count_planes(outlink->format);
 
     av_assert0(desc_in->nb_components == desc_out->nb_components);
 
