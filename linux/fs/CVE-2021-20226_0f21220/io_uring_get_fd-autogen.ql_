/**
 * @name linux-0f2122045b946241a9e549c2a76cea54fa58a7ff-io_uring_get_fd
 * @id cpp/linux/0f2122045b946241a9e549c2a76cea54fa58a7ff/io-uring-get-fd
 * @description linux-0f2122045b946241a9e549c2a76cea54fa58a7ff-fs/io_uring.c-io_uring_get_fd CVE-2021-20194
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vret_8577, VariableAccess target_0) {
	target_0.getTarget()=vret_8577
}

predicate func_1(Parameter vctx_8574, Variable vret_8577, Variable vinit_net, VariableAccess target_1) {
	target_1.getTarget()=vret_8577
	and target_1.getParent().(AssignExpr).getLValue() = target_1
	and target_1.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("sock_create_kern")
	and target_1.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vinit_net
	and target_1.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
	and target_1.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="ring_sock"
	and target_1.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
}

/*predicate func_2(Parameter vctx_8574, Variable vret_8577, Variable vinit_net, FunctionCall target_2) {
	target_2.getTarget().hasName("sock_create_kern")
	and not target_2.getTarget().hasName("list_empty")
	and target_2.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vinit_net
	and target_2.getArgument(1) instanceof Literal
	and target_2.getArgument(4).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="ring_sock"
	and target_2.getArgument(4).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_2.getParent().(AssignExpr).getRValue() = target_2
	and target_2.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_8577
}

*/
predicate func_3(Variable vret_8577, ReturnStmt target_67, VariableAccess target_3) {
	target_3.getTarget()=vret_8577
	and target_3.getParent().(IfStmt).getThen()=target_67
}

predicate func_4(Variable vret_8577, VariableAccess target_4) {
	target_4.getTarget()=vret_8577
	and target_4.getParent().(AssignExpr).getLValue() = target_4
	and target_4.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("get_unused_fd_flags")
	and target_4.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="524290"
}

/*predicate func_5(Variable vret_8577, FunctionCall target_5) {
	target_5.getTarget().hasName("get_unused_fd_flags")
	and not target_5.getTarget().hasName("io_init_req")
	and target_5.getArgument(0).(BitwiseOrExpr).getValue()="524290"
	and target_5.getParent().(AssignExpr).getRValue() = target_5
	and target_5.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_8577
}

*/
predicate func_6(Function func, Literal target_6) {
	target_6.getValue()="2"
	and not target_6.getValue()="0"
	and target_6.getParent().(BitwiseOrExpr).getParent().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="524290"
	and target_6.getEnclosingFunction() = func
}

predicate func_7(Function func, Literal target_7) {
	target_7.getValue()="524288"
	and not target_7.getValue()="0"
	and target_7.getParent().(BitwiseOrExpr).getParent().(FunctionCall).getArgument(0).(BitwiseOrExpr).getValue()="524290"
	and target_7.getEnclosingFunction() = func
}

predicate func_8(Variable vret_8577, VariableAccess target_8) {
	target_8.getTarget()=vret_8577
	and target_8.getParent().(LTExpr).getGreaterOperand() instanceof Literal
	and target_8.getParent().(LTExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_9(Function func, Literal target_9) {
	target_9.getValue()="2"
	and not target_9.getValue()="0"
	and target_9.getParent().(BitwiseOrExpr).getParent().(FunctionCall).getArgument(3) instanceof BitwiseOrExpr
	and target_9.getEnclosingFunction() = func
}

predicate func_10(Function func, Literal target_10) {
	target_10.getValue()="524288"
	and not target_10.getValue()="0"
	and target_10.getParent().(BitwiseOrExpr).getParent().(FunctionCall).getArgument(3) instanceof BitwiseOrExpr
	and target_10.getEnclosingFunction() = func
}

predicate func_11(Variable vfile_8576, BlockStmt target_68, FunctionCall target_11) {
	target_11.getTarget().hasName("IS_ERR")
	and not target_11.getTarget().hasName("test_bit")
	and target_11.getArgument(0).(VariableAccess).getTarget()=vfile_8576
	and target_11.getParent().(IfStmt).getThen()=target_68
}

predicate func_12(Variable vret_8577, FunctionCall target_12) {
	target_12.getTarget().hasName("put_unused_fd")
	and not target_12.getTarget().hasName("io_submit_state_start")
	and target_12.getArgument(0).(VariableAccess).getTarget()=vret_8577
}

predicate func_13(Variable vfile_8576, Variable vret_8577, VariableAccess target_13) {
	target_13.getTarget()=vret_8577
	and target_13.getParent().(AssignExpr).getLValue() = target_13
	and target_13.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("PTR_ERR")
	and target_13.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vfile_8576
}

/*predicate func_14(Variable vfile_8576, Variable vret_8577, FunctionCall target_14) {
	target_14.getTarget().hasName("PTR_ERR")
	and not target_14.getTarget().hasName("__builtin_expect")
	and target_14.getArgument(0).(VariableAccess).getTarget()=vfile_8576
	and target_14.getParent().(AssignExpr).getRValue() = target_14
	and target_14.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_8577
}

*/
predicate func_15(Variable vfile_8576, Variable vret_8577, FunctionCall target_15) {
	target_15.getTarget().hasName("fd_install")
	and not target_15.getTarget().hasName("io_consume_sqe")
	and target_15.getArgument(0).(VariableAccess).getTarget()=vret_8577
	and target_15.getArgument(1).(VariableAccess).getTarget()=vfile_8576
}

predicate func_16(Variable vret_8577, VariableAccess target_16) {
	target_16.getTarget()=vret_8577
}

predicate func_17(Parameter vctx_8574, FunctionCall target_17) {
	target_17.getTarget().hasName("sock_release")
	and not target_17.getTarget().hasName("io_consume_sqe")
	and target_17.getArgument(0).(PointerFieldAccess).getTarget().getName()="ring_sock"
	and target_17.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
}

predicate func_18(Variable vret_8577, VariableAccess target_18) {
	target_18.getTarget()=vret_8577
}

predicate func_20(Parameter vctx_8574, Variable vfile_8576, BlockStmt target_68) {
exists(AddressOfExpr target_20 |
	target_20.getOperand().(ValueFieldAccess).getTarget().getName()="sq_check_overflow"
	and target_20.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_20.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_20.getParent().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vfile_8576
	and target_20.getParent().(FunctionCall).getParent().(IfStmt).getThen()=target_68)
}

predicate func_21(Parameter vctx_8574, BlockStmt target_68) {
exists(LogicalAndExpr target_21 |
	target_21.getLeftOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("list_empty")
	and target_21.getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="cq_overflow_list"
	and target_21.getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_21.getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_21.getRightOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("io_cqring_overflow_flush")
	and target_21.getRightOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_21.getRightOperand().(NotExpr).getOperand().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_21.getRightOperand().(NotExpr).getOperand().(FunctionCall).getArgument(3).(Literal).getValue()="0"
	and target_21.getParent().(IfStmt).getThen()=target_68)
}

/*predicate func_22(Parameter vctx_8574) {
exists(AddressOfExpr target_22 |
	target_22.getOperand().(ValueFieldAccess).getTarget().getName()="cq_overflow_list"
	and target_22.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_22.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_22.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall)
}

*/
predicate func_23(Function func) {
exists(UnaryMinusExpr target_23 |
	target_23.getValue()="-16"
	and target_23.getEnclosingFunction() = func)
}

predicate func_24(Parameter vctx_8574) {
exists(AssignExpr target_24 |
	target_24.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(ValueFieldAccess).getTarget().getName()="sq_entries"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(FunctionCall).getTarget().hasName("io_sqring_entries")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getTarget().getName()="sq_entries"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(ValueFieldAccess).getTarget().getName()="sq_entries"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("io_sqring_entries")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_24.getRValue().(BuiltInChooseExpr).getChild(2).(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getRValue().(BuiltInChooseExpr).getChild(2).(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getElse().(VariableAccess).getType().hasName("unsigned int"))
}

predicate func_26(Parameter vctx_8574) {
exists(ValueFieldAccess target_26 |
	target_26.getTarget().getName()="sq_entries"
	and target_26.getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_26.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574)
}

predicate func_27(Function func) {
exists(ConditionalExpr target_27 |
	target_27.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_27.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_27.getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_27.getElse().(VariableAccess).getType().hasName("unsigned int")
	and target_27.getEnclosingFunction() = func)
}

/*predicate func_28(Function func) {
exists(ConditionalExpr target_28 |
	target_28.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_28.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_28.getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_28.getElse().(VariableAccess).getType().hasName("unsigned int")
	and target_28.getEnclosingFunction() = func)
}

*/
predicate func_29(Parameter vctx_8574) {
exists(NotExpr target_29 |
	target_29.getOperand().(FunctionCall).getTarget().hasName("percpu_ref_tryget_many")
	and target_29.getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="refs"
	and target_29.getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_29.getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_29.getOperand().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("unsigned int")
	and target_29.getParent().(IfStmt).getThen() instanceof GotoStmt)
}

predicate func_30(Function func) {
exists(UnaryMinusExpr target_30 |
	target_30.getValue()="-11"
	and target_30.getEnclosingFunction() = func)
}

predicate func_31(Function func) {
exists(AddressOfExpr target_31 |
	target_31.getOperand().(VariableAccess).getType().hasName("io_submit_state")
	and target_31.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_31.getEnclosingFunction() = func)
}

predicate func_34(Parameter vctx_8574, IfStmt target_70, Function func) {
exists(ForStmt target_34 |
	target_34.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_34.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_34.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_34.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_34.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("const io_uring_sqe *")
	and target_34.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("io_get_sqe")
	and target_34.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(4).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_34.getStmt().(BlockStmt).getStmt(4).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_34.getStmt().(BlockStmt).getStmt(4).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("io_consume_sqe")
	and target_34.getStmt().(BlockStmt).getStmt(4).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("io_alloc_req")
	and target_34.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("io_submit_state")
	and target_34.getStmt().(BlockStmt).getStmt(6).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_34.getStmt().(BlockStmt).getStmt(6).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_34.getStmt().(BlockStmt).getStmt(6).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(NotExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("io_init_req")
	and target_34.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("const io_uring_sqe *")
	and target_34.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("io_submit_state")
	and target_34.getStmt().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("io_consume_sqe")
	and target_34.getStmt().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(0) instanceof LabelStmt
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("io_put_req")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("io_req_complete")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("trace_io_uring_submit_sqe")
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="opcode"
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="user_data"
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(4).(FunctionCall).getTarget().hasName("io_async_submit")
	and target_34.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getArgument(4).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and target_34.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("io_submit_sqe")
	and target_34.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("const io_uring_sqe *")
	and target_34.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("io_kiocb *")
	and target_34.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="comp"
	and target_34.getStmt().(BlockStmt).getStmt(13).(IfStmt).getCondition().(VariableAccess).getType().hasName("int")
	and target_34.getStmt().(BlockStmt).getStmt(13).(IfStmt).getThen().(GotoStmt).getName() ="fail_req"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_34
	and target_34.getLocation().isBefore(target_70.getLocation()))
}

/*predicate func_35(Function func) {
exists(NotExpr target_35 |
	target_35.getOperand().(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("const io_uring_sqe *")
	and target_35.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_35.getEnclosingFunction() = func)
}

*/
/*predicate func_38(Variable vret_8577) {
exists(UnaryMinusExpr target_38 |
	target_38.getValue()="-11"
	and target_38.getParent().(AssignExpr).getRValue() = target_38
	and target_38.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_8577)
}

*/
/*predicate func_43(Function func) {
exists(AddressOfExpr target_43 |
	target_43.getOperand().(VariableAccess).getType().hasName("io_submit_state")
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_43.getEnclosingFunction() = func)
}

*/
/*predicate func_45(Function func) {
exists(PostfixIncrExpr target_45 |
	target_45.getOperand().(VariableAccess).getType().hasName("int")
	and target_45.getEnclosingFunction() = func)
}

*/
/*predicate func_46(Function func) {
exists(FunctionCall target_46 |
	target_46.getTarget().hasName("io_put_req")
	and target_46.getArgument(0).(VariableAccess).getType().hasName("io_kiocb *")
	and target_46.getEnclosingFunction() = func)
}

*/
/*predicate func_47(Function func) {
exists(AssignExpr target_47 |
	target_47.getLValue().(VariableAccess).getType().hasName("int")
	and target_47.getRValue().(FunctionCall).getTarget().hasName("io_submit_sqe")
	and target_47.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("io_kiocb *")
	and target_47.getRValue().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("const io_uring_sqe *")
	and target_47.getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("io_kiocb *")
	and target_47.getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="comp"
	and target_47.getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_submit_state")
	and target_47.getEnclosingFunction() = func)
}

*/
predicate func_48(IfStmt target_70, Function func) {
exists(IfStmt target_48 |
	target_48.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_48.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_48.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getRightOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_48.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("percpu_ref_put_many")
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="refs"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(SubExpr).getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_48.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(SubExpr).getRightOperand().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
	and target_48.getLocation().isBefore(target_70.getLocation()))
}

predicate func_49(IfStmt target_70, Function func) {
exists(IfStmt target_49 |
	target_49.getCondition().(VariableAccess).getType().hasName("io_kiocb *")
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("io_queue_link_head")
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("io_kiocb *")
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="comp"
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("io_submit_state")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
	and target_49.getLocation().isBefore(target_70.getLocation()))
}

predicate func_50(IfStmt target_70, Function func) {
exists(ExprStmt target_50 |
	target_50.getExpr().(FunctionCall).getTarget().hasName("io_submit_state_end")
	and target_50.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("io_submit_state")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_50
	and target_50.getLocation().isBefore(target_70.getLocation()))
}

predicate func_51(Parameter vctx_8574, IfStmt target_70, Function func) {
exists(ExprStmt target_51 |
	target_51.getExpr().(FunctionCall).getTarget().hasName("io_commit_sqring")
	and target_51.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_8574
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
	and target_51.getLocation().isBefore(target_70.getLocation()))
}

predicate func_52(Parameter vctx_8574, VariableAccess target_52) {
	target_52.getTarget()=vctx_8574
	and target_52.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_53(Parameter vctx_8574, VariableAccess target_53) {
	target_53.getTarget()=vctx_8574
}

predicate func_54(Parameter vctx_8574, VariableAccess target_54) {
	target_54.getTarget()=vctx_8574
	and target_54.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_55(Parameter vctx_8574, VariableAccess target_55) {
	target_55.getTarget()=vctx_8574
}

predicate func_59(Parameter vctx_8574, VariableAccess target_59) {
	target_59.getTarget()=vctx_8574
	and target_59.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_61(Variable vinit_net, VariableAccess target_61) {
	target_61.getTarget()=vinit_net
	and target_61.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_62(Parameter vctx_8574, PointerFieldAccess target_62) {
	target_62.getTarget().getName()="ring_sock"
	and target_62.getQualifier().(VariableAccess).getTarget()=vctx_8574
}

predicate func_63(Parameter vctx_8574, Variable vfile_8576, Variable vio_uring_fops, AssignExpr target_63) {
	target_63.getLValue().(VariableAccess).getTarget()=vfile_8576
	and target_63.getRValue().(FunctionCall).getTarget().hasName("anon_inode_getfile")
	and target_63.getRValue().(FunctionCall).getArgument(0).(StringLiteral).getValue()="[io_uring]"
	and target_63.getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vio_uring_fops
	and target_63.getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vctx_8574
	and target_63.getRValue().(FunctionCall).getArgument(3).(BitwiseOrExpr).getValue()="524290"
}

predicate func_64(FunctionCall target_11, Function func, GotoStmt target_64) {
	target_64.getName() ="err"
	and target_64.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
	and target_64.getEnclosingFunction() = func
}

predicate func_65(Parameter vctx_8574, Variable vfile_8576, AssignExpr target_65) {
	target_65.getLValue().(PointerFieldAccess).getTarget().getName()="file"
	and target_65.getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ring_sock"
	and target_65.getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_65.getRValue().(VariableAccess).getTarget()=vfile_8576
}

predicate func_66(Parameter vctx_8574, AssignExpr target_66) {
	target_66.getLValue().(PointerFieldAccess).getTarget().getName()="ring_sock"
	and target_66.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_8574
	and target_66.getRValue() instanceof Literal
}

predicate func_67(Variable vret_8577, ReturnStmt target_67) {
	target_67.getExpr().(VariableAccess).getTarget()=vret_8577
}

predicate func_68(Variable vret_8577, BlockStmt target_68) {
	target_68.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_68.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_8577
	and target_68.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and target_68.getStmt(2) instanceof GotoStmt
}

predicate func_70(Variable vret_8577, IfStmt target_70) {
	target_70.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vret_8577
	and target_70.getCondition().(RelationalOperation).getGreaterOperand() instanceof Literal
	and target_70.getThen().(GotoStmt).getName() ="err"
}

from Function func, Parameter vctx_8574, Variable vfile_8576, Variable vret_8577, Variable vinit_net, Variable vio_uring_fops, VariableAccess target_0, VariableAccess target_1, VariableAccess target_3, VariableAccess target_4, Literal target_6, Literal target_7, VariableAccess target_8, Literal target_9, Literal target_10, FunctionCall target_11, FunctionCall target_12, VariableAccess target_13, FunctionCall target_15, VariableAccess target_16, FunctionCall target_17, VariableAccess target_18, VariableAccess target_52, VariableAccess target_53, VariableAccess target_54, VariableAccess target_55, VariableAccess target_59, VariableAccess target_61, PointerFieldAccess target_62, AssignExpr target_63, GotoStmt target_64, AssignExpr target_65, AssignExpr target_66, ReturnStmt target_67, BlockStmt target_68, IfStmt target_70
where
func_0(vret_8577, target_0)
and func_1(vctx_8574, vret_8577, vinit_net, target_1)
and func_3(vret_8577, target_67, target_3)
and func_4(vret_8577, target_4)
and func_6(func, target_6)
and func_7(func, target_7)
and func_8(vret_8577, target_8)
and func_9(func, target_9)
and func_10(func, target_10)
and func_11(vfile_8576, target_68, target_11)
and func_12(vret_8577, target_12)
and func_13(vfile_8576, vret_8577, target_13)
and func_15(vfile_8576, vret_8577, target_15)
and func_16(vret_8577, target_16)
and func_17(vctx_8574, target_17)
and func_18(vret_8577, target_18)
and not func_20(vctx_8574, vfile_8576, target_68)
and not func_21(vctx_8574, target_68)
and not func_23(func)
and not func_24(vctx_8574)
and not func_26(vctx_8574)
and not func_27(func)
and not func_29(vctx_8574)
and not func_30(func)
and not func_31(func)
and not func_34(vctx_8574, target_70, func)
and not func_48(target_70, func)
and not func_49(target_70, func)
and not func_50(target_70, func)
and not func_51(vctx_8574, target_70, func)
and func_52(vctx_8574, target_52)
and func_53(vctx_8574, target_53)
and func_54(vctx_8574, target_54)
and func_55(vctx_8574, target_55)
and func_59(vctx_8574, target_59)
and func_61(vinit_net, target_61)
and func_62(vctx_8574, target_62)
and func_63(vctx_8574, vfile_8576, vio_uring_fops, target_63)
and func_64(target_11, func, target_64)
and func_65(vctx_8574, vfile_8576, target_65)
and func_66(vctx_8574, target_66)
and func_67(vret_8577, target_67)
and func_68(vret_8577, target_68)
and func_70(vret_8577, target_70)
and vctx_8574.getType().hasName("io_ring_ctx *")
and vfile_8576.getType().hasName("file *")
and vret_8577.getType().hasName("int")
and vinit_net.getType().hasName("net")
and vio_uring_fops.getType().hasName("const file_operations")
and vctx_8574.getFunction() = func
and vfile_8576.(LocalVariable).getFunction() = func
and vret_8577.(LocalVariable).getFunction() = func
and not vinit_net.getParentScope+() = func
and not vio_uring_fops.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
