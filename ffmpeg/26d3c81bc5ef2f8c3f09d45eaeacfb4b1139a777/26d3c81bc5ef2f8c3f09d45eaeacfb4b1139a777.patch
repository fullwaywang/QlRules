commit 26d3c81bc5ef2f8c3f09d45eaeacfb4b1139a777
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Tue May 25 19:29:18 2021 +0200

    avcodec/exr: More strictly check dc_count
    
    Fixes: out of array access
    Fixes: exr/deneme
    
    Found-by: Burak Çarıkçı <burakcarikci@crypttech.com>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/exr.c b/libavcodec/exr.c
index 9377a89169..4648ed7d62 100644
--- a/libavcodec/exr.c
+++ b/libavcodec/exr.c
@@ -1059,11 +1059,11 @@ static int dwa_uncompress(EXRContext *s, const uint8_t *src, int compressed_size
         bytestream2_skip(&gb, ac_size);
     }
 
-    if (dc_size > 0) {
+    {
         unsigned long dest_len = dc_count * 2LL;
         GetByteContext agb = gb;
 
-        if (dc_count > (6LL * td->xsize * td->ysize + 63) / 64)
+        if (dc_count != dc_w * dc_h * 3)
             return AVERROR_INVALIDDATA;
 
         av_fast_padded_malloc(&td->dc_data, &td->dc_size, FFALIGN(dest_len, 64) * 2);
