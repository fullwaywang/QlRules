/**
 * @name linux-158b515f703e75e7d68289bf4d98c664e1d632df-tun_set_iff
 * @id cpp/linux/158b515f703e75e7d68289bf4d98c664e1d632df/tun-set-iff
 * @description linux-158b515f703e75e7d68289bf4d98c664e1d632df-drivers/net/tun.c-tun_set_iff CVE-2022-4744
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, SizeofTypeOperator target_0) {
	target_0.getType() instanceof LongType
	and target_0.getValue()="10712"
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Variable vdev_2613, FunctionCall target_1) {
	target_1.getTarget().hasName("tun_net_init")
	and not target_1.getTarget().hasName("tun_net_initialize")
	and target_1.getArgument(0).(VariableAccess).getTarget()=vdev_2613
}

predicate func_2(DoStmt target_31, Function func, IfStmt target_2) {
	target_2.getCondition() instanceof NotExpr
	and target_2.getThen() instanceof BlockStmt
	and target_2.getLocation().isBefore(target_31.getLocation())
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Parameter vifr_2609, Variable vtun_2611, AddressOfExpr target_51) {
exists(AssignExpr target_3 |
	target_3.getLValue().(PointerFieldAccess).getTarget().getName()="ifr"
	and target_3.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and target_3.getRValue().(VariableAccess).getTarget()=vifr_2609
	and target_3.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_51.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_4(Parameter vfile_2609, Variable vtun_2611, ExprStmt target_36) {
exists(AssignExpr target_4 |
	target_4.getLValue().(PointerFieldAccess).getTarget().getName()="file"
	and target_4.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and target_4.getRValue().(VariableAccess).getTarget()=vfile_2609
	and target_4.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_5(Variable verr_2614, RelationalOperation target_5) {
	 (target_5 instanceof GTExpr or target_5 instanceof LTExpr)
	and target_5.getLesserOperand().(VariableAccess).getTarget()=verr_2614
	and target_5.getGreaterOperand().(Literal).getValue()="0"
	and target_5.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_6(Variable vdev_2613, Function func, ExprStmt target_6) {
	target_6.getExpr().(FunctionCall).getTarget().hasName("free_netdev")
	and target_6.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdev_2613
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_6
}

predicate func_7(Variable verr_2614, Function func, ReturnStmt target_7) {
	target_7.getExpr().(VariableAccess).getTarget()=verr_2614
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_7
}

predicate func_8(Variable vtun_2611, VariableAccess target_8) {
	target_8.getTarget()=vtun_2611
	and target_8.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(FunctionCall).getArgument(0) instanceof FunctionCall
}

predicate func_9(Variable vtun_2611, VariableAccess target_9) {
	target_9.getTarget()=vtun_2611
	and target_9.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_10(Parameter vifr_2609, VariableAccess target_10) {
	target_10.getTarget()=vifr_2609
}

predicate func_11(Parameter vfile_2609, VariableAccess target_11) {
	target_11.getTarget()=vfile_2609
	and target_11.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_12(Variable vdev_2613, Variable vpcpu_stats_2719, AssignExpr target_12) {
	target_12.getLValue().(ValueFieldAccess).getTarget().getName()="tstats"
	and target_12.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_12.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getTarget()=vpcpu_stats_2719
	and target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=vpcpu_stats_2719
}

/*predicate func_14(Variable vnr_cpu_ids, Variable vstat_2719, Variable vpcpu_stats_2719, Variable v__cpu_2719, IfStmt target_14) {
	target_14.getCondition().(VariableAccess).getTarget()=vpcpu_stats_2719
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cpumask_next")
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=v__cpu_2719
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__cpu_2719
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vnr_cpu_ids
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstat_2719
	and target_14.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
}

*/
predicate func_15(VariableAccess target_52, Function func, DeclStmt target_15) {
	target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_52
	and target_15.getEnclosingFunction() = func
}

/*predicate func_16(Variable vnr_cpu_ids, Variable vstat_2719, Variable v__cpu_2719, Variable v__cpu_possible_mask, VariableAccess target_52, ForStmt target_16) {
	target_16.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
	and target_16.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_16.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__cpu_2719
	and target_16.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cpumask_next")
	and target_16.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=v__cpu_2719
	and target_16.getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__cpu_possible_mask
	and target_16.getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__cpu_2719
	and target_16.getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vnr_cpu_ids
	and target_16.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstat_2719
	and target_16.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
	and target_16.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="syncp"
	and target_16.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vstat_2719
	and target_16.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_52
}

*/
/*predicate func_18(Variable vstat_2719, ExprStmt target_18) {
	target_18.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstat_2719
	and target_18.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
}

*/
/*predicate func_19(Variable v__vpp_verify_2719, DoStmt target_19) {
	target_19.getCondition().(Literal).getValue()="0"
	and target_19.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__vpp_verify_2719
}

*/
/*predicate func_21(Variable v__vpp_verify_2719, ExprStmt target_21) {
	target_21.getExpr().(VariableAccess).getTarget()=v__vpp_verify_2719
}

*/
/*predicate func_22(Variable v__ptr_2719, Variable v__per_cpu_offset, Variable vpcpu_stats_2719, Variable v__cpu_2719, ExprStmt target_22) {
	target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ptr_2719
	and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(VariableAccess).getTarget()=vpcpu_stats_2719
	and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=v__ptr_2719
	and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
	and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=v__cpu_2719
}

*/
/*predicate func_24(Variable v__ptr_2719, Variable vpcpu_stats_2719, AsmStmt target_24) {
	target_24.getChild(0).(VariableAccess).getTarget()=v__ptr_2719
	and target_24.getChild(1).(VariableAccess).getTarget()=vpcpu_stats_2719
}

*/
/*predicate func_25(Variable v__ptr_2719, Variable v__per_cpu_offset, Variable v__cpu_2719, ExprStmt target_25) {
	target_25.getExpr().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=v__ptr_2719
	and target_25.getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
	and target_25.getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=v__cpu_2719
}

*/
/*predicate func_26(Variable vstat_2719, ExprStmt target_26) {
	target_26.getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
	and target_26.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="syncp"
	and target_26.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vstat_2719
}

*/
/*predicate func_27(Variable vpcpu_stats_2719, ExprStmt target_27) {
	target_27.getExpr().(VariableAccess).getTarget()=vpcpu_stats_2719
}

*/
predicate func_28(Variable vdev_2613, BlockStmt target_53, NotExpr target_28) {
	target_28.getOperand().(ValueFieldAccess).getTarget().getName()="tstats"
	and target_28.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_28.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_28.getParent().(IfStmt).getThen()=target_53
}

predicate func_29(Variable verr_2614, NotExpr target_28, ExprStmt target_29) {
	target_29.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_2614
	and target_29.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-12"
	and target_29.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_28
}

predicate func_30(NotExpr target_28, Function func, GotoStmt target_30) {
	target_30.getName() ="err_free_dev"
	and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_28
	and target_30.getEnclosingFunction() = func
}

predicate func_31(Variable v__key_2725, VariableAccess target_56, DoStmt target_31) {
	target_31.getCondition().(Literal).getValue()="0"
	and target_31.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__raw_spin_lock_init")
	and target_31.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
	and target_31.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_31.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="&tun->lock"
	and target_31.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_2725
	and target_31.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

/*predicate func_33(Variable v__key_2725, Variable vtun_2611, ExprStmt target_33) {
	target_33.getExpr().(FunctionCall).getTarget().hasName("__raw_spin_lock_init")
	and target_33.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
	and target_33.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_33.getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and target_33.getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="&tun->lock"
	and target_33.getExpr().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_2725
}

*/
predicate func_34(Variable vtun_2611, Variable verr_2614, AssignExpr target_34) {
	target_34.getLValue().(VariableAccess).getTarget()=verr_2614
	and target_34.getRValue().(FunctionCall).getTarget().hasName("security_tun_dev_alloc_security")
	and target_34.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="security"
	and target_34.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_35(VariableAccess target_56, Function func, IfStmt target_35) {
	target_35.getCondition() instanceof RelationalOperation
	and target_35.getThen().(GotoStmt).getName() ="err_free_stat"
	and target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
	and target_35.getEnclosingFunction() = func
}

predicate func_36(Variable vtun_2611, VariableAccess target_56, ExprStmt target_36) {
	target_36.getExpr().(FunctionCall).getTarget().hasName("tun_flow_init")
	and target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
	and target_36.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_37(Variable vdev_2613, VariableAccess target_56, ExprStmt target_37) {
	target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="hw_features"
	and target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_37.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="35184373465289"
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_38(Variable vdev_2613, VariableAccess target_56, ExprStmt target_38) {
	target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="features"
	and target_38.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_38.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="hw_features"
	and target_38.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_38.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_39(Variable vdev_2613, VariableAccess target_56, ExprStmt target_39) {
	target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vlan_features"
	and target_39.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_39.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="features"
	and target_39.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_39.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446708889337462655"
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_40(Parameter vifr_2609, Variable vtun_2611, VariableAccess target_56, ExprStmt target_36, AddressOfExpr target_58, ExprStmt target_40) {
	target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294938319"
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
	and target_40.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="28976"
	and target_40.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
	and target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_58.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_41(Variable vtun_2611, VariableAccess target_56, ExprStmt target_41) {
	target_41.getExpr().(FunctionCall).getTarget().hasName("INIT_LIST_HEAD")
	and target_41.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="disabled"
	and target_41.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_42(Parameter vfile_2609, Parameter vifr_2609, Variable vtun_2611, Variable verr_2614, VariableAccess target_56, ExprStmt target_42) {
	target_42.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_2614
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("tun_attach")
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vfile_2609
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="16"
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32"
	and target_42.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_43(Variable verr_2614, VariableAccess target_56, IfStmt target_43) {
	target_43.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=verr_2614
	and target_43.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_43.getThen().(GotoStmt).getName() ="err_free_flow"
	and target_43.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_44(Variable verr_2614, VariableAccess target_56, IfStmt target_44) {
	target_44.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=verr_2614
	and target_44.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_44.getThen().(GotoStmt).getName() ="err_detach"
	and target_44.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

predicate func_45(Variable vdev_2613, Function func, ExprStmt target_45) {
	target_45.getExpr().(FunctionCall).getTarget().hasName("tun_detach_all")
	and target_45.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdev_2613
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_45
}

predicate func_46(Variable vdev_2613, Function func, IfStmt target_46) {
	target_46.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="tstats"
	and target_46.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_46.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and target_46.getThen().(GotoStmt).getName() ="err_free_dev"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

predicate func_47(Variable vtun_2611, Function func, ExprStmt target_47) {
	target_47.getExpr().(FunctionCall).getTarget().hasName("tun_flow_uninit")
	and target_47.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_2611
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_47
}

predicate func_48(Variable vtun_2611, Function func, ExprStmt target_48) {
	target_48.getExpr().(FunctionCall).getTarget().hasName("security_tun_dev_free_security")
	and target_48.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="security"
	and target_48.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Variable vdev_2613, Function func, ExprStmt target_49) {
	target_49.getExpr().(FunctionCall).getTarget().hasName("free_percpu")
	and target_49.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="tstats"
	and target_49.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_49.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_2613
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
}

predicate func_51(Variable vtun_2611, AddressOfExpr target_51) {
	target_51.getOperand().(PointerFieldAccess).getTarget().getName()="security"
	and target_51.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_52(Variable vpcpu_stats_2719, BlockStmt target_59, VariableAccess target_52) {
	target_52.getTarget()=vpcpu_stats_2719
	and target_52.getParent().(IfStmt).getThen()=target_59
}

predicate func_53(Function func, BlockStmt target_53) {
	target_53.getStmt(0) instanceof ExprStmt
	and target_53.getStmt(1) instanceof GotoStmt
	and target_53.getEnclosingFunction() = func
}

predicate func_56(Variable vdev_2613, BlockStmt target_60, VariableAccess target_56) {
	target_56.getTarget()=vdev_2613
	and target_56.getParent().(IfStmt).getThen()=target_60
}

predicate func_58(Variable vtun_2611, AddressOfExpr target_58) {
	target_58.getOperand().(PointerFieldAccess).getTarget().getName()="disabled"
	and target_58.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_2611
}

predicate func_59(Function func, BlockStmt target_59) {
	target_59.getStmt(1) instanceof ForStmt
	and target_59.getEnclosingFunction() = func
}

predicate func_60(Parameter vifr_2609, BlockStmt target_60) {
	target_60.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_60.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_60.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vifr_2609
	and target_60.getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32768"
	and target_60.getStmt(0).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-16"
}

from Function func, Variable vnr_cpu_ids, Variable vstat_2719, Variable v__vpp_verify_2719, Variable v__ptr_2719, Variable v__per_cpu_offset, Variable v__key_2725, Parameter vfile_2609, Parameter vifr_2609, Variable vtun_2611, Variable vdev_2613, Variable verr_2614, Variable vpcpu_stats_2719, Variable v__cpu_2719, Variable v__cpu_possible_mask, SizeofTypeOperator target_0, FunctionCall target_1, IfStmt target_2, RelationalOperation target_5, ExprStmt target_6, ReturnStmt target_7, VariableAccess target_8, VariableAccess target_9, VariableAccess target_10, VariableAccess target_11, AssignExpr target_12, DeclStmt target_15, NotExpr target_28, ExprStmt target_29, GotoStmt target_30, DoStmt target_31, AssignExpr target_34, IfStmt target_35, ExprStmt target_36, ExprStmt target_37, ExprStmt target_38, ExprStmt target_39, ExprStmt target_40, ExprStmt target_41, ExprStmt target_42, IfStmt target_43, IfStmt target_44, ExprStmt target_45, IfStmt target_46, ExprStmt target_47, ExprStmt target_48, ExprStmt target_49, AddressOfExpr target_51, VariableAccess target_52, BlockStmt target_53, VariableAccess target_56, AddressOfExpr target_58, BlockStmt target_59, BlockStmt target_60
where
func_0(func, target_0)
and func_1(vdev_2613, target_1)
and func_2(target_31, func, target_2)
and not func_3(vifr_2609, vtun_2611, target_51)
and not func_4(vfile_2609, vtun_2611, target_36)
and func_5(verr_2614, target_5)
and func_6(vdev_2613, func, target_6)
and func_7(verr_2614, func, target_7)
and func_8(vtun_2611, target_8)
and func_9(vtun_2611, target_9)
and func_10(vifr_2609, target_10)
and func_11(vfile_2609, target_11)
and func_12(vdev_2613, vpcpu_stats_2719, target_12)
and func_15(target_52, func, target_15)
and func_28(vdev_2613, target_53, target_28)
and func_29(verr_2614, target_28, target_29)
and func_30(target_28, func, target_30)
and func_31(v__key_2725, target_56, target_31)
and func_34(vtun_2611, verr_2614, target_34)
and func_35(target_56, func, target_35)
and func_36(vtun_2611, target_56, target_36)
and func_37(vdev_2613, target_56, target_37)
and func_38(vdev_2613, target_56, target_38)
and func_39(vdev_2613, target_56, target_39)
and func_40(vifr_2609, vtun_2611, target_56, target_36, target_58, target_40)
and func_41(vtun_2611, target_56, target_41)
and func_42(vfile_2609, vifr_2609, vtun_2611, verr_2614, target_56, target_42)
and func_43(verr_2614, target_56, target_43)
and func_44(verr_2614, target_56, target_44)
and func_45(vdev_2613, func, target_45)
and func_46(vdev_2613, func, target_46)
and func_47(vtun_2611, func, target_47)
and func_48(vtun_2611, func, target_48)
and func_49(vdev_2613, func, target_49)
and func_51(vtun_2611, target_51)
and func_52(vpcpu_stats_2719, target_59, target_52)
and func_53(func, target_53)
and func_56(vdev_2613, target_60, target_56)
and func_58(vtun_2611, target_58)
and func_59(func, target_59)
and func_60(vifr_2609, target_60)
and vnr_cpu_ids.getType().hasName("unsigned int")
and vstat_2719.getType().hasName("pcpu_sw_netstats *")
and v__vpp_verify_2719.getType().hasName("const void *")
and v__ptr_2719.getType().hasName("unsigned long")
and v__per_cpu_offset.getType() instanceof ArrayType
and v__key_2725.getType().hasName("lock_class_key")
and vfile_2609.getType().hasName("file *")
and vifr_2609.getType().hasName("ifreq *")
and vtun_2611.getType().hasName("tun_struct *")
and vdev_2613.getType().hasName("net_device *")
and verr_2614.getType().hasName("int")
and vpcpu_stats_2719.getType().hasName("pcpu_sw_netstats *")
and v__cpu_2719.getType().hasName("int")
and v__cpu_possible_mask.getType().hasName("cpumask")
and not vnr_cpu_ids.getParentScope+() = func
and vstat_2719.(LocalVariable).getFunction() = func
and v__vpp_verify_2719.(LocalVariable).getFunction() = func
and v__ptr_2719.(LocalVariable).getFunction() = func
and not v__per_cpu_offset.getParentScope+() = func
and v__key_2725.(LocalVariable).getFunction() = func
and vfile_2609.getFunction() = func
and vifr_2609.getFunction() = func
and vtun_2611.(LocalVariable).getFunction() = func
and vdev_2613.(LocalVariable).getFunction() = func
and verr_2614.(LocalVariable).getFunction() = func
and vpcpu_stats_2719.(LocalVariable).getFunction() = func
and v__cpu_2719.(LocalVariable).getFunction() = func
and not v__cpu_possible_mask.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
