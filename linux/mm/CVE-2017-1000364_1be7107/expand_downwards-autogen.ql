/**
 * @name linux-1be7107fbe18eed3e319a6c3e83c78254b693acb-expand_downwards
 * @id cpp/linux/1be7107fbe18eed3e319a6c3e83c78254b693acb/expand-downwards
 * @description linux-1be7107fbe18eed3e319a6c3e83c78254b693acb-mm/mmap.c-expand_downwards CVE-2017-1000364
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vaddress_2282, Variable verror_2285, FunctionCall target_0) {
	target_0.getTarget().hasName("security_mmap_addr")
	and not target_0.getTarget().hasName("expand_downwards")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vaddress_2282
	and target_0.getParent().(AssignExpr).getRValue() = target_0
	and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
}

predicate func_1(Parameter vvma_2281, VariableAccess target_1) {
	target_1.getTarget()=vvma_2281
	and target_1.getParent().(FunctionCall).getParent().(NotExpr).getOperand() instanceof FunctionCall
}

predicate func_2(Function func, DeclStmt target_2) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_2
}

predicate func_3(Function func, DeclStmt target_3) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_3
}

predicate func_4(Parameter vaddress_2282, Function func, ExprStmt target_4) {
	target_4.getExpr().(AssignAndExpr).getLValue().(VariableAccess).getTarget()=vaddress_2282
	and target_4.getExpr().(AssignAndExpr).getRValue().(ComplementExpr).getValue()="18446744073709547520"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_4
}

predicate func_5(Variable verror_2285, Function func, ExprStmt target_5) {
	target_5.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
	and target_5.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_5
}

predicate func_6(Variable verror_2285, Function func, IfStmt target_6) {
	target_6.getCondition().(VariableAccess).getTarget()=verror_2285
	and target_6.getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=verror_2285
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_6
}

/*predicate func_7(Variable verror_2285, IfStmt target_6, VariableAccess target_7) {
	target_7.getTarget()=verror_2285
	and target_6.getCondition().(VariableAccess).getLocation().isBefore(target_7.getLocation())
}

*/
predicate func_8(Parameter vvma_2281, Function func, IfStmt target_8) {
	target_8.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_8.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("anon_vma_prepare")
	and target_8.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_8.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_8.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-12"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_8
}

predicate func_9(Parameter vvma_2281, Function func, ExprStmt target_9) {
	target_9.getExpr().(FunctionCall).getTarget().hasName("anon_vma_lock_write")
	and target_9.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="anon_vma"
	and target_9.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_9
}

predicate func_10(Parameter vvma_2281, Parameter vaddress_2282, Variable verror_2285, Variable vsize_2305, Variable vgrow_2305, Function func, IfStmt target_10) {
	target_10.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vaddress_2282
	and target_10.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_10.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_10.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_2305
	and target_10.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_end"
	and target_10.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_10.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vaddress_2282
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vgrow_2305
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vaddress_2282
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="12"
	and target_10.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
	and target_10.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-12"
	and target_10.getThen().(BlockStmt).getStmt(4).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vgrow_2305
	and target_10.getThen().(BlockStmt).getStmt(4).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_10.getThen().(BlockStmt).getStmt(4).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_10.getThen().(BlockStmt).getStmt(4).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
	and target_10.getThen().(BlockStmt).getStmt(4).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("acct_stack_growth")
	and target_10.getThen().(BlockStmt).getStmt(4).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=verror_2285
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_10
}

predicate func_11(RelationalOperation target_32, Function func, DeclStmt target_11) {
	target_11.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_32
	and target_11.getEnclosingFunction() = func
}

/*predicate func_12(Parameter vvma_2281, Parameter vaddress_2282, Variable vsize_2305, RelationalOperation target_32, ExprStmt target_12) {
	target_12.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_2305
	and target_12.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_end"
	and target_12.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_12.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vaddress_2282
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_32
}

*/
/*predicate func_13(Parameter vvma_2281, Parameter vaddress_2282, Variable vgrow_2305, RelationalOperation target_32, ExprStmt target_13) {
	target_13.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vgrow_2305
	and target_13.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_13.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_13.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vaddress_2282
	and target_13.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="12"
	and target_13.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_32
}

*/
/*predicate func_14(Variable verror_2285, RelationalOperation target_32, ExprStmt target_14) {
	target_14.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
	and target_14.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-12"
	and target_14.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_32
}

*/
/*predicate func_15(Parameter vvma_2281, Parameter vaddress_2282, Variable vmm_2284, Variable verror_2285, Variable vsize_2305, Variable vgrow_2305, RelationalOperation target_32, IfStmt target_15) {
	target_15.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vgrow_2305
	and target_15.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_15.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_15.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
	and target_15.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("acct_stack_growth")
	and target_15.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_15.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsize_2305
	and target_15.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vgrow_2305
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=verror_2285
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("spin_lock")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8192"
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vm_stat_account")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmm_2284
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vgrow_2305
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("anon_vma_interval_tree_pre_update_vma")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vaddress_2282
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vgrow_2305
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("anon_vma_interval_tree_post_update_vma")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vma_gap_update")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("spin_unlock")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_mmap")
	and target_15.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_32
}

*/
/*predicate func_16(Parameter vvma_2281, Variable verror_2285, Variable vsize_2305, Variable vgrow_2305, RelationalOperation target_33, ExprStmt target_16) {
	target_16.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_2285
	and target_16.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("acct_stack_growth")
	and target_16.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_16.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsize_2305
	and target_16.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vgrow_2305
	and target_16.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_33
}

*/
/*predicate func_17(Parameter vvma_2281, Parameter vaddress_2282, Variable vmm_2284, Variable verror_2285, Variable vgrow_2305, RelationalOperation target_33, IfStmt target_17) {
	target_17.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=verror_2285
	and target_17.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("spin_lock")
	and target_17.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="page_table_lock"
	and target_17.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_2284
	and target_17.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_17.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8192"
	and target_17.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="locked_vm"
	and target_17.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_2284
	and target_17.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vgrow_2305
	and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vm_stat_account")
	and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmm_2284
	and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vgrow_2305
	and target_17.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("anon_vma_interval_tree_pre_update_vma")
	and target_17.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_17.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vaddress_2282
	and target_17.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_17.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vgrow_2305
	and target_17.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("anon_vma_interval_tree_post_update_vma")
	and target_17.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vma_gap_update")
	and target_17.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_17.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("spin_unlock")
	and target_17.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="page_table_lock"
	and target_17.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_2284
	and target_17.getThen().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_mmap")
	and target_17.getThen().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_17.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_33
}

*/
/*predicate func_18(Variable vmm_2284, NotExpr target_34, ExprStmt target_18) {
	target_18.getExpr().(FunctionCall).getTarget().hasName("spin_lock")
	and target_18.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="page_table_lock"
	and target_18.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_2284
	and target_18.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_19(Parameter vvma_2281, Variable vmm_2284, Variable vgrow_2305, NotExpr target_34, IfStmt target_19) {
	target_19.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_19.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_19.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8192"
	and target_19.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="locked_vm"
	and target_19.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_2284
	and target_19.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vgrow_2305
	and target_19.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_20(Parameter vvma_2281, Variable vmm_2284, Variable vgrow_2305, NotExpr target_34, ExprStmt target_20) {
	target_20.getExpr().(FunctionCall).getTarget().hasName("vm_stat_account")
	and target_20.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmm_2284
	and target_20.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_20.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_20.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vgrow_2305
	and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_21(Parameter vvma_2281, NotExpr target_34, ExprStmt target_21) {
	target_21.getExpr().(FunctionCall).getTarget().hasName("anon_vma_interval_tree_pre_update_vma")
	and target_21.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_22(Parameter vvma_2281, Parameter vaddress_2282, NotExpr target_34, ExprStmt target_22) {
	target_22.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_22.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_22.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vaddress_2282
	and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_23(Parameter vvma_2281, Variable vgrow_2305, NotExpr target_34, ExprStmt target_23) {
	target_23.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_23.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and target_23.getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vgrow_2305
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_24(Parameter vvma_2281, NotExpr target_34, ExprStmt target_24) {
	target_24.getExpr().(FunctionCall).getTarget().hasName("anon_vma_interval_tree_post_update_vma")
	and target_24.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_25(Parameter vvma_2281, NotExpr target_34, ExprStmt target_25) {
	target_25.getExpr().(FunctionCall).getTarget().hasName("vma_gap_update")
	and target_25.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_25.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_26(Variable vmm_2284, NotExpr target_34, ExprStmt target_26) {
	target_26.getExpr().(FunctionCall).getTarget().hasName("spin_unlock")
	and target_26.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="page_table_lock"
	and target_26.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_2284
	and target_26.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
/*predicate func_27(Parameter vvma_2281, NotExpr target_34, ExprStmt target_27) {
	target_27.getExpr().(FunctionCall).getTarget().hasName("perf_event_mmap")
	and target_27.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_34
}

*/
predicate func_28(Parameter vvma_2281, Function func, ExprStmt target_28) {
	target_28.getExpr().(FunctionCall).getTarget().hasName("anon_vma_unlock_write")
	and target_28.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="anon_vma"
	and target_28.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

predicate func_29(Parameter vvma_2281, Function func, ExprStmt target_29) {
	target_29.getExpr().(FunctionCall).getTarget().hasName("khugepaged_enter_vma_merge")
	and target_29.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_2281
	and target_29.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_29.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

predicate func_30(Variable vmm_2284, Function func, ExprStmt target_30) {
	target_30.getExpr().(FunctionCall).getTarget().hasName("validate_mm")
	and target_30.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmm_2284
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

predicate func_31(Variable verror_2285, NotExpr target_34, Function func, ReturnStmt target_31) {
	target_31.getExpr().(VariableAccess).getTarget()=verror_2285
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_31
	and target_34.getOperand().(VariableAccess).getLocation().isBefore(target_31.getExpr().(VariableAccess).getLocation())
}

predicate func_32(Parameter vvma_2281, Parameter vaddress_2282, RelationalOperation target_32) {
	 (target_32 instanceof GTExpr or target_32 instanceof LTExpr)
	and target_32.getLesserOperand().(VariableAccess).getTarget()=vaddress_2282
	and target_32.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_32.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
}

predicate func_33(Parameter vvma_2281, Variable vgrow_2305, RelationalOperation target_33) {
	 (target_33 instanceof GEExpr or target_33 instanceof LEExpr)
	and target_33.getLesserOperand().(VariableAccess).getTarget()=vgrow_2305
	and target_33.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_33.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_2281
}

predicate func_34(Variable verror_2285, NotExpr target_34) {
	target_34.getOperand().(VariableAccess).getTarget()=verror_2285
}

from Function func, Parameter vvma_2281, Parameter vaddress_2282, Variable vmm_2284, Variable verror_2285, Variable vsize_2305, Variable vgrow_2305, FunctionCall target_0, VariableAccess target_1, DeclStmt target_2, DeclStmt target_3, ExprStmt target_4, ExprStmt target_5, IfStmt target_6, IfStmt target_8, ExprStmt target_9, IfStmt target_10, DeclStmt target_11, ExprStmt target_28, ExprStmt target_29, ExprStmt target_30, ReturnStmt target_31, RelationalOperation target_32, RelationalOperation target_33, NotExpr target_34
where
func_0(vaddress_2282, verror_2285, target_0)
and func_1(vvma_2281, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(vaddress_2282, func, target_4)
and func_5(verror_2285, func, target_5)
and func_6(verror_2285, func, target_6)
and func_8(vvma_2281, func, target_8)
and func_9(vvma_2281, func, target_9)
and func_10(vvma_2281, vaddress_2282, verror_2285, vsize_2305, vgrow_2305, func, target_10)
and func_11(target_32, func, target_11)
and func_28(vvma_2281, func, target_28)
and func_29(vvma_2281, func, target_29)
and func_30(vmm_2284, func, target_30)
and func_31(verror_2285, target_34, func, target_31)
and func_32(vvma_2281, vaddress_2282, target_32)
and func_33(vvma_2281, vgrow_2305, target_33)
and func_34(verror_2285, target_34)
and vvma_2281.getType().hasName("vm_area_struct *")
and vaddress_2282.getType().hasName("unsigned long")
and vmm_2284.getType().hasName("mm_struct *")
and verror_2285.getType().hasName("int")
and vsize_2305.getType().hasName("unsigned long")
and vgrow_2305.getType().hasName("unsigned long")
and vvma_2281.getFunction() = func
and vaddress_2282.getFunction() = func
and vmm_2284.(LocalVariable).getFunction() = func
and verror_2285.(LocalVariable).getFunction() = func
and vsize_2305.(LocalVariable).getFunction() = func
and vgrow_2305.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
