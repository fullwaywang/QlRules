/**
 * @name linux-ce683e5f9d045e5d67d1312a42b359cb2ab2a13c-xt_compat_target_to_user
 * @id cpp/linux/ce683e5f9d045e5d67d1312a42b359cb2ab2a13c/xt-compat-target-to-user
 * @description linux-ce683e5f9d045e5d67d1312a42b359cb2ab2a13c-include/linux/netfilter/x_tables.h-xt_compat_target_to_user CVE-2016-4997
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Initializer target_0) {
	target_0.getExpr().(ValueFieldAccess).getTarget().getName()="target"
	and target_0.getExpr().(ValueFieldAccess).getQualifier() instanceof ValueFieldAccess
	and target_0.getExpr().getEnclosingFunction() = func
}

predicate func_1(Variable vtarget_705, FunctionCall target_1) {
	target_1.getTarget().hasName("xt_compat_target_offset")
	and not target_1.getTarget().hasName("xt_register_match")
	and target_1.getArgument(0).(VariableAccess).getTarget()=vtarget_705
}

predicate func_2(Variable voff_707, VariableAccess target_2) {
	target_2.getTarget()=voff_707
}

predicate func_3(Function func, FunctionCall target_3) {
	target_3.getTarget().hasName("__might_fault")
	and not target_3.getTarget().hasName("xt_unregister_matches")
	and target_3.getArgument(0) instanceof StringLiteral
	and target_3.getArgument(1) instanceof Literal
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Variable v__ret_pu_711, VariableAccess target_4) {
	target_4.getTarget()=v__ret_pu_711
}

predicate func_5(Variable v__ret_pu_711, VariableAccess target_5) {
	target_5.getTarget()=v__ret_pu_711
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_6(Variable voff_707, VariableAccess target_6) {
	target_6.getTarget()=voff_707
	and target_6.getParent().(AssignSubExpr).getRValue() = target_6
	and target_6.getParent().(AssignSubExpr).getLValue() instanceof PointerDereferenceExpr
}

predicate func_8(Function func) {
exists(ForStmt target_8 |
	target_8.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_8.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_8.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_8.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_8.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_8.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_8.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("xt_register_match")
	and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getType().hasName("int")
	and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(GotoStmt).getName() ="err"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_8
	and target_8.getFollowingStmt() instanceof DeclStmt)
}

/*predicate func_9(Function func) {
exists(AssignExpr target_9 |
	target_9.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_9.getRValue() instanceof Literal
	and target_9.getEnclosingFunction() = func)
}

*/
/*predicate func_10(Function func) {
exists(AssignExpr target_10 |
	target_10.getLValue().(VariableAccess).getType().hasName("int")
	and target_10.getRValue().(FunctionCall).getTarget().hasName("xt_register_match")
	and target_10.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("xt_match *")
	and target_10.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
	and target_10.getEnclosingFunction() = func)
}

*/
/*predicate func_11(Function func) {
exists(AddressOfExpr target_11 |
	target_11.getOperand().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("xt_match *")
	and target_11.getOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getParent().(FunctionCall).getParent().(Initializer).getExpr() instanceof FunctionCall
	and target_11.getEnclosingFunction() = func)
}

*/
/*predicate func_12(LogicalOrExpr target_25, Function func) {
exists(GotoStmt target_12 |
	target_12.getName() ="err"
	and target_12.getParent().(IfStmt).getCondition()=target_25
	and target_12.getEnclosingFunction() = func)
}

*/
predicate func_13(BlockStmt target_54, Function func) {
exists(RelationalOperation target_13 |
	 (target_13 instanceof GTExpr or target_13 instanceof LTExpr)
	and target_13.getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_13.getLesserOperand() instanceof Literal
	and target_13.getParent().(IfStmt).getThen()=target_54
	and target_13.getEnclosingFunction() = func)
}

predicate func_20(Parameter vt_702, ValueFieldAccess target_20) {
	target_20.getTarget().getName()="kernel"
	and target_20.getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_20.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vt_702
}

predicate func_22(Function func, DeclStmt target_22) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_22
}

predicate func_23(Function func, Initializer target_23) {
	target_23.getExpr() instanceof FunctionCall
	and target_23.getExpr().getEnclosingFunction() = func
}

predicate func_24(Function func, DeclStmt target_24) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_24
}

predicate func_25(Variable vct_706, Variable vtsize_708, Variable v__ret_pu_711, Variable v__pu_val_711, Parameter vt_702, ReturnStmt target_56, LogicalOrExpr target_25) {
	target_25.getLeftOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_25.getLeftOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vct_706
	and target_25.getLeftOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vt_702
	and target_25.getLeftOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="32"
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr() instanceof Literal
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr() instanceof FunctionCall
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__pu_val_711
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vtsize_708
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(5).(SwitchStmt).getExpr().(SizeofExprOperator).getValue()="2"
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(5).(SwitchStmt).getStmt().(BlockStmt).getStmt(12).(SwitchCase).toString() = "default: "
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(6) instanceof LabelStmt
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_25.getLeftOperand().(LogicalOrExpr).getRightOperand().(StmtExpr).getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_25.getRightOperand().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_25.getRightOperand().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="name"
	and target_25.getRightOperand().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_25.getRightOperand().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_25.getRightOperand().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_25.getRightOperand().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="name"
	and target_25.getRightOperand().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="target"
	and target_25.getRightOperand().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="kernel"
	and target_25.getRightOperand().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_25.getRightOperand().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vt_702
	and target_25.getRightOperand().(FunctionCall).getArgument(2).(AddExpr).getLeftOperand().(FunctionCall).getTarget().hasName("strlen")
	and target_25.getRightOperand().(FunctionCall).getArgument(2).(AddExpr).getLeftOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="name"
	and target_25.getRightOperand().(FunctionCall).getArgument(2).(AddExpr).getLeftOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="target"
	and target_25.getRightOperand().(FunctionCall).getArgument(2).(AddExpr).getLeftOperand().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="kernel"
	and target_25.getRightOperand().(FunctionCall).getArgument(2).(AddExpr).getRightOperand().(Literal).getValue()="1"
	and target_25.getParent().(IfStmt).getThen()=target_56
}

/*predicate func_28(Variable vtsize_708, Variable v__pu_val_711, AssignExpr target_28) {
	target_28.getLValue().(VariableAccess).getTarget()=v__pu_val_711
	and target_28.getRValue().(VariableAccess).getTarget()=vtsize_708
}

*/
/*predicate func_29(Variable v__ret_pu_711, Variable v__pu_val_711, SwitchStmt target_29) {
	target_29.getExpr().(SizeofExprOperator).getValue()="2"
	and target_29.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr().(Literal).getValue()="1"
	and target_29.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_29.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_29.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_29.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_29.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_29.getStmt().(BlockStmt).getStmt(3).(SwitchCase).getExpr().(Literal).getValue()="2"
	and target_29.getStmt().(BlockStmt).getStmt(4).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_29.getStmt().(BlockStmt).getStmt(4).(AsmStmt).getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_29.getStmt().(BlockStmt).getStmt(4).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_29.getStmt().(BlockStmt).getStmt(4).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_29.getStmt().(BlockStmt).getStmt(4).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_29.getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="4"
	and target_29.getStmt().(BlockStmt).getStmt(7).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_29.getStmt().(BlockStmt).getStmt(7).(AsmStmt).getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_29.getStmt().(BlockStmt).getStmt(7).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_29.getStmt().(BlockStmt).getStmt(7).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_29.getStmt().(BlockStmt).getStmt(7).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_29.getStmt().(BlockStmt).getStmt(9).(SwitchCase).getExpr().(Literal).getValue()="8"
	and target_29.getStmt().(BlockStmt).getStmt(10).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_29.getStmt().(BlockStmt).getStmt(10).(AsmStmt).getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_29.getStmt().(BlockStmt).getStmt(10).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_29.getStmt().(BlockStmt).getStmt(10).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_29.getStmt().(BlockStmt).getStmt(10).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_29.getStmt().(BlockStmt).getStmt(12).(SwitchCase).toString() = "default: "
	and target_29.getStmt().(BlockStmt).getStmt(13).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_29.getStmt().(BlockStmt).getStmt(13).(AsmStmt).getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_29.getStmt().(BlockStmt).getStmt(13).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_29.getStmt().(BlockStmt).getStmt(13).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_29.getStmt().(BlockStmt).getStmt(13).(AsmStmt).getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
}

*/
/*predicate func_30(Function func, SwitchCase target_30) {
	target_30.getExpr().(Literal).getValue()="1"
	and target_30.getEnclosingFunction() = func
}

*/
/*predicate func_31(Variable vct_706, Variable v__ret_pu_711, Variable v__pu_val_711, SizeofExprOperator target_57, AsmStmt target_31) {
	target_31.getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_31.getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_31.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_31.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_31.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_31.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_31.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
}

*/
/*predicate func_32(SizeofExprOperator target_57, Function func, BreakStmt target_32) {
	target_32.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
	and target_32.getEnclosingFunction() = func
}

*/
/*predicate func_33(Function func, SwitchCase target_33) {
	target_33.getExpr().(Literal).getValue()="2"
	and target_33.getEnclosingFunction() = func
}

*/
/*predicate func_34(Variable vct_706, Variable v__ret_pu_711, Variable v__pu_val_711, SizeofExprOperator target_57, AsmStmt target_34) {
	target_34.getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_34.getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_34.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_34.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_34.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_34.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_34.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
}

*/
/*predicate func_35(SizeofExprOperator target_57, Function func, BreakStmt target_35) {
	target_35.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
	and target_35.getEnclosingFunction() = func
}

*/
/*predicate func_36(Function func, SwitchCase target_36) {
	target_36.getExpr().(Literal).getValue()="4"
	and target_36.getEnclosingFunction() = func
}

*/
/*predicate func_37(Variable vct_706, Variable v__ret_pu_711, Variable v__pu_val_711, SizeofExprOperator target_57, AsmStmt target_37) {
	target_37.getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_37.getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_37.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_37.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_37.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_37.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_37.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
}

*/
/*predicate func_38(SizeofExprOperator target_57, Function func, BreakStmt target_38) {
	target_38.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
	and target_38.getEnclosingFunction() = func
}

*/
/*predicate func_39(Function func, SwitchCase target_39) {
	target_39.getExpr().(Literal).getValue()="8"
	and target_39.getEnclosingFunction() = func
}

*/
/*predicate func_40(Variable vct_706, Variable v__ret_pu_711, Variable v__pu_val_711, SizeofExprOperator target_57, AsmStmt target_40) {
	target_40.getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_40.getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_40.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_40.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_40.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_40.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_40.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
}

*/
/*predicate func_41(SizeofExprOperator target_57, Function func, BreakStmt target_41) {
	target_41.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
	and target_41.getEnclosingFunction() = func
}

*/
/*predicate func_42(Function func, SwitchCase target_42) {
	target_42.toString() = "default: "
	and target_42.getEnclosingFunction() = func
}

*/
/*predicate func_43(Variable vct_706, Variable v__ret_pu_711, Variable v__pu_val_711, SizeofExprOperator target_57, AsmStmt target_43) {
	target_43.getChild(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_43.getChild(1).(VariableAccess).getTarget()=v__pu_val_711
	and target_43.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="target_size"
	and target_43.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="user"
	and target_43.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="u"
	and target_43.getChild(2).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_43.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
}

*/
/*predicate func_44(SizeofExprOperator target_57, Function func, BreakStmt target_44) {
	target_44.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_57
	and target_44.getEnclosingFunction() = func
}

*/
/*predicate func_45(Variable v__ret_pu_711, ExprStmt target_45) {
	target_45.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_45.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=v__ret_pu_711
	and target_45.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
predicate func_46(Function func, UnaryMinusExpr target_46) {
	target_46.getValue()="-14"
	and target_46.getEnclosingFunction() = func
}

predicate func_47(Variable vtarget_705, FunctionCall target_1, VariableCall target_59, PointerFieldAccess target_47) {
	target_47.getTarget().getName()="compat_to_user"
	and target_47.getQualifier().(VariableAccess).getTarget()=vtarget_705
	and target_1.getArgument(0).(VariableAccess).getLocation().isBefore(target_47.getQualifier().(VariableAccess).getLocation())
	and target_47.getQualifier().(VariableAccess).getLocation().isBefore(target_59.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_48(Variable vtarget_705, Variable vct_706, Parameter vt_702, PointerFieldAccess target_47, IfStmt target_48) {
	target_48.getCondition().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="compat_to_user"
	and target_48.getCondition().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtarget_705
	and target_48.getCondition().(VariableCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
	and target_48.getCondition().(VariableCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_48.getCondition().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
	and target_48.getCondition().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vt_702
	and target_48.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_48.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_47
}

/*predicate func_49(Function func, UnaryMinusExpr target_49) {
	target_49.getValue()="-14"
	and target_49.getEnclosingFunction() = func
}

*/
predicate func_50(Variable vct_706, Variable vtsize_708, Parameter vt_702, PointerFieldAccess target_47, IfStmt target_50) {
	target_50.getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_50.getCondition().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
	and target_50.getCondition().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_50.getCondition().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
	and target_50.getCondition().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vt_702
	and target_50.getCondition().(FunctionCall).getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vtsize_708
	and target_50.getCondition().(FunctionCall).getArgument(2).(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="32"
	and target_50.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_50.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_47
}

predicate func_51(Parameter vsize_703, Variable voff_707, Function func, ExprStmt target_51) {
	target_51.getExpr().(AssignSubExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vsize_703
	and target_51.getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=voff_707
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
}

predicate func_52(Variable vtsize_708, Parameter vdstptr_703, Function func, ExprStmt target_52) {
	target_52.getExpr().(AssignPointerAddExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vdstptr_703
	and target_52.getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vtsize_708
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_52
}

predicate func_53(Function func, ReturnStmt target_53) {
	target_53.getExpr() instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_53
}

predicate func_54(Function func, BlockStmt target_54) {
	target_54.getStmt(0) instanceof IfStmt
	and target_54.getEnclosingFunction() = func
}

predicate func_56(LogicalOrExpr target_25, Function func, ReturnStmt target_56) {
	target_56.getExpr() instanceof UnaryMinusExpr
	and target_56.getParent().(IfStmt).getCondition()=target_25
	and target_56.getEnclosingFunction() = func
}

predicate func_57(Function func, SizeofExprOperator target_57) {
	target_57.getValue()="2"
	and target_57.getEnclosingFunction() = func
}

predicate func_59(Variable vtarget_705, Variable vct_706, Parameter vt_702, VariableCall target_59) {
	target_59.getExpr().(PointerFieldAccess).getTarget().getName()="compat_to_user"
	and target_59.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtarget_705
	and target_59.getArgument(0).(PointerFieldAccess).getTarget().getName()="data"
	and target_59.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vct_706
	and target_59.getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
	and target_59.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vt_702
}

from Function func, Parameter vsize_703, Variable vtarget_705, Variable vct_706, Variable voff_707, Variable vtsize_708, Variable v__ret_pu_711, Variable v__pu_val_711, Parameter vt_702, Parameter vdstptr_703, Initializer target_0, FunctionCall target_1, VariableAccess target_2, FunctionCall target_3, VariableAccess target_4, VariableAccess target_5, VariableAccess target_6, ValueFieldAccess target_20, DeclStmt target_22, Initializer target_23, DeclStmt target_24, LogicalOrExpr target_25, UnaryMinusExpr target_46, PointerFieldAccess target_47, IfStmt target_48, IfStmt target_50, ExprStmt target_51, ExprStmt target_52, ReturnStmt target_53, BlockStmt target_54, ReturnStmt target_56, SizeofExprOperator target_57, VariableCall target_59
where
func_0(func, target_0)
and func_1(vtarget_705, target_1)
and func_2(voff_707, target_2)
and func_3(func, target_3)
and func_4(v__ret_pu_711, target_4)
and func_5(v__ret_pu_711, target_5)
and func_6(voff_707, target_6)
and not func_8(func)
and not func_13(target_54, func)
and func_20(vt_702, target_20)
and func_22(func, target_22)
and func_23(func, target_23)
and func_24(func, target_24)
and func_25(vct_706, vtsize_708, v__ret_pu_711, v__pu_val_711, vt_702, target_56, target_25)
and func_46(func, target_46)
and func_47(vtarget_705, target_1, target_59, target_47)
and func_48(vtarget_705, vct_706, vt_702, target_47, target_48)
and func_50(vct_706, vtsize_708, vt_702, target_47, target_50)
and func_51(vsize_703, voff_707, func, target_51)
and func_52(vtsize_708, vdstptr_703, func, target_52)
and func_53(func, target_53)
and func_54(func, target_54)
and func_56(target_25, func, target_56)
and func_57(func, target_57)
and func_59(vtarget_705, vct_706, vt_702, target_59)
and vsize_703.getType().hasName("unsigned int *")
and vtarget_705.getType().hasName("const xt_target *")
and vct_706.getType().hasName("compat_xt_entry_target *")
and voff_707.getType().hasName("int")
and vtsize_708.getType().hasName("u_int16_t")
and v__ret_pu_711.getType().hasName("int")
and v__pu_val_711.getType().hasName("u_int16_t")
and vt_702.getType().hasName("const xt_entry_target *")
and vdstptr_703.getType().hasName("void **")
and vsize_703.getFunction() = func
and vtarget_705.(LocalVariable).getFunction() = func
and vct_706.(LocalVariable).getFunction() = func
and voff_707.(LocalVariable).getFunction() = func
and vtsize_708.(LocalVariable).getFunction() = func
and v__ret_pu_711.(LocalVariable).getFunction() = func
and v__pu_val_711.(LocalVariable).getFunction() = func
and vt_702.getFunction() = func
and vdstptr_703.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
