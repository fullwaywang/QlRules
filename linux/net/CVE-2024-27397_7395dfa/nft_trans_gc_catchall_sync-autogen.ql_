/**
 * @name linux-7395dfacfff65e9938ac0889dafa1ab01e987d15-nft_trans_gc_catchall_sync
 * @id cpp/linux/7395dfacfff65e9938ac0889dafa1ab01e987d15/nft-trans-gc-catchall-sync
 * @description linux-7395dfacfff65e9938ac0889dafa1ab01e987d15-net/netfilter/nf_tables_api.c-nft_trans_gc_catchall_sync CVE-2024-27397
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vext_9832, FunctionCall target_0) {
	target_0.getTarget().hasName("nft_set_elem_expired")
	and not target_0.getTarget().hasName("__nft_set_elem_expired")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vext_9832
	and target_0.getParent().(NotExpr).getParent().(IfStmt).getThen() instanceof ContinueStmt
}

from Function func, Variable vext_9832, FunctionCall target_0
where
func_0(vext_9832, target_0)
and vext_9832.getType().hasName("nft_set_ext *")
and vext_9832.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
