/**
 * @name linux-5314454ea3ff6fc746eaf71b9a7ceebed52888fa-ocfs2_convert_inline_data_to_extents
 * @id cpp/linux/5314454ea3ff6fc746eaf71b9a7ceebed52888fa/ocfs2-convert-inline-data-to-extents
 * @description linux-5314454ea3ff6fc746eaf71b9a7ceebed52888fa-fs/ocfs2/alloc.c-ocfs2_convert_inline_data_to_extents CVE-2021-47460
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Initializer target_0) {
	target_0.getExpr().(Literal).getValue()="0"
	and target_0.getExpr().getEnclosingFunction() = func
}

predicate func_1(Variable vosb_7054, Initializer target_1) {
	target_1.getExpr().(PointerFieldAccess).getTarget().getName()="s_clustersize"
	and target_1.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
}

predicate func_2(Function func, SizeofTypeOperator target_2) {
	target_2.getType() instanceof LongType
	and target_2.getValue()="8"
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
	target_3.getValue()="12"
	and not target_3.getValue()="1"
	and target_3.getParent().(UnaryMinusExpr).getParent().(AssignExpr).getRValue() instanceof UnaryMinusExpr
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, Literal target_4) {
	target_4.getValue()="0"
	and not target_4.getValue()="1"
	and target_4.getParent().(ArrayExpr).getParent().(FunctionCall).getArgument(1) instanceof ArrayExpr
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Function func, Literal target_5) {
	target_5.getValue()="0"
	and not target_5.getValue()="8"
	and target_5.getParent().(AssignExpr).getParent().(ExprStmt).getExpr() instanceof AssignExpr
	and target_5.getEnclosingFunction() = func
}

predicate func_6(Function func, Literal target_6) {
	target_6.getValue()="0"
	and not target_6.getValue()="8"
	and target_6.getParent().(GTExpr).getParent().(FunctionCall).getArgument(5) instanceof RelationalOperation
	and target_6.getEnclosingFunction() = func
}

predicate func_7(Variable vret_7048, Variable vneed_free_7049, Variable v_st_7130, ExprStmt target_55, IfStmt target_7) {
	target_7.getCondition().(VariableAccess).getTarget()=vret_7048
	and target_7.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_st_7130
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vneed_free_7049
	and target_7.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_7.getThen().(BlockStmt).getStmt(2).(GotoStmt).getName() ="out_commit"
	and target_55.getLocation().isBefore(target_7.getLocation())
}

predicate func_8(Variable vret_7048, Variable vneed_free_7049, Variable v_st_7141, ExprStmt target_56, IfStmt target_8) {
	target_8.getCondition().(VariableAccess).getTarget()=vret_7048
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_st_7141
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vneed_free_7049
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_8.getThen().(BlockStmt).getStmt(2).(GotoStmt).getName() ="out_unlock"
	and target_56.getLocation().isBefore(target_8.getLocation())
}

predicate func_10(Variable vosb_7054) {
exists(Initializer target_10 |
	target_10.getExpr().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_10.getExpr().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition() instanceof RelationalOperation
	and target_10.getExpr().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen() instanceof BinaryBitwiseOperation
	and target_10.getExpr().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(PointerFieldAccess).getTarget().getName()="s_clustersize"
	and target_10.getExpr().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_10.getExpr().(BuiltInChooseExpr).getChild(2).(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_10.getExpr().(BuiltInChooseExpr).getChild(2).(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getElse().(VariableAccess).getType().hasName("unsigned int"))
}

/*predicate func_12(Function func) {
exists(ConditionalExpr target_12 |
	target_12.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_12.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_12.getThen().(VariableAccess).getType().hasName("unsigned int")
	and target_12.getElse().(VariableAccess).getType().hasName("unsigned int")
	and target_12.getEnclosingFunction() = func)
}

*/
predicate func_15(Parameter vinode_7045, Variable vnum_pages_7048, Variable vpages_7057, Variable vend_7058) {
exists(AddressOfExpr target_15 |
	target_15.getOperand().(VariableAccess).getType().hasName("page *")
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ocfs2_grab_eof_pages")
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vend_7058
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpages_7057
	and target_15.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vnum_pages_7048)
}

predicate func_20(Variable vnum_pages_7048, Variable vpages_7057) {
exists(AddressOfExpr target_20 |
	target_20.getOperand().(VariableAccess).getType().hasName("page *")
	and target_20.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_unlock_and_free_pages")
	and target_20.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpages_7057
	and target_20.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnum_pages_7048)
}

predicate func_21(Variable vosb_7054, ExprStmt target_58, BinaryBitwiseOperation target_21) {
	target_21.getValue()="4096"
	and target_21.getParent().(GTExpr).getLesserOperand().(PointerFieldAccess).getTarget().getName()="s_clustersize"
	and target_21.getParent().(GTExpr).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_21.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_58
}

/*predicate func_22(Variable vosb_7054, ExprStmt target_58, PointerFieldAccess target_22) {
	target_22.getTarget().getName()="s_clustersize"
	and target_22.getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_22.getParent().(GTExpr).getGreaterOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_22.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_58
}

*/
predicate func_23(Variable vosb_7054, PointerFieldAccess target_23) {
	target_23.getTarget().getName()="s_clustersize"
	and target_23.getQualifier().(VariableAccess).getTarget()=vosb_7054
}

predicate func_24(Variable vret_7048, EqualityOperation target_59, ReturnStmt target_24) {
	target_24.getExpr().(VariableAccess).getTarget()=vret_7048
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_25(Variable vosb_7054, ExprStmt target_60, RelationalOperation target_25) {
	 (target_25 instanceof GTExpr or target_25 instanceof LTExpr)
	and target_25.getLesserOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_25.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="s_clustersize"
	and target_25.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_25.getParent().(LogicalAndExpr).getLeftOperand() instanceof NotExpr
	and target_25.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_60
}

predicate func_26(Variable vend_7058, BinaryBitwiseOperation target_26) {
	target_26.getValue()="4096"
	and target_26.getParent().(AssignExpr).getRValue() = target_26
	and target_26.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_7058
}

predicate func_27(Variable vpage_end_7096, BinaryBitwiseOperation target_27) {
	target_27.getValue()="4096"
	and target_27.getParent().(AssignExpr).getRValue() = target_27
	and target_27.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpage_end_7096
}

predicate func_28(Variable vosb_7054, Variable vpage_end_7096, PointerFieldAccess target_28) {
	target_28.getTarget().getName()="s_clustersize"
	and target_28.getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_28.getParent().(AssignExpr).getRValue() = target_28
	and target_28.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpage_end_7096
}

predicate func_29(Parameter vinode_7045, Variable vhandle_7051, Variable vpage_end_7096, Variable vphys_7097, VariableAccess target_29) {
	target_29.getTarget()=vpage_end_7096
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_map_and_dirty_page")
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_7051
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4) instanceof ArrayExpr
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(5) instanceof RelationalOperation
	and target_29.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vphys_7097
}

predicate func_34(Variable vosb_7054, Variable vpages_7057, AssignExpr target_34) {
	target_34.getLValue().(VariableAccess).getTarget()=vpages_7057
	and target_34.getRValue().(FunctionCall).getTarget().hasName("kcalloc")
	and target_34.getRValue().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("ocfs2_pages_per_cluster")
	and target_34.getRValue().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="sb"
	and target_34.getRValue().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_34.getRValue().(FunctionCall).getArgument(1) instanceof SizeofTypeOperator
	and target_34.getRValue().(FunctionCall).getArgument(2).(BitwiseOrExpr).getValue()="3136"
}

predicate func_35(Variable vpages_7057, BlockStmt target_61, ExprStmt target_55, VariableAccess target_35) {
	target_35.getTarget()=vpages_7057
	and target_35.getParent().(EQExpr).getRightOperand() instanceof Literal
	and target_35.getParent().(EQExpr).getParent().(IfStmt).getThen()=target_61
	and target_35.getLocation().isBefore(target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
}

predicate func_36(Variable vret_7048, UnaryMinusExpr target_36) {
	target_36.getValue()="-12"
	and target_36.getParent().(AssignExpr).getRValue() = target_36
	and target_36.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7048
}

predicate func_37(Variable v_st_7069, EqualityOperation target_59, ExprStmt target_37) {
	target_37.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=v_st_7069
	and target_37.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
	and target_37.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_st_7069
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

predicate func_38(Variable vosb_7054, Variable vend_7058, VariableAccess target_63, IfStmt target_38) {
	target_38.getCondition().(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("ocfs2_sparse_alloc")
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vosb_7054
	and target_38.getCondition().(LogicalAndExpr).getRightOperand() instanceof RelationalOperation
	and target_38.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_7058
	and target_38.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof BinaryBitwiseOperation
	and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_63
}

/*predicate func_39(Variable vend_7058, AssignExpr target_39) {
	target_39.getLValue().(VariableAccess).getTarget()=vend_7058
	and target_39.getRValue() instanceof BinaryBitwiseOperation
}

*/
predicate func_40(Parameter vinode_7045, Variable vnum_pages_7048, Variable vpages_7057, Variable vend_7058, VariableAccess target_40) {
	target_40.getTarget()=vend_7058
	and target_40.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ocfs2_grab_eof_pages")
	and target_40.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_40.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_40.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpages_7057
	and target_40.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vnum_pages_7048
}

/*predicate func_41(Parameter vinode_7045, Variable vnum_pages_7048, Variable vpages_7057, Variable vend_7058, ExprStmt target_64, ExprStmt target_56, RelationalOperation target_66, EqualityOperation target_59, ArrayExpr target_43, ExprStmt target_60, VariableAccess target_41) {
	target_41.getTarget()=vpages_7057
	and target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ocfs2_grab_eof_pages")
	and target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vend_7058
	and target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vnum_pages_7048
	and target_64.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_41.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getLocation().isBefore(target_66.getGreaterOperand().(VariableAccess).getLocation())
	and target_59.getLeftOperand().(VariableAccess).getLocation().isBefore(target_41.getLocation())
	and target_41.getLocation().isBefore(target_43.getArrayBase().(VariableAccess).getLocation())
}

*/
predicate func_42(Parameter vinode_7045, Parameter vdi_bh_7046, Variable vret_7048, Variable vpages_7057, AssignExpr target_42) {
	target_42.getLValue().(VariableAccess).getTarget()=vret_7048
	and target_42.getRValue().(FunctionCall).getTarget().hasName("ocfs2_read_inline_data")
	and target_42.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_42.getRValue().(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_7057
	and target_42.getRValue().(FunctionCall).getArgument(1).(ArrayExpr).getArrayOffset() instanceof Literal
	and target_42.getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vdi_bh_7046
}

predicate func_43(Variable vpages_7057, ArrayExpr target_43) {
	target_43.getArrayBase().(VariableAccess).getTarget()=vpages_7057
	and target_43.getArrayOffset() instanceof Literal
}

predicate func_44(Variable vpage_end_7096, VariableAccess target_63, ExprStmt target_44) {
	target_44.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpage_end_7096
	and target_44.getExpr().(AssignExpr).getRValue() instanceof BinaryBitwiseOperation
	and target_44.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_63
}

predicate func_45(Variable vosb_7054, Variable vpage_end_7096, VariableAccess target_63, IfStmt target_45) {
	target_45.getCondition().(RelationalOperation).getGreaterOperand() instanceof BinaryBitwiseOperation
	and target_45.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="s_clustersize"
	and target_45.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_45.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpage_end_7096
	and target_45.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="s_clustersize"
	and target_45.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_45.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_63
}

predicate func_46(Parameter vinode_7045, Variable vi_7048, Variable vnum_pages_7048, Variable vhandle_7051, Variable vpages_7057, Variable vpage_end_7096, Variable vphys_7097, VariableAccess target_63, ForStmt target_46) {
	target_46.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vi_7048
	and target_46.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_46.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vi_7048
	and target_46.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vnum_pages_7048
	and target_46.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vi_7048
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_map_and_dirty_page")
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_7051
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpage_end_7096
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_7057
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_7048
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vi_7048
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(RelationalOperation).getLesserOperand() instanceof Literal
	and target_46.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vphys_7097
	and target_46.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_63
}

/*predicate func_47(Variable vi_7048, Variable vnum_pages_7048, ExprStmt target_67, AddressOfExpr target_68, ExprStmt target_69, VariableAccess target_47) {
	target_47.getTarget()=vi_7048
	and target_47.getParent().(LTExpr).getGreaterOperand().(VariableAccess).getTarget()=vnum_pages_7048
	and target_47.getParent().(LTExpr).getParent().(ForStmt).getStmt()=target_67
	and target_68.getOperand().(VariableAccess).getLocation().isBefore(target_47.getParent().(LTExpr).getGreaterOperand().(VariableAccess).getLocation())
	and target_47.getParent().(LTExpr).getGreaterOperand().(VariableAccess).getLocation().isBefore(target_69.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
}

*/
/*predicate func_48(Variable vi_7048, Variable vnum_pages_7048, ExprStmt target_67, AddressOfExpr target_68, ExprStmt target_69, VariableAccess target_48) {
	target_48.getTarget()=vnum_pages_7048
	and target_48.getParent().(LTExpr).getLesserOperand().(VariableAccess).getTarget()=vi_7048
	and target_48.getParent().(LTExpr).getParent().(ForStmt).getStmt()=target_67
	and target_68.getOperand().(VariableAccess).getLocation().isBefore(target_48.getLocation())
	and target_48.getLocation().isBefore(target_69.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
}

*/
/*predicate func_49(Parameter vinode_7045, Variable vi_7048, Variable vhandle_7051, Variable vpages_7057, Variable vpage_end_7096, Variable vphys_7097, ArrayExpr target_49) {
	target_49.getArrayBase().(VariableAccess).getTarget()=vpages_7057
	and target_49.getArrayOffset().(VariableAccess).getTarget()=vi_7048
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_map_and_dirty_page")
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_7051
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpage_end_7096
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vi_7048
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(5).(RelationalOperation).getLesserOperand() instanceof Literal
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vphys_7097
}

*/
/*predicate func_50(Parameter vinode_7045, Variable vi_7048, Variable vhandle_7051, Variable vpages_7057, Variable vpage_end_7096, Variable vphys_7097, RelationalOperation target_50) {
	 (target_50 instanceof GTExpr or target_50 instanceof LTExpr)
	and target_50.getGreaterOperand().(VariableAccess).getTarget()=vi_7048
	and target_50.getLesserOperand() instanceof Literal
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_map_and_dirty_page")
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_7051
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpage_end_7096
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vpages_7057
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_7048
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vphys_7097
}

*/
predicate func_51(Variable vnum_pages_7048, Variable vpages_7057, Function func, IfStmt target_51) {
	target_51.getCondition().(VariableAccess).getTarget()=vpages_7057
	and target_51.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_unlock_and_free_pages")
	and target_51.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpages_7057
	and target_51.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnum_pages_7048
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
}

/*predicate func_52(Variable vnum_pages_7048, Variable vpages_7057, RelationalOperation target_66, IfStmt target_51, ExprStmt target_53, VariableAccess target_52) {
	target_52.getTarget()=vpages_7057
	and target_52.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ocfs2_unlock_and_free_pages")
	and target_52.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnum_pages_7048
	and target_66.getGreaterOperand().(VariableAccess).getLocation().isBefore(target_52.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
	and target_51.getCondition().(VariableAccess).getLocation().isBefore(target_52.getLocation())
	and target_52.getLocation().isBefore(target_53.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
}

*/
predicate func_53(Variable vpages_7057, Function func, ExprStmt target_53) {
	target_53.getExpr().(FunctionCall).getTarget().hasName("kfree")
	and target_53.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpages_7057
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_53
}

predicate func_54(Variable vret_7048, Function func, ReturnStmt target_54) {
	target_54.getExpr().(VariableAccess).getTarget()=vret_7048
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_54
}

predicate func_55(Parameter vinode_7045, Variable vret_7048, Variable vnum_pages_7048, Variable vpages_7057, Variable vend_7058, ExprStmt target_55) {
	target_55.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7048
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ocfs2_grab_eof_pages")
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vend_7058
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpages_7057
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vnum_pages_7048
}

predicate func_56(Function func, ExprStmt target_56) {
	target_56.getExpr() instanceof AssignExpr
	and target_56.getEnclosingFunction() = func
}

predicate func_58(Function func, ExprStmt target_58) {
	target_58.getExpr() instanceof AssignExpr
	and target_58.getEnclosingFunction() = func
}

predicate func_59(Variable vpages_7057, EqualityOperation target_59) {
	target_59.getLeftOperand().(VariableAccess).getTarget()=vpages_7057
	and target_59.getRightOperand() instanceof Literal
}

predicate func_60(Function func, ExprStmt target_60) {
	target_60.getExpr() instanceof AssignExpr
	and target_60.getEnclosingFunction() = func
}

predicate func_61(Variable vret_7048, BlockStmt target_61) {
	target_61.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7048
	and target_61.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof UnaryMinusExpr
	and target_61.getStmt(1) instanceof ExprStmt
	and target_61.getStmt(2) instanceof ReturnStmt
}

predicate func_63(Variable vhas_data_7048, BlockStmt target_70, VariableAccess target_63) {
	target_63.getTarget()=vhas_data_7048
	and target_63.getParent().(IfStmt).getThen()=target_70
}

predicate func_64(Parameter vinode_7045, Variable vphys_7097, ExprStmt target_64) {
	target_64.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("u64")
	and target_64.getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(VariableAccess).getTarget()=vphys_7097
	and target_64.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ocfs2_clusters_to_blocks")
	and target_64.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="i_sb"
	and target_64.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinode_7045
	and target_64.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget().getType().hasName("u32")
}

predicate func_66(Variable vi_7048, Variable vnum_pages_7048, RelationalOperation target_66) {
	 (target_66 instanceof GTExpr or target_66 instanceof LTExpr)
	and target_66.getLesserOperand().(VariableAccess).getTarget()=vi_7048
	and target_66.getGreaterOperand().(VariableAccess).getTarget()=vnum_pages_7048
}

predicate func_67(Parameter vinode_7045, Variable vhandle_7051, Variable vpage_end_7096, Variable vphys_7097, ExprStmt target_67) {
	target_67.getExpr().(FunctionCall).getTarget().hasName("ocfs2_map_and_dirty_page")
	and target_67.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_67.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_7051
	and target_67.getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_67.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vpage_end_7096
	and target_67.getExpr().(FunctionCall).getArgument(4) instanceof ArrayExpr
	and target_67.getExpr().(FunctionCall).getArgument(5) instanceof RelationalOperation
	and target_67.getExpr().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vphys_7097
}

predicate func_68(Variable vnum_pages_7048, AddressOfExpr target_68) {
	target_68.getOperand().(VariableAccess).getTarget()=vnum_pages_7048
}

predicate func_69(Variable vnum_pages_7048, Variable vpages_7057, ExprStmt target_69) {
	target_69.getExpr().(FunctionCall).getTarget().hasName("ocfs2_unlock_and_free_pages")
	and target_69.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpages_7057
	and target_69.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnum_pages_7048
}

predicate func_70(Parameter vinode_7045, Variable vret_7048, Variable vosb_7054, BlockStmt target_70) {
	target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7048
	and target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("dquot_alloc_space_nodirty")
	and target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinode_7045
	and target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(FunctionCall).getTarget().hasName("ocfs2_clusters_to_bytes")
	and target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="sb"
	and target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vosb_7054
	and target_70.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(FunctionCall).getArgument(1).(Literal).getValue()="1"
}

from Function func, Parameter vinode_7045, Parameter vdi_bh_7046, Variable vret_7048, Variable vi_7048, Variable vhas_data_7048, Variable vnum_pages_7048, Variable vneed_free_7049, Variable vhandle_7051, Variable vosb_7054, Variable vpages_7057, Variable vend_7058, Variable v_st_7069, Variable vpage_end_7096, Variable vphys_7097, Variable v_st_7130, Variable v_st_7141, Initializer target_0, Initializer target_1, SizeofTypeOperator target_2, Literal target_3, Literal target_4, Literal target_5, Literal target_6, IfStmt target_7, IfStmt target_8, BinaryBitwiseOperation target_21, PointerFieldAccess target_23, ReturnStmt target_24, RelationalOperation target_25, BinaryBitwiseOperation target_26, BinaryBitwiseOperation target_27, PointerFieldAccess target_28, VariableAccess target_29, AssignExpr target_34, VariableAccess target_35, UnaryMinusExpr target_36, ExprStmt target_37, IfStmt target_38, VariableAccess target_40, AssignExpr target_42, ArrayExpr target_43, ExprStmt target_44, IfStmt target_45, ForStmt target_46, IfStmt target_51, ExprStmt target_53, ReturnStmt target_54, ExprStmt target_55, ExprStmt target_56, ExprStmt target_58, EqualityOperation target_59, ExprStmt target_60, BlockStmt target_61, VariableAccess target_63, ExprStmt target_64, RelationalOperation target_66, ExprStmt target_67, AddressOfExpr target_68, ExprStmt target_69, BlockStmt target_70
where
func_0(func, target_0)
and func_1(vosb_7054, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(func, target_6)
and func_7(vret_7048, vneed_free_7049, v_st_7130, target_55, target_7)
and func_8(vret_7048, vneed_free_7049, v_st_7141, target_56, target_8)
and not func_10(vosb_7054)
and not func_15(vinode_7045, vnum_pages_7048, vpages_7057, vend_7058)
and not func_20(vnum_pages_7048, vpages_7057)
and func_21(vosb_7054, target_58, target_21)
and func_23(vosb_7054, target_23)
and func_24(vret_7048, target_59, target_24)
and func_25(vosb_7054, target_60, target_25)
and func_26(vend_7058, target_26)
and func_27(vpage_end_7096, target_27)
and func_28(vosb_7054, vpage_end_7096, target_28)
and func_29(vinode_7045, vhandle_7051, vpage_end_7096, vphys_7097, target_29)
and func_34(vosb_7054, vpages_7057, target_34)
and func_35(vpages_7057, target_61, target_55, target_35)
and func_36(vret_7048, target_36)
and func_37(v_st_7069, target_59, target_37)
and func_38(vosb_7054, vend_7058, target_63, target_38)
and func_40(vinode_7045, vnum_pages_7048, vpages_7057, vend_7058, target_40)
and func_42(vinode_7045, vdi_bh_7046, vret_7048, vpages_7057, target_42)
and func_43(vpages_7057, target_43)
and func_44(vpage_end_7096, target_63, target_44)
and func_45(vosb_7054, vpage_end_7096, target_63, target_45)
and func_46(vinode_7045, vi_7048, vnum_pages_7048, vhandle_7051, vpages_7057, vpage_end_7096, vphys_7097, target_63, target_46)
and func_51(vnum_pages_7048, vpages_7057, func, target_51)
and func_53(vpages_7057, func, target_53)
and func_54(vret_7048, func, target_54)
and func_55(vinode_7045, vret_7048, vnum_pages_7048, vpages_7057, vend_7058, target_55)
and func_56(func, target_56)
and func_58(func, target_58)
and func_59(vpages_7057, target_59)
and func_60(func, target_60)
and func_61(vret_7048, target_61)
and func_63(vhas_data_7048, target_70, target_63)
and func_64(vinode_7045, vphys_7097, target_64)
and func_66(vi_7048, vnum_pages_7048, target_66)
and func_67(vinode_7045, vhandle_7051, vpage_end_7096, vphys_7097, target_67)
and func_68(vnum_pages_7048, target_68)
and func_69(vnum_pages_7048, vpages_7057, target_69)
and func_70(vinode_7045, vret_7048, vosb_7054, target_70)
and vinode_7045.getType().hasName("inode *")
and vdi_bh_7046.getType().hasName("buffer_head *")
and vret_7048.getType().hasName("int")
and vi_7048.getType().hasName("int")
and vhas_data_7048.getType().hasName("int")
and vnum_pages_7048.getType().hasName("int")
and vneed_free_7049.getType().hasName("int")
and vhandle_7051.getType().hasName("handle_t *")
and vosb_7054.getType().hasName("ocfs2_super *")
and vpages_7057.getType().hasName("page **")
and vend_7058.getType().hasName("loff_t")
and v_st_7069.getType().hasName("int")
and vpage_end_7096.getType().hasName("unsigned int")
and vphys_7097.getType().hasName("u64")
and v_st_7130.getType().hasName("int")
and v_st_7141.getType().hasName("int")
and vinode_7045.getFunction() = func
and vdi_bh_7046.getFunction() = func
and vret_7048.(LocalVariable).getFunction() = func
and vi_7048.(LocalVariable).getFunction() = func
and vhas_data_7048.(LocalVariable).getFunction() = func
and vnum_pages_7048.(LocalVariable).getFunction() = func
and vneed_free_7049.(LocalVariable).getFunction() = func
and vhandle_7051.(LocalVariable).getFunction() = func
and vosb_7054.(LocalVariable).getFunction() = func
and vpages_7057.(LocalVariable).getFunction() = func
and vend_7058.(LocalVariable).getFunction() = func
and v_st_7069.(LocalVariable).getFunction() = func
and vpage_end_7096.(LocalVariable).getFunction() = func
and vphys_7097.(LocalVariable).getFunction() = func
and v_st_7130.(LocalVariable).getFunction() = func
and v_st_7141.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
