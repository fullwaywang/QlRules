/**
 * @name postgresql-18b585155a891784ca8985f595ebc0dde94e0d43-array_set_element_expanded
 * @id cpp/postgresql/18b585155a891784ca8985f595ebc0dde94e0d43/array-set-element-expanded
 * @description postgresql-18b585155a891784ca8985f595ebc0dde94e0d43-src/backend/utils/adt/arrayfuncs.c-array_set_element_expanded CVE-2023-5869
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vdim_2499, Variable vaddedbefore_2504, RelationalOperation target_24, ExprStmt target_25, ExprStmt target_27, RelationalOperation target_28) {
	exists(IfStmt target_0 |
		target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof ArrayExpr
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedbefore_2504
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedbefore_2504
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_0.getThen().(DoStmt).getCondition() instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getCondition().(LogicalAndExpr).getValue()="1"
		/*and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getValue()="1"
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")*/
		and target_0.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_0
		and target_0.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_24
		and target_25.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getLocation())
		and target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getLocation())
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getLocation().isBefore(target_28.getGreaterOperand().(VariableAccess).getLocation()))
}

/*predicate func_1(BlockStmt target_29, Function func) {
	exists(ConditionalExpr target_1 |
		target_1.getCondition().(LogicalAndExpr).getValue()="1"
		and target_1.getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_1.getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_1.getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_1.getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_1.getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_1.getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_1.getParent().(IfStmt).getThen()=target_29
		and target_1.getEnclosingFunction() = func)
}

*/
/*predicate func_2(Variable v__func__, ExprStmt target_30) {
	exists(CommaExpr target_2 |
		target_2.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_2.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="261"
		and target_2.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_2.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array size exceeds the maximum allowed (%d)"
		and target_2.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(DivExpr).getValue()="134217727"
		and target_2.getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_2.getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_2.getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_2.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_2.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

*/
predicate func_4(Variable vdim_2499, Variable vdimschanged_2502, Variable vnewhasnulls_2503, Variable vaddedafter_2505, EqualityOperation target_31, RelationalOperation target_10, ExprStmt target_33, IfStmt target_34, ExprStmt target_35, LogicalAndExpr target_36, RelationalOperation target_38) {
	exists(IfStmt target_4 |
		target_4.getCondition() instanceof RelationalOperation
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof AddExpr
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddedafter_2505
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(Literal).getValue()="1"
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedafter_2505
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
		and target_4.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vdimschanged_2502
		and target_4.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_4.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vaddedafter_2505
		and target_4.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_4.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2503
		and target_4.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_4.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_4
		and target_4.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_31
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getLocation())
		and target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_4.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
		and target_4.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_34.getCondition().(VariableAccess).getLocation())
		and target_35.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_4.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
		and target_4.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_36.getAnOperand().(VariableAccess).getLocation())
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_38.getGreaterOperand().(VariableAccess).getLocation()))
}

/*predicate func_5(Variable vdim_2499, Variable vaddedafter_2505, RelationalOperation target_10) {
	exists(IfStmt target_5 |
		target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof AddExpr
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedafter_2505
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddedafter_2505
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(Literal).getValue()="1"
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedafter_2505
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedafter_2505
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_5.getThen().(DoStmt).getCondition() instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getCondition().(LogicalAndExpr).getValue()="1"
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getValue()="1"
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
		and target_5.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_5
		and target_5.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_10)
}

*/
/*predicate func_6(Variable v__func__, ExprStmt target_40) {
	exists(CommaExpr target_6 |
		target_6.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_6.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="261"
		and target_6.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_6.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array size exceeds the maximum allowed (%d)"
		and target_6.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(DivExpr).getValue()="134217727"
		and target_6.getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_6.getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_6.getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_6.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_6.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_40.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

*/
predicate func_8(Variable vlb_2500, ArrayExpr target_8) {
		target_8.getArrayBase().(VariableAccess).getTarget()=vlb_2500
		and target_8.getArrayOffset().(Literal).getValue()="0"
}

predicate func_9(Parameter vindx_2489, ArrayExpr target_9) {
		target_9.getArrayBase().(VariableAccess).getTarget()=vindx_2489
		and target_9.getArrayOffset().(Literal).getValue()="0"
}

predicate func_10(Parameter vindx_2489, Variable vdim_2499, Variable vlb_2500, BlockStmt target_29, RelationalOperation target_10) {
		 (target_10 instanceof GEExpr or target_10 instanceof LEExpr)
		and target_10.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vindx_2489
		and target_10.getGreaterOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2500
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_10.getParent().(IfStmt).getThen()=target_29
}

predicate func_11(Parameter vindx_2489, ArrayExpr target_11) {
		target_11.getArrayBase().(VariableAccess).getTarget()=vindx_2489
		and target_11.getArrayOffset().(Literal).getValue()="0"
}

predicate func_12(Variable vdim_2499, Variable vlb_2500, AddExpr target_12) {
		target_12.getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_12.getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_12.getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2500
		and target_12.getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_13(Variable vdim_2499, Variable vaddedbefore_2504, ArrayExpr target_13) {
		target_13.getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_13.getArrayOffset().(Literal).getValue()="0"
		and target_13.getParent().(AssignAddExpr).getLValue() = target_13
		and target_13.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vaddedbefore_2504
}

predicate func_14(Variable vdim_2499, Variable vaddedafter_2505, ArrayExpr target_14) {
		target_14.getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_14.getArrayOffset().(Literal).getValue()="0"
		and target_14.getParent().(AssignAddExpr).getLValue() = target_14
		and target_14.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vaddedafter_2505
}

predicate func_15(Variable vaddedbefore_2504, VariableAccess target_15) {
		target_15.getTarget()=vaddedbefore_2504
		and target_15.getParent().(AssignExpr).getLValue() = target_15
		and target_15.getParent().(AssignExpr).getRValue() instanceof SubExpr
}

/*predicate func_16(Variable vdim_2499, Variable vaddedbefore_2504, VariableAccess target_16) {
		target_16.getTarget()=vaddedbefore_2504
		and target_16.getParent().(AssignAddExpr).getRValue() = target_16
		and target_16.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_16.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

*/
predicate func_17(Variable vaddedafter_2505, VariableAccess target_17) {
		target_17.getTarget()=vaddedafter_2505
		and target_17.getParent().(AssignExpr).getLValue() = target_17
		and target_17.getParent().(AssignExpr).getRValue() instanceof AddExpr
}

/*predicate func_19(Variable vdim_2499, Variable vaddedafter_2505, VariableAccess target_19) {
		target_19.getTarget()=vaddedafter_2505
		and target_19.getParent().(AssignAddExpr).getRValue() = target_19
		and target_19.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_19.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

*/
predicate func_20(Variable vaddedbefore_2504, AssignExpr target_20) {
		target_20.getLValue().(VariableAccess).getTarget()=vaddedbefore_2504
		and target_20.getRValue().(SubExpr).getLeftOperand() instanceof ArrayExpr
		and target_20.getRValue().(SubExpr).getRightOperand() instanceof ArrayExpr
}

predicate func_21(Variable vaddedbefore_2504, AssignAddExpr target_21) {
		target_21.getLValue() instanceof ArrayExpr
		and target_21.getRValue().(VariableAccess).getTarget()=vaddedbefore_2504
}

predicate func_22(Variable vaddedafter_2505, AssignExpr target_22) {
		target_22.getLValue().(VariableAccess).getTarget()=vaddedafter_2505
		and target_22.getRValue().(AddExpr).getAnOperand().(SubExpr).getLeftOperand() instanceof ArrayExpr
		and target_22.getRValue().(AddExpr).getAnOperand().(SubExpr).getRightOperand() instanceof AddExpr
		and target_22.getRValue().(AddExpr).getAnOperand() instanceof Literal
}

predicate func_23(Variable vaddedafter_2505, AssignAddExpr target_23) {
		target_23.getLValue() instanceof ArrayExpr
		and target_23.getRValue().(VariableAccess).getTarget()=vaddedafter_2505
}

predicate func_24(Parameter vindx_2489, Variable vlb_2500, RelationalOperation target_24) {
		 (target_24 instanceof GTExpr or target_24 instanceof LTExpr)
		and target_24.getLesserOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vindx_2489
		and target_24.getLesserOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_24.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2500
		and target_24.getGreaterOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_25(Variable vdim_2499, ExprStmt target_25) {
		target_25.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2499
		and target_25.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget().getType().hasName("int")
		and target_25.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_27(Variable vaddedbefore_2504, Variable vaddedafter_2505, ExprStmt target_27) {
		target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddedbefore_2504
		and target_27.getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddedafter_2505
		and target_27.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_28(Variable vaddedbefore_2504, RelationalOperation target_28) {
		 (target_28 instanceof GTExpr or target_28 instanceof LTExpr)
		and target_28.getGreaterOperand().(VariableAccess).getTarget()=vaddedbefore_2504
		and target_28.getLesserOperand().(Literal).getValue()="1"
}

predicate func_29(Variable vdimschanged_2502, Variable vnewhasnulls_2503, Variable vaddedafter_2505, BlockStmt target_29) {
		target_29.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
		and target_29.getStmt(1).(ExprStmt).getExpr() instanceof AssignAddExpr
		and target_29.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vdimschanged_2502
		and target_29.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_29.getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vaddedafter_2505
		and target_29.getStmt(3).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_29.getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2503
		and target_29.getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
}

/*
predicate func_30(Variable v__func__, ExprStmt target_30) {
		target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="352845954"
		and target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="wrong number of array subscripts"
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
}
*/

predicate func_31(Function func, EqualityOperation target_31) {
		target_31.getAnOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_31.getAnOperand().(Literal).getValue()="1"
		and target_31.getEnclosingFunction() = func
}

predicate func_33(Variable vdimschanged_2502, RelationalOperation target_24, ExprStmt target_33) {
		target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vdimschanged_2502
		and target_33.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_33.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_24
}

predicate func_34(Variable vdim_2499, Variable vlb_2500, Variable vdimschanged_2502, IfStmt target_34) {
		target_34.getCondition().(VariableAccess).getTarget()=vdimschanged_2502
		and target_34.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ArrayGetNItems")
		and target_34.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("int")
		and target_34.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vdim_2499
		and target_34.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ArrayCheckBounds")
		and target_34.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("int")
		and target_34.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vdim_2499
		and target_34.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vlb_2500
}

predicate func_35(Variable vnewhasnulls_2503, RelationalOperation target_28, ExprStmt target_35) {
		target_35.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2503
		and target_35.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_35.getParent().(IfStmt).getCondition()=target_28
}

predicate func_36(Variable vnewhasnulls_2503, LogicalAndExpr target_36) {
		target_36.getAnOperand().(VariableAccess).getTarget()=vnewhasnulls_2503
		and target_36.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget().getType().hasName("bool *")
		and target_36.getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
}

predicate func_38(Variable vaddedafter_2505, RelationalOperation target_38) {
		 (target_38 instanceof GTExpr or target_38 instanceof LTExpr)
		and target_38.getGreaterOperand().(VariableAccess).getTarget()=vaddedafter_2505
		and target_38.getLesserOperand().(Literal).getValue()="0"
}

/*
predicate func_40(Variable v__func__, ExprStmt target_40) {
		target_40.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_40.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="352845954"
		and target_40.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_40.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array subscript out of range"
		and target_40.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_40.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_40.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_40.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
}
*/

from Function func, Parameter vindx_2489, Variable vdim_2499, Variable vlb_2500, Variable vdimschanged_2502, Variable vnewhasnulls_2503, Variable vaddedbefore_2504, Variable vaddedafter_2505, Variable v__func__, ArrayExpr target_8, ArrayExpr target_9, RelationalOperation target_10, ArrayExpr target_11, AddExpr target_12, ArrayExpr target_13, ArrayExpr target_14, VariableAccess target_15, VariableAccess target_17, AssignExpr target_20, AssignAddExpr target_21, AssignExpr target_22, AssignAddExpr target_23, RelationalOperation target_24, ExprStmt target_25, ExprStmt target_27, RelationalOperation target_28, BlockStmt target_29, /*ExprStmt target_30,*/ EqualityOperation target_31, ExprStmt target_33, IfStmt target_34, ExprStmt target_35, LogicalAndExpr target_36, RelationalOperation target_38/*, ExprStmt target_40*/
where
not func_0(vdim_2499, vaddedbefore_2504, target_24, target_25, target_27, target_28)
and not func_4(vdim_2499, vdimschanged_2502, vnewhasnulls_2503, vaddedafter_2505, target_31, target_10, target_33, target_34, target_35, target_36, target_38)
and func_8(vlb_2500, target_8)
and func_9(vindx_2489, target_9)
and func_10(vindx_2489, vdim_2499, vlb_2500, target_29, target_10)
and func_11(vindx_2489, target_11)
and func_12(vdim_2499, vlb_2500, target_12)
and func_13(vdim_2499, vaddedbefore_2504, target_13)
and func_14(vdim_2499, vaddedafter_2505, target_14)
and func_15(vaddedbefore_2504, target_15)
and func_17(vaddedafter_2505, target_17)
and func_20(vaddedbefore_2504, target_20)
and func_21(vaddedbefore_2504, target_21)
and func_22(vaddedafter_2505, target_22)
and func_23(vaddedafter_2505, target_23)
and func_24(vindx_2489, vlb_2500, target_24)
and func_25(vdim_2499, target_25)
and func_27(vaddedbefore_2504, vaddedafter_2505, target_27)
and func_28(vaddedbefore_2504, target_28)
and func_29(vdimschanged_2502, vnewhasnulls_2503, vaddedafter_2505, target_29)
//and func_30(v__func__, target_30)
and func_31(func, target_31)
and func_33(vdimschanged_2502, target_24, target_33)
and func_34(vdim_2499, vlb_2500, vdimschanged_2502, target_34)
and func_35(vnewhasnulls_2503, target_28, target_35)
and func_36(vnewhasnulls_2503, target_36)
and func_38(vaddedafter_2505, target_38)
//and func_40(v__func__, target_40)
and vindx_2489.getType().hasName("int *")
and vdim_2499.getType().hasName("int[6]")
and vlb_2500.getType().hasName("int[6]")
and vdimschanged_2502.getType().hasName("bool")
and vnewhasnulls_2503.getType().hasName("bool")
and vaddedbefore_2504.getType().hasName("int")
and vaddedafter_2505.getType().hasName("int")
and v__func__.getType() instanceof ArrayType
and vindx_2489.getFunction() = func
and vdim_2499.(LocalVariable).getFunction() = func
and vlb_2500.(LocalVariable).getFunction() = func
and vdimschanged_2502.(LocalVariable).getFunction() = func
and vnewhasnulls_2503.(LocalVariable).getFunction() = func
and vaddedbefore_2504.(LocalVariable).getFunction() = func
and vaddedafter_2505.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
