commit e38e252dbceeef7d2f848017132efd68e9ae1416
Author: Bard Liao <yung-chuan.liao@linux.intel.com>
Date:   Mon Dec 4 15:41:59 2023 -0600

    ASoC: Intel: sof_sdw_rt_sdca_jack_common: ctx->headset_codec_dev = NULL
    
    sof_sdw_rt_sdca_jack_exit() are used by different codecs, and some of
    them use the same dai name.
    For example, rt712 and rt713 both use "rt712-sdca-aif1" and
    sof_sdw_rt_sdca_jack_exit().
    As a result, sof_sdw_rt_sdca_jack_exit() will be called twice by
    mc_dailink_exit_loop(). Set ctx->headset_codec_dev = NULL; after
    put_device(ctx->headset_codec_dev); to avoid ctx->headset_codec_dev
    being put twice.
    
    Fixes: 5360c6704638 ("ASoC: Intel: sof_sdw: add rt712 support")
    Reviewed-by: PÃ©ter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Signed-off-by: Bard Liao <yung-chuan.liao@linux.intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Link: https://lore.kernel.org/r/20231204214200.203100-5-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

diff --git a/sound/soc/intel/boards/sof_sdw_rt_sdca_jack_common.c b/sound/soc/intel/boards/sof_sdw_rt_sdca_jack_common.c
index e430be7681d2..1e5725f0ae33 100644
--- a/sound/soc/intel/boards/sof_sdw_rt_sdca_jack_common.c
+++ b/sound/soc/intel/boards/sof_sdw_rt_sdca_jack_common.c
@@ -176,6 +176,7 @@ int sof_sdw_rt_sdca_jack_exit(struct snd_soc_card *card, struct snd_soc_dai_link
 
 	device_remove_software_node(ctx->headset_codec_dev);
 	put_device(ctx->headset_codec_dev);
+	ctx->headset_codec_dev = NULL;
 
 	return 0;
 }
