commit 9dea1181c3af5209ba02fadf8e1a229b33b2ca6b	9dea1181c3af5209ba02fadf8e1a229b33b2ca6b
Author: Andrii Natiahlyi <natiahlyi@google.com>
Date:   Mon Sep 18 13:41:17 2023 +0000

    Fix PasswordManagerPorter is called after destruction
    
    Fixed: 1478889
    Change-Id: I3acbf5dea56ea16a23a5799c241ca9aeb7ff091a
    Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/4872120
    Auto-Submit: Andrii Natiahlyi <natiahlyi@google.com>
    Commit-Queue: Vasilii Sukhanov <vasilii@chromium.org>
    Reviewed-by: Vasilii Sukhanov <vasilii@chromium.org>
    Commit-Queue: Andrii Natiahlyi <natiahlyi@google.com>
    Cr-Commit-Position: refs/heads/main@{#1197799}

diff --git a/chrome/browser/ui/passwords/settings/password_manager_porter.cc b/chrome/browser/ui/passwords/settings/password_manager_porter.cc
index 54e049174f255..0a72750c86798 100644
--- a/chrome/browser/ui/passwords/settings/password_manager_porter.cc
+++ b/chrome/browser/ui/passwords/settings/password_manager_porter.cc
@@ -70,7 +70,13 @@ PasswordManagerPorter::PasswordManagerPorter(
       presenter_(presenter),
       on_export_progress_callback_(on_export_progress_callback) {}
 
-PasswordManagerPorter::~PasswordManagerPorter() = default;
+PasswordManagerPorter::~PasswordManagerPorter() {
+  // There may be open file selection dialogs. We need to let them know that we
+  // have gone away so that they do not attempt to call us back.
+  if (select_file_dialog_) {
+    select_file_dialog_->ListenerDestroyed();
+  }
+}
 
 bool PasswordManagerPorter::Export(content::WebContents* web_contents) {
   if (exporter_ && exporter_->GetProgressStatus() ==
