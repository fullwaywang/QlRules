/**
 * @name linux-df7e40425813c50cd252e6f5e348a81ef1acae56-hns_roce_alloc_ucontext
 * @id cpp/linux/df7e40425813c50cd252e6f5e348a81ef1acae56/hns-roce-alloc-ucontext
 * @description linux-df7e40425813c50cd252e6f5e348a81ef1acae56-drivers/infiniband/hw/hns/hns_roce_main.c-hns_roce_alloc_ucontext CVE-2019-16921
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func) {
	exists(Initializer target_0 |
		target_0.getExpr().(ClassAggregateLiteral).getType() instanceof Struct
		and target_0.getExpr().getEnclosingFunction() = func)
}

from Function func
where
not func_0(func)
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
