commit 82bf83a0639fbcd6c8daaf7a67ab6ce4f5654551	82bf83a0639fbcd6c8daaf7a67ab6ce4f5654551
Author: Dibyajyoti Pal <dibyapal@google.com>
Date:   Fri May 5 14:08:09 2023 +0000

    [dPWA] Make Cancel button default on PWA install dialogs.
    
    To prevent keyjacking schemes, ensure that the Cancel button is set as
    the default button instead of the Accept one so that users spoofed
    with multiple Enter keys do not install a spoofed app by mistake.
    
    The fix cannot be applied to the NONE button on the new detailed
    installed dialog because the DialogBuilder does not allow making
    buttons that are not implemented default.
    
    Bug: 1442018
    Change-Id: I94ea8558877698bca138ce50e62a213f58b973f0
    Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/4505003
    Reviewed-by: Dominick Ng <dominickn@chromium.org>
    Commit-Queue: Dibyajyoti Pal <dibyapal@chromium.org>
    Reviewed-by: Daniel Murphy <dmurph@chromium.org>
    Cr-Commit-Position: refs/heads/main@{#1140100}

diff --git a/chrome/browser/ui/views/web_apps/pwa_confirmation_bubble_view.cc b/chrome/browser/ui/views/web_apps/pwa_confirmation_bubble_view.cc
index d95e624fcdd78..29ea5f2ec2819 100644
--- a/chrome/browser/ui/views/web_apps/pwa_confirmation_bubble_view.cc
+++ b/chrome/browser/ui/views/web_apps/pwa_confirmation_bubble_view.cc
@@ -147,6 +147,8 @@ PWAConfirmationBubbleView::PWAConfirmationBubbleView(
         web_app::mojom::UserDisplayMode::kTabbed);
   }
 
+  SetDefaultButton(ui::DIALOG_BUTTON_CANCEL);
+
   SetHighlightedButton(highlight_icon_button_);
 
   if (g_dont_close_on_deactivate) {
diff --git a/chrome/browser/ui/views/web_apps/web_app_detailed_install_dialog.cc b/chrome/browser/ui/views/web_apps/web_app_detailed_install_dialog.cc
index f41a5a5f2e24b..7df2791aee7d4 100644
--- a/chrome/browser/ui/views/web_apps/web_app_detailed_install_dialog.cc
+++ b/chrome/browser/ui/views/web_apps/web_app_detailed_install_dialog.cc
@@ -366,6 +366,7 @@ void ShowWebAppDetailedInstallDialog(
                 delegate->OnCancel();
               },
               base::Unretained(delegate_ptr)))
+          .OverrideDefaultButton(ui::DialogButton::DIALOG_BUTTON_CANCEL)
           .Build();
 
   auto dialog = views::BubbleDialogModelHost::CreateModal(
