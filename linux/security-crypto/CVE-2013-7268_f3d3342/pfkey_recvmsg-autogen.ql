/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-pfkey_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/pfkey-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/key/af_key.c-pfkey_recvmsg CVE-2013-7268
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable verr_3613, UnaryMinusExpr target_0) {
		target_0.getValue()="-22"
		and target_0.getParent().(AssignExpr).getRValue() = target_0
		and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_3613
}

predicate func_1(Parameter vflags_3608, Literal target_1) {
		target_1.getValue()="32"
		and not target_1.getValue()="1"
		and target_1.getParent().(BitwiseAndExpr).getParent().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
}

predicate func_2(Variable vsk_3610, Initializer target_2) {
		target_2.getExpr().(FunctionCall).getTarget().hasName("pfkey_sk")
		and target_2.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
}

predicate func_3(Parameter vflags_3608, VariableAccess target_3) {
		target_3.getTarget()=vflags_3608
		and vflags_3608.getIndex() = 4
		and target_3.getParent().(BitwiseAndExpr).getRightOperand() instanceof ComplementExpr
		and target_3.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_4(Function func, Literal target_4) {
		target_4.getValue()="2"
		and not target_4.getValue()="220"
		and target_4.getParent().(BitwiseOrExpr).getParent().(BitwiseOrExpr).getLeftOperand() instanceof BitwiseOrExpr
		and target_4.getEnclosingFunction() = func
}

predicate func_5(Function func, Literal target_5) {
		target_5.getValue()="64"
		and not target_5.getValue()="0"
		and target_5.getParent().(BitwiseOrExpr).getParent().(BitwiseOrExpr).getLeftOperand() instanceof BitwiseOrExpr
		and target_5.getEnclosingFunction() = func
}

predicate func_6(Function func, Literal target_6) {
		target_6.getValue()="32"
		and not target_6.getValue()="1"
		and target_6.getParent().(BitwiseOrExpr).getParent().(BitwiseOrExpr).getLeftOperand() instanceof BitwiseOrExpr
		and target_6.getEnclosingFunction() = func
}

predicate func_7(Parameter vlen_3607, Variable vcopied_1_3613, BlockStmt target_53, ExprStmt target_54, VariableAccess target_7) {
		target_7.getTarget()=vcopied_1_3613
		and target_7.getParent().(GTExpr).getLesserOperand().(VariableAccess).getTarget()=vlen_3607
		and target_7.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_53
		and target_7.getParent().(GTExpr).getLesserOperand().(VariableAccess).getLocation().isBefore(target_54.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
}

predicate func_8(Variable vskb_3612, PointerFieldAccess target_8) {
		target_8.getTarget().getName()="len"
		and target_8.getQualifier().(VariableAccess).getTarget()=vskb_3612
}

predicate func_9(Function func, Literal target_9) {
		target_9.getValue()="3"
		and not target_9.getValue()="0"
		and target_9.getParent().(MulExpr).getParent().(LEExpr).getLesserOperand() instanceof MulExpr
		and target_9.getEnclosingFunction() = func
}

predicate func_10(Function func, FunctionCall target_10) {
		target_10.getTarget().hasName("atomic_read")
		and not target_10.getTarget().hasName("__dynamic_pr_debug")
		and target_10.getArgument(0).(AddressOfExpr).getOperand() instanceof ValueFieldAccess
		and target_10.getEnclosingFunction() = func
}

predicate func_12(Parameter vsock_3607, Parameter vlen_3607, Variable vsk_3610, ExprStmt target_54, ExprStmt target_27, Function func) {
	exists(DoStmt target_12 |
		target_12.getCondition() instanceof Literal
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__dynamic_pr_debug")
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("_ddebug")
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="sock %p sk %p len %zu\n"
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vsock_3607
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vsk_3610
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(VariableAccess).getTarget()=vlen_3607
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_12
		and target_54.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(VariableAccess).getLocation())
		and target_12.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_27.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

/*predicate func_13(Function func) {
	exists(FunctionCall target_13 |
		target_13.getTarget().hasName("__builtin_expect")
		and target_13.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
		and target_13.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("_ddebug")
		and target_13.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
		and target_13.getArgument(1) instanceof Literal
		and target_13.getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_13.getEnclosingFunction() = func)
}

*/
/*predicate func_14(Function func) {
	exists(AddressOfExpr target_14 |
		target_14.getOperand().(VariableAccess).getType().hasName("_ddebug")
		and target_14.getParent().(FunctionCall).getParent().(MulExpr).getRightOperand() instanceof FunctionCall
		and target_14.getEnclosingFunction() = func)
}

*/
predicate func_18(LogicalAndExpr target_50, Function func) {
	exists(ReturnStmt target_18 |
		target_18.getExpr().(UnaryMinusExpr).getValue()="-95"
		and target_18.getParent().(IfStmt).getCondition()=target_50
		and target_18.getEnclosingFunction() = func)
}

predicate func_19(Variable vskb_3612, ExprStmt target_55, ExprStmt target_56) {
	exists(NotExpr target_19 |
		target_19.getOperand().(VariableAccess).getTarget()=vskb_3612
		and target_19.getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_55.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_19.getOperand().(VariableAccess).getLocation())
		and target_19.getOperand().(VariableAccess).getLocation().isBefore(target_56.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_20(Variable vsk_3610, EqualityOperation target_57, ExprStmt target_27) {
	exists(IfStmt target_20 |
		target_20.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sk_shutdown"
		and target_20.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_20.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="1"
		and target_20.getThen().(ReturnStmt).getExpr().(Literal).getValue()="0"
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_20
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_57
		and target_27.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_20.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_21(Parameter vlen_3607, Variable vcopied_1_3613, BlockStmt target_53, ExprStmt target_54, ExprStmt target_56, RelationalOperation target_47) {
	exists(RelationalOperation target_21 |
		 (target_21 instanceof GTExpr or target_21 instanceof LTExpr)
		and target_21.getLesserOperand().(VariableAccess).getTarget()=vlen_3607
		and target_21.getGreaterOperand().(VariableAccess).getTarget()=vcopied_1_3613
		and target_21.getParent().(IfStmt).getThen()=target_53
		and target_21.getLesserOperand().(VariableAccess).getLocation().isBefore(target_54.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
		and target_56.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_21.getGreaterOperand().(VariableAccess).getLocation())
		and target_21.getGreaterOperand().(VariableAccess).getLocation().isBefore(target_47.getGreaterOperand().(VariableAccess).getLocation()))
}

predicate func_22(Parameter vmsg_3607, Variable vsk_3610, Variable vskb_3612, VariableAccess target_32, ExprStmt target_58, ExprStmt target_55, ExprStmt target_27, ExprStmt target_60) {
	exists(IfStmt target_22 |
		target_22.getCondition().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_22.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vskb_3612
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_22.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_22
		and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_32
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_58.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_22.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
		and target_27.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(VariableAccess).getLocation())
		and target_22.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_60.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

/*predicate func_23(Parameter vmsg_3607, Variable vsk_3610, Variable vskb_3612, ExprStmt target_58, FunctionCall target_61, ExprStmt target_55, ExprStmt target_27, ExprStmt target_60) {
	exists(VariableCall target_23 |
		target_23.getExpr().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_23.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_23.getArgument(0).(VariableAccess).getTarget()=vskb_3612
		and target_23.getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_23.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_23.getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_23.getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_23.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_58.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_61.getArgument(0).(VariableAccess).getLocation().isBefore(target_23.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_23.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
		and target_27.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_23.getArgument(0).(VariableAccess).getLocation())
		and target_23.getArgument(0).(VariableAccess).getLocation().isBefore(target_60.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

*/
predicate func_24(Variable vcopied_1_3613, Variable verr_3613, ExprStmt target_62, ExprStmt target_49, Function func) {
	exists(ReturnStmt target_24 |
		target_24.getExpr().(ConditionalExpr).getCondition().(VariableAccess).getTarget()=verr_3613
		and target_24.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=vcopied_1_3613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_24.getExpr().(ConditionalExpr).getElse().(VariableAccess).getLocation())
		and target_24.getExpr().(ConditionalExpr).getElse().(VariableAccess).getLocation().isBefore(target_49.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getElse().(VariableAccess).getLocation()))
}

predicate func_25(Parameter vmsg_3607, PointerFieldAccess target_25) {
		target_25.getTarget().getName()="msg_namelen"
		and target_25.getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_25.getParent().(AssignExpr).getLValue() = target_25
		and target_25.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_26(Parameter vflags_3608, Variable vsk_3610, Variable verr_3613, BitwiseAndExpr target_26) {
		target_26.getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_26.getRightOperand().(Literal).getValue()="64"
		and target_26.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_26.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_26.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_26.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613
}

predicate func_27(Parameter vmsg_3607, Variable vsk_3610, Variable vskb_3612, Function func, ExprStmt target_27) {
		target_27.getExpr().(FunctionCall).getTarget().hasName("sock_recv_ts_and_drops")
		and target_27.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmsg_3607
		and target_27.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsk_3610
		and target_27.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vskb_3612
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
}

predicate func_28(Variable verr_3613, Function func, ReturnStmt target_28) {
		target_28.getExpr().(VariableAccess).getTarget()=verr_3613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

predicate func_29(Variable vsk_3610, VariableAccess target_29) {
		target_29.getTarget()=vsk_3610
		and target_29.getParent().(FunctionCall).getParent().(Initializer).getExpr().(FunctionCall).getTarget().hasName("pfkey_sk")
}

predicate func_31(Parameter vlen_3607, Variable vcopied_1_3613, BlockStmt target_53, VariableAccess target_31) {
		target_31.getTarget()=vlen_3607
		and target_31.getParent().(GTExpr).getGreaterOperand().(VariableAccess).getTarget()=vcopied_1_3613
		and target_31.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_53
}

predicate func_32(Variable verr_3613, VariableAccess target_32) {
		target_32.getTarget()=verr_3613
		and target_32.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_34(Variable vsk_3610, VariableAccess target_34) {
		target_34.getTarget()=vsk_3610
		and target_34.getParent().(PointerFieldAccess).getParent().(ValueFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(MulExpr).getRightOperand() instanceof FunctionCall
}

predicate func_35(Variable vsk_3610, VariableAccess target_35) {
		target_35.getTarget()=vsk_3610
}

/*predicate func_38(Parameter vflags_3608, Variable vsk_3610, Variable verr_3613, VariableAccess target_38) {
		target_38.getTarget()=vsk_3610
		and target_38.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_38.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_38.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_38.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
		and target_38.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613
}

*/
predicate func_39(Variable vskb_3612, VariableAccess target_39) {
		target_39.getTarget()=vskb_3612
		and target_39.getParent().(EQExpr).getAnOperand().(Literal).getValue()="0"
		and target_39.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_40(Variable vskb_3612, VariableAccess target_40) {
		target_40.getTarget()=vskb_3612
}

predicate func_42(Variable verr_3613, AssignExpr target_42) {
		target_42.getLValue().(VariableAccess).getTarget()=verr_3613
		and target_42.getRValue() instanceof UnaryMinusExpr
}

predicate func_43(Parameter vflags_3608, BitwiseAndExpr target_43) {
		target_43.getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_43.getRightOperand().(ComplementExpr).getValue()="2147483549"
		and target_43.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_44(BitwiseAndExpr target_43, Function func, GotoStmt target_44) {
		target_44.getParent().(IfStmt).getCondition()=target_43
		and target_44.getEnclosingFunction() = func
}

predicate func_45(Parameter vmsg_3607, Function func, ExprStmt target_45) {
		target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_45.getExpr().(AssignExpr).getRValue() instanceof Literal
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_45
}

predicate func_46(EqualityOperation target_57, Function func, GotoStmt target_46) {
		target_46.getParent().(IfStmt).getCondition()=target_57
		and target_46.getEnclosingFunction() = func
}

predicate func_47(Parameter vlen_3607, Variable vcopied_1_3613, BlockStmt target_53, RelationalOperation target_47) {
		 (target_47 instanceof GTExpr or target_47 instanceof LTExpr)
		and target_47.getGreaterOperand().(VariableAccess).getTarget()=vcopied_1_3613
		and target_47.getLesserOperand().(VariableAccess).getTarget()=vlen_3607
		and target_47.getParent().(IfStmt).getThen()=target_53
}

predicate func_48(VariableAccess target_32, Function func, GotoStmt target_48) {
		target_48.getParent().(IfStmt).getCondition()=target_32
		and target_48.getEnclosingFunction() = func
}

predicate func_49(Parameter vflags_3608, Variable vskb_3612, Variable vcopied_1_3613, Variable verr_3613, Function func, ExprStmt target_49) {
		target_49.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_3613
		and target_49.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_49.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getCondition().(BitwiseAndExpr).getRightOperand() instanceof Literal
		and target_49.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getThen().(PointerFieldAccess).getTarget().getName()="len"
		and target_49.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getThen().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
		and target_49.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getElse().(VariableAccess).getTarget()=vcopied_1_3613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
}

predicate func_50(Variable vsk_3610, Variable vpfk_3611, ExprStmt target_63, LogicalAndExpr target_50) {
		target_50.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="dump"
		and target_50.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="dump"
		and target_50.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpfk_3611
		and target_50.getAnOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_50.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getLeftOperand() instanceof Literal
		and target_50.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getRightOperand() instanceof FunctionCall
		and target_50.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="sk_rcvbuf"
		and target_50.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_50.getParent().(IfStmt).getThen()=target_63
}

predicate func_51(Variable vsk_3610, ValueFieldAccess target_51) {
		target_51.getTarget().getName()="rmem_alloc"
		and target_51.getQualifier().(PointerFieldAccess).getTarget().getName()="sk_backlog"
		and target_51.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_51.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(MulExpr).getRightOperand() instanceof FunctionCall
}

predicate func_52(Variable vpfk_3611, FunctionCall target_52) {
		target_52.getTarget().hasName("pfkey_do_dump")
		and target_52.getArgument(0).(VariableAccess).getTarget()=vpfk_3611
}

predicate func_53(Parameter vmsg_3607, Parameter vlen_3607, Variable vcopied_1_3613, BlockStmt target_53) {
		target_53.getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_53.getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_53.getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
		and target_53.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_1_3613
		and target_53.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_3607
}

predicate func_54(Parameter vlen_3607, Variable vcopied_1_3613, ExprStmt target_54) {
		target_54.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_1_3613
		and target_54.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_3607
}

predicate func_55(Parameter vflags_3608, Variable vsk_3610, Variable vskb_3612, Variable verr_3613, ExprStmt target_55) {
		target_55.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vskb_3612
		and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2) instanceof BitwiseAndExpr
		and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613
}

predicate func_56(Variable vskb_3612, Variable vcopied_1_3613, ExprStmt target_56) {
		target_56.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_1_3613
		and target_56.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_56.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
}

predicate func_57(Variable vskb_3612, EqualityOperation target_57) {
		target_57.getAnOperand().(VariableAccess).getTarget()=vskb_3612
		and target_57.getAnOperand() instanceof Literal
}

predicate func_58(Parameter vmsg_3607, ExprStmt target_58) {
		target_58.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_58.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_58.getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
}

predicate func_60(Variable vsk_3610, Variable vskb_3612, ExprStmt target_60) {
		target_60.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_60.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_60.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_3612
}

predicate func_61(Variable vsk_3610, FunctionCall target_61) {
		target_61.getTarget().hasName("pfkey_sk")
		and target_61.getArgument(0).(VariableAccess).getTarget()=vsk_3610
}

predicate func_62(Parameter vmsg_3607, Variable vskb_3612, Variable vcopied_1_3613, Variable verr_3613, ExprStmt target_62) {
		target_62.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_3613
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_3612
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_1_3613
}

predicate func_63(Function func, ExprStmt target_63) {
		target_63.getExpr() instanceof FunctionCall
		and target_63.getEnclosingFunction() = func
}

from Function func, Parameter vsock_3607, Parameter vmsg_3607, Parameter vlen_3607, Parameter vflags_3608, Variable vsk_3610, Variable vpfk_3611, Variable vskb_3612, Variable vcopied_1_3613, Variable verr_3613, UnaryMinusExpr target_0, Literal target_1, Initializer target_2, VariableAccess target_3, Literal target_4, Literal target_5, Literal target_6, VariableAccess target_7, PointerFieldAccess target_8, Literal target_9, FunctionCall target_10, PointerFieldAccess target_25, BitwiseAndExpr target_26, ExprStmt target_27, ReturnStmt target_28, VariableAccess target_29, VariableAccess target_31, VariableAccess target_32, VariableAccess target_34, VariableAccess target_35, VariableAccess target_39, VariableAccess target_40, AssignExpr target_42, BitwiseAndExpr target_43, GotoStmt target_44, ExprStmt target_45, GotoStmt target_46, RelationalOperation target_47, GotoStmt target_48, ExprStmt target_49, LogicalAndExpr target_50, ValueFieldAccess target_51, FunctionCall target_52, BlockStmt target_53, ExprStmt target_54, ExprStmt target_55, ExprStmt target_56, EqualityOperation target_57, ExprStmt target_58, ExprStmt target_60, FunctionCall target_61, ExprStmt target_62, ExprStmt target_63
where
func_0(verr_3613, target_0)
and func_1(vflags_3608, target_1)
and func_2(vsk_3610, target_2)
and func_3(vflags_3608, target_3)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(func, target_6)
and func_7(vlen_3607, vcopied_1_3613, target_53, target_54, target_7)
and func_8(vskb_3612, target_8)
and func_9(func, target_9)
and func_10(func, target_10)
and not func_12(vsock_3607, vlen_3607, vsk_3610, target_54, target_27, func)
and not func_18(target_50, func)
and not func_19(vskb_3612, target_55, target_56)
and not func_20(vsk_3610, target_57, target_27)
and not func_21(vlen_3607, vcopied_1_3613, target_53, target_54, target_56, target_47)
and not func_22(vmsg_3607, vsk_3610, vskb_3612, target_32, target_58, target_55, target_27, target_60)
and not func_24(vcopied_1_3613, verr_3613, target_62, target_49, func)
and func_25(vmsg_3607, target_25)
and func_26(vflags_3608, vsk_3610, verr_3613, target_26)
and func_27(vmsg_3607, vsk_3610, vskb_3612, func, target_27)
and func_28(verr_3613, func, target_28)
and func_29(vsk_3610, target_29)
and func_31(vlen_3607, vcopied_1_3613, target_53, target_31)
and func_32(verr_3613, target_32)
and func_34(vsk_3610, target_34)
and func_35(vsk_3610, target_35)
and func_39(vskb_3612, target_39)
and func_40(vskb_3612, target_40)
and func_42(verr_3613, target_42)
and func_43(vflags_3608, target_43)
and func_44(target_43, func, target_44)
and func_45(vmsg_3607, func, target_45)
and func_46(target_57, func, target_46)
and func_47(vlen_3607, vcopied_1_3613, target_53, target_47)
and func_48(target_32, func, target_48)
and func_49(vflags_3608, vskb_3612, vcopied_1_3613, verr_3613, func, target_49)
and func_50(vsk_3610, vpfk_3611, target_63, target_50)
and func_51(vsk_3610, target_51)
and func_52(vpfk_3611, target_52)
and func_53(vmsg_3607, vlen_3607, vcopied_1_3613, target_53)
and func_54(vlen_3607, vcopied_1_3613, target_54)
and func_55(vflags_3608, vsk_3610, vskb_3612, verr_3613, target_55)
and func_56(vskb_3612, vcopied_1_3613, target_56)
and func_57(vskb_3612, target_57)
and func_58(vmsg_3607, target_58)
and func_60(vsk_3610, vskb_3612, target_60)
and func_61(vsk_3610, target_61)
and func_62(vmsg_3607, vskb_3612, vcopied_1_3613, verr_3613, target_62)
and func_63(func, target_63)
and vsock_3607.getType().hasName("socket *")
and vmsg_3607.getType().hasName("msghdr *")
and vlen_3607.getType().hasName("size_t")
and vflags_3608.getType().hasName("int")
and vsk_3610.getType().hasName("sock *")
and vpfk_3611.getType().hasName("pfkey_sock *")
and vskb_3612.getType().hasName("sk_buff *")
and vcopied_1_3613.getType().hasName("int")
and verr_3613.getType().hasName("int")
and vsock_3607.getFunction() = func
and vmsg_3607.getFunction() = func
and vlen_3607.getFunction() = func
and vflags_3608.getFunction() = func
and vsk_3610.(LocalVariable).getFunction() = func
and vpfk_3611.(LocalVariable).getFunction() = func
and vskb_3612.(LocalVariable).getFunction() = func
and vcopied_1_3613.(LocalVariable).getFunction() = func
and verr_3613.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
