/**
 * @name linux-dcde237319e626d1ec3c9d8b7613032f0fd4663a-ksys_mmap_pgoff
 * @id cpp/linux/dcde237319e626d1ec3c9d8b7613032f0fd4663a/ksys-mmap-pgoff
 * @description linux-dcde237319e626d1ec3c9d8b7613032f0fd4663a-mm/mmap.c-ksys_mmap_pgoff CVE-2020-9391
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vaddr_1553, Function func, ExprStmt target_0) {
	target_0.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddr_1553
	and target_0.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vaddr_1553
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_0
}

from Function func, Parameter vaddr_1553, ExprStmt target_0
where
func_0(vaddr_1553, func, target_0)
and vaddr_1553.getType().hasName("unsigned long")
and vaddr_1553.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
