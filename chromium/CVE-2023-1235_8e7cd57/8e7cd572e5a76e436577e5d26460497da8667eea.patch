commit 8e7cd572e5a76e436577e5d26460497da8667eea	8e7cd572e5a76e436577e5d26460497da8667eea
Author: Simon Zünd <szuend@chromium.org>
Date:   Wed Jan 11 05:55:14 2023 +0000

    [devtools] Ensure that invoked method is an actual v8::Function
    
    CallMethodOnFrame invokes a function part of an object which in turn
    is installed on globalThis. E.g. globalThis['foo'].bar();
    
    CallMethodOnFrame already bails out if 'foo' or 'bar' can't be found,
    but we should also bail out if 'bar' is not an actual function.
    
    Fixed: 1404704
    Change-Id: I67c0883a53b358176898bd04fad3c45cf98721ed
    Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/4150308
    Reviewed-by: David Bokan <bokan@chromium.org>
    Commit-Queue: Simon Zünd <szuend@chromium.org>
    Cr-Commit-Position: refs/heads/main@{#1091189}

diff --git a/third_party/blink/renderer/core/frame/local_frame_mojo_handler.cc b/third_party/blink/renderer/core/frame/local_frame_mojo_handler.cc
index 84d506b956931..bfcbde0c27651 100644
--- a/third_party/blink/renderer/core/frame/local_frame_mojo_handler.cc
+++ b/third_party/blink/renderer/core/frame/local_frame_mojo_handler.cc
@@ -213,9 +213,11 @@ v8::MaybeLocal<v8::Value> CallMethodOnFrame(LocalFrame* local_frame,
   v8::Local<v8::Value> object;
   v8::Local<v8::Value> method;
   if (!GetProperty(context, context->Global(), object_name).ToLocal(&object) ||
-      !GetProperty(context, object, method_name).ToLocal(&method)) {
+      !GetProperty(context, object, method_name).ToLocal(&method) ||
+      !method->IsFunction()) {
     return v8::MaybeLocal<v8::Value>();
   }
+  CHECK(method->IsFunction());
 
   return local_frame->DomWindow()
       ->GetScriptController()
