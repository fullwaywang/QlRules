/**
 * @name linux-7ff9554bb578ba02166071d2d487b7fc7d860d62-kmsg_dump
 * @id cpp/linux/7ff9554bb578ba02166071d2d487b7fc7d860d62/kmsg-dump
 * @description linux-7ff9554bb578ba02166071d2d487b7fc7d860d62-kernel/printk.c-kmsg_dump CVE-2013-1772
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vs2_1773, Variable vlog_buf, VariableAccess target_0) {
	target_0.getTarget()=vs2_1773
	and target_0.getParent().(AssignExpr).getLValue() = target_0
	and target_0.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlog_buf
}

predicate func_1(Variable vend_1770, Variable vs1_1773, VariableAccess target_1) {
	target_1.getTarget()=vs1_1773
	and target_1.getParent().(AssignExpr).getLValue() = target_1
	and target_1.getParent().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand() instanceof PointerArithmeticOperation
	and target_1.getParent().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vend_1770
}

predicate func_2(Variable vend_1770, Variable vchars_1771, Variable vs1_1773, Variable vs2_1773, Variable vl1_1774, Variable vl2_1774, Variable vlog_buf, DoStmt target_36, IfStmt target_2) {
	target_2.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vchars_1771
	and target_2.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vend_1770
	and target_2.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs1_1773
	and target_2.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand() instanceof PointerArithmeticOperation
	and target_2.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vend_1770
	and target_2.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
	and target_2.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof SubExpr
	and target_2.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs2_1773
	and target_2.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlog_buf
	and target_2.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl2_1774
	and target_2.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vend_1770
	and target_2.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs1_1773
	and target_2.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(StringLiteral).getValue()=""
	and target_2.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
	and target_2.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_2.getElse().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs2_1773
	and target_2.getElse().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof PointerArithmeticOperation
	and target_2.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr() instanceof AssignExpr
	and target_36.getLocation().isBefore(target_2.getLocation())
}

predicate func_3(Variable vs2_1773, Variable vlog_buf, ExprStmt target_37, ExprStmt target_3) {
	target_3.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs2_1773
	and target_3.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlog_buf
	and target_37.getLocation().isBefore(target_3.getLocation())
}

predicate func_5(BlockStmt target_38, Function func) {
exists(RelationalOperation target_5 |
	 (target_5 instanceof GTExpr or target_5 instanceof LTExpr)
	and target_5.getLesserOperand().(VariableAccess).getType().hasName("u64")
	and target_5.getGreaterOperand().(VariableAccess).getType().hasName("u64")
	and target_5.getParent().(IfStmt).getThen()=target_38
	and target_5.getEnclosingFunction() = func)
}

predicate func_6(Function func) {
exists(AssignExpr target_6 |
	target_6.getLValue().(VariableAccess).getType().hasName("u64")
	and target_6.getRValue().(VariableAccess).getType().hasName("u32")
	and target_6.getEnclosingFunction() = func)
}

predicate func_7(Function func) {
exists(AssignExpr target_7 |
	target_7.getLValue().(VariableAccess).getType().hasName("u64")
	and target_7.getRValue().(VariableAccess).getType().hasName("u32")
	and target_7.getEnclosingFunction() = func)
}

predicate func_8(Variable vs1_1773, Variable vs2_1773, Variable vl1_1774, Variable vl2_1774, Variable vlog_buf_len, ExprStmt target_39, ExprStmt target_40, ExprStmt target_41, Function func) {
exists(IfStmt target_8 |
	target_8.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("u64")
	and target_8.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("u32")
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("const char *")
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("char *")
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("u32")
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs2_1773
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getType().hasName("char *")
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getType().hasName("u64")
	and target_8.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl2_1774
	and target_8.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vlog_buf_len
	and target_8.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(VariableAccess).getType().hasName("u64")
	and target_8.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs1_1773
	and target_8.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(StringLiteral).getValue()=""
	and target_8.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
	and target_8.getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_8.getElse().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("const char *")
	and target_8.getElse().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getType().hasName("char *")
	and target_8.getElse().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getType().hasName("u64")
	and target_8.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl2_1774
	and target_8.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(VariableAccess).getType().hasName("u32")
	and target_8.getElse().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(VariableAccess).getType().hasName("u64")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_8
	and target_8.getLocation().isBefore(target_39.getLocation())
	and target_40.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_8.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_8.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_41.getExpr().(VariableCall).getArgument(2).(VariableAccess).getLocation()))
}

/*predicate func_13(Variable vl1_1774, Variable vlog_buf_len, ExprStmt target_40) {
exists(SubExpr target_13 |
	target_13.getLeftOperand().(VariableAccess).getTarget()=vlog_buf_len
	and target_13.getRightOperand().(VariableAccess).getType().hasName("u64")
	and target_13.getParent().(AssignExpr).getRValue() = target_13
	and target_13.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774)
}

*/
/*predicate func_15(Variable vl2_1774) {
exists(SubExpr target_15 |
	target_15.getLeftOperand().(VariableAccess).getType().hasName("u32")
	and target_15.getRightOperand().(VariableAccess).getType().hasName("u64")
	and target_15.getParent().(AssignExpr).getRValue() = target_15
	and target_15.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl2_1774)
}

*/
predicate func_16(Variable vlog_buf, VariableAccess target_16) {
	target_16.getTarget()=vlog_buf
}

predicate func_17(Variable vl1_1774, VariableAccess target_17) {
	target_17.getTarget()=vl1_1774
	and target_17.getParent().(AssignExpr).getLValue() = target_17
	and target_17.getParent().(AssignExpr).getRValue() instanceof SubExpr
}

predicate func_18(Variable vend_1770, Variable vl2_1774, VariableAccess target_18) {
	target_18.getTarget()=vl2_1774
	and target_18.getParent().(AssignExpr).getLValue() = target_18
	and target_18.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vend_1770
}

predicate func_19(Variable vs2_1773, VariableAccess target_19) {
	target_19.getTarget()=vs2_1773
	and target_19.getParent().(AssignExpr).getLValue() = target_19
	and target_19.getParent().(AssignExpr).getRValue() instanceof PointerArithmeticOperation
}

predicate func_20(Variable vlog_buf, VariableAccess target_20) {
	target_20.getTarget()=vlog_buf
}

predicate func_21(Variable vchars_1771, Variable vl2_1774, VariableAccess target_21) {
	target_21.getTarget()=vl2_1774
	and target_21.getParent().(AssignExpr).getLValue() = target_21
	and target_21.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vchars_1771
}

predicate func_23(Function func, DeclStmt target_23) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

predicate func_24(Variable vend_1770, Variable vlog_end, Variable vlog_buf_len, VariableAccess target_24) {
	target_24.getTarget()=vend_1770
	and target_24.getParent().(AssignExpr).getLValue() = target_24
	and target_24.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vlog_end
	and target_24.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vlog_buf_len
	and target_24.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
}

/*predicate func_25(Variable vend_1770, Variable vlog_end, Variable vlog_buf_len, BitwiseAndExpr target_25) {
	target_25.getLeftOperand().(VariableAccess).getTarget()=vlog_end
	and target_25.getRightOperand().(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vlog_buf_len
	and target_25.getRightOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_25.getParent().(AssignExpr).getRValue() = target_25
	and target_25.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_1770
}

*/
predicate func_26(Variable vchars_1771, Variable vlogged_chars, AssignExpr target_26) {
	target_26.getLValue().(VariableAccess).getTarget()=vchars_1771
	and target_26.getRValue().(VariableAccess).getTarget()=vlogged_chars
}

predicate func_27(Variable vend_1770, Variable vchars_1771, BlockStmt target_38, VariableAccess target_27) {
	target_27.getTarget()=vchars_1771
	and target_27.getParent().(GTExpr).getLesserOperand().(VariableAccess).getTarget()=vend_1770
	and target_27.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_38
}

/*predicate func_28(Variable vend_1770, Variable vchars_1771, BlockStmt target_38, VariableAccess target_28) {
	target_28.getTarget()=vend_1770
	and target_28.getParent().(GTExpr).getGreaterOperand().(VariableAccess).getTarget()=vchars_1771
	and target_28.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_38
}

*/
predicate func_29(Variable vchars_1771, Variable vlog_buf_len, Variable vlog_buf, PointerArithmeticOperation target_29) {
	target_29.getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=vlog_buf
	and target_29.getLeftOperand().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vlog_buf_len
	and target_29.getRightOperand().(VariableAccess).getTarget()=vchars_1771
}

/*predicate func_30(Variable vlog_buf_len, ExprStmt target_39, VariableAccess target_30) {
	target_30.getTarget()=vlog_buf_len
}

*/
predicate func_31(Variable vend_1770, VariableAccess target_31) {
	target_31.getTarget()=vend_1770
}

predicate func_32(Variable vend_1770, Variable vchars_1771, Variable vl1_1774, SubExpr target_32) {
	target_32.getLeftOperand().(VariableAccess).getTarget()=vchars_1771
	and target_32.getRightOperand().(VariableAccess).getTarget()=vend_1770
	and target_32.getParent().(AssignExpr).getRValue() = target_32
	and target_32.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
}

predicate func_33(Variable vend_1770, Variable vl2_1774, VariableAccess target_33) {
	target_33.getTarget()=vend_1770
	and target_33.getParent().(AssignExpr).getRValue() = target_33
	and target_33.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl2_1774
}

predicate func_34(Variable vend_1770, Variable vchars_1771, Variable vs2_1773, Variable vlog_buf, PointerArithmeticOperation target_34) {
	target_34.getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=vlog_buf
	and target_34.getLeftOperand().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vend_1770
	and target_34.getRightOperand().(VariableAccess).getTarget()=vchars_1771
	and target_34.getParent().(AssignExpr).getRValue() = target_34
	and target_34.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs2_1773
}

predicate func_35(Variable vchars_1771, Variable vl2_1774, AssignExpr target_35) {
	target_35.getLValue().(VariableAccess).getTarget()=vl2_1774
	and target_35.getRValue().(VariableAccess).getTarget()=vchars_1771
}

predicate func_36(Function func, DoStmt target_36) {
	target_36.getCondition().(Literal).getValue()="0"
	and target_36.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(Literal).getValue()="1"
	and target_36.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_raw_spin_unlock_irqrestore")
	and target_36.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("raw_spinlock_t")
	and target_36.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget().getType().hasName("unsigned long")
	and target_36.getEnclosingFunction() = func
}

predicate func_37(Variable vl1_1774, ExprStmt target_37) {
	target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
	and target_37.getExpr().(AssignExpr).getRValue() instanceof SubExpr
}

predicate func_38(Variable vend_1770, Variable vs1_1773, Variable vl1_1774, BlockStmt target_38) {
	target_38.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs1_1773
	and target_38.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand() instanceof PointerArithmeticOperation
	and target_38.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vend_1770
	and target_38.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vl1_1774
	and target_38.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof SubExpr
}

predicate func_39(Variable vend_1770, ExprStmt target_39) {
	target_39.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_1770
	and target_39.getExpr().(AssignExpr).getRValue() instanceof BitwiseAndExpr
}

predicate func_40(Variable vend_1770, Variable vs1_1773, ExprStmt target_40) {
	target_40.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vs1_1773
	and target_40.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand() instanceof PointerArithmeticOperation
	and target_40.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vend_1770
}

predicate func_41(Variable vs1_1773, Variable vs2_1773, Variable vl1_1774, Variable vl2_1774, ExprStmt target_41) {
	target_41.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="dump"
	and target_41.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("kmsg_dumper *")
	and target_41.getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("kmsg_dumper *")
	and target_41.getExpr().(VariableCall).getArgument(1).(VariableAccess).getTarget().getType().hasName("kmsg_dump_reason")
	and target_41.getExpr().(VariableCall).getArgument(2).(VariableAccess).getTarget()=vs1_1773
	and target_41.getExpr().(VariableCall).getArgument(3).(VariableAccess).getTarget()=vl1_1774
	and target_41.getExpr().(VariableCall).getArgument(4).(VariableAccess).getTarget()=vs2_1773
	and target_41.getExpr().(VariableCall).getArgument(5).(VariableAccess).getTarget()=vl2_1774
}

from Function func, Variable vend_1770, Variable vchars_1771, Variable vs1_1773, Variable vs2_1773, Variable vl1_1774, Variable vl2_1774, Variable vlog_end, Variable vlog_buf_len, Variable vlogged_chars, Variable vlog_buf, VariableAccess target_0, VariableAccess target_1, IfStmt target_2, ExprStmt target_3, VariableAccess target_16, VariableAccess target_17, VariableAccess target_18, VariableAccess target_19, VariableAccess target_20, VariableAccess target_21, DeclStmt target_23, VariableAccess target_24, AssignExpr target_26, VariableAccess target_27, PointerArithmeticOperation target_29, VariableAccess target_31, SubExpr target_32, VariableAccess target_33, PointerArithmeticOperation target_34, AssignExpr target_35, DoStmt target_36, ExprStmt target_37, BlockStmt target_38, ExprStmt target_39, ExprStmt target_40, ExprStmt target_41
where
func_0(vs2_1773, vlog_buf, target_0)
and func_1(vend_1770, vs1_1773, target_1)
and func_2(vend_1770, vchars_1771, vs1_1773, vs2_1773, vl1_1774, vl2_1774, vlog_buf, target_36, target_2)
and func_3(vs2_1773, vlog_buf, target_37, target_3)
and not func_5(target_38, func)
and not func_6(func)
and not func_7(func)
and not func_8(vs1_1773, vs2_1773, vl1_1774, vl2_1774, vlog_buf_len, target_39, target_40, target_41, func)
and func_16(vlog_buf, target_16)
and func_17(vl1_1774, target_17)
and func_18(vend_1770, vl2_1774, target_18)
and func_19(vs2_1773, target_19)
and func_20(vlog_buf, target_20)
and func_21(vchars_1771, vl2_1774, target_21)
and func_23(func, target_23)
and func_24(vend_1770, vlog_end, vlog_buf_len, target_24)
and func_26(vchars_1771, vlogged_chars, target_26)
and func_27(vend_1770, vchars_1771, target_38, target_27)
and func_29(vchars_1771, vlog_buf_len, vlog_buf, target_29)
and func_31(vend_1770, target_31)
and func_32(vend_1770, vchars_1771, vl1_1774, target_32)
and func_33(vend_1770, vl2_1774, target_33)
and func_34(vend_1770, vchars_1771, vs2_1773, vlog_buf, target_34)
and func_35(vchars_1771, vl2_1774, target_35)
and func_36(func, target_36)
and func_37(vl1_1774, target_37)
and func_38(vend_1770, vs1_1773, vl1_1774, target_38)
and func_39(vend_1770, target_39)
and func_40(vend_1770, vs1_1773, target_40)
and func_41(vs1_1773, vs2_1773, vl1_1774, vl2_1774, target_41)
and vend_1770.getType().hasName("unsigned long")
and vchars_1771.getType().hasName("unsigned int")
and vs1_1773.getType().hasName("const char *")
and vs2_1773.getType().hasName("const char *")
and vl1_1774.getType().hasName("unsigned long")
and vl2_1774.getType().hasName("unsigned long")
and vlog_end.getType().hasName("unsigned int")
and vlog_buf_len.getType().hasName("int")
and vlogged_chars.getType().hasName("unsigned int")
and vlog_buf.getType().hasName("char *")
and vend_1770.(LocalVariable).getFunction() = func
and vchars_1771.(LocalVariable).getFunction() = func
and vs1_1773.(LocalVariable).getFunction() = func
and vs2_1773.(LocalVariable).getFunction() = func
and vl1_1774.(LocalVariable).getFunction() = func
and vl2_1774.(LocalVariable).getFunction() = func
and not vlog_end.getParentScope+() = func
and not vlog_buf_len.getParentScope+() = func
and not vlogged_chars.getParentScope+() = func
and not vlog_buf.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
