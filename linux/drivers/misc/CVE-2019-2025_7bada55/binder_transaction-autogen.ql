/**
 * @name linux-7bada55ab50697861eee6bb7d60b41e68a961a9c-binder_transaction
 * @id cpp/linux/7bada55ab50697861eee6bb7d60b41e68a961a9c/binder-transaction
 * @description linux-7bada55ab50697861eee6bb7d60b41e68a961a9c-drivers/android/binder.c-binder_transaction CVE-2019-2025
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
	target_0.getValue()="2992"
	and not target_0.getValue()="2991"
	and target_0.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Function func, Literal target_1) {
	target_1.getValue()="3001"
	and not target_1.getValue()="3000"
	and target_1.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, Literal target_2) {
	target_2.getValue()="3009"
	and not target_2.getValue()="3008"
	and target_2.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
	target_3.getValue()="3018"
	and not target_3.getValue()="3017"
	and target_3.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, Literal target_4) {
	target_4.getValue()="3036"
	and not target_4.getValue()="3035"
	and target_4.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Function func, Literal target_5) {
	target_5.getValue()="3052"
	and not target_5.getValue()="3051"
	and target_5.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_5.getEnclosingFunction() = func
}

predicate func_6(Function func, Literal target_6) {
	target_6.getValue()="3065"
	and not target_6.getValue()="3064"
	and target_6.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_6.getEnclosingFunction() = func
}

predicate func_7(Function func, Literal target_7) {
	target_7.getValue()="3078"
	and not target_7.getValue()="3077"
	and target_7.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_7.getEnclosingFunction() = func
}

predicate func_8(Function func, Literal target_8) {
	target_8.getValue()="3095"
	and not target_8.getValue()="3094"
	and target_8.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_8.getEnclosingFunction() = func
}

predicate func_9(Function func, Literal target_9) {
	target_9.getValue()="3106"
	and not target_9.getValue()="3105"
	and target_9.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_9.getEnclosingFunction() = func
}

predicate func_10(Function func, Literal target_10) {
	target_10.getValue()="3114"
	and not target_10.getValue()="3113"
	and target_10.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_10.getEnclosingFunction() = func
}

predicate func_11(Function func, Literal target_11) {
	target_11.getValue()="3131"
	and not target_11.getValue()="3130"
	and target_11.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_11.getEnclosingFunction() = func
}

predicate func_12(Function func, Literal target_12) {
	target_12.getValue()="3141"
	and not target_12.getValue()="3140"
	and target_12.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_12.getEnclosingFunction() = func
}

predicate func_13(Function func, Literal target_13) {
	target_13.getValue()="3157"
	and not target_13.getValue()="3156"
	and target_13.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_13.getEnclosingFunction() = func
}

predicate func_14(Function func, Literal target_14) {
	target_14.getValue()="3168"
	and not target_14.getValue()="3167"
	and target_14.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_14.getEnclosingFunction() = func
}

predicate func_15(Function func, Literal target_15) {
	target_15.getValue()="3231"
	and not target_15.getValue()="3230"
	and target_15.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_15.getEnclosingFunction() = func
}

predicate func_16(Variable vt_2703, Function func, ExprStmt target_16) {
	target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="allow_user_free"
	and target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="buffer"
	and target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vt_2703
	and target_16.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

from Function func, Variable vt_2703, Literal target_0, Literal target_1, Literal target_2, Literal target_3, Literal target_4, Literal target_5, Literal target_6, Literal target_7, Literal target_8, Literal target_9, Literal target_10, Literal target_11, Literal target_12, Literal target_13, Literal target_14, Literal target_15, ExprStmt target_16
where
func_0(func, target_0)
and func_1(func, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(func, target_6)
and func_7(func, target_7)
and func_8(func, target_8)
and func_9(func, target_9)
and func_10(func, target_10)
and func_11(func, target_11)
and func_12(func, target_12)
and func_13(func, target_13)
and func_14(func, target_14)
and func_15(func, target_15)
and func_16(vt_2703, func, target_16)
and vt_2703.getType().hasName("binder_transaction *")
and vt_2703.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
