/**
 * @name linux-9933e113c2e87a9f46a40fde8dafbf801dca1ab9-crypto_skcipher_init_tfm
 * @id cpp/linux/9933e113c2e87a9f46a40fde8dafbf801dca1ab9/crypto-skcipher-init-tfm
 * @description linux-9933e113c2e87a9f46a40fde8dafbf801dca1ab9-crypto/skcipher.c-crypto_skcipher_init_tfm CVE-2017-9211
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(Variable valg_778, PointerFieldAccess target_1) {
	target_1.getTarget().getName()="setkey"
	and target_1.getQualifier().(VariableAccess).getTarget()=valg_778
}

from Function func, Variable valg_778, PointerFieldAccess target_1
where
func_1(valg_778, target_1)
and valg_778.getType().hasName("skcipher_alg *")
and valg_778.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
