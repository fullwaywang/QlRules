/**
 * @name postgresql-18b585155a891784ca8985f595ebc0dde94e0d43-array_set_element
 * @id cpp/postgresql/18b585155a891784ca8985f595ebc0dde94e0d43/array-set-element
 * @description postgresql-18b585155a891784ca8985f595ebc0dde94e0d43-src/backend/utils/adt/arrayfuncs.c-array_set_element CVE-2023-5869
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vdim_2218, Variable vaddedbefore_2232, RelationalOperation target_24, ExprStmt target_25, ExprStmt target_27, RelationalOperation target_28) {
	exists(IfStmt target_0 |
		target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof ArrayExpr
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedbefore_2232
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedbefore_2232
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_0.getThen().(DoStmt).getCondition() instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getCondition().(LogicalAndExpr).getValue()="1"
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getValue()="1"
		and target_0.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
		and target_0.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_0
		and target_0.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_24
		and target_25.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getLocation())
		and target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getLocation())
		and target_0.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getLocation().isBefore(target_28.getGreaterOperand().(VariableAccess).getLocation()))
}

/*predicate func_1(BlockStmt target_29, Function func) {
	exists(ConditionalExpr target_1 |
		target_1.getCondition().(LogicalAndExpr).getValue()="1"
		and target_1.getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_1.getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_1.getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_1.getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_1.getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_1.getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_1.getParent().(IfStmt).getThen()=target_29
		and target_1.getEnclosingFunction() = func)
}

*/
/*predicate func_2(Variable v__func__, ExprStmt target_30) {
	exists(CommaExpr target_2 |
		target_2.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_2.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="261"
		and target_2.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_2.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array size exceeds the maximum allowed (%d)"
		and target_2.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(DivExpr).getValue()="134217727"
		and target_2.getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_2.getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_2.getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_2.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_2.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

*/
predicate func_4(Variable vdim_2218, Variable vnewhasnulls_2222, Variable vaddedafter_2233, EqualityOperation target_31, RelationalOperation target_10, ExprStmt target_33, IfStmt target_34, IfStmt target_36) {
	exists(IfStmt target_4 |
		target_4.getCondition() instanceof RelationalOperation
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof AddExpr
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddedafter_2233
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(Literal).getValue()="1"
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedafter_2233
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
		and target_4.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vaddedafter_2233
		and target_4.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_4.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2222
		and target_4.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_4.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_4
		and target_4.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_31
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getLocation())
		and target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_4.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
		and target_4.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_34.getCondition().(VariableAccess).getLocation())
		and target_4.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_36.getCondition().(VariableAccess).getLocation()))
}

/*predicate func_5(Variable vdim_2218, Variable vaddedafter_2233, RelationalOperation target_10) {
	exists(IfStmt target_5 |
		target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_sub_s32_overflow")
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0) instanceof ArrayExpr
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1) instanceof AddExpr
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedafter_2233
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vaddedafter_2233
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(Literal).getValue()="1"
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vaddedafter_2233
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("pg_add_s32_overflow")
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(0).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddedafter_2233
		and target_5.getCondition().(LogicalOrExpr).getAnOperand().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand() instanceof ArrayExpr
		and target_5.getThen().(DoStmt).getCondition() instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getCondition().(LogicalAndExpr).getValue()="1"
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getValue()="1"
		and target_5.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
		and target_5.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_5
		and target_5.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_10)
}

*/
/*predicate func_6(Variable v__func__, ExprStmt target_38) {
	exists(CommaExpr target_6 |
		target_6.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_6.getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="261"
		and target_6.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_6.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array size exceeds the maximum allowed (%d)"
		and target_6.getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1).(DivExpr).getValue()="134217727"
		and target_6.getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_6.getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_6.getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_6.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_6.getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_38.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getLocation()))
}

*/
predicate func_8(Variable vlb_2219, ArrayExpr target_8) {
		target_8.getArrayBase().(VariableAccess).getTarget()=vlb_2219
		and target_8.getArrayOffset().(Literal).getValue()="0"
}

predicate func_9(Parameter vindx_2206, ArrayExpr target_9) {
		target_9.getArrayBase().(VariableAccess).getTarget()=vindx_2206
		and target_9.getArrayOffset().(Literal).getValue()="0"
}

predicate func_10(Parameter vindx_2206, Variable vdim_2218, Variable vlb_2219, BlockStmt target_29, RelationalOperation target_10) {
		 (target_10 instanceof GEExpr or target_10 instanceof LEExpr)
		and target_10.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vindx_2206
		and target_10.getGreaterOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2219
		and target_10.getLesserOperand().(AddExpr).getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_10.getParent().(IfStmt).getThen()=target_29
}

predicate func_11(Parameter vindx_2206, ArrayExpr target_11) {
		target_11.getArrayBase().(VariableAccess).getTarget()=vindx_2206
		and target_11.getArrayOffset().(Literal).getValue()="0"
}

predicate func_12(Variable vdim_2218, Variable vlb_2219, AddExpr target_12) {
		target_12.getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_12.getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_12.getAnOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2219
		and target_12.getAnOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_13(Variable vdim_2218, Variable vaddedbefore_2232, ArrayExpr target_13) {
		target_13.getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_13.getArrayOffset().(Literal).getValue()="0"
		and target_13.getParent().(AssignAddExpr).getLValue() = target_13
		and target_13.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vaddedbefore_2232
}

predicate func_14(Variable vdim_2218, Variable vaddedafter_2233, ArrayExpr target_14) {
		target_14.getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_14.getArrayOffset().(Literal).getValue()="0"
		and target_14.getParent().(AssignAddExpr).getLValue() = target_14
		and target_14.getParent().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vaddedafter_2233
}

predicate func_15(Variable vaddedbefore_2232, VariableAccess target_15) {
		target_15.getTarget()=vaddedbefore_2232
		and target_15.getParent().(AssignExpr).getLValue() = target_15
		and target_15.getParent().(AssignExpr).getRValue() instanceof SubExpr
}

/*predicate func_16(Variable vdim_2218, Variable vaddedbefore_2232, VariableAccess target_16) {
		target_16.getTarget()=vaddedbefore_2232
		and target_16.getParent().(AssignAddExpr).getRValue() = target_16
		and target_16.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_16.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

*/
predicate func_17(Variable vaddedafter_2233, VariableAccess target_17) {
		target_17.getTarget()=vaddedafter_2233
		and target_17.getParent().(AssignExpr).getLValue() = target_17
		and target_17.getParent().(AssignExpr).getRValue() instanceof AddExpr
}

/*predicate func_19(Variable vdim_2218, Variable vaddedafter_2233, VariableAccess target_19) {
		target_19.getTarget()=vaddedafter_2233
		and target_19.getParent().(AssignAddExpr).getRValue() = target_19
		and target_19.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vdim_2218
		and target_19.getParent().(AssignAddExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

*/
predicate func_20(Variable vaddedbefore_2232, AssignExpr target_20) {
		target_20.getLValue().(VariableAccess).getTarget()=vaddedbefore_2232
		and target_20.getRValue().(SubExpr).getLeftOperand() instanceof ArrayExpr
		and target_20.getRValue().(SubExpr).getRightOperand() instanceof ArrayExpr
}

predicate func_21(Variable vaddedbefore_2232, AssignAddExpr target_21) {
		target_21.getLValue() instanceof ArrayExpr
		and target_21.getRValue().(VariableAccess).getTarget()=vaddedbefore_2232
}

predicate func_22(Variable vaddedafter_2233, AssignExpr target_22) {
		target_22.getLValue().(VariableAccess).getTarget()=vaddedafter_2233
		and target_22.getRValue().(AddExpr).getAnOperand().(SubExpr).getLeftOperand() instanceof ArrayExpr
		and target_22.getRValue().(AddExpr).getAnOperand().(SubExpr).getRightOperand() instanceof AddExpr
		and target_22.getRValue().(AddExpr).getAnOperand() instanceof Literal
}

predicate func_23(Variable vaddedafter_2233, AssignAddExpr target_23) {
		target_23.getLValue() instanceof ArrayExpr
		and target_23.getRValue().(VariableAccess).getTarget()=vaddedafter_2233
}

predicate func_24(Parameter vindx_2206, Variable vlb_2219, RelationalOperation target_24) {
		 (target_24 instanceof GTExpr or target_24 instanceof LTExpr)
		and target_24.getLesserOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vindx_2206
		and target_24.getLesserOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
		and target_24.getGreaterOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vlb_2219
		and target_24.getGreaterOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_25(Variable vdim_2218, ExprStmt target_25) {
		target_25.getExpr().(FunctionCall).getTarget().hasName("memcpy")
		and target_25.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdim_2218
		and target_25.getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getAnOperand().(VariableAccess).getTarget().getType().hasName("ArrayType *")
		and target_25.getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getAnOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_25.getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getAnOperand().(SizeofTypeOperator).getValue()="16"
		and target_25.getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_25.getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_25.getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="4"
}

predicate func_27(Variable vaddedbefore_2232, Variable vaddedafter_2233, ExprStmt target_27) {
		target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddedbefore_2232
		and target_27.getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddedafter_2233
		and target_27.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_28(Variable vaddedbefore_2232, RelationalOperation target_28) {
		 (target_28 instanceof GTExpr or target_28 instanceof LTExpr)
		and target_28.getGreaterOperand().(VariableAccess).getTarget()=vaddedbefore_2232
		and target_28.getLesserOperand().(Literal).getValue()="1"
}

predicate func_29(Variable vnewhasnulls_2222, Variable vaddedafter_2233, BlockStmt target_29) {
		target_29.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
		and target_29.getStmt(1).(ExprStmt).getExpr() instanceof AssignAddExpr
		and target_29.getStmt(2).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vaddedafter_2233
		and target_29.getStmt(2).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="1"
		and target_29.getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2222
		and target_29.getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
}

/*
predicate func_30(Variable v__func__, ConditionalExpr target_39, ExprStmt target_30) {
		target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="352845954"
		and target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_30.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="wrong number of array subscripts"
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_30.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_30.getParent().(IfStmt).getCondition()=target_39
}
*/

predicate func_31(Function func, EqualityOperation target_31) {
		target_31.getAnOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_31.getAnOperand().(Literal).getValue()="1"
		and target_31.getEnclosingFunction() = func
}

predicate func_33(Variable vnewhasnulls_2222, RelationalOperation target_28, ExprStmt target_33) {
		target_33.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnewhasnulls_2222
		and target_33.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
		and target_33.getParent().(IfStmt).getCondition()=target_28
}

predicate func_34(Variable vnewhasnulls_2222, IfStmt target_34) {
		target_34.getCondition().(VariableAccess).getTarget()=vnewhasnulls_2222
		and target_34.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_34.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(SubExpr).getValue()="7"
		and target_34.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446744073709551608"
		and target_34.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_34.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(AddExpr).getAnOperand().(SizeofTypeOperator).getType() instanceof LongType
		and target_34.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(AddExpr).getAnOperand().(SizeofTypeOperator).getValue()="16"
		and target_34.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(SubExpr).getValue()="7"
		and target_34.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446744073709551608"
}

predicate func_36(Parameter vindx_2206, Variable vdim_2218, Variable vlb_2219, Variable vaddedafter_2233, IfStmt target_36) {
		target_36.getCondition().(VariableAccess).getTarget()=vaddedafter_2233
		and target_36.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_36.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ArrayGetOffset")
		and target_36.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("int")
		and target_36.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vdim_2218
		and target_36.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vlb_2219
		and target_36.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vindx_2206
}

/*
predicate func_38(Variable v__func__, ConditionalExpr target_40, ExprStmt target_38) {
		target_38.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getTarget().hasName("errcode")
		and target_38.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getLeftOperand().(FunctionCall).getArgument(0).(AddExpr).getValue()="352845954"
		and target_38.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errmsg")
		and target_38.getExpr().(CommaExpr).getLeftOperand().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0).(StringLiteral).getValue()="array subscript out of range"
		and target_38.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getTarget().hasName("errfinish")
		and target_38.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_38.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(1) instanceof Literal
		and target_38.getExpr().(CommaExpr).getRightOperand().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_38.getParent().(IfStmt).getCondition()=target_40
}

predicate func_39(ExprStmt target_30, Function func, ConditionalExpr target_39) {
		target_39.getCondition().(LogicalAndExpr).getValue()="1"
		and target_39.getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_39.getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_39.getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_39.getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_39.getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_39.getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_39.getParent().(IfStmt).getThen()=target_30
		and target_39.getEnclosingFunction() = func
}

predicate func_40(ExprStmt target_38, Function func, ConditionalExpr target_40) {
		target_40.getCondition().(LogicalAndExpr).getValue()="1"
		and target_40.getThen().(FunctionCall).getTarget().hasName("errstart_cold")
		and target_40.getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_40.getThen().(FunctionCall).getArgument(1) instanceof Literal
		and target_40.getElse().(FunctionCall).getTarget().hasName("errstart")
		and target_40.getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_40.getElse().(FunctionCall).getArgument(1) instanceof Literal
		and target_40.getParent().(IfStmt).getThen()=target_38
		and target_40.getEnclosingFunction() = func
}
*/

from Function func, Parameter vindx_2206, Variable vdim_2218, Variable vlb_2219, Variable vnewhasnulls_2222, Variable vaddedbefore_2232, Variable vaddedafter_2233, Variable v__func__, ArrayExpr target_8, ArrayExpr target_9, RelationalOperation target_10, ArrayExpr target_11, AddExpr target_12, ArrayExpr target_13, ArrayExpr target_14, VariableAccess target_15, VariableAccess target_17, AssignExpr target_20, AssignAddExpr target_21, AssignExpr target_22, AssignAddExpr target_23, RelationalOperation target_24, ExprStmt target_25, ExprStmt target_27, RelationalOperation target_28, BlockStmt target_29, /*ExprStmt target_30,*/ EqualityOperation target_31, ExprStmt target_33, IfStmt target_34, IfStmt target_36, ExprStmt target_38/*, ConditionalExpr target_39, ConditionalExpr target_40*/
where
not func_0(vdim_2218, vaddedbefore_2232, target_24, target_25, target_27, target_28)
and not func_4(vdim_2218, vnewhasnulls_2222, vaddedafter_2233, target_31, target_10, target_33, target_34, target_36)
and func_8(vlb_2219, target_8)
and func_9(vindx_2206, target_9)
and func_10(vindx_2206, vdim_2218, vlb_2219, target_29, target_10)
and func_11(vindx_2206, target_11)
and func_12(vdim_2218, vlb_2219, target_12)
and func_13(vdim_2218, vaddedbefore_2232, target_13)
and func_14(vdim_2218, vaddedafter_2233, target_14)
and func_15(vaddedbefore_2232, target_15)
and func_17(vaddedafter_2233, target_17)
and func_20(vaddedbefore_2232, target_20)
and func_21(vaddedbefore_2232, target_21)
and func_22(vaddedafter_2233, target_22)
and func_23(vaddedafter_2233, target_23)
and func_24(vindx_2206, vlb_2219, target_24)
and func_25(vdim_2218, target_25)
and func_27(vaddedbefore_2232, vaddedafter_2233, target_27)
and func_28(vaddedbefore_2232, target_28)
and func_29(vnewhasnulls_2222, vaddedafter_2233, target_29)
//and func_30(v__func__, target_39, target_30)
and func_31(func, target_31)
and func_33(vnewhasnulls_2222, target_28, target_33)
and func_34(vnewhasnulls_2222, target_34)
and func_36(vindx_2206, vdim_2218, vlb_2219, vaddedafter_2233, target_36)
//and func_38(v__func__, target_40, target_38)
//and func_39(target_30, func, target_39)
//and func_40(target_38, func, target_40)
and vindx_2206.getType().hasName("int *")
and vdim_2218.getType().hasName("int[6]")
and vlb_2219.getType().hasName("int[6]")
and vnewhasnulls_2222.getType().hasName("bool")
and vaddedbefore_2232.getType().hasName("int")
and vaddedafter_2233.getType().hasName("int")
and v__func__.getType() instanceof ArrayType
and vindx_2206.getFunction() = func
and vdim_2218.(LocalVariable).getFunction() = func
and vlb_2219.(LocalVariable).getFunction() = func
and vnewhasnulls_2222.(LocalVariable).getFunction() = func
and vaddedbefore_2232.(LocalVariable).getFunction() = func
and vaddedafter_2233.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
