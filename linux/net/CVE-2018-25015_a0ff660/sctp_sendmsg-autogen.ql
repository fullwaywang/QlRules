/**
 * @name linux-a0ff660058b88d12625a783ce9e5c1371c87951f-sctp_sendmsg
 * @id cpp/linux/a0ff660058b88d12625a783ce9e5c1371c87951f/sctp-sendmsg
 * @description linux-a0ff660058b88d12625a783ce9e5c1371c87951f-net/sctp/socket.c-sctp_sendmsg CVE-2018-25015
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vsk_1631, AddressOfExpr target_0) {
	target_0.getOperand().(VariableAccess).getTarget()=vsk_1631
	and target_0.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("sctp_wait_for_sndbuf")
	and target_0.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("sctp_association *")
	and target_0.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("long")
	and target_0.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget().getType().hasName("size_t")
}

from Function func, Parameter vsk_1631, AddressOfExpr target_0
where
func_0(vsk_1631, target_0)
and vsk_1631.getType().hasName("sock *")
and vsk_1631.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
