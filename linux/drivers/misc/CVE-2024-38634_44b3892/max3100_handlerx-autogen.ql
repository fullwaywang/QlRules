/**
 * @name linux-44b38924135d2093e2ec1812969464845dd66dc9-max3100_handlerx
 * @id cpp/linux/44b38924135d2093e2ec1812969464845dd66dc9/max3100-handlerx
 * @description linux-44b38924135d2093e2ec1812969464845dd66dc9-drivers/tty/serial/max3100.c-max3100_handlerx CVE-2024-38634
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vrx_216, Parameter vs_216, BlockStmt target_41, FunctionCall target_0) {
	target_0.getTarget().hasName("max3100_check_parity")
	and not target_0.getTarget().hasName("max3100_handlerx_unlocked")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vs_216
	and target_0.getArgument(1).(VariableAccess).getTarget()=vrx_216
	and target_0.getParent().(IfStmt).getThen()=target_41
}

predicate func_1(Variable vdescriptor_222, Variable v__func__, Parameter vs_216, FunctionCall target_1) {
	exists(AddressOfExpr obj_0 | obj_0=target_1.getArgument(1) |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				obj_2.getTarget().getName()="spi"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vs_216
			)
			and obj_1.getTarget().getName()="dev"
		)
	)
	and target_1.getTarget().hasName("__dynamic_dev_dbg")
	and not target_1.getTarget().hasName("uart_port_lock_irqsave")
	and target_1.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdescriptor_222
	and target_1.getArgument(2).(StringLiteral).getValue()="%s\n"
	and target_1.getArgument(3).(VariableAccess).getTarget()=v__func__
}

predicate func_2(Variable vch_218, Variable vflg_218, Variable vstatus_218, FunctionCall target_2) {
	target_2.getTarget().hasName("uart_insert_char")
	and not target_2.getTarget().hasName("uart_port_unlock_irqrestore")
	and target_2.getArgument(0) instanceof AddressOfExpr
	and target_2.getArgument(1).(VariableAccess).getTarget()=vstatus_218
	and target_2.getArgument(2).(Literal).getValue()="4"
	and target_2.getArgument(3).(VariableAccess).getTarget()=vch_218
	and target_2.getArgument(4).(VariableAccess).getTarget()=vflg_218
}

predicate func_4(Function func) {
exists(AddressOfExpr target_4 |
	target_4.getOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_4.getEnclosingFunction() = func
)
}

predicate func_6(Parameter vs_216, AddressOfExpr target_6) {
	exists(PointerFieldAccess obj_0 | obj_0=target_6.getOperand() |
		obj_0.getTarget().getName()="port"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vs_216
	)
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_7(Parameter vs_216, AddressOfExpr target_7) {
	exists(PointerFieldAccess obj_0 | obj_0=target_7.getOperand() |
		obj_0.getTarget().getName()="port"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vs_216
	)
	and target_7.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_11(Function func, Initializer target_11) {
	target_11.getExpr().(Literal).getValue()="0"
	and target_11.getExpr().getEnclosingFunction() = func
}

predicate func_13(Variable vch_218, Variable vflg_218, Variable vstatus_218, Variable vret_219, Parameter vrx_216, Parameter vs_216, Function func, IfStmt target_13) {
	exists(LogicalAndExpr obj_0 | obj_0=target_13.getCondition() |
		exists(BitwiseAndExpr obj_1 | obj_1=obj_0.getLeftOperand() |
			obj_1.getLeftOperand().(VariableAccess).getTarget()=vrx_216
			and obj_1.getRightOperand().(BinaryBitwiseOperation).getValue()="32768"
		)
		and exists(PointerFieldAccess obj_2 | obj_2=obj_0.getRightOperand() |
			obj_2.getTarget().getName()="rx_enabled"
			and obj_2.getQualifier().(VariableAccess).getTarget()=vs_216
		)
	)
	and exists(BlockStmt obj_3 | obj_3=target_13.getThen() |
		exists(DoStmt obj_4 | obj_4=obj_3.getStmt(0) |
			obj_4.getCondition() instanceof Literal
			and obj_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
		)
		and exists(ExprStmt obj_5 | obj_5=obj_3.getStmt(1) |
			exists(AssignExpr obj_6 | obj_6=obj_5.getExpr() |
				exists(BitwiseAndExpr obj_7 | obj_7=obj_6.getRValue() |
					exists(ConditionalExpr obj_8 | obj_8=obj_7.getRightOperand() |
						obj_8.getThen().(HexLiteral).getValue()="127"
						and obj_8.getElse().(HexLiteral).getValue()="255"
					)
					and obj_7.getLeftOperand().(VariableAccess).getTarget()=vrx_216
				)
				and obj_6.getLValue().(VariableAccess).getTarget()=vch_218
			)
		)
		and exists(IfStmt obj_9 | obj_9=obj_3.getStmt(2) |
			exists(BitwiseAndExpr obj_10 | obj_10=obj_9.getCondition() |
				obj_10.getLeftOperand().(VariableAccess).getTarget()=vrx_216
				and obj_10.getRightOperand().(BinaryBitwiseOperation).getValue()="1024"
			)
			and exists(BlockStmt obj_11 | obj_11=obj_9.getThen() |
				exists(ExprStmt obj_12 | obj_12=obj_11.getStmt(1) |
					exists(AssignExpr obj_13 | obj_13=obj_12.getExpr() |
						obj_13.getLValue().(VariableAccess).getTarget()=vflg_218
						and obj_13.getRValue().(Literal).getValue()="2"
					)
				)
				and exists(ExprStmt obj_14 | obj_14=obj_11.getStmt(2) |
					exists(AssignOrExpr obj_15 | obj_15=obj_14.getExpr() |
						obj_15.getLValue().(VariableAccess).getTarget()=vstatus_218
						and obj_15.getRValue().(Literal).getValue()="2"
					)
				)
				and obj_11.getStmt(0).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getTarget().getName()="frame"
			)
			and exists(BlockStmt obj_16 | obj_16=obj_9.getElse() |
				exists(IfStmt obj_17 | obj_17=obj_16.getStmt(0) |
					exists(BitwiseAndExpr obj_18 | obj_18=obj_17.getCondition() |
						obj_18.getLeftOperand().(PointerFieldAccess).getTarget().getName()="parity"
						and obj_18.getRightOperand().(Literal).getValue()="1"
					)
				)
			)
		)
		and exists(ExprStmt obj_19 | obj_19=obj_3.getStmt(4) |
			exists(AssignExpr obj_20 | obj_20=obj_19.getExpr() |
				obj_20.getLValue().(VariableAccess).getTarget()=vret_219
				and obj_20.getRValue().(Literal).getValue()="1"
			)
		)
		and obj_3.getStmt(3).(ExprStmt).getExpr() instanceof FunctionCall
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_13
}

/*predicate func_14(LogicalAndExpr target_42, Function func, DoStmt target_14) {
	exists(BlockStmt obj_0 | obj_0=target_14.getStmt() |
		exists(IfStmt obj_1 | obj_1=obj_0.getStmt(1) |
			obj_1.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
			and obj_1.getThen().(ExprStmt).getExpr() instanceof FunctionCall
		)
	)
	and target_14.getCondition() instanceof Literal
	and target_14.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_42
	and target_14.getEnclosingFunction() = func
}

*/
/*predicate func_16(Variable vbranch_222, IfStmt target_16) {
	exists(StmtExpr obj_0 | obj_0=target_16.getCondition() |
		exists(BlockStmt obj_1 | obj_1=obj_0.getStmt() |
			exists(IfStmt obj_2 | obj_2=obj_1.getStmt(1) |
				exists(ExprStmt obj_3 | obj_3=obj_2.getThen() |
					exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
						obj_4.getLValue().(VariableAccess).getTarget()=vbranch_222
						and obj_4.getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
					)
				)
				and obj_2.getCondition().(BuiltInOperation).getValue()="0"
				and obj_2.getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
			)
			and exists(ExprStmt obj_5 | obj_5=obj_1.getStmt(2) |
				exists(FunctionCall obj_6 | obj_6=obj_5.getExpr() |
					obj_6.getTarget().hasName("__builtin_expect")
					and obj_6.getArgument(1) instanceof Literal
				)
			)
		)
	)
	and target_16.getThen().(ExprStmt).getExpr() instanceof FunctionCall
}

*/
/*predicate func_18(Variable vbranch_222, IfStmt target_18) {
	exists(ExprStmt obj_0 | obj_0=target_18.getThen() |
		exists(AssignExpr obj_1 | obj_1=obj_0.getExpr() |
			exists(FunctionCall obj_2 | obj_2=obj_1.getRValue() |
				obj_2.getTarget().hasName("arch_static_branch_jump")
				and obj_2.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
			)
			and obj_1.getLValue().(VariableAccess).getTarget()=vbranch_222
		)
	)
	and exists(IfStmt obj_3 | obj_3=target_18.getElse() |
		exists(ExprStmt obj_4 | obj_4=obj_3.getThen() |
			exists(AssignExpr obj_5 | obj_5=obj_4.getExpr() |
				exists(FunctionCall obj_6 | obj_6=obj_5.getRValue() |
					obj_6.getTarget().hasName("arch_static_branch")
					and obj_6.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
				)
				and obj_5.getLValue().(VariableAccess).getTarget()=vbranch_222
			)
		)
		and exists(ExprStmt obj_7 | obj_7=obj_3.getElse() |
			exists(AssignExpr obj_8 | obj_8=obj_7.getExpr() |
				obj_8.getLValue().(VariableAccess).getTarget()=vbranch_222
				and obj_8.getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
			)
		)
		and obj_3.getCondition().(BuiltInOperation).getValue()="1"
	)
	and target_18.getCondition().(BuiltInOperation).getValue()="0"
}

*/
/*predicate func_19(Variable vbranch_222, FunctionCall target_19) {
	target_19.getTarget().hasName("__builtin_expect")
	and target_19.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vbranch_222
	and target_19.getArgument(1) instanceof Literal
}

*/
predicate func_20(Variable vdescriptor_222, VariableAccess target_20) {
	target_20.getTarget()=vdescriptor_222
	and target_20.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_21(Parameter vs_216, PointerFieldAccess target_21) {
	exists(PointerFieldAccess obj_0 | obj_0=target_21.getQualifier() |
		obj_0.getTarget().getName()="spi"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vs_216
	)
	and target_21.getTarget().getName()="dev"
}

/*predicate func_22(Variable vch_218, Parameter vrx_216, Parameter vs_216, LogicalAndExpr target_42, ExprStmt target_22) {
	exists(AssignExpr obj_0 | obj_0=target_22.getExpr() |
		exists(BitwiseAndExpr obj_1 | obj_1=obj_0.getRValue() |
			exists(ConditionalExpr obj_2 | obj_2=obj_1.getRightOperand() |
				exists(BitwiseAndExpr obj_3 | obj_3=obj_2.getCondition() |
					exists(PointerFieldAccess obj_4 | obj_4=obj_3.getLeftOperand() |
						obj_4.getTarget().getName()="parity"
						and obj_4.getQualifier().(VariableAccess).getTarget()=vs_216
					)
					and obj_3.getRightOperand().(Literal).getValue()="4"
				)
				and obj_2.getThen().(HexLiteral).getValue()="127"
				and obj_2.getElse().(HexLiteral).getValue()="255"
			)
			and obj_1.getLeftOperand().(VariableAccess).getTarget()=vrx_216
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vch_218
	)
	and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_42
}

*/
/*predicate func_23(Variable vflg_218, Variable vstatus_218, Parameter vrx_216, Parameter vs_216, LogicalAndExpr target_42, IfStmt target_23) {
	exists(BitwiseAndExpr obj_0 | obj_0=target_23.getCondition() |
		obj_0.getLeftOperand().(VariableAccess).getTarget()=vrx_216
		and obj_0.getRightOperand().(BinaryBitwiseOperation).getValue()="1024"
	)
	and exists(BlockStmt obj_1 | obj_1=target_23.getThen() |
		exists(ExprStmt obj_2 | obj_2=obj_1.getStmt(0) |
			exists(PostfixIncrExpr obj_3 | obj_3=obj_2.getExpr() |
				exists(ValueFieldAccess obj_4 | obj_4=obj_3.getOperand() |
					exists(ValueFieldAccess obj_5 | obj_5=obj_4.getQualifier() |
						obj_5.getTarget().getName()="icount"
						and obj_5.getQualifier().(PointerFieldAccess).getTarget().getName()="port"
					)
					and obj_4.getTarget().getName()="frame"
				)
			)
		)
		and exists(ExprStmt obj_6 | obj_6=obj_1.getStmt(1) |
			exists(AssignExpr obj_7 | obj_7=obj_6.getExpr() |
				obj_7.getLValue().(VariableAccess).getTarget()=vflg_218
				and obj_7.getRValue().(Literal).getValue()="2"
			)
		)
		and exists(ExprStmt obj_8 | obj_8=obj_1.getStmt(2) |
			exists(AssignOrExpr obj_9 | obj_9=obj_8.getExpr() |
				obj_9.getLValue().(VariableAccess).getTarget()=vstatus_218
				and obj_9.getRValue().(Literal).getValue()="2"
			)
		)
	)
	and exists(BlockStmt obj_10 | obj_10=target_23.getElse() |
		exists(IfStmt obj_11 | obj_11=obj_10.getStmt(0) |
			exists(BitwiseAndExpr obj_12 | obj_12=obj_11.getCondition() |
				exists(PointerFieldAccess obj_13 | obj_13=obj_12.getLeftOperand() |
					obj_13.getTarget().getName()="parity"
					and obj_13.getQualifier().(VariableAccess).getTarget()=vs_216
				)
				and obj_12.getRightOperand().(Literal).getValue()="1"
			)
			and exists(BlockStmt obj_14 | obj_14=obj_11.getElse() |
				exists(ExprStmt obj_15 | obj_15=obj_14.getStmt(1) |
					exists(AssignExpr obj_16 | obj_16=obj_15.getExpr() |
						obj_16.getLValue().(VariableAccess).getTarget()=vflg_218
						and obj_16.getRValue().(Literal).getValue()="0"
					)
				)
				and obj_14.getStmt(0).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getTarget().getName()="rx"
			)
			and obj_11.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition() instanceof FunctionCall
		)
	)
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_42
}

*/
/*predicate func_24(Parameter vs_216, BitwiseAndExpr target_43, ExprStmt target_24) {
	exists(PostfixIncrExpr obj_0 | obj_0=target_24.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			exists(ValueFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
					obj_3.getTarget().getName()="port"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vs_216
				)
				and obj_2.getTarget().getName()="icount"
			)
			and obj_1.getTarget().getName()="frame"
		)
	)
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_43
}

*/
predicate func_25(Variable vflg_218, BitwiseAndExpr target_43, ExprStmt target_25) {
	exists(AssignExpr obj_0 | obj_0=target_25.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vflg_218
		and obj_0.getRValue().(Literal).getValue()="2"
	)
	and target_25.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_43
}

/*predicate func_26(Variable vstatus_218, BitwiseAndExpr target_43, ExprStmt target_26) {
	exists(AssignOrExpr obj_0 | obj_0=target_26.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vstatus_218
		and obj_0.getRValue().(Literal).getValue()="2"
	)
	and target_26.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_43
}

*/
/*predicate func_27(Variable vflg_218, Variable vstatus_218, Parameter vs_216, BitwiseAndExpr target_43, IfStmt target_27) {
	exists(BitwiseAndExpr obj_0 | obj_0=target_27.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLeftOperand() |
			obj_1.getTarget().getName()="parity"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vs_216
		)
		and obj_0.getRightOperand().(Literal).getValue()="1"
	)
	and exists(BlockStmt obj_2 | obj_2=target_27.getThen() |
		exists(IfStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(BlockStmt obj_4 | obj_4=obj_3.getThen() |
				exists(ExprStmt obj_5 | obj_5=obj_4.getStmt(1) |
					exists(AssignExpr obj_6 | obj_6=obj_5.getExpr() |
						obj_6.getLValue().(VariableAccess).getTarget()=vflg_218
						and obj_6.getRValue().(Literal).getValue()="0"
					)
				)
				and obj_4.getStmt(0).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getTarget().getName()="rx"
			)
			and exists(BlockStmt obj_7 | obj_7=obj_3.getElse() |
				exists(ExprStmt obj_8 | obj_8=obj_7.getStmt(1) |
					exists(AssignExpr obj_9 | obj_9=obj_8.getExpr() |
						obj_9.getLValue().(VariableAccess).getTarget()=vflg_218
						and obj_9.getRValue().(Literal).getValue()="3"
					)
				)
				and exists(ExprStmt obj_10 | obj_10=obj_7.getStmt(2) |
					exists(AssignOrExpr obj_11 | obj_11=obj_10.getExpr() |
						obj_11.getLValue().(VariableAccess).getTarget()=vstatus_218
						and obj_11.getRValue().(Literal).getValue()="1"
					)
				)
				and obj_7.getStmt(0).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getTarget().getName()="parity"
			)
			and obj_3.getCondition() instanceof FunctionCall
		)
	)
	and exists(BlockStmt obj_12 | obj_12=target_27.getElse() |
		exists(ExprStmt obj_13 | obj_13=obj_12.getStmt(0) |
			exists(PostfixIncrExpr obj_14 | obj_14=obj_13.getExpr() |
				exists(ValueFieldAccess obj_15 | obj_15=obj_14.getOperand() |
					exists(ValueFieldAccess obj_16 | obj_16=obj_15.getQualifier() |
						obj_16.getTarget().getName()="icount"
						and obj_16.getQualifier().(PointerFieldAccess).getTarget().getName()="port"
					)
					and obj_15.getTarget().getName()="rx"
				)
			)
		)
		and exists(ExprStmt obj_17 | obj_17=obj_12.getStmt(1) |
			exists(AssignExpr obj_18 | obj_18=obj_17.getExpr() |
				obj_18.getLValue().(VariableAccess).getTarget()=vflg_218
				and obj_18.getRValue().(Literal).getValue()="0"
			)
		)
	)
	and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_43
}

*/
/*predicate func_28(Variable vflg_218, Variable vstatus_218, BitwiseAndExpr target_44, IfStmt target_28) {
	exists(BlockStmt obj_0 | obj_0=target_28.getThen() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getStmt(0) |
			exists(PostfixIncrExpr obj_2 | obj_2=obj_1.getExpr() |
				exists(ValueFieldAccess obj_3 | obj_3=obj_2.getOperand() |
					exists(ValueFieldAccess obj_4 | obj_4=obj_3.getQualifier() |
						obj_4.getTarget().getName()="icount"
						and obj_4.getQualifier().(PointerFieldAccess).getTarget().getName()="port"
					)
					and obj_3.getTarget().getName()="rx"
				)
			)
		)
		and exists(ExprStmt obj_5 | obj_5=obj_0.getStmt(1) |
			exists(AssignExpr obj_6 | obj_6=obj_5.getExpr() |
				obj_6.getLValue().(VariableAccess).getTarget()=vflg_218
				and obj_6.getRValue().(Literal).getValue()="0"
			)
		)
	)
	and exists(BlockStmt obj_7 | obj_7=target_28.getElse() |
		exists(ExprStmt obj_8 | obj_8=obj_7.getStmt(0) |
			exists(PostfixIncrExpr obj_9 | obj_9=obj_8.getExpr() |
				exists(ValueFieldAccess obj_10 | obj_10=obj_9.getOperand() |
					exists(ValueFieldAccess obj_11 | obj_11=obj_10.getQualifier() |
						obj_11.getTarget().getName()="icount"
						and obj_11.getQualifier().(PointerFieldAccess).getTarget().getName()="port"
					)
					and obj_10.getTarget().getName()="parity"
				)
			)
		)
		and exists(ExprStmt obj_12 | obj_12=obj_7.getStmt(1) |
			exists(AssignExpr obj_13 | obj_13=obj_12.getExpr() |
				obj_13.getLValue().(VariableAccess).getTarget()=vflg_218
				and obj_13.getRValue().(Literal).getValue()="3"
			)
		)
		and exists(ExprStmt obj_14 | obj_14=obj_7.getStmt(2) |
			exists(AssignOrExpr obj_15 | obj_15=obj_14.getExpr() |
				obj_15.getLValue().(VariableAccess).getTarget()=vstatus_218
				and obj_15.getRValue().(Literal).getValue()="1"
			)
		)
	)
	and target_28.getCondition() instanceof FunctionCall
	and target_28.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_44
}

*/
/*predicate func_29(Parameter vs_216, FunctionCall target_0, ExprStmt target_31, ExprStmt target_29) {
	exists(PostfixIncrExpr obj_0 | obj_0=target_29.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			exists(ValueFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
					obj_3.getTarget().getName()="port"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vs_216
				)
				and obj_2.getTarget().getName()="icount"
			)
			and obj_1.getTarget().getName()="rx"
		)
	)
	and target_29.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_0
	and target_29.getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_31.getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
/*predicate func_30(Variable vflg_218, FunctionCall target_0, ExprStmt target_25, ExprStmt target_30) {
	exists(AssignExpr obj_0 | obj_0=target_30.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vflg_218
		and obj_0.getRValue().(Literal).getValue()="0"
	)
	and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_0
	and target_25.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

*/
predicate func_31(Parameter vs_216, ExprStmt target_31) {
	exists(PostfixIncrExpr obj_0 | obj_0=target_31.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			exists(ValueFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
					obj_3.getTarget().getName()="port"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vs_216
				)
				and obj_2.getTarget().getName()="icount"
			)
			and obj_1.getTarget().getName()="parity"
		)
	)
}

predicate func_32(Variable vflg_218, FunctionCall target_0, ExprStmt target_32) {
	exists(AssignExpr obj_0 | obj_0=target_32.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vflg_218
		and obj_0.getRValue().(Literal).getValue()="3"
	)
	and target_32.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_0
}

/*predicate func_33(Variable vstatus_218, FunctionCall target_0, ExprStmt target_33) {
	exists(AssignOrExpr obj_0 | obj_0=target_33.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vstatus_218
		and obj_0.getRValue().(Literal).getValue()="1"
	)
	and target_33.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_0
}

*/
/*predicate func_34(Parameter vs_216, BitwiseAndExpr target_44, ExprStmt target_31, AddressOfExpr target_6, ExprStmt target_34) {
	exists(PostfixIncrExpr obj_0 | obj_0=target_34.getExpr() |
		exists(ValueFieldAccess obj_1 | obj_1=obj_0.getOperand() |
			exists(ValueFieldAccess obj_2 | obj_2=obj_1.getQualifier() |
				exists(PointerFieldAccess obj_3 | obj_3=obj_2.getQualifier() |
					obj_3.getTarget().getName()="port"
					and obj_3.getQualifier().(VariableAccess).getTarget()=vs_216
				)
				and obj_2.getTarget().getName()="icount"
			)
			and obj_1.getTarget().getName()="rx"
		)
	)
	and target_34.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_44
	and target_31.getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_34.getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_34.getExpr().(PostfixIncrExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_6.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
/*predicate func_35(Variable vflg_218, BitwiseAndExpr target_44, ExprStmt target_32, ExprStmt target_35) {
	exists(AssignExpr obj_0 | obj_0=target_35.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vflg_218
		and obj_0.getRValue().(Literal).getValue()="0"
	)
	and target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_44
	and target_32.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_35.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

*/
predicate func_37(Variable vcts_219, Parameter vrx_216, Function func, ExprStmt target_37) {
	exists(AssignExpr obj_0 | obj_0=target_37.getExpr() |
		exists(RelationalOperation obj_1 | obj_1=obj_0.getRValue() |
			exists(BitwiseAndExpr obj_2 | obj_2=obj_1.getGreaterOperand() |
				obj_2.getLeftOperand().(VariableAccess).getTarget()=vrx_216
				and obj_2.getRightOperand().(BinaryBitwiseOperation).getValue()="512"
			)
			and obj_1.getLesserOperand().(Literal).getValue()="0"
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vcts_219
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_37
}

predicate func_38(Variable vcts_219, Parameter vs_216, Function func, IfStmt target_38) {
	exists(EqualityOperation obj_0 | obj_0=target_38.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLeftOperand() |
			obj_1.getTarget().getName()="cts"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vs_216
		)
		and obj_0.getRightOperand().(VariableAccess).getTarget()=vcts_219
	)
	and exists(BlockStmt obj_2 | obj_2=target_38.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(AssignExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(PointerFieldAccess obj_5 | obj_5=obj_4.getLValue() |
					obj_5.getTarget().getName()="cts"
					and obj_5.getQualifier().(VariableAccess).getTarget()=vs_216
				)
				and obj_4.getRValue().(VariableAccess).getTarget()=vcts_219
			)
		)
		and exists(ExprStmt obj_6 | obj_6=obj_2.getStmt(1) |
			exists(FunctionCall obj_7 | obj_7=obj_6.getExpr() |
				exists(ConditionalExpr obj_8 | obj_8=obj_7.getArgument(1) |
					obj_8.getCondition().(VariableAccess).getTarget()=vcts_219
					and obj_8.getThen().(Literal).getValue()="32"
					and obj_8.getElse().(Literal).getValue()="0"
				)
				and obj_7.getTarget().hasName("uart_handle_cts_change")
				and obj_7.getArgument(0) instanceof AddressOfExpr
			)
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

/*predicate func_39(Variable vcts_219, Parameter vs_216, EqualityOperation target_46, ExprStmt target_39) {
	exists(AssignExpr obj_0 | obj_0=target_39.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLValue() |
			obj_1.getTarget().getName()="cts"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vs_216
		)
		and obj_0.getRValue().(VariableAccess).getTarget()=vcts_219
	)
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_46
}

*/
/*predicate func_40(Variable vcts_219, EqualityOperation target_46, ExprStmt target_40) {
	exists(FunctionCall obj_0 | obj_0=target_40.getExpr() |
		exists(ConditionalExpr obj_1 | obj_1=obj_0.getArgument(1) |
			obj_1.getCondition().(VariableAccess).getTarget()=vcts_219
			and obj_1.getThen().(Literal).getValue()="32"
			and obj_1.getElse().(Literal).getValue()="0"
		)
		and obj_0.getTarget().hasName("uart_handle_cts_change")
		and obj_0.getArgument(0) instanceof AddressOfExpr
	)
	and target_40.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_46
}

*/
predicate func_41(FunctionCall target_0, Function func, BlockStmt target_41) {
	target_41.getStmt(0) instanceof ExprStmt
	and target_41.getStmt(1) instanceof ExprStmt
	and target_41.getParent().(IfStmt).getCondition()=target_0
	and target_41.getEnclosingFunction() = func
}

predicate func_42(Parameter vs_216, LogicalAndExpr target_42) {
	exists(PointerFieldAccess obj_0 | obj_0=target_42.getRightOperand() |
		obj_0.getTarget().getName()="rx_enabled"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vs_216
	)
	and target_42.getLeftOperand() instanceof BitwiseAndExpr
}

predicate func_43(Parameter vrx_216, BitwiseAndExpr target_43) {
	target_43.getLeftOperand().(VariableAccess).getTarget()=vrx_216
	and target_43.getRightOperand() instanceof BinaryBitwiseOperation
}

predicate func_44(Parameter vs_216, BitwiseAndExpr target_44) {
	exists(PointerFieldAccess obj_0 | obj_0=target_44.getLeftOperand() |
		obj_0.getTarget().getName()="parity"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vs_216
	)
	and target_44.getRightOperand() instanceof Literal
}

predicate func_46(Variable vcts_219, Parameter vs_216, EqualityOperation target_46) {
	exists(PointerFieldAccess obj_0 | obj_0=target_46.getLeftOperand() |
		obj_0.getTarget().getName()="cts"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vs_216
	)
	and target_46.getRightOperand().(VariableAccess).getTarget()=vcts_219
}

from Function func, Variable vch_218, Variable vflg_218, Variable vstatus_218, Variable vret_219, Variable vcts_219, Variable vdescriptor_222, Variable v__func__, Variable vbranch_222, Parameter vrx_216, Parameter vs_216, FunctionCall target_0, FunctionCall target_1, FunctionCall target_2, AddressOfExpr target_6, AddressOfExpr target_7, Initializer target_11, IfStmt target_13, VariableAccess target_20, PointerFieldAccess target_21, ExprStmt target_25, ExprStmt target_31, ExprStmt target_32, ExprStmt target_37, IfStmt target_38, BlockStmt target_41, LogicalAndExpr target_42, BitwiseAndExpr target_43, BitwiseAndExpr target_44, EqualityOperation target_46
where
func_0(vrx_216, vs_216, target_41, target_0)
and func_1(vdescriptor_222, v__func__, vs_216, target_1)
and func_2(vch_218, vflg_218, vstatus_218, target_2)
and not func_4(func)
and func_6(vs_216, target_6)
and func_7(vs_216, target_7)
and func_11(func, target_11)
and func_13(vch_218, vflg_218, vstatus_218, vret_219, vrx_216, vs_216, func, target_13)
and func_20(vdescriptor_222, target_20)
and func_21(vs_216, target_21)
and func_25(vflg_218, target_43, target_25)
and func_31(vs_216, target_31)
and func_32(vflg_218, target_0, target_32)
and func_37(vcts_219, vrx_216, func, target_37)
and func_38(vcts_219, vs_216, func, target_38)
and func_41(target_0, func, target_41)
and func_42(vs_216, target_42)
and func_43(vrx_216, target_43)
and func_44(vs_216, target_44)
and func_46(vcts_219, vs_216, target_46)
and vch_218.getType().hasName("unsigned int")
and vflg_218.getType().hasName("unsigned int")
and vstatus_218.getType().hasName("unsigned int")
and vret_219.getType().hasName("int")
and vcts_219.getType().hasName("int")
and vdescriptor_222.getType().hasName("_ddebug")
and v__func__.getType() instanceof ArrayType
and vbranch_222.getType().hasName("bool")
and vrx_216.getType().hasName("u16")
and vs_216.getType().hasName("max3100_port *")
and vch_218.(LocalVariable).getFunction() = func
and vflg_218.(LocalVariable).getFunction() = func
and vstatus_218.(LocalVariable).getFunction() = func
and vret_219.(LocalVariable).getFunction() = func
and vcts_219.(LocalVariable).getFunction() = func
and vdescriptor_222.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
and vbranch_222.(LocalVariable).getFunction() = func
and vrx_216.getFunction() = func
and vs_216.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
