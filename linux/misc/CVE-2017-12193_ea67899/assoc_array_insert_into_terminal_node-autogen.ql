/**
 * @name linux-ea6789980fdaa610d7eb63602c746bf6ec70cd2b-assoc_array_insert_into_terminal_node
 * @id cpp/linux/ea6789980fdaa610d7eb63602c746bf6ec70cd2b/assoc-array-insert-into-terminal-node
 * @description linux-ea6789980fdaa610d7eb63602c746bf6ec70cd2b-lib/assoc_array.c-assoc_array_insert_into_terminal_node CVE-2017-12193
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vnode_497, Variable vnew_n0_497, PointerFieldAccess target_0) {
	target_0.getTarget().getName()="back_pointer"
	and target_0.getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_0.getParent().(AssignExpr).getLValue() = target_0
	and target_0.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_0.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
}

/*predicate func_1(Variable vnode_497, Variable vnew_n0_497, PointerFieldAccess target_1) {
	target_1.getTarget().getName()="back_pointer"
	and target_1.getQualifier().(VariableAccess).getTarget()=vnode_497
	and target_1.getParent().(AssignExpr).getRValue() = target_1
	and target_1.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_1.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n0_497
}

*/
predicate func_2(Variable vnode_497, Variable vnew_n0_497, PointerFieldAccess target_2) {
	target_2.getTarget().getName()="parent_slot"
	and target_2.getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_2.getParent().(AssignExpr).getLValue() = target_2
	and target_2.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="parent_slot"
	and target_2.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
}

predicate func_3(Variable vnew_n0_497, Variable vnew_n1_497, PointerFieldAccess target_3) {
	target_3.getTarget().getName()="back_pointer"
	and target_3.getQualifier().(VariableAccess).getTarget()=vnew_n1_497
	and target_3.getParent().(AssignExpr).getLValue() = target_3
	and target_3.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("assoc_array_node_to_ptr")
	and target_3.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnew_n0_497
}

/*predicate func_4(Variable vnew_n0_497, Variable vnew_n1_497, FunctionCall target_4) {
	target_4.getTarget().hasName("assoc_array_node_to_ptr")
	and target_4.getArgument(0).(VariableAccess).getTarget()=vnew_n0_497
	and target_4.getParent().(AssignExpr).getRValue() = target_4
	and target_4.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_4.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n1_497
}

*/
predicate func_5(Variable vnew_n1_497, PointerFieldAccess target_5) {
	target_5.getTarget().getName()="parent_slot"
	and target_5.getQualifier().(VariableAccess).getTarget()=vnew_n1_497
	and target_5.getParent().(AssignExpr).getLValue() = target_5
	and target_5.getParent().(AssignExpr).getRValue() instanceof ArrayExpr
}

predicate func_6(Variable vi_503, ExprStmt target_6) {
	target_6.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vi_503
	and target_6.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_7(Variable vi_503, ExprStmt target_34, RelationalOperation target_7) {
	 (target_7 instanceof GTExpr or target_7 instanceof LTExpr)
	and target_7.getLesserOperand().(VariableAccess).getTarget()=vi_503
	and target_7.getGreaterOperand().(Literal).getValue()="16"
	and target_7.getParent().(ForStmt).getStmt()=target_34
}

predicate func_8(Variable vi_503, PostfixIncrExpr target_8) {
	target_8.getOperand().(VariableAccess).getTarget()=vi_503
}

predicate func_9(Variable vnode_497, Variable vi_503, ArrayExpr target_9) {
	target_9.getArrayBase().(PointerFieldAccess).getTarget().getName()="slots"
	and target_9.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and target_9.getArrayOffset().(VariableAccess).getTarget()=vi_503
	and target_9.getParent().(AssignExpr).getRValue() = target_9
	and target_9.getParent().(AssignExpr).getLValue() instanceof ArrayExpr
}

predicate func_10(Variable vnew_n0_497, FunctionCall target_10) {
	target_10.getTarget().hasName("assoc_array_node_to_ptr")
	and target_10.getArgument(0).(VariableAccess).getTarget()=vnew_n0_497
	and target_10.getParent().(AssignExpr).getRValue() = target_10
	and target_10.getParent().(AssignExpr).getLValue() instanceof ArrayExpr
}

predicate func_11(Parameter vedit_491, PointerFieldAccess target_11) {
	target_11.getTarget().getName()="segment_cache"
	and target_11.getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_11.getParent().(ArrayExpr).getArrayOffset() instanceof Literal
}

predicate func_12(Parameter vedit_491, PointerFieldAccess target_12) {
	target_12.getTarget().getName()="set"
	and target_12.getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_12.getParent().(ArrayExpr).getArrayOffset() instanceof Literal
}

predicate func_13(Parameter vedit_491, ValueFieldAccess target_13) {
	target_13.getTarget().getName()="to"
	and target_13.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="set"
	and target_13.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_13.getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
}

predicate func_14(Function func, ExprStmt target_14) {
	target_14.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_14.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(Literal).getValue()="0"
	and target_14.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(EqualityOperation target_35, Function func, GotoStmt target_15) {
	target_15.getName() ="present_leaves_cluster_but_not_new_leaf"
	and target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_35
	and target_15.getEnclosingFunction() = func
}

predicate func_16(Variable vnode_497, Variable vnew_n0_497, ExprStmt target_17, Function func, ExprStmt target_16) {
	target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_16.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_16.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
	and target_16.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_17.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_17(Variable vnode_497, Variable vnew_n0_497, ExprStmt target_16, ExprStmt target_18, Function func, ExprStmt target_17) {
	target_17.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="parent_slot"
	and target_17.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_17.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="parent_slot"
	and target_17.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_17
	and target_16.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_17.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_17.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_18(Variable vnode_497, Variable vnew_n0_497, ExprStmt target_17, ExprStmt target_21, ExprStmt target_19, Function func, ExprStmt target_18) {
	target_18.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="nr_leaves_on_branch"
	and target_18.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="nr_leaves_on_branch"
	and target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_18
	and target_17.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_18.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_21.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_19(Variable vnew_n1_497, ExprStmt target_20, Function func, ExprStmt target_19) {
	target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n1_497
	and target_19.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_19
	and target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_20(Variable vnew_n1_497, Parameter vedit_491, Function func, ExprStmt target_20) {
	target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="parent_slot"
	and target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n1_497
	and target_20.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="segment_cache"
	and target_20.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_20.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
}

predicate func_21(Variable vnode_497, Variable vnew_n1_497, Function func, ExprStmt target_21) {
	target_21.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="nr_leaves_on_branch"
	and target_21.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n1_497
	and target_21.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="nr_leaves_on_branch"
	and target_21.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
}

predicate func_22(Variable vnew_n0_497, Parameter vedit_491, ExprStmt target_19, ExprStmt target_24, ExprStmt target_20, Function func, ExprStmt target_22) {
	target_22.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="adjust_count_on"
	and target_22.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_22.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnew_n0_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_22
	and target_22.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_24.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_20.getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_22.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_23(Variable vnew_n1_497, Variable vi_503, Function func, ForStmt target_23) {
	target_23.getInitialization() instanceof ExprStmt
	and target_23.getCondition() instanceof RelationalOperation
	and target_23.getUpdate() instanceof PostfixIncrExpr
	and target_23.getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="slots"
	and target_23.getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n1_497
	and target_23.getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_503
	and target_23.getStmt().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof ArrayExpr
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

predicate func_24(Variable vnew_n0_497, Parameter vedit_491, Function func, ExprStmt target_24) {
	target_24.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="slots"
	and target_24.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_24.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="segment_cache"
	and target_24.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_24.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_24.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
}

predicate func_25(Variable vnew_n0_497, Parameter vedit_491, Function func, ExprStmt target_25) {
	target_25.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="leaf_p"
	and target_25.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_25.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="slots"
	and target_25.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnew_n0_497
	and target_25.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="segment_cache"
	and target_25.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_25.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(ArrayExpr).getArrayOffset().(Literal).getValue()="16"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
}

predicate func_26(Variable vnode_497, Parameter vedit_491, Function func, ExprStmt target_26) {
	target_26.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="ptr"
	and target_26.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="set"
	and target_26.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_26.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_26.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="slots"
	and target_26.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("assoc_array_ptr_to_node")
	and target_26.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="back_pointer"
	and target_26.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getTarget().getName()="parent_slot"
	and target_26.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_26
}

predicate func_27(Variable vnew_n0_497, ExprStmt target_25, ExprStmt target_36, Function func, ExprStmt target_27) {
	target_27.getExpr().(AssignExpr).getLValue() instanceof ValueFieldAccess
	and target_27.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("assoc_array_node_to_ptr")
	and target_27.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnew_n0_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
	and target_25.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_27.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_27.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_36.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
}

predicate func_28(Variable vnode_497, Parameter vedit_491, ExprStmt target_26, ArrayExpr target_37, ExprStmt target_27, ExprStmt target_38, Function func, ExprStmt target_28) {
	target_28.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="excised_meta"
	and target_28.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_28.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_28.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("assoc_array_node_to_ptr")
	and target_28.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnode_497
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
	and target_26.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_28.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_28.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_37.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_28.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_38.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_29(Function func, ExprStmt target_29) {
	target_29.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_29.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(Literal).getValue()="0"
	and target_29.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

/*predicate func_30(Variable v__func__, DoStmt target_30) {
	target_30.getCondition().(Literal).getValue()="0"
	and target_30.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(Literal).getValue()="0"
	and target_30.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_30.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="7<--%s() = ok [insert node before]\n"
	and target_30.getStmt().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=v__func__
}

*/
/*predicate func_31(Variable v__func__, IfStmt target_31) {
	target_31.getCondition().(Literal).getValue()="0"
	and target_31.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_31.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="7<--%s() = ok [insert node before]\n"
	and target_31.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=v__func__
}

*/
/*predicate func_32(Function func, ExprStmt target_32) {
	target_32.getExpr().(Literal).getValue()="0"
	and target_32.getEnclosingFunction() = func
}

*/
predicate func_33(Function func, ReturnStmt target_33) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_33
}

predicate func_34(Function func, ExprStmt target_34) {
	target_34.getExpr() instanceof AssignExpr
	and target_34.getEnclosingFunction() = func
}

predicate func_35(Function func, EqualityOperation target_35) {
	target_35.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("unsigned long")
	and target_35.getLeftOperand().(BitwiseAndExpr).getRightOperand().(SubExpr).getValue()="15"
	and target_35.getRightOperand().(Literal).getValue()="0"
	and target_35.getEnclosingFunction() = func
}

predicate func_36(Variable vnew_n0_497, ExprStmt target_36) {
	target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="next_node"
	and target_36.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("assoc_array_shortcut *")
	and target_36.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("assoc_array_node_to_ptr")
	and target_36.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vnew_n0_497
}

predicate func_37(Variable vnode_497, Variable vi_503, ArrayExpr target_37) {
	target_37.getArrayBase().(PointerFieldAccess).getTarget().getName()="slots"
	and target_37.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnode_497
	and target_37.getArrayOffset().(VariableAccess).getTarget()=vi_503
	and target_37.getParent().(FunctionCall).getParent().(VariableCall).getArgument(0).(FunctionCall).getTarget().hasName("assoc_array_ptr_to_leaf")
}

predicate func_38(Parameter vedit_491, ExprStmt target_38) {
	target_38.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="new_meta"
	and target_38.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedit_491
	and target_38.getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(Literal).getValue()="2"
	and target_38.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("assoc_array_shortcut_to_ptr")
	and target_38.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("assoc_array_shortcut *")
}

from Function func, Variable vnode_497, Variable vnew_n0_497, Variable vnew_n1_497, Variable vi_503, Variable v__func__, Parameter vedit_491, PointerFieldAccess target_0, PointerFieldAccess target_2, PointerFieldAccess target_3, PointerFieldAccess target_5, ExprStmt target_6, RelationalOperation target_7, PostfixIncrExpr target_8, ArrayExpr target_9, FunctionCall target_10, PointerFieldAccess target_11, PointerFieldAccess target_12, ValueFieldAccess target_13, ExprStmt target_14, GotoStmt target_15, ExprStmt target_16, ExprStmt target_17, ExprStmt target_18, ExprStmt target_19, ExprStmt target_20, ExprStmt target_21, ExprStmt target_22, ForStmt target_23, ExprStmt target_24, ExprStmt target_25, ExprStmt target_26, ExprStmt target_27, ExprStmt target_28, ExprStmt target_29, ReturnStmt target_33, ExprStmt target_34, EqualityOperation target_35, ExprStmt target_36, ArrayExpr target_37, ExprStmt target_38
where
func_0(vnode_497, vnew_n0_497, target_0)
and func_2(vnode_497, vnew_n0_497, target_2)
and func_3(vnew_n0_497, vnew_n1_497, target_3)
and func_5(vnew_n1_497, target_5)
and func_6(vi_503, target_6)
and func_7(vi_503, target_34, target_7)
and func_8(vi_503, target_8)
and func_9(vnode_497, vi_503, target_9)
and func_10(vnew_n0_497, target_10)
and func_11(vedit_491, target_11)
and func_12(vedit_491, target_12)
and func_13(vedit_491, target_13)
and func_14(func, target_14)
and func_15(target_35, func, target_15)
and func_16(vnode_497, vnew_n0_497, target_17, func, target_16)
and func_17(vnode_497, vnew_n0_497, target_16, target_18, func, target_17)
and func_18(vnode_497, vnew_n0_497, target_17, target_21, target_19, func, target_18)
and func_19(vnew_n1_497, target_20, func, target_19)
and func_20(vnew_n1_497, vedit_491, func, target_20)
and func_21(vnode_497, vnew_n1_497, func, target_21)
and func_22(vnew_n0_497, vedit_491, target_19, target_24, target_20, func, target_22)
and func_23(vnew_n1_497, vi_503, func, target_23)
and func_24(vnew_n0_497, vedit_491, func, target_24)
and func_25(vnew_n0_497, vedit_491, func, target_25)
and func_26(vnode_497, vedit_491, func, target_26)
and func_27(vnew_n0_497, target_25, target_36, func, target_27)
and func_28(vnode_497, vedit_491, target_26, target_37, target_27, target_38, func, target_28)
and func_29(func, target_29)
and func_33(func, target_33)
and func_34(func, target_34)
and func_35(func, target_35)
and func_36(vnew_n0_497, target_36)
and func_37(vnode_497, vi_503, target_37)
and func_38(vedit_491, target_38)
and vnode_497.getType().hasName("assoc_array_node *")
and vnew_n0_497.getType().hasName("assoc_array_node *")
and vnew_n1_497.getType().hasName("assoc_array_node *")
and vi_503.getType().hasName("int")
and v__func__.getType() instanceof ArrayType
and vedit_491.getType().hasName("assoc_array_edit *")
and vnode_497.(LocalVariable).getFunction() = func
and vnew_n0_497.(LocalVariable).getFunction() = func
and vnew_n1_497.(LocalVariable).getFunction() = func
and vi_503.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
and vedit_491.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
