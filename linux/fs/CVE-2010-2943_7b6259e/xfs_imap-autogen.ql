/**
 * @name linux-7b6259e7a83647948fa33a736cc832310c8d85aa-xfs_imap
 * @id cpp/linux/7b6259e7a83647948fa33a736cc832310c8d85aa/xfs-imap
 * @description linux-7b6259e7a83647948fa33a736cc832310c8d85aa-fs/xfs/xfs_ialloc.c-xfs_imap CVE-2010-2943
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vmp_1268, SubExpr target_0) {
		target_0.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(Literal).getValue()="1"
		and target_0.getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inopblog"
		and target_0.getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_0.getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_0.getRightOperand().(Literal).getValue()="1"
}

predicate func_1(Variable vagbno_1274, Variable vcluster_agbno_1279, SubExpr target_1) {
		target_1.getLeftOperand().(VariableAccess).getTarget()=vagbno_1274
		and target_1.getRightOperand().(VariableAccess).getTarget()=vcluster_agbno_1279
}

predicate func_2(Parameter vmp_1268, ValueFieldAccess target_2) {
		target_2.getTarget().getName()="sb_inopblock"
		and target_2.getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_2.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
}

predicate func_3(Parameter vmp_1268, Parameter vimap_1271, Variable vblks_per_cluster_1277, PointerFieldAccess target_13, ExprStmt target_3) {
		target_3.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="im_len"
		and target_3.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_3.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=vblks_per_cluster_1277
		and target_3.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getTarget().getName()="m_blkbb_log"
		and target_3.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_3.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
}

predicate func_4(Parameter vmp_1268, Parameter vimap_1271, Variable voffset_1281, PointerFieldAccess target_13, ExprStmt target_4) {
		target_4.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="im_boffset"
		and target_4.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_4.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voffset_1281
		and target_4.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inodelog"
		and target_4.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_4.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_4.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
}

predicate func_5(Parameter vino_1270, Parameter vmp_1268, Parameter vimap_1271, Variable vcluster_agbno_1279, Variable voffset_1281, Function func, IfStmt target_5) {
		target_5.getCondition().(PointerFieldAccess).getTarget().getName()="im_blkno"
		and target_5.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_5.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voffset_1281
		and target_5.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vino_1270
		and target_5.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand() instanceof SubExpr
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getThen() instanceof Literal
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("assfail")
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(StringLiteral).getValue()="offset < mp->m_sb.sb_inopblock"
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof StringLiteral
		and target_5.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(ConditionalExpr).getElse().(FunctionCall).getArgument(2) instanceof Literal
		and target_5.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcluster_agbno_1279
		and target_5.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("xfs_daddr_to_agbno")
		and target_5.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmp_1268
		and target_5.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="im_blkno"
		and target_5.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_5.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=voffset_1281
		and target_5.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(MulExpr).getLeftOperand() instanceof SubExpr
		and target_5.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(MulExpr).getRightOperand() instanceof ValueFieldAccess
		and target_5.getThen().(BlockStmt).getStmt(4) instanceof ExprStmt
		and target_5.getThen().(BlockStmt).getStmt(5) instanceof ExprStmt
		and target_5.getThen().(BlockStmt).getStmt(6).(ReturnStmt).getExpr().(Literal).getValue()="0"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_5
}

predicate func_6(Parameter vino_1270, Variable voffset_1281, PointerFieldAccess target_13, ExprStmt target_14, ExprStmt target_15, ExprStmt target_16, ExprStmt target_6) {
		target_6.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voffset_1281
		and target_6.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vino_1270
		and target_6.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand() instanceof SubExpr
		and target_6.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
		and target_14.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_6.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation())
		and target_6.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation())
		and target_16.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_6.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

/*predicate func_7(Variable voffset_1281, PointerFieldAccess target_13, ExprStmt target_6, ExprStmt target_9, ExprStmt target_7) {
		target_7.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_7.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=voffset_1281
		and target_7.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getTarget().getName()="sb_inopblock"
		and target_7.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_7.getExpr().(ConditionalExpr).getThen() instanceof Literal
		and target_7.getExpr().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("assfail")
		and target_7.getExpr().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(StringLiteral).getValue()="offset < mp->m_sb.sb_inopblock"
		and target_7.getExpr().(ConditionalExpr).getElse().(FunctionCall).getArgument(1) instanceof StringLiteral
		and target_7.getExpr().(ConditionalExpr).getElse().(FunctionCall).getArgument(2) instanceof Literal
		and target_7.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
		and target_6.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_7.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getLocation())
		and target_7.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getLocation().isBefore(target_9.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation())
}

*/
/*predicate func_8(Parameter vmp_1268, Parameter vimap_1271, Variable vcluster_agbno_1279, PointerFieldAccess target_13, ExprStmt target_8) {
		target_8.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcluster_agbno_1279
		and target_8.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("xfs_daddr_to_agbno")
		and target_8.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmp_1268
		and target_8.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="im_blkno"
		and target_8.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_8.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
}

*/
predicate func_9(Variable voffset_1281, ExprStmt target_9) {
		target_9.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=voffset_1281
		and target_9.getExpr().(AssignAddExpr).getRValue().(MulExpr).getLeftOperand() instanceof SubExpr
		and target_9.getExpr().(AssignAddExpr).getRValue().(MulExpr).getRightOperand() instanceof ValueFieldAccess
}

/*predicate func_10(PointerFieldAccess target_13, Function func, ReturnStmt target_10) {
		target_10.getExpr().(Literal).getValue()="0"
		and target_10.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_13
		and target_10.getEnclosingFunction() = func
}

*/
predicate func_11(Parameter vmp_1268, Parameter vimap_1271, Variable vblks_per_cluster_1277, ExprStmt target_18, ExprStmt target_12, ExprStmt target_19, Function func, ExprStmt target_11) {
		target_11.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="im_len"
		and target_11.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=vblks_per_cluster_1277
		and target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getTarget().getName()="m_blkbb_log"
		and target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_11
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(DivExpr).getRightOperand().(VariableAccess).getLocation().isBefore(target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getLocation())
}

predicate func_12(Parameter vmp_1268, Parameter vimap_1271, Variable voffset_1281, ExprStmt target_11, RelationalOperation target_20, ExprStmt target_15, Function func, ExprStmt target_12) {
		target_12.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="im_boffset"
		and target_12.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voffset_1281
		and target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inodelog"
		and target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_12
		and target_11.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_20.getLesserOperand().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_15.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_12.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getLocation())
}

predicate func_13(Parameter vimap_1271, PointerFieldAccess target_13) {
		target_13.getTarget().getName()="im_blkno"
		and target_13.getQualifier().(VariableAccess).getTarget()=vimap_1271
}

predicate func_14(Parameter vino_1270, Variable voffset_1281, RelationalOperation target_21, ExprStmt target_14) {
		target_14.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voffset_1281
		and target_14.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vino_1270
		and target_14.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(SubExpr).getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(Literal).getValue()="1"
		and target_14.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(SubExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inopblog"
		and target_14.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(SubExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_14.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
		and target_14.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_21
}

predicate func_15(Variable vagbno_1274, Parameter vino_1270, Parameter vmp_1268, Variable vcluster_agbno_1279, Variable voffset_1281, ExprStmt target_15) {
		target_15.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voffset_1281
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vagbno_1274
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vcluster_agbno_1279
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inopblock"
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vino_1270
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(BitwiseAndExpr).getRightOperand().(SubExpr).getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(Literal).getValue()="1"
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(BitwiseAndExpr).getRightOperand().(SubExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inopblog"
		and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(BitwiseAndExpr).getRightOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
}

predicate func_16(Parameter vmp_1268, Parameter vimap_1271, Variable voffset_1281, RelationalOperation target_21, ExprStmt target_16) {
		target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="im_boffset"
		and target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_16.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voffset_1281
		and target_16.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_inodelog"
		and target_16.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_16.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_16.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_21
}

predicate func_18(Parameter vmp_1268, Parameter vimap_1271, Variable vcluster_agbno_1279, ExprStmt target_18) {
		target_18.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="im_blkno"
		and target_18.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("xfs_agnumber_t")
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(ValueFieldAccess).getTarget().getName()="sb_agblocks"
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getAnOperand().(VariableAccess).getTarget()=vcluster_agbno_1279
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getTarget().getName()="m_blkbb_log"
		and target_18.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
}

predicate func_19(Variable vblks_per_cluster_1277, Variable vcluster_agbno_1279, ExprStmt target_19) {
		target_19.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcluster_agbno_1279
		and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(VariableAccess).getTarget().getType().hasName("xfs_agblock_t")
		and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(DivExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getLeftOperand().(DivExpr).getRightOperand().(VariableAccess).getTarget()=vblks_per_cluster_1277
		and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(MulExpr).getRightOperand().(VariableAccess).getTarget()=vblks_per_cluster_1277
}

predicate func_20(Parameter vmp_1268, Parameter vimap_1271, RelationalOperation target_20) {
		 (target_20 instanceof GTExpr or target_20 instanceof LTExpr)
		and target_20.getGreaterOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getTarget().getName()="im_blkno"
		and target_20.getGreaterOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_20.getGreaterOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getTarget().getName()="im_len"
		and target_20.getGreaterOperand().(AddExpr).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vimap_1271
		and target_20.getLesserOperand().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="sb_dblocks"
		and target_20.getLesserOperand().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_20.getLesserOperand().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_20.getLesserOperand().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getTarget().getName()="m_blkbb_log"
		and target_20.getLesserOperand().(BinaryBitwiseOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
}

predicate func_21(Parameter vmp_1268, RelationalOperation target_21) {
		 (target_21 instanceof GEExpr or target_21 instanceof LEExpr)
		and target_21.getLesserOperand().(PointerFieldAccess).getTarget().getName()="m_inode_cluster_size"
		and target_21.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
		and target_21.getGreaterOperand().(ValueFieldAccess).getTarget().getName()="sb_blocksize"
		and target_21.getGreaterOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="m_sb"
		and target_21.getGreaterOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmp_1268
}

from Function func, Variable vagbno_1274, Parameter vino_1270, Parameter vmp_1268, Parameter vimap_1271, Variable vblks_per_cluster_1277, Variable vcluster_agbno_1279, Variable voffset_1281, SubExpr target_0, SubExpr target_1, ValueFieldAccess target_2, ExprStmt target_3, ExprStmt target_4, IfStmt target_5, ExprStmt target_6, ExprStmt target_9, ExprStmt target_11, ExprStmt target_12, PointerFieldAccess target_13, ExprStmt target_14, ExprStmt target_15, ExprStmt target_16, ExprStmt target_18, ExprStmt target_19, RelationalOperation target_20, RelationalOperation target_21
where
func_0(vmp_1268, target_0)
and func_1(vagbno_1274, vcluster_agbno_1279, target_1)
and func_2(vmp_1268, target_2)
and func_3(vmp_1268, vimap_1271, vblks_per_cluster_1277, target_13, target_3)
and func_4(vmp_1268, vimap_1271, voffset_1281, target_13, target_4)
and func_5(vino_1270, vmp_1268, vimap_1271, vcluster_agbno_1279, voffset_1281, func, target_5)
and func_6(vino_1270, voffset_1281, target_13, target_14, target_15, target_16, target_6)
and func_9(voffset_1281, target_9)
and func_11(vmp_1268, vimap_1271, vblks_per_cluster_1277, target_18, target_12, target_19, func, target_11)
and func_12(vmp_1268, vimap_1271, voffset_1281, target_11, target_20, target_15, func, target_12)
and func_13(vimap_1271, target_13)
and func_14(vino_1270, voffset_1281, target_21, target_14)
and func_15(vagbno_1274, vino_1270, vmp_1268, vcluster_agbno_1279, voffset_1281, target_15)
and func_16(vmp_1268, vimap_1271, voffset_1281, target_21, target_16)
and func_18(vmp_1268, vimap_1271, vcluster_agbno_1279, target_18)
and func_19(vblks_per_cluster_1277, vcluster_agbno_1279, target_19)
and func_20(vmp_1268, vimap_1271, target_20)
and func_21(vmp_1268, target_21)
and vagbno_1274.getType().hasName("xfs_agblock_t")
and vino_1270.getType().hasName("xfs_ino_t")
and vmp_1268.getType().hasName("xfs_mount_t *")
and vimap_1271.getType().hasName("xfs_imap *")
and vblks_per_cluster_1277.getType().hasName("int")
and vcluster_agbno_1279.getType().hasName("xfs_agblock_t")
and voffset_1281.getType().hasName("int")
and vagbno_1274.(LocalVariable).getFunction() = func
and vino_1270.getFunction() = func
and vmp_1268.getFunction() = func
and vimap_1271.getFunction() = func
and vblks_per_cluster_1277.(LocalVariable).getFunction() = func
and vcluster_agbno_1279.(LocalVariable).getFunction() = func
and voffset_1281.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
