commit 96f452ac647dae33c53c242ef3266b65a9beafb6	96f452ac647dae33c53c242ef3266b65a9beafb6
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Jan 27 20:37:27 2013 +0100

    aacdec: check channel count
    
    Prevent out of array accesses
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/aacdec.c b/libavcodec/aacdec.c
index 235ea4670c..49e9b60f44 100644
--- a/libavcodec/aacdec.c
+++ b/libavcodec/aacdec.c
@@ -914,6 +914,11 @@ static av_cold int aac_decode_init(AVCodecContext *avctx)
         }
     }
 
+    if (avctx->channels > MAX_CHANNELS) {
+        av_log(avctx, AV_LOG_ERROR, "Too many channels\n");
+        return AVERROR_INVALIDDATA;
+    }
+
     AAC_INIT_VLC_STATIC( 0, 304);
     AAC_INIT_VLC_STATIC( 1, 270);
     AAC_INIT_VLC_STATIC( 2, 550);
