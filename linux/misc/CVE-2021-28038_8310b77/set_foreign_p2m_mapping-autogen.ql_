/**
 * @name linux-8310b77b48c5558c140e7a57a702e7819e62f04e-set_foreign_p2m_mapping
 * @id cpp/linux/8310b77b48c5558c140e7a57a702e7819e62f04e/set-foreign-p2m-mapping
 * @description linux-8310b77b48c5558c140e7a57a702e7819e62f04e-arch/arm/xen/p2m.c-set_foreign_p2m_mapping CVE-2021-28038
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vret_698, UnaryMinusExpr target_0) {
	target_0.getValue()="-12"
	and target_0.getParent().(AssignExpr).getRValue() = target_0
	and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_698
}

/*predicate func_1(Variable vret_698, VariableAccess target_1) {
	target_1.getTarget()=vret_698
	and target_1.getParent().(AssignExpr).getLValue() = target_1
	and target_1.getParent().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-12"
}

*/
predicate func_3(FunctionCall target_22, Function func) {
exists(ContinueStmt target_3 |
	target_3.getParent().(IfStmt).getCondition()=target_22
	and target_3.getEnclosingFunction() = func)
}

predicate func_4(Parameter vmap_ops_694, Variable vi_698, ExprStmt target_23) {
exists(ExprStmt target_4 |
	target_4.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="status"
	and target_4.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_4.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_4.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_23.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getLocation().isBefore(target_4.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getLocation()))
}

predicate func_5(Parameter vmap_ops_694, Variable vi_698) {
exists(ExprStmt target_5 |
	target_5.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="host_addr"
	and target_5.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_5.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_5.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="host_addr"
	and target_5.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_5.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_5.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_5.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_5.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_5.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_5.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_5.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698)
}

predicate func_6(Parameter vmap_ops_694, Variable vi_698) {
exists(ExprStmt target_6 |
	target_6.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_6.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_6.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_6.getExpr().(AssignExpr).getRValue().(ComplementExpr).getValue()="4294967295")
}

predicate func_7(Parameter vmap_ops_694, Variable vi_698) {
exists(IfStmt target_7 |
	target_7.getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
	and target_7.getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_7.getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_7.getCondition().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
	and target_7.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_7.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_7.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_7.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_7.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_7.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_7.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_7.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_7.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_7.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0")
}

predicate func_8(Parameter vkmap_ops_695, Variable vi_698, ExprStmt target_24) {
exists(IfStmt target_8 |
	target_8.getCondition().(VariableAccess).getTarget()=vkmap_ops_695
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="status"
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="host_addr"
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="host_addr"
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_8.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_8.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(ComplementExpr).getValue()="4294967295"
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_8.getThen().(BlockStmt).getStmt(3).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_24.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getLocation().isBefore(target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getLocation()))
}

/*predicate func_9(Parameter vkmap_ops_695, Variable vi_698, LogicalOrExpr target_25, ExprStmt target_24) {
exists(AssignExpr target_9 |
	target_9.getLValue().(ValueFieldAccess).getTarget().getName()="status"
	and target_9.getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_9.getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_9.getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_25.getRightOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_9.getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getLocation())
	and target_24.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getLocation().isBefore(target_9.getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getLocation()))
}

*/
/*predicate func_10(Parameter vkmap_ops_695, Variable vi_698, FunctionCall target_22) {
exists(ExprStmt target_10 |
	target_10.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="host_addr"
	and target_10.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_10.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_10.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="host_addr"
	and target_10.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_10.getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_10.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_10.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_10.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_10.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_10.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_10.getExpr().(CommaExpr).getRightOperand().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_10.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_10
	and target_10.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_22)
}

*/
/*predicate func_11(Parameter vkmap_ops_695, Variable vi_698, FunctionCall target_22) {
exists(ExprStmt target_11 |
	target_11.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="handle"
	and target_11.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_11.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_11.getExpr().(AssignExpr).getRValue().(ComplementExpr).getValue()="4294967295"
	and target_11.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_11
	and target_11.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_22)
}

*/
/*predicate func_12(Parameter vkmap_ops_695, Variable vi_698, FunctionCall target_22) {
exists(IfStmt target_12 |
	target_12.getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
	and target_12.getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_12.getCondition().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_12.getCondition().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
	and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_12.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_12.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_12.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_12.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_12.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_12
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_22)
}

*/
predicate func_13(Function func) {
exists(ExprStmt target_13 |
	target_13.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="status"
	and target_13.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_13.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_13.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_13.getEnclosingFunction() = func)
}

predicate func_14(Function func) {
exists(ExprStmt target_14 |
	target_14.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="status"
	and target_14.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_14.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_14.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_14.getEnclosingFunction() = func)
}

predicate func_15(Parameter vkmap_ops_695) {
exists(ExprStmt target_15 |
	target_15.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_15.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("HYPERVISOR_grant_table_op")
	and target_15.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(Literal).getValue()="1"
	and target_15.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_15.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddExpr).getLeftOperand().(Literal).getValue()="1"
	and target_15.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddExpr).getRightOperand().(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vkmap_ops_695)
}

/*predicate func_16(Parameter vkmap_ops_695, Variable vret_698) {
exists(FunctionCall target_16 |
	target_16.getTarget().hasName("HYPERVISOR_grant_table_op")
	and target_16.getArgument(0).(Literal).getValue()="1"
	and target_16.getArgument(1).(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_16.getArgument(2).(AddExpr).getLeftOperand().(Literal).getValue()="1"
	and target_16.getArgument(2).(AddExpr).getRightOperand().(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vkmap_ops_695
	and target_16.getParent().(AssignExpr).getRValue() = target_16
	and target_16.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_698)
}

*/
predicate func_17(Function func) {
exists(IfStmt target_17 |
	target_17.getCondition().(LogicalOrExpr).getLeftOperand().(LogicalOrExpr).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_17.getCondition().(LogicalOrExpr).getLeftOperand().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="status"
	and target_17.getCondition().(LogicalOrExpr).getLeftOperand().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_17.getCondition().(LogicalOrExpr).getLeftOperand().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_17.getCondition().(LogicalOrExpr).getLeftOperand().(LogicalOrExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_17.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="status"
	and target_17.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("gnttab_unmap_grant_ref[2]")
	and target_17.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_17.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_17.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
	and target_17.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_17.getThen().(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_17.getEnclosingFunction() = func)
}

/*predicate func_18(Function func) {
exists(NotExpr target_18 |
	target_18.getOperand().(VariableAccess).getType().hasName("bool")
	and target_18.getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_18.getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand() instanceof NotExpr
	and target_18.getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_18.getEnclosingFunction() = func)
}

*/
predicate func_19(Variable vmfn_712, Variable vpfn_712, NotExpr target_19) {
	target_19.getOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("set_phys_to_machine")
	and target_19.getOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpfn_712
	and target_19.getOperand().(NotExpr).getOperand().(FunctionCall).getArgument(1).(BitwiseOrExpr).getLeftOperand().(VariableAccess).getTarget()=vmfn_712
	and target_19.getOperand().(NotExpr).getOperand().(FunctionCall).getArgument(1).(BitwiseOrExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="9223372036854775808"
	and target_19.getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_19.getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
}

predicate func_21(FunctionCall target_22, Function func, GotoStmt target_21) {
	target_21.getName() ="out"
	and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_22
	and target_21.getEnclosingFunction() = func
}

predicate func_22(Function func, FunctionCall target_22) {
	target_22.getTarget().hasName("__builtin_expect")
	and target_22.getArgument(0).(NotExpr).getOperand() instanceof NotExpr
	and target_22.getArgument(1) instanceof Literal
	and target_22.getEnclosingFunction() = func
}

predicate func_23(Parameter vmap_ops_694, Variable vi_698, Variable vmfn_712, ExprStmt target_23) {
	target_23.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vmfn_712
	and target_23.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="dev_bus_addr"
	and target_23.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_23.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_23.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="12"
}

predicate func_24(Variable vi_698, Variable vpfn_712, ExprStmt target_24) {
	target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vpfn_712
	and target_24.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget().getType().hasName("page **")
	and target_24.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_24.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget().getType().hasName("unsigned long")
}

predicate func_25(Parameter vmap_ops_694, Parameter vkmap_ops_695, Variable vi_698, LogicalOrExpr target_25) {
	target_25.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="status"
	and target_25.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vmap_ops_694
	and target_25.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_25.getLeftOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_25.getRightOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=vkmap_ops_695
	and target_25.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="status"
	and target_25.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vkmap_ops_695
	and target_25.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vi_698
	and target_25.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
}

from Function func, Parameter vmap_ops_694, Parameter vkmap_ops_695, Variable vi_698, Variable vret_698, Variable vmfn_712, Variable vpfn_712, UnaryMinusExpr target_0, NotExpr target_19, GotoStmt target_21, FunctionCall target_22, ExprStmt target_23, ExprStmt target_24, LogicalOrExpr target_25
where
func_0(vret_698, target_0)
and not func_3(target_22, func)
and not func_4(vmap_ops_694, vi_698, target_23)
and not func_5(vmap_ops_694, vi_698)
and not func_6(vmap_ops_694, vi_698)
and not func_7(vmap_ops_694, vi_698)
and not func_8(vkmap_ops_695, vi_698, target_24)
and not func_13(func)
and not func_14(func)
and not func_15(vkmap_ops_695)
and not func_17(func)
and func_19(vmfn_712, vpfn_712, target_19)
and func_21(target_22, func, target_21)
and func_22(func, target_22)
and func_23(vmap_ops_694, vi_698, vmfn_712, target_23)
and func_24(vi_698, vpfn_712, target_24)
and func_25(vmap_ops_694, vkmap_ops_695, vi_698, target_25)
and vmap_ops_694.getType().hasName("gnttab_map_grant_ref *")
and vkmap_ops_695.getType().hasName("gnttab_map_grant_ref *")
and vi_698.getType().hasName("int")
and vret_698.getType().hasName("int")
and vmfn_712.getType().hasName("unsigned long")
and vpfn_712.getType().hasName("unsigned long")
and vmap_ops_694.getFunction() = func
and vkmap_ops_695.getFunction() = func
and vi_698.(LocalVariable).getFunction() = func
and vret_698.(LocalVariable).getFunction() = func
and vmfn_712.(LocalVariable).getFunction() = func
and vpfn_712.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
