/**
 * @name linux-ed09f81eeaa8f9265e1787282cb283f10285c259-qsee_uefi_query_variable_info
 * @id cpp/linux/ed09f81eeaa8f9265e1787282cb283f10285c259/qsee-uefi-query-variable-info
 * @description linux-ed09f81eeaa8f9265e1787282cb283f10285c259-drivers/firmware/qcom/qcom_qseecom_uefisecapp.c-qsee_uefi_query_variable_info CVE-2024-35994
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(Variable v__UNIQUE_ID_ddebug1016_698, VariableAccess target_1) {
	target_1.getTarget()=v__UNIQUE_ID_ddebug1016_698
	and target_1.getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(AddressOfExpr).getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
}

predicate func_2(Variable v__UNIQUE_ID_ddebug1016_698, VariableAccess target_2) {
	target_2.getTarget()=v__UNIQUE_ID_ddebug1016_698
	and target_2.getParent().(ValueFieldAccess).getParent().(ValueFieldAccess).getParent().(AddressOfExpr).getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
}

predicate func_3(Variable vrsp_data_660, Variable v__UNIQUE_ID_ddebug1016_698, Parameter vqcuefi_655, VariableAccess target_3) {
	target_3.getTarget()=v__UNIQUE_ID_ddebug1016_698
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__dynamic_dev_dbg")
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(FunctionCall).getTarget().hasName("qcuefi_dev")
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vqcuefi_655
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="%s: uefisecapp error: 0x%x\n"
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget().getType() instanceof ArrayType
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="status"
	and target_3.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrsp_data_660
}

predicate func_4(Variable vreq_data_659, FunctionCall target_4) {
	target_4.getTarget().hasName("kzalloc")
	and not target_4.getTarget().hasName("qseecom_dma_alloc")
	and target_4.getArgument(0) instanceof SizeofExprOperator
	and target_4.getArgument(1).(BitwiseOrExpr).getValue()="3264"
	and target_4.getParent().(AssignExpr).getRValue() = target_4
	and target_4.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreq_data_659
}

predicate func_5(Function func, Literal target_5) {
	target_5.getValue()="9"
	and not target_5.getValue()="0"
	and target_5.getParent().(BitwiseOrExpr).getParent().(AssignExpr).getRValue() instanceof BitwiseOrExpr
	and target_5.getEnclosingFunction() = func
}

predicate func_6(Variable vrsp_data_660, FunctionCall target_6) {
	target_6.getTarget().hasName("kfree")
	and not target_6.getTarget().hasName("qseecom_dma_free")
	and target_6.getArgument(0).(VariableAccess).getTarget()=vrsp_data_660
}

predicate func_7(Function func) {
exists(AssignExpr target_7 |
	target_7.getLValue().(VariableAccess).getType().hasName("size_t")
	and target_7.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(VariableAccess).getType().hasName("size_t")
	and target_7.getEnclosingFunction() = func)
}

/*predicate func_8(Function func) {
exists(StmtExpr target_8 |
	target_8.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
	and target_8.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("size_t")
	and target_8.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446744073709551608"
	and target_8.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
	and target_8.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("size_t")
	and target_8.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(MulExpr).getValue()="12"
	and target_8.getStmt().(BlockStmt).getStmt(4).(IfStmt).getCondition().(VariableAccess).getType().hasName("size_t *")
	and target_8.getStmt().(BlockStmt).getStmt(4).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("size_t *")
	and target_8.getStmt().(BlockStmt).getStmt(4).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("size_t")
	and target_8.getEnclosingFunction() = func)
}

*/
/*predicate func_9(Function func) {
exists(AssignExpr target_9 |
	target_9.getLValue().(VariableAccess).getType().hasName("size_t")
	and target_9.getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("size_t")
	and target_9.getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getValue()="7"
	and target_9.getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446744073709551608"
	and target_9.getEnclosingFunction() = func)
}

*/
/*predicate func_10(Function func) {
exists(AssignExpr target_10 |
	target_10.getLValue().(VariableAccess).getType().hasName("size_t")
	and target_10.getRValue().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("size_t")
	and target_10.getRValue().(AddExpr).getRightOperand().(MulExpr).getValue()="12"
	and target_10.getEnclosingFunction() = func)
}

*/
/*predicate func_12(Function func) {
exists(AssignExpr target_12 |
	target_12.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("size_t *")
	and target_12.getRValue().(VariableAccess).getType().hasName("size_t")
	and target_12.getEnclosingFunction() = func)
}

*/
/*predicate func_13(NotExpr target_39, Function func) {
exists(ExprStmt target_13 |
	target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("size_t")
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(IfStmt).getCondition().(VariableAccess).getType().hasName("size_t *")
	and target_13.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("size_t")
	and target_13.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_13
	and target_13.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_39
	and target_13.getEnclosingFunction() = func)
}

*/
/*predicate func_15(NotExpr target_39, Function func) {
exists(ExprStmt target_15 |
	target_15.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("size_t *")
	and target_15.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("size_t")
	and target_15.getParent().(IfStmt).getCondition()=target_39
	and target_15.getEnclosingFunction() = func)
}

*/
/*predicate func_16(NotExpr target_39, Function func) {
exists(ExprStmt target_16 |
	target_16.getExpr().(VariableAccess).getType().hasName("size_t")
	and target_16.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_16
	and target_16.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_39
	and target_16.getEnclosingFunction() = func)
}

*/
predicate func_17(Parameter vqcuefi_655, IfStmt target_45, ExprStmt target_46, Function func) {
exists(ExprStmt target_17 |
	target_17.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("void *")
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("qseecom_dma_alloc")
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("size_t")
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("dma_addr_t")
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BitwiseOrExpr).getValue()="3264"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_17
	and target_17.getLocation().isBefore(target_45.getLocation())
	and target_17.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_18(Parameter vqcuefi_655, ExprStmt target_46) {
exists(PointerFieldAccess target_18 |
	target_18.getTarget().getName()="client"
	and target_18.getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_18.getQualifier().(VariableAccess).getLocation().isBefore(target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_20(Function func) {
exists(AddressOfExpr target_20 |
	target_20.getOperand().(VariableAccess).getType().hasName("dma_addr_t")
	and target_20.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_20.getEnclosingFunction() = func)
}

*/
predicate func_21(Variable vefi_status_661, IfStmt target_45, Function func) {
exists(IfStmt target_21 |
	target_21.getCondition().(NotExpr).getOperand().(VariableAccess).getType().hasName("void *")
	and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vefi_status_661
	and target_21.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="9223372036854775817"
	and target_21.getThen().(BlockStmt).getStmt(1).(GotoStmt).getName() ="out"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
	and target_21.getLocation().isBefore(target_45.getLocation()))
}

predicate func_23(Variable vreq_data_659, IfStmt target_45, Function func) {
exists(ExprStmt target_23 |
	target_23.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreq_data_659
	and target_23.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_23.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getType().hasName("size_t")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
	and target_23.getLocation().isBefore(target_45.getLocation()))
}

/*predicate func_24(Variable vreq_data_659) {
exists(PointerArithmeticOperation target_24 |
	target_24.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_24.getRightOperand().(VariableAccess).getType().hasName("size_t")
	and target_24.getParent().(AssignExpr).getRValue() = target_24
	and target_24.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreq_data_659)
}

*/
predicate func_25(Variable vrsp_data_660, IfStmt target_45, Function func) {
exists(ExprStmt target_25 |
	target_25.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vrsp_data_660
	and target_25.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_25.getExpr().(AssignExpr).getRValue().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getType().hasName("size_t")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
	and target_25.getLocation().isBefore(target_45.getLocation()))
}

/*predicate func_26(Variable vrsp_data_660) {
exists(PointerArithmeticOperation target_26 |
	target_26.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_26.getRightOperand().(VariableAccess).getType().hasName("size_t")
	and target_26.getParent().(AssignExpr).getRValue() = target_26
	and target_26.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vrsp_data_660)
}

*/
predicate func_27(Variable vreq_data_659, Variable vrsp_data_660, Parameter vqcuefi_655) {
exists(AddExpr target_27 |
	target_27.getLeftOperand().(VariableAccess).getType().hasName("dma_addr_t")
	and target_27.getRightOperand().(VariableAccess).getType().hasName("size_t")
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("qcom_qseecom_app_send")
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vreq_data_659
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="12"
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrsp_data_660
	and target_27.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(SizeofExprOperator).getValue()="40")
}

predicate func_28(Variable vreq_data_659, Variable vrsp_data_660, Parameter vqcuefi_655) {
exists(AddExpr target_28 |
	target_28.getLeftOperand().(VariableAccess).getType().hasName("dma_addr_t")
	and target_28.getRightOperand().(VariableAccess).getType().hasName("size_t")
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("qcom_qseecom_app_send")
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vreq_data_659
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="12"
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrsp_data_660
	and target_28.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(SizeofExprOperator).getValue()="40")
}

predicate func_29(Parameter vqcuefi_655, IfStmt target_50, FunctionCall target_51, Function func) {
exists(ExprStmt target_29 |
	target_29.getExpr().(FunctionCall).getTarget().hasName("qseecom_dma_free")
	and target_29.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_29.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_29.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("size_t")
	and target_29.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("void *")
	and target_29.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getType().hasName("dma_addr_t")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
	and target_29.getLocation().isBefore(target_50.getLocation())
	and target_51.getArgument(0).(VariableAccess).getLocation().isBefore(target_29.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_30(Parameter vqcuefi_655, FunctionCall target_51) {
exists(PointerFieldAccess target_30 |
	target_30.getTarget().getName()="client"
	and target_30.getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_51.getArgument(0).(VariableAccess).getLocation().isBefore(target_30.getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_34(Function func, SubExpr target_34) {
	target_34.getValue()="63"
	and target_34.getEnclosingFunction() = func
}

predicate func_35(Function func, SizeofExprOperator target_35) {
	target_35.getValue()="12"
	and target_35.getEnclosingFunction() = func
}

predicate func_36(Function func, SizeofExprOperator target_36) {
	target_36.getValue()="40"
	and target_36.getEnclosingFunction() = func
}

predicate func_37(Variable vreq_data_659, BlockStmt target_52, SizeofExprOperator target_35, ExprStmt target_53, VariableAccess target_37) {
	target_37.getTarget()=vreq_data_659
	and target_37.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_52
	and target_37.getLocation().isBefore(target_53.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_38(Variable vrsp_data_660, FunctionCall target_38) {
	target_38.getTarget().hasName("kzalloc")
	and target_38.getArgument(0) instanceof SizeofExprOperator
	and target_38.getArgument(1).(BitwiseOrExpr).getValue()="3264"
	and target_38.getParent().(AssignExpr).getRValue() = target_38
	and target_38.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vrsp_data_660
}

predicate func_39(Variable vrsp_data_660, BlockStmt target_54, NotExpr target_39) {
	target_39.getOperand().(VariableAccess).getTarget()=vrsp_data_660
	and target_39.getParent().(IfStmt).getThen()=target_54
}

predicate func_40(Variable vefi_status_661, ExprStmt target_55, AssignExpr target_40) {
	target_40.getLValue().(VariableAccess).getTarget()=vefi_status_661
	and target_40.getRValue().(BitwiseOrExpr).getValue()="9223372036854775817"
	and target_55.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_40.getLValue().(VariableAccess).getLocation())
}

predicate func_41(NotExpr target_39, Function func, GotoStmt target_41) {
	target_41.getName() ="out_free_req"
	and target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_39
	and target_41.getEnclosingFunction() = func
}

predicate func_42(Variable vreq_data_659, Variable vrsp_data_660, Parameter vqcuefi_655, ExprStmt target_56, NotExpr target_39, FunctionCall target_51, VariableAccess target_42) {
	target_42.getTarget()=vreq_data_659
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("qcom_qseecom_app_send")
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="12"
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrsp_data_660
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(SizeofExprOperator).getValue()="40"
	and target_56.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_42.getLocation())
	and target_39.getOperand().(VariableAccess).getLocation().isBefore(target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
	and target_42.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_51.getArgument(0).(VariableAccess).getLocation())
}

/*predicate func_43(Variable vreq_data_659, Variable vrsp_data_660, Parameter vqcuefi_655, ExprStmt target_56, NotExpr target_39, FunctionCall target_51, VariableAccess target_43) {
	target_43.getTarget()=vrsp_data_660
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("qcom_qseecom_app_send")
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vreq_data_659
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="12"
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(SizeofExprOperator).getValue()="40"
	and target_56.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
	and target_39.getOperand().(VariableAccess).getLocation().isBefore(target_43.getLocation())
	and target_43.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_51.getArgument(0).(VariableAccess).getLocation())
}

*/
predicate func_44(Variable vreq_data_659, FunctionCall target_44) {
	target_44.getTarget().hasName("kfree")
	and target_44.getArgument(0).(VariableAccess).getTarget()=vreq_data_659
}

predicate func_45(Variable vreq_data_659, Variable vefi_status_661, IfStmt target_45) {
	target_45.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vreq_data_659
	and target_45.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vefi_status_661
	and target_45.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="9223372036854775817"
	and target_45.getThen().(BlockStmt).getStmt(1).(GotoStmt).getName() ="out"
}

predicate func_46(Variable vreq_data_659, Variable vrsp_data_660, Parameter vqcuefi_655, ExprStmt target_46) {
	target_46.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("qcom_qseecom_app_send")
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="client"
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vqcuefi_655
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vreq_data_659
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="12"
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrsp_data_660
	and target_46.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(SizeofExprOperator).getValue()="40"
}

predicate func_50(Variable vrsp_data_660, IfStmt target_50) {
	target_50.getCondition().(VariableAccess).getTarget().getType().hasName("u64 *")
	and target_50.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget().getType().hasName("u64 *")
	and target_50.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="remaining_space"
	and target_50.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrsp_data_660
}

predicate func_51(Parameter vqcuefi_655, FunctionCall target_51) {
	target_51.getTarget().hasName("qcuefi_dev")
	and target_51.getArgument(0).(VariableAccess).getTarget()=vqcuefi_655
}

predicate func_52(Variable vefi_status_661, BlockStmt target_52) {
	target_52.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vefi_status_661
	and target_52.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="9223372036854775817"
	and target_52.getStmt(1).(GotoStmt).getName() ="out"
}

predicate func_53(Variable vreq_data_659, ExprStmt target_53) {
	target_53.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="command_id"
	and target_53.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_data_659
	and target_53.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="32771"
}

predicate func_54(Function func, BlockStmt target_54) {
	target_54.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
	and target_54.getStmt(1) instanceof GotoStmt
	and target_54.getEnclosingFunction() = func
}

predicate func_55(Variable vefi_status_661, ExprStmt target_55) {
	target_55.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vefi_status_661
	and target_55.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="9223372036854775817"
}

predicate func_56(Variable vreq_data_659, ExprStmt target_56) {
	target_56.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="length"
	and target_56.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_data_659
	and target_56.getExpr().(AssignExpr).getRValue().(SizeofExprOperator).getValue()="12"
}

from Function func, Variable vreq_data_659, Variable vrsp_data_660, Variable vefi_status_661, Variable v__UNIQUE_ID_ddebug1016_698, Parameter vqcuefi_655, VariableAccess target_1, VariableAccess target_2, VariableAccess target_3, FunctionCall target_4, Literal target_5, FunctionCall target_6, SubExpr target_34, SizeofExprOperator target_35, SizeofExprOperator target_36, VariableAccess target_37, FunctionCall target_38, NotExpr target_39, AssignExpr target_40, GotoStmt target_41, VariableAccess target_42, FunctionCall target_44, IfStmt target_45, ExprStmt target_46, IfStmt target_50, FunctionCall target_51, BlockStmt target_52, ExprStmt target_53, BlockStmt target_54, ExprStmt target_55, ExprStmt target_56
where
func_1(v__UNIQUE_ID_ddebug1016_698, target_1)
and func_2(v__UNIQUE_ID_ddebug1016_698, target_2)
and func_3(vrsp_data_660, v__UNIQUE_ID_ddebug1016_698, vqcuefi_655, target_3)
and func_4(vreq_data_659, target_4)
and func_5(func, target_5)
and func_6(vrsp_data_660, target_6)
and not func_7(func)
and not func_17(vqcuefi_655, target_45, target_46, func)
and not func_21(vefi_status_661, target_45, func)
and not func_23(vreq_data_659, target_45, func)
and not func_25(vrsp_data_660, target_45, func)
and not func_27(vreq_data_659, vrsp_data_660, vqcuefi_655)
and not func_28(vreq_data_659, vrsp_data_660, vqcuefi_655)
and not func_29(vqcuefi_655, target_50, target_51, func)
and func_34(func, target_34)
and func_35(func, target_35)
and func_36(func, target_36)
and func_37(vreq_data_659, target_52, target_35, target_53, target_37)
and func_38(vrsp_data_660, target_38)
and func_39(vrsp_data_660, target_54, target_39)
and func_40(vefi_status_661, target_55, target_40)
and func_41(target_39, func, target_41)
and func_42(vreq_data_659, vrsp_data_660, vqcuefi_655, target_56, target_39, target_51, target_42)
and func_44(vreq_data_659, target_44)
and func_45(vreq_data_659, vefi_status_661, target_45)
and func_46(vreq_data_659, vrsp_data_660, vqcuefi_655, target_46)
and func_50(vrsp_data_660, target_50)
and func_51(vqcuefi_655, target_51)
and func_52(vefi_status_661, target_52)
and func_53(vreq_data_659, target_53)
and func_54(func, target_54)
and func_55(vefi_status_661, target_55)
and func_56(vreq_data_659, target_56)
and vreq_data_659.getType().hasName("qsee_req_uefi_query_variable_info *")
and vrsp_data_660.getType().hasName("qsee_rsp_uefi_query_variable_info *")
and vefi_status_661.getType().hasName("efi_status_t")
and v__UNIQUE_ID_ddebug1016_698.getType().hasName("_ddebug")
and vqcuefi_655.getType().hasName("qcuefi_client *")
and vreq_data_659.(LocalVariable).getFunction() = func
and vrsp_data_660.(LocalVariable).getFunction() = func
and vefi_status_661.(LocalVariable).getFunction() = func
and v__UNIQUE_ID_ddebug1016_698.(LocalVariable).getFunction() = func
and vqcuefi_655.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
