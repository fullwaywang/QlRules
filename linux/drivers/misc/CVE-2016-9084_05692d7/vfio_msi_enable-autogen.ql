/**
 * @name linux-05692d7005a364add85c6e25a6c4447ce08f913a-vfio_msi_enable
 * @id cpp/linux/05692d7005a364add85c6e25a6c4447ce08f913a/vfio-msi-enable
 * @description linux-05692d7005a364add85c6e25a6c4447ce08f913a-drivers/vfio/pci/vfio_pci_intrs.c-vfio_msi_enable CVE-2016-9083
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vvdev_1_0, PointerFieldAccess target_0) {
	target_0.getTarget().getName()="irq_type"
	and target_0.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_1(Variable vvdev_1_0, PointerFieldAccess target_1) {
	target_1.getTarget().getName()="irq_type"
	and target_1.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_2(Parameter vmsix_250, Initializer target_2) {
	target_2.getExpr().(ConditionalExpr).getCondition().(VariableAccess).getTarget()=vmsix_250
	and target_2.getExpr().(ConditionalExpr).getThen() instanceof BinaryBitwiseOperation
	and target_2.getExpr().(ConditionalExpr).getElse() instanceof BinaryBitwiseOperation
}

/*predicate func_3(Parameter vmsix_250, VariableAccess target_3) {
	target_3.getTarget()=vmsix_250
	and vmsix_250.getIndex() = 2
}

*/
predicate func_5(Variable vvdev_1_0, PointerFieldAccess target_5) {
	target_5.getTarget().getName()="irq_type"
	and target_5.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_6(Parameter vnvec_250, Variable vvdev_1_0, FunctionCall target_6) {
	target_6.getTarget().hasName("kzalloc")
	and not target_6.getTarget().hasName("pci_map_rom")
	and target_6.getArgument(0).(MulExpr).getLeftOperand().(VariableAccess).getTarget()=vnvec_250
	and target_6.getArgument(0).(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_6.getArgument(0).(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="104"
	and target_6.getArgument(1) instanceof BitwiseOrExpr
	and target_6.getParent().(AssignExpr).getRValue() = target_6
	and target_6.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ctx"
	and target_6.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

/*predicate func_7(Parameter vnvec_250, VariableAccess target_7) {
	target_7.getTarget()=vnvec_250
	and vnvec_250.getIndex() = 1
	and target_7.getParent().(MulExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("kzalloc")
	and target_7.getParent().(MulExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(MulExpr).getRightOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_7.getParent().(MulExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(MulExpr).getRightOperand().(SizeofTypeOperator).getValue()="104"
	and target_7.getParent().(MulExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof BitwiseOrExpr
}

*/
/*predicate func_8(Function func, SizeofTypeOperator target_8) {
	target_8.getType() instanceof LongType
	and target_8.getValue()="104"
	and target_8.getEnclosingFunction() = func
}

*/
predicate func_9(Parameter vnvec_250, Variable vpdev_252, Variable vflag_253, Variable vret_254, FunctionCall target_9) {
	target_9.getTarget().hasName("pci_alloc_irq_vectors")
	and not target_9.getTarget().hasName("msix_sparse_mmap_cap")
	and target_9.getArgument(0).(VariableAccess).getTarget()=vpdev_252
	and target_9.getArgument(1) instanceof Literal
	and target_9.getArgument(2).(VariableAccess).getTarget()=vnvec_250
	and target_9.getArgument(3).(VariableAccess).getTarget()=vflag_253
	and target_9.getParent().(AssignExpr).getRValue() = target_9
	and target_9.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_254
}

predicate func_10(Parameter vnvec_250, Variable vret_254, BlockStmt target_120, VariableAccess target_10) {
	target_10.getTarget()=vnvec_250
	and vnvec_250.getIndex() = 1
	and target_10.getParent().(LTExpr).getLesserOperand().(VariableAccess).getTarget()=vret_254
	and target_10.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_120
}

predicate func_11(Variable vpdev_252, FunctionCall target_11) {
	target_11.getTarget().hasName("pci_free_irq_vectors")
	and not target_11.getTarget().hasName("pci_unmap_rom")
	and target_11.getArgument(0).(VariableAccess).getTarget()=vpdev_252
}

predicate func_12(Parameter vnvec_250, Variable vvdev_1_0, VariableAccess target_12) {
	target_12.getTarget()=vnvec_250
	and vnvec_250.getIndex() = 1
	and target_12.getParent().(AssignExpr).getRValue() = target_12
	and target_12.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="num_ctx"
	and target_12.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_13(Parameter vmsix_250, VariableAccess target_13) {
	target_13.getTarget()=vmsix_250
	and vmsix_250.getIndex() = 2
}

predicate func_16(Parameter vmsix_250, BlockStmt target_121, VariableAccess target_16) {
	target_16.getTarget()=vmsix_250
	and vmsix_250.getIndex() = 2
	and target_16.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_121
}

/*predicate func_17(Function func, FunctionCall target_17) {
	target_17.getTarget().hasName("fls")
	and not target_17.getTarget().hasName("region_type_cap")
	and target_17.getArgument(0).(SubExpr).getLeftOperand() instanceof MulExpr
	and target_17.getArgument(0).(SubExpr).getRightOperand() instanceof Literal
	and target_17.getEnclosingFunction() = func
}

*/
predicate func_18(Parameter vnvec_250, VariableAccess target_18) {
	target_18.getTarget()=vnvec_250
	and vnvec_250.getIndex() = 1
	and target_18.getParent().(MulExpr).getParent().(SubExpr).getParent().(FunctionCall).getParent().(SubExpr).getLeftOperand().(FunctionCall).getTarget().hasName("fls")
	and target_18.getParent().(MulExpr).getParent().(SubExpr).getParent().(FunctionCall).getParent().(SubExpr).getLeftOperand().(FunctionCall).getArgument(0).(SubExpr).getLeftOperand() instanceof MulExpr
	and target_18.getParent().(MulExpr).getParent().(SubExpr).getParent().(FunctionCall).getParent().(SubExpr).getLeftOperand().(FunctionCall).getArgument(0).(SubExpr).getRightOperand() instanceof Literal
}

predicate func_21(Variable vret_254, ReturnStmt target_93, Function func) {
exists(IfStmt target_21 |
	target_21.getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_21.getCondition().(EqualityOperation).getRightOperand().(BitwiseOrExpr).getValue()="15211"
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned long")
	and target_21.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getValue()="16"
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("copy_from_user")
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_21.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getTarget().getName()="argsz"
	and target_21.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_21.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_21.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_21.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof BinaryBitwiseOperation
	and target_21.getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="reset_works"
	and target_21.getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_21.getThen().(BlockStmt).getStmt(5).(IfStmt).getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_21.getThen().(BlockStmt).getStmt(5).(IfStmt).getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(5).(IfStmt).getThen().(ExprStmt).getExpr().(AssignOrExpr).getRValue().(BinaryBitwiseOperation).getValue()="1"
	and target_21.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="num_regions"
	and target_21.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="num_regions"
	and target_21.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_21.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="num_irqs"
	and target_21.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(8).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_21.getThen().(BlockStmt).getStmt(8).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getThen().(BlockStmt).getStmt(8).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_device_info")
	and target_21.getThen().(BlockStmt).getStmt(8).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getThen().(BlockStmt).getStmt(8).(ReturnStmt).getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getValue()="-14"
	and target_21.getThen().(BlockStmt).getStmt(8).(ReturnStmt).getExpr().(ConditionalExpr).getElse().(Literal).getValue()="0"
	and target_21.getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_21.getElse().(IfStmt).getCondition().(EqualityOperation).getRightOperand().(BitwiseOrExpr).getValue()="15212"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getValue()="32"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("copy_from_user")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_region_info")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(5).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(6).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getTarget().getName()="argsz"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(6).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(6).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(6).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(SwitchStmt).getExpr().(ValueFieldAccess).getTarget().getName()="index"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(SwitchStmt).getExpr().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(SwitchStmt).getStmt().(BlockStmt).getStmt(20).(SwitchCase).toString() = "default: "
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(SwitchStmt).getStmt().(BlockStmt).getStmt(27).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_254
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(9).(IfStmt).getCondition().(ValueFieldAccess).getTarget().getName()="size"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(9).(IfStmt).getCondition().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("kfree")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getValue()="-14"
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(ConditionalExpr).getElse().(Literal).getValue()="0"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getRightOperand().(BitwiseOrExpr).getValue()="15213"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("copy_from_user")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(4).(SwitchStmt).getExpr().(ValueFieldAccess).getTarget().getName()="index"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(4).(SwitchStmt).getExpr().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_info")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(4).(SwitchStmt).getStmt().(BlockStmt).getStmt(5).(SwitchCase).toString() = "default: "
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="count"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vfio_pci_get_irq_count")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(8).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(8).(IfStmt).getCondition().(EqualityOperation).getRightOperand() instanceof EnumConstantAccess
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(9).(ReturnStmt).getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(9).(ReturnStmt).getExpr().(ConditionalExpr).getElse().(Literal).getValue()="0"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getRightOperand().(BitwiseOrExpr).getValue()="15214"
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("copy_from_user")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(11).(IfStmt).getCondition().(VariableAccess).getType().hasName("size_t")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("mutex_lock_nested")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(14).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("mutex_unlock")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(15).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("kfree")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getThen().(BlockStmt).getStmt(16).(ReturnStmt).getExpr().(VariableAccess).getType().hasName("int")
	and target_21.getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("unsigned int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
	and target_21.getFollowingStmt() instanceof DeclStmt
	and target_21.getElse().(IfStmt).getThen().(BlockStmt).getStmt(7).(SwitchStmt).getStmt().(BlockStmt).getStmt(27).(IfStmt).getCondition().(VariableAccess).getLocation().isBefore(target_93.getExpr().(VariableAccess).getLocation()))
}

/*predicate func_22(Function func) {
exists(AssignExpr target_22 |
	target_22.getLValue().(VariableAccess).getType().hasName("unsigned long")
	and target_22.getRValue().(AddExpr).getValue()="16"
	and target_22.getEnclosingFunction() = func)
}

*/
/*predicate func_23(RelationalOperation target_122, Function func) {
exists(IfStmt target_23 |
	target_23.getCondition().(FunctionCall).getTarget().hasName("copy_from_user")
	and target_23.getCondition().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_device_info")
	and target_23.getCondition().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("unsigned long")
	and target_23.getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_23.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_23
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_122
	and target_23.getEnclosingFunction() = func)
}

*/
/*predicate func_24(Function func) {
exists(UnaryMinusExpr target_24 |
	target_24.getValue()="-14"
	and target_24.getEnclosingFunction() = func)
}

*/
/*predicate func_25(Function func) {
exists(ValueFieldAccess target_25 |
	target_25.getTarget().getName()="argsz"
	and target_25.getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_25.getEnclosingFunction() = func)
}

*/
/*predicate func_27(Function func) {
exists(AssignExpr target_27 |
	target_27.getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_27.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_27.getRValue() instanceof BinaryBitwiseOperation
	and target_27.getEnclosingFunction() = func)
}

*/
/*predicate func_28(Function func) {
exists(PointerFieldAccess target_28 |
	target_28.getTarget().getName()="reset_works"
	and target_28.getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_28.getEnclosingFunction() = func)
}

*/
/*predicate func_29(Function func) {
exists(AssignOrExpr target_29 |
	target_29.getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_29.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_29.getRValue().(BinaryBitwiseOperation).getValue()="1"
	and target_29.getEnclosingFunction() = func)
}

*/
/*predicate func_30(Function func) {
exists(AssignExpr target_30 |
	target_30.getLValue().(ValueFieldAccess).getTarget().getName()="num_regions"
	and target_30.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_30.getRValue().(AddExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="num_regions"
	and target_30.getRValue().(AddExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_30.getEnclosingFunction() = func)
}

*/
/*predicate func_31(RelationalOperation target_122, Function func) {
exists(ExprStmt target_31 |
	target_31.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="num_irqs"
	and target_31.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_device_info")
	and target_31.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(7)=target_31
	and target_31.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_122
	and target_31.getEnclosingFunction() = func)
}

*/
/*predicate func_32(RelationalOperation target_122, Function func) {
exists(ReturnStmt target_32 |
	target_32.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_32.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("unsigned long")
	and target_32.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_device_info")
	and target_32.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_32.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getValue()="-14"
	and target_32.getExpr().(ConditionalExpr).getElse().(Literal).getValue()="0"
	and target_32.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(8)=target_32
	and target_32.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_122
	and target_32.getEnclosingFunction() = func)
}

*/
/*predicate func_33(Function func) {
exists(FunctionCall target_33 |
	target_33.getTarget().hasName("copy_to_user")
	and target_33.getArgument(0).(VariableAccess).getType().hasName("unsigned long")
	and target_33.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_device_info")
	and target_33.getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_33.getEnclosingFunction() = func)
}

*/
/*predicate func_34(Function func) {
exists(UnaryMinusExpr target_34 |
	target_34.getValue()="-14"
	and target_34.getEnclosingFunction() = func)
}

*/
/*predicate func_37(NotExpr target_123, Function func) {
exists(ExprStmt target_37 |
	target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned long")
	and target_37.getExpr().(AssignExpr).getRValue().(AddExpr).getValue()="32"
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(4)=target_37
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_37.getEnclosingFunction() = func)
}

*/
/*predicate func_38(NotExpr target_123, Function func) {
exists(IfStmt target_38 |
	target_38.getCondition().(FunctionCall).getTarget().hasName("copy_from_user")
	and target_38.getCondition().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_region_info")
	and target_38.getCondition().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("unsigned long")
	and target_38.getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_38.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_38.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(5)=target_38
	and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_38.getEnclosingFunction() = func)
}

*/
/*predicate func_39(NotExpr target_123, Function func) {
exists(IfStmt target_39 |
	target_39.getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getTarget().getName()="argsz"
	and target_39.getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_39.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_39.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(6)=target_39
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_39.getEnclosingFunction() = func)
}

*/
/*predicate func_40(Variable vpdev_252, Variable vret_254, NotExpr target_123, ReturnStmt target_93) {
exists(SwitchStmt target_40 |
	target_40.getExpr().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getExpr().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="offset"
	and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="40"
	and target_40.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="cfg_size"
	and target_40.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_40.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="3"
	and target_40.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="offset"
	and target_40.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="40"
	and target_40.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getThen().(Literal).getValue()="0"
	and target_40.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getElse().(AddExpr).getRightOperand() instanceof Literal
	and target_40.getStmt().(BlockStmt).getStmt(8).(IfStmt).getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(8).(IfStmt).getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(8).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(8).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_40.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="3"
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="bar_mmap_supported"
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getRValue() instanceof BinaryBitwiseOperation
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(EqualityOperation).getRightOperand().(PointerFieldAccess).getTarget().getName()="msix_bar"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="offset"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="40"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(ConditionalExpr).getThen().(Literal).getValue()="0"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(5).(IfStmt).getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(5).(IfStmt).getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("void *")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("pci_map_rom")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpdev_252
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(7).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("void *")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(7).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("size_t")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("pci_unmap_rom")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vpdev_252
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(8).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getType().hasName("void *")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(13).(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getValue()="1"
	and target_40.getStmt().(BlockStmt).getStmt(15).(IfStmt).getCondition().(NotExpr).getOperand().(PointerFieldAccess).getTarget().getName()="has_vga"
	and target_40.getStmt().(BlockStmt).getStmt(15).(IfStmt).getCondition().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_40.getStmt().(BlockStmt).getStmt(15).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_40.getStmt().(BlockStmt).getStmt(16).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="offset"
	and target_40.getStmt().(BlockStmt).getStmt(16).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(16).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(16).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(16).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="40"
	and target_40.getStmt().(BlockStmt).getStmt(17).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(17).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(17).(ExprStmt).getExpr().(AssignExpr).getRValue().(HexLiteral).getValue()="786432"
	and target_40.getStmt().(BlockStmt).getStmt(18).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(18).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(18).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="3"
	and target_40.getStmt().(BlockStmt).getStmt(20).(SwitchCase).toString() = "default: "
	and target_40.getStmt().(BlockStmt).getStmt(21).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(21).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(21).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(AddExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="num_regions"
	and target_40.getStmt().(BlockStmt).getStmt(21).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(AddExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_40.getStmt().(BlockStmt).getStmt(21).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_40.getStmt().(BlockStmt).getStmt(22).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_40.getStmt().(BlockStmt).getStmt(22).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(22).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="offset"
	and target_40.getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_40.getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="40"
	and target_40.getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_40.getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="region"
	and target_40.getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_40.getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_40.getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_40.getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="region"
	and target_40.getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_254
	and target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("region_type_cap")
	and target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="type"
	and target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getTarget().getName()="subtype"
	and target_40.getStmt().(BlockStmt).getStmt(27).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_254
	and target_40.getStmt().(BlockStmt).getStmt(27).(IfStmt).getThen().(ReturnStmt).getExpr().(VariableAccess).getType().hasName("int")
	and target_40.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(7)=target_40
	and target_40.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_93.getExpr().(VariableAccess).getLocation().isBefore(target_40.getStmt().(BlockStmt).getStmt(26).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation()))
}

*/
/*predicate func_42(Variable vpdev_252, DeclStmt target_89) {
exists(ValueFieldAccess target_42 |
	target_42.getTarget().getName()="start"
	and target_42.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="resource"
	and target_42.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_42.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_42.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info"))
}

*/
/*predicate func_44(Variable vpdev_252) {
exists(ValueFieldAccess target_44 |
	target_44.getTarget().getName()="end"
	and target_44.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="resource"
	and target_44.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_44.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_44.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info"))
}

*/
/*predicate func_45(Variable vpdev_252) {
exists(ValueFieldAccess target_45 |
	target_45.getTarget().getName()="start"
	and target_45.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="resource"
	and target_45.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_45.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_45.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info"))
}

*/
/*predicate func_46(Function func) {
exists(ValueFieldAccess target_46 |
	target_46.getTarget().getName()="size"
	and target_46.getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_46.getEnclosingFunction() = func)
}

*/
/*predicate func_47(Function func) {
exists(AssignExpr target_47 |
	target_47.getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_47.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_47.getRValue().(Literal).getValue()="0"
	and target_47.getEnclosingFunction() = func)
}

*/
/*predicate func_48(Function func) {
exists(AssignExpr target_48 |
	target_48.getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_48.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_48.getRValue().(BitwiseOrExpr).getValue()="3"
	and target_48.getEnclosingFunction() = func)
}

*/
/*predicate func_49(BlockStmt target_121, Function func) {
exists(ArrayExpr target_49 |
	target_49.getArrayBase().(PointerFieldAccess).getTarget().getName()="bar_mmap_supported"
	and target_49.getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_49.getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_49.getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_49.getParent().(IfStmt).getThen()=target_121
	and target_49.getEnclosingFunction() = func)
}

*/
/*predicate func_50(NotExpr target_123, Function func) {
exists(ExprStmt target_50 |
	target_50.getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_50.getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_50.getExpr().(AssignOrExpr).getRValue() instanceof BinaryBitwiseOperation
	and target_50.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_50
	and target_50.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_50.getEnclosingFunction() = func)
}

*/
/*predicate func_51(Variable vret_254, NotExpr target_123, RelationalOperation target_125) {
exists(IfStmt target_51 |
	target_51.getCondition().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_51.getCondition().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_51.getCondition().(EqualityOperation).getRightOperand().(PointerFieldAccess).getTarget().getName()="msix_bar"
	and target_51.getCondition().(EqualityOperation).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_254
	and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("msix_sparse_mmap_cap")
	and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_51.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_254
	and target_51.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen() instanceof ReturnStmt
	and target_51.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_51
	and target_51.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_125.getGreaterOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_53(Function func) {
exists(AddressOfExpr target_53 |
	target_53.getOperand().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_53.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_53.getEnclosingFunction() = func)
}

*/
/*predicate func_54(Variable vpdev_252) {
exists(ValueFieldAccess target_54 |
	target_54.getTarget().getName()="end"
	and target_54.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="resource"
	and target_54.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_54.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_54.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info"))
}

*/
/*predicate func_55(Variable vpdev_252) {
exists(ValueFieldAccess target_55 |
	target_55.getTarget().getName()="start"
	and target_55.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="resource"
	and target_55.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_55.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getTarget().getName()="index"
	and target_55.getQualifier().(ArrayExpr).getArrayOffset().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info"))
}

*/
/*predicate func_56(Function func) {
exists(ValueFieldAccess target_56 |
	target_56.getTarget().getName()="size"
	and target_56.getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_56.getEnclosingFunction() = func)
}

*/
/*predicate func_57(Variable vpdev_252, ExprStmt target_126) {
exists(BitwiseAndExpr target_57 |
	target_57.getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
	and target_57.getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="resource"
	and target_57.getLeftOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpdev_252
	and target_57.getRightOperand().(BinaryBitwiseOperation).getValue()="2"
	and target_57.getParent().(IfStmt).getThen()=target_126)
}

*/
/*predicate func_58(RelationalOperation target_125, Function func) {
exists(ExprStmt target_58 |
	target_58.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_58.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_58.getExpr().(AssignExpr).getRValue().(HexLiteral).getValue()="131072"
	and target_58.getParent().(IfStmt).getCondition()=target_125
	and target_58.getEnclosingFunction() = func)
}

*/
/*predicate func_59(RelationalOperation target_125, Function func) {
exists(BreakStmt target_59 |
	target_59.getParent().(IfStmt).getCondition()=target_125
	and target_59.getEnclosingFunction() = func)
}

*/
/*predicate func_60(Function func) {
exists(AddressOfExpr target_60 |
	target_60.getOperand().(VariableAccess).getType().hasName("size_t")
	and target_60.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_60.getEnclosingFunction() = func)
}

*/
/*predicate func_61(Function func) {
exists(NotExpr target_61 |
	target_61.getOperand().(VariableAccess).getType().hasName("void *")
	and target_61.getEnclosingFunction() = func)
}

*/
/*predicate func_62(Function func) {
exists(NotExpr target_62 |
	target_62.getOperand().(VariableAccess).getType().hasName("size_t")
	and target_62.getEnclosingFunction() = func)
}

*/
/*predicate func_63(RelationalOperation target_122, Function func) {
exists(ExprStmt target_63 |
	target_63.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="size"
	and target_63.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_63.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_63.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_63
	and target_63.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_122
	and target_63.getEnclosingFunction() = func)
}

*/
/*predicate func_64(RelationalOperation target_122, Function func) {
exists(BreakStmt target_64 |
	target_64.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_64
	and target_64.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_122
	and target_64.getEnclosingFunction() = func)
}

*/
/*predicate func_66(Function func) {
exists(PointerFieldAccess target_66 |
	target_66.getTarget().getName()="has_vga"
	and target_66.getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_66.getEnclosingFunction() = func)
}

*/
/*predicate func_68(Variable vvdev_1_0) {
exists(SubExpr target_68 |
	target_68.getLeftOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_68.getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_68.getParent().(AssignExpr).getRValue() = target_68
	and target_68.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="num_ctx"
	and target_68.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0)
}

*/
/*predicate func_71(Function func) {
exists(AddressOfExpr target_71 |
	target_71.getOperand().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_71.getParent().(FunctionCall).getParent().(SubExpr).getLeftOperand() instanceof FunctionCall
	and target_71.getEnclosingFunction() = func)
}

*/
/*predicate func_72(Function func) {
exists(ValueFieldAccess target_72 |
	target_72.getTarget().getName()="type"
	and target_72.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="region"
	and target_72.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_72.getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_72.getEnclosingFunction() = func)
}

*/
/*predicate func_73(Function func) {
exists(ValueFieldAccess target_73 |
	target_73.getTarget().getName()="subtype"
	and target_73.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="region"
	and target_73.getQualifier().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_73.getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_73.getEnclosingFunction() = func)
}

*/
/*predicate func_74(NotExpr target_123, Function func) {
exists(IfStmt target_74 |
	target_74.getCondition().(ValueFieldAccess).getTarget().getName()="size"
	and target_74.getCondition().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_74.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getTarget().getName()="flags"
	and target_74.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_74.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(BinaryBitwiseOperation).getValue()="8"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getTarget().getName()="argsz"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_region_info")
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getLeftOperand().(SizeofExprOperator).getValue()="32"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getRightOperand().(ValueFieldAccess).getTarget().getName()="size"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="argsz"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="cap_offset"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vfio_info_cap_shift")
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1).(ValueFieldAccess).getTarget().getName()="buf"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="size"
	and target_74.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="cap_offset"
	and target_74.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("kfree")
	and target_74.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="buf"
	and target_74.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_74.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(9)=target_74
	and target_74.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_74.getEnclosingFunction() = func)
}

*/
/*predicate func_75(Function func) {
exists(ValueFieldAccess target_75 |
	target_75.getTarget().getName()="buf"
	and target_75.getQualifier().(VariableAccess).getType().hasName("vfio_info_cap")
	and target_75.getEnclosingFunction() = func)
}

*/
/*predicate func_76(NotExpr target_123, Function func) {
exists(ReturnStmt target_76 |
	target_76.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_76.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("unsigned long")
	and target_76.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vfio_region_info")
	and target_76.getExpr().(ConditionalExpr).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getType().hasName("unsigned long")
	and target_76.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getValue()="-14"
	and target_76.getExpr().(ConditionalExpr).getElse().(Literal).getValue()="0"
	and target_76.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(10)=target_76
	and target_76.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_123
	and target_76.getEnclosingFunction() = func)
}

*/
/*predicate func_77(Function func) {
exists(LogicalOrExpr target_77 |
	target_77.getLeftOperand().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getTarget().getName()="argsz"
	and target_77.getLeftOperand().(RelationalOperation).getLesserOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_77.getLeftOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_77.getRightOperand().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getTarget().getName()="index"
	and target_77.getRightOperand().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_77.getEnclosingFunction() = func)
}

*/
/*predicate func_78(Function func) {
exists(RelationalOperation target_78 |
	 (target_78 instanceof GEExpr or target_78 instanceof LEExpr)
	and target_78.getGreaterOperand().(ValueFieldAccess).getTarget().getName()="count"
	and target_78.getGreaterOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_78.getLesserOperand().(SubExpr).getLeftOperand().(ComplementExpr).getValue()="4294967295"
	and target_78.getLesserOperand().(SubExpr).getRightOperand().(ValueFieldAccess).getTarget().getName()="start"
	and target_78.getLesserOperand().(SubExpr).getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_78.getEnclosingFunction() = func)
}

*/
/*predicate func_79(Variable vret_254, ExprStmt target_126) {
exists(AddExpr target_79 |
	target_79.getLeftOperand().(ValueFieldAccess).getTarget().getName()="start"
	and target_79.getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_79.getRightOperand().(ValueFieldAccess).getTarget().getName()="count"
	and target_79.getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_79.getParent().(GTExpr).getGreaterOperand().(VariableAccess).getTarget()=vret_254
	and target_79.getParent().(GTExpr).getLesserOperand() instanceof Literal
	and target_79.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_126)
}

*/
/*predicate func_81(Function func) {
exists(ValueFieldAccess target_81 |
	target_81.getTarget().getName()="count"
	and target_81.getQualifier().(VariableAccess).getType().hasName("vfio_irq_set")
	and target_81.getEnclosingFunction() = func)
}

*/
/*predicate func_83(Function func) {
exists(Initializer target_83 |
	target_83.getExpr().(Literal).getValue()="0"
	and target_83.getExpr().getEnclosingFunction() = func)
}

*/
/*predicate func_84(Function func) {
exists(NotExpr target_84 |
	target_84.getOperand().(ValueFieldAccess).getTarget().getName()="max"
	and target_84.getOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_fill_info")
	and target_84.getEnclosingFunction() = func)
}

*/
/*predicate func_86(Function func) {
exists(FunctionCall target_86 |
	target_86.getTarget().hasName("pci_try_reset_slot")
	and target_86.getArgument(0).(PointerFieldAccess).getTarget().getName()="slot"
	and target_86.getArgument(0).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="pdev"
	and target_86.getArgument(0).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_86.getEnclosingFunction() = func)
}

*/
/*predicate func_87(Function func) {
exists(FunctionCall target_87 |
	target_87.getTarget().hasName("pci_try_reset_bus")
	and target_87.getArgument(0).(PointerFieldAccess).getTarget().getName()="bus"
	and target_87.getArgument(0).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="pdev"
	and target_87.getArgument(0).(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vfio_pci_device *")
	and target_87.getEnclosingFunction() = func)
}

*/
predicate func_88(Function func) {
exists(ReturnStmt target_88 |
	target_88.getExpr().(UnaryMinusExpr).getValue()="-25"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_88
	and target_88.getFollowingStmt() instanceof DeclStmt)
}

predicate func_89(Function func, DeclStmt target_89) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_89
}

predicate func_90(Function func, BinaryBitwiseOperation target_90) {
	target_90.getValue()="4"
	and target_90.getEnclosingFunction() = func
}

predicate func_91(Function func, BinaryBitwiseOperation target_91) {
	target_91.getValue()="2"
	and target_91.getEnclosingFunction() = func
}

predicate func_92(Function func, BitwiseOrExpr target_92) {
	target_92.getValue()="37748928"
	and target_92.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
	and target_92.getEnclosingFunction() = func
}

predicate func_93(Variable vret_254, RelationalOperation target_122, ReturnStmt target_93) {
	target_93.getExpr().(VariableAccess).getTarget()=vret_254
	and target_93.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_122
}

predicate func_95(Variable vvdev_1_0, VariableAccess target_95) {
	target_95.getTarget()=vvdev_1_0
}

predicate func_96(Variable vvdev_1_0, VariableAccess target_96) {
	target_96.getTarget()=vvdev_1_0
}

predicate func_97(Variable vvdev_1_0, VariableAccess target_97) {
	target_97.getTarget()=vvdev_1_0
}

predicate func_98(Variable vpdev_252, VariableAccess target_98) {
	target_98.getTarget()=vpdev_252
	and target_98.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_100(Variable vvdev_1_0, VariableAccess target_100) {
	target_100.getTarget()=vvdev_1_0
	and target_100.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("kfree")
	and target_100.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ctx"
}

predicate func_101(Variable vvdev_1_0, VariableAccess target_101) {
	target_101.getTarget()=vvdev_1_0
}

predicate func_102(Variable vvdev_1_0, VariableAccess target_102) {
	target_102.getTarget()=vvdev_1_0
}

predicate func_103(Variable vvdev_1_0, VariableAccess target_103) {
	target_103.getTarget()=vvdev_1_0
}

predicate func_110(Parameter vnvec_250, Variable vret_254, BlockStmt target_120, VariableAccess target_110) {
	target_110.getTarget()=vret_254
	and target_110.getParent().(LTExpr).getGreaterOperand().(VariableAccess).getTarget()=vnvec_250
	and target_110.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_120
}

predicate func_111(Variable vret_254, ExprStmt target_126, VariableAccess target_111) {
	target_111.getTarget()=vret_254
	and target_111.getParent().(GTExpr).getLesserOperand().(Literal).getValue()="0"
	and target_111.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_126
}

predicate func_113(Variable vvdev_1_0, AssignExpr target_113) {
	target_113.getLValue().(PointerFieldAccess).getTarget().getName()="ctx"
	and target_113.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0
	and target_113.getRValue() instanceof FunctionCall
}

predicate func_114(Variable vvdev_1_0, PointerFieldAccess target_114) {
	target_114.getTarget().getName()="ctx"
	and target_114.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_115(Variable vvdev_1_0, ExprStmt target_128, PointerFieldAccess target_115) {
	target_115.getTarget().getName()="ctx"
	and target_115.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
	and target_115.getQualifier().(VariableAccess).getLocation().isBefore(target_128.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_116(Variable vvdev_1_0, PointerFieldAccess target_116) {
	target_116.getTarget().getName()="num_ctx"
	and target_116.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_117(Variable vvdev_1_0, PointerFieldAccess target_117) {
	target_117.getTarget().getName()="irq_type"
	and target_117.getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_118(Variable vvdev_1_0, AssignExpr target_118) {
	target_118.getLValue().(PointerFieldAccess).getTarget().getName()="msi_qmax"
	and target_118.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0
	and target_118.getRValue().(SubExpr).getLeftOperand() instanceof FunctionCall
	and target_118.getRValue().(SubExpr).getRightOperand() instanceof Literal
}

predicate func_119(Parameter vnvec_250, MulExpr target_119) {
	target_119.getLeftOperand().(VariableAccess).getTarget()=vnvec_250
	and target_119.getRightOperand() instanceof Literal
	and target_119.getParent().(SubExpr).getParent().(FunctionCall).getParent().(SubExpr).getLeftOperand() instanceof FunctionCall
}

predicate func_120(Variable vvdev_1_0, Variable vret_254, BlockStmt target_120) {
	target_120.getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vret_254
	and target_120.getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand() instanceof Literal
	and target_120.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_120.getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("kfree")
	and target_120.getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ctx"
	and target_120.getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0
}

predicate func_121(Function func, BlockStmt target_121) {
	target_121.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
	and target_121.getEnclosingFunction() = func
}

predicate func_122(Parameter vnvec_250, Variable vret_254, RelationalOperation target_122) {
	 (target_122 instanceof GTExpr or target_122 instanceof LTExpr)
	and target_122.getLesserOperand().(VariableAccess).getTarget()=vret_254
	and target_122.getGreaterOperand().(VariableAccess).getTarget()=vnvec_250
}

predicate func_123(Parameter vmsix_250, NotExpr target_123) {
	target_123.getOperand().(VariableAccess).getTarget()=vmsix_250
}

predicate func_125(Variable vret_254, RelationalOperation target_125) {
	 (target_125 instanceof GTExpr or target_125 instanceof LTExpr)
	and target_125.getGreaterOperand().(VariableAccess).getTarget()=vret_254
	and target_125.getLesserOperand() instanceof Literal
}

predicate func_126(Function func, ExprStmt target_126) {
	target_126.getExpr() instanceof FunctionCall
	and target_126.getEnclosingFunction() = func
}

predicate func_128(Parameter vnvec_250, Variable vvdev_1_0, ExprStmt target_128) {
	target_128.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="num_ctx"
	and target_128.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvdev_1_0
	and target_128.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnvec_250
}

from Function func, Parameter vnvec_250, Parameter vmsix_250, Variable vvdev_1_0, Variable vpdev_252, Variable vflag_253, Variable vret_254, PointerFieldAccess target_0, PointerFieldAccess target_1, Initializer target_2, PointerFieldAccess target_5, FunctionCall target_6, FunctionCall target_9, VariableAccess target_10, FunctionCall target_11, VariableAccess target_12, VariableAccess target_13, VariableAccess target_16, VariableAccess target_18, DeclStmt target_89, BinaryBitwiseOperation target_90, BinaryBitwiseOperation target_91, BitwiseOrExpr target_92, ReturnStmt target_93, VariableAccess target_95, VariableAccess target_96, VariableAccess target_97, VariableAccess target_98, VariableAccess target_100, VariableAccess target_101, VariableAccess target_102, VariableAccess target_103, VariableAccess target_110, VariableAccess target_111, AssignExpr target_113, PointerFieldAccess target_114, PointerFieldAccess target_115, PointerFieldAccess target_116, PointerFieldAccess target_117, AssignExpr target_118, MulExpr target_119, BlockStmt target_120, BlockStmt target_121, RelationalOperation target_122, NotExpr target_123, RelationalOperation target_125, ExprStmt target_126, ExprStmt target_128
where
func_0(vvdev_1_0, target_0)
and func_1(vvdev_1_0, target_1)
and func_2(vmsix_250, target_2)
and func_5(vvdev_1_0, target_5)
and func_6(vnvec_250, vvdev_1_0, target_6)
and func_9(vnvec_250, vpdev_252, vflag_253, vret_254, target_9)
and func_10(vnvec_250, vret_254, target_120, target_10)
and func_11(vpdev_252, target_11)
and func_12(vnvec_250, vvdev_1_0, target_12)
and func_13(vmsix_250, target_13)
and func_16(vmsix_250, target_121, target_16)
and func_18(vnvec_250, target_18)
and not func_21(vret_254, target_93, func)
and not func_88(func)
and func_89(func, target_89)
and func_90(func, target_90)
and func_91(func, target_91)
and func_92(func, target_92)
and func_93(vret_254, target_122, target_93)
and func_95(vvdev_1_0, target_95)
and func_96(vvdev_1_0, target_96)
and func_97(vvdev_1_0, target_97)
and func_98(vpdev_252, target_98)
and func_100(vvdev_1_0, target_100)
and func_101(vvdev_1_0, target_101)
and func_102(vvdev_1_0, target_102)
and func_103(vvdev_1_0, target_103)
and func_110(vnvec_250, vret_254, target_120, target_110)
and func_111(vret_254, target_126, target_111)
and func_113(vvdev_1_0, target_113)
and func_114(vvdev_1_0, target_114)
and func_115(vvdev_1_0, target_128, target_115)
and func_116(vvdev_1_0, target_116)
and func_117(vvdev_1_0, target_117)
and func_118(vvdev_1_0, target_118)
and func_119(vnvec_250, target_119)
and func_120(vvdev_1_0, vret_254, target_120)
and func_121(func, target_121)
and func_122(vnvec_250, vret_254, target_122)
and func_123(vmsix_250, target_123)
and func_125(vret_254, target_125)
and func_126(func, target_126)
and func_128(vnvec_250, vvdev_1_0, target_128)
and vnvec_250.getType().hasName("int")
and vmsix_250.getType().hasName("bool")
and vvdev_1_0.getType().hasName("vfio_pci_device *")
and vpdev_252.getType().hasName("pci_dev *")
and vflag_253.getType().hasName("unsigned int")
and vret_254.getType().hasName("int")
and vnvec_250.getFunction() = func
and vmsix_250.getFunction() = func
and vvdev_1_0.(LocalVariable).getFunction() = func
and vpdev_252.(LocalVariable).getFunction() = func
and vflag_253.(LocalVariable).getFunction() = func
and vret_254.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
