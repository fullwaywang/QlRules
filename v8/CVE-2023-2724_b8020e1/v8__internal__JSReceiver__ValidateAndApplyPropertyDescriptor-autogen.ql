/**
 * @name v8-b8020e1973d7d3a50b17c076cd948f079e59f9e5-v8__internal__JSReceiver__ValidateAndApplyPropertyDescriptor
 * @id cpp/v8/b8020e1973d7d3a50b17c076cd948f079e59f9e5/v8internaljsreceivervalidateandapplypropertydescriptor
 * @description v8-b8020e1973d7d3a50b17c076cd948f079e59f9e5-src/objects/js-objects.cc-v8__internal__JSReceiver__ValidateAndApplyPropertyDescriptor CVE-2023-2724
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vgetter_1535, Variable vsetter_1539, Parameter vit_1479, Parameter vdesc_1480, FunctionCall target_0) {
	target_0.getTarget().hasName("DefineAccessor")
	and not target_0.getTarget().hasName("DefineOwnAccessorIgnoreAttributes")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vit_1479
	and target_0.getArgument(1).(VariableAccess).getTarget()=vgetter_1535
	and target_0.getArgument(2).(VariableAccess).getTarget()=vsetter_1539
	and target_0.getArgument(3).(FunctionCall).getTarget().hasName("ToAttributes")
	and target_0.getArgument(3).(FunctionCall).getQualifier().(VariableAccess).getTarget()=vdesc_1480
}

predicate func_1(Variable vattrs_1679, Variable vgetter_1716, Variable vsetter_1722, Parameter vit_1479, FunctionCall target_1) {
	target_1.getTarget().hasName("DefineAccessor")
	and not target_1.getTarget().hasName("DefineOwnAccessorIgnoreAttributes")
	and target_1.getArgument(0).(VariableAccess).getTarget()=vit_1479
	and target_1.getArgument(1).(VariableAccess).getTarget()=vgetter_1716
	and target_1.getArgument(2).(VariableAccess).getTarget()=vsetter_1722
	and target_1.getArgument(3).(VariableAccess).getTarget()=vattrs_1679
}

from Function func, Variable vgetter_1535, Variable vsetter_1539, Variable vattrs_1679, Variable vgetter_1716, Variable vsetter_1722, Parameter vit_1479, Parameter vdesc_1480, FunctionCall target_0, FunctionCall target_1
where
func_0(vgetter_1535, vsetter_1539, vit_1479, vdesc_1480, target_0)
and func_1(vattrs_1679, vgetter_1716, vsetter_1722, vit_1479, target_1)
and vgetter_1535.getType().hasName("Handle<Object>")
and vsetter_1539.getType().hasName("Handle<Object>")
and vattrs_1679.getType().hasName("PropertyAttributes")
and vgetter_1716.getType().hasName("Handle<Object>")
and vsetter_1722.getType().hasName("Handle<Object>")
and vit_1479.getType().hasName("LookupIterator *")
and vdesc_1480.getType().hasName("PropertyDescriptor *")
and vgetter_1535.(LocalVariable).getFunction() = func
and vsetter_1539.(LocalVariable).getFunction() = func
and vattrs_1679.(LocalVariable).getFunction() = func
and vgetter_1716.(LocalVariable).getFunction() = func
and vsetter_1722.(LocalVariable).getFunction() = func
and vit_1479.getFunction() = func
and vdesc_1480.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
