/**
 * @name linux-f63a8daa5812afef4f06c962351687e1ff9ccb2b-perf_pmu_migrate_context
 * @id cpp/linux/f63a8daa5812afef4f06c962351687e1ff9ccb2b/perf-pmu-migrate-context
 * @description linux-f63a8daa5812afef4f06c962351687e1ff9ccb2b-kernel/events/core.c-perf_pmu_migrate_context CVE-2016-6786
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Initializer target_0) {
	target_0.getExpr().(Literal).getValue()="0"
	and target_0.getExpr().getEnclosingFunction() = func
}

predicate func_2(Variable vsrc_ctx_7621, PointerFieldAccess target_2) {
	target_2.getTarget().getName()="mutex"
	and target_2.getQualifier().(VariableAccess).getTarget()=vsrc_ctx_7621
}

predicate func_3(Variable vevent_7623, FunctionCall target_3) {
	target_3.getTarget().hasName("perf_remove_from_context")
	and not target_3.getTarget().hasName("poll_wait")
	and target_3.getArgument(0).(VariableAccess).getTarget()=vevent_7623
}

predicate func_4(Variable vsrc_ctx_7621, PointerFieldAccess target_4) {
	target_4.getTarget().getName()="mutex"
	and target_4.getQualifier().(VariableAccess).getTarget()=vsrc_ctx_7621
}

predicate func_5(Function func) {
exists(PointerFieldAccess target_5 |
	target_5.getTarget().getName()="private_data"
	and target_5.getQualifier().(VariableAccess).getType().hasName("file *")
	and target_5.getEnclosingFunction() = func)
}

predicate func_9(Variable vevent_7623) {
exists(AddressOfExpr target_9 |
	target_9.getOperand().(PointerFieldAccess).getTarget().getName()="waitq"
	and target_9.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_9.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall)
}

predicate func_11(Variable vevent_7623, ExprStmt target_72, ExprStmt target_53) {
exists(FunctionCall target_11 |
	target_11.getTarget().hasName("is_event_hup")
	and target_11.getArgument(0).(VariableAccess).getTarget()=vevent_7623
	and target_11.getParent().(IfStmt).getThen()=target_72
	and target_11.getArgument(0).(VariableAccess).getLocation().isBefore(target_53.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_13(Variable vevent_7623) {
exists(AssignExpr target_13 |
	target_13.getLValue().(VariableAccess).getType().hasName("ring_buffer *")
	and target_13.getRValue().(PointerFieldAccess).getTarget().getName()="rb"
	and target_13.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623)
}

predicate func_14(Variable vevents_1_7624, ForStmt target_45, Function func) {
exists(IfStmt target_14 |
	target_14.getCondition().(VariableAccess).getType().hasName("ring_buffer *")
	and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vevents_1_7624
	and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("atomic_xchg")
	and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="poll"
	and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ring_buffer *")
	and target_14.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_14
	and target_14.getLocation().isBefore(target_45.getLocation()))
}

/*predicate func_15(Variable vevents_1_7624) {
exists(AssignExpr target_15 |
	target_15.getLValue().(VariableAccess).getTarget()=vevents_1_7624
	and target_15.getRValue().(FunctionCall).getTarget().hasName("atomic_xchg")
	and target_15.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="poll"
	and target_15.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ring_buffer *")
	and target_15.getRValue().(FunctionCall).getArgument(1) instanceof Literal)
}

*/
predicate func_16(Variable vevents_1_7624, ExprStmt target_75, AddressOfExpr target_76, Function func) {
exists(ReturnStmt target_16 |
	target_16.getExpr().(VariableAccess).getTarget()=vevents_1_7624
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
	and target_16.getLocation().isBefore(target_75.getLocation())
	and target_76.getOperand().(VariableAccess).getLocation().isBefore(target_16.getExpr().(VariableAccess).getLocation()))
}

predicate func_17(Variable vevent_7623, VariableAccess target_17) {
	target_17.getTarget()=vevent_7623
}

predicate func_18(Variable vevent_7623, VariableAccess target_18) {
	target_18.getTarget()=vevent_7623
}

predicate func_19(Variable vevent_7623, VariableAccess target_19) {
	target_19.getTarget()=vevent_7623
	and target_19.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_20(Variable vevent_7623, VariableAccess target_20) {
	target_20.getTarget()=vevent_7623
	and target_20.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_22(Variable vevent_7623, VariableAccess target_22) {
	target_22.getTarget()=vevent_7623
}

predicate func_26(Function func, DeclStmt target_26) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_26
}

predicate func_29(Variable vsrc_ctx_7621, Function func, ExprStmt target_29) {
	target_29.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsrc_ctx_7621
	and target_29.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="ctx"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

/*predicate func_30(Variable v__vpp_verify_7626, DoStmt target_30) {
	target_30.getCondition().(Literal).getValue()="0"
	and target_30.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__vpp_verify_7626
}

*/
/*predicate func_32(Variable v__vpp_verify_7626, ExprStmt target_32) {
	target_32.getExpr().(VariableAccess).getTarget()=v__vpp_verify_7626
}

*/
/*predicate func_33(Variable v__ptr_7626, Variable v__per_cpu_offset, Parameter vsrc_cpu_7619, Parameter vpmu_7619, ExprStmt target_33) {
	target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ptr_7626
	and target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerFieldAccess).getTarget().getName()="pmu_cpu_context"
	and target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpmu_7619
	and target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=v__ptr_7626
	and target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
	and target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsrc_cpu_7619
}

*/
/*predicate func_35(Variable v__ptr_7626, Parameter vpmu_7619, AsmStmt target_43, AsmStmt target_35) {
	target_35.getChild(0).(VariableAccess).getTarget()=v__ptr_7626
	and target_35.getChild(1).(PointerFieldAccess).getTarget().getName()="pmu_cpu_context"
	and target_35.getChild(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpmu_7619
	and target_35.getChild(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_43.getChild(1).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
/*predicate func_36(Variable v__ptr_7626, Variable v__per_cpu_offset, Parameter vsrc_cpu_7619, ExprStmt target_36) {
	target_36.getExpr().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=v__ptr_7626
	and target_36.getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
	and target_36.getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsrc_cpu_7619
}

*/
predicate func_37(Variable vdst_ctx_7622, AssignExpr target_37) {
	target_37.getLValue().(VariableAccess).getTarget()=vdst_ctx_7622
	and target_37.getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="ctx"
	and target_37.getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
}

/*predicate func_38(Variable v__vpp_verify_7627, DoStmt target_38) {
	target_38.getCondition().(Literal).getValue()="0"
	and target_38.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__vpp_verify_7627
}

*/
/*predicate func_40(Variable v__vpp_verify_7627, ExprStmt target_40) {
	target_40.getExpr().(VariableAccess).getTarget()=v__vpp_verify_7627
}

*/
/*predicate func_41(Variable v__per_cpu_offset, Variable v__ptr_7627, Parameter vdst_cpu_7619, Parameter vpmu_7619, ExprStmt target_41) {
	target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__ptr_7627
	and target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerFieldAccess).getTarget().getName()="pmu_cpu_context"
	and target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpmu_7619
	and target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=v__ptr_7627
	and target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
	and target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vdst_cpu_7619
}

*/
predicate func_43(Variable v__ptr_7627, Parameter vpmu_7619, AsmStmt target_43) {
	target_43.getChild(0).(VariableAccess).getTarget()=v__ptr_7627
	and target_43.getChild(1).(PointerFieldAccess).getTarget().getName()="pmu_cpu_context"
	and target_43.getChild(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpmu_7619
}

/*predicate func_44(Variable v__per_cpu_offset, Variable v__ptr_7627, Parameter vdst_cpu_7619, ExprStmt target_44) {
	target_44.getExpr().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=v__ptr_7627
	and target_44.getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=v__per_cpu_offset
	and target_44.getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vdst_cpu_7619
}

*/
predicate func_45(Variable vevent_7623, Variable vtmp_7623, Variable vevents_1_7624, Parameter vsrc_cpu_7619, Variable vsrc_ctx_7621, Function func, ForStmt target_45) {
	target_45.getInitialization().(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vevent_7623
	and target_45.getInitialization().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vtmp_7623
	and target_45.getCondition().(EqualityOperation).getLeftOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="event_entry"
	and target_45.getCondition().(EqualityOperation).getLeftOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_45.getCondition().(EqualityOperation).getRightOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="event_list"
	and target_45.getCondition().(EqualityOperation).getRightOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsrc_ctx_7621
	and target_45.getUpdate().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vevent_7623
	and target_45.getUpdate().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(VariableAccess).getTarget()=vtmp_7623
	and target_45.getUpdate().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vtmp_7623
	and target_45.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_45.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("unaccount_event_cpu")
	and target_45.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_7623
	and target_45.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsrc_cpu_7619
	and target_45.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("put_ctx")
	and target_45.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsrc_ctx_7621
	and target_45.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("list_add")
	and target_45.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="migrate_entry"
	and target_45.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_45.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vevents_1_7624
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_45
}

/*predicate func_47(Variable v__mptr_7630, ExprStmt target_47) {
	target_47.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_7630
	and target_47.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="0"
}

*/
/*predicate func_49(Variable v__mptr_1_7630, ExprStmt target_49) {
	target_49.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_1_7630
	and target_49.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="0"
}

*/
/*predicate func_51(Variable v__mptr_2_7630, ExprStmt target_51) {
	target_51.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_2_7630
	and target_51.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="0"
}

*/
/*predicate func_52(Function func, ExprStmt target_52) {
	target_52.getExpr() instanceof FunctionCall
	and target_52.getEnclosingFunction() = func
}

*/
predicate func_53(Variable vevent_7623, Parameter vsrc_cpu_7619, ExprStmt target_53) {
	target_53.getExpr().(FunctionCall).getTarget().hasName("unaccount_event_cpu")
	and target_53.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_7623
	and target_53.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsrc_cpu_7619
}

/*predicate func_54(Variable vsrc_ctx_7621, ExprStmt target_54) {
	target_54.getExpr().(FunctionCall).getTarget().hasName("put_ctx")
	and target_54.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsrc_ctx_7621
}

*/
/*predicate func_55(Variable vevent_7623, Variable vevents_1_7624, FunctionCall target_55) {
	target_55.getTarget().hasName("list_add")
	and target_55.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="migrate_entry"
	and target_55.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_55.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vevents_1_7624
}

*/
predicate func_56(Function func, ExprStmt target_56) {
	target_56.getExpr().(FunctionCall).getTarget().hasName("synchronize_rcu")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_56
}

predicate func_57(Variable vdst_ctx_7622, Function func, ExprStmt target_57) {
	target_57.getExpr().(FunctionCall).getTarget().hasName("mutex_lock_nested")
	and target_57.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="mutex"
	and target_57.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdst_ctx_7622
	and target_57.getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_57
}

predicate func_58(Variable vevent_7623, Variable vtmp_7623, Variable vevents_1_7624, Parameter vdst_cpu_7619, Variable vdst_ctx_7622, Function func, ForStmt target_58) {
	target_58.getInitialization().(ExprStmt).getExpr().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vevent_7623
	and target_58.getInitialization().(ExprStmt).getExpr().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vtmp_7623
	and target_58.getCondition().(EqualityOperation).getLeftOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="migrate_entry"
	and target_58.getCondition().(EqualityOperation).getLeftOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_58.getCondition().(EqualityOperation).getRightOperand().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vevents_1_7624
	and target_58.getUpdate().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vevent_7623
	and target_58.getUpdate().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(VariableAccess).getTarget()=vtmp_7623
	and target_58.getUpdate().(CommaExpr).getRightOperand().(AssignExpr).getLValue().(VariableAccess).getTarget()=vtmp_7623
	and target_58.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("list_del")
	and target_58.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="migrate_entry"
	and target_58.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_58.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="state"
	and target_58.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_58.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="state"
	and target_58.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_58.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("account_event_cpu")
	and target_58.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_7623
	and target_58.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vdst_cpu_7619
	and target_58.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("perf_install_in_context")
	and target_58.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdst_ctx_7622
	and target_58.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vevent_7623
	and target_58.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vdst_cpu_7619
	and target_58.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("get_ctx")
	and target_58.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdst_ctx_7622
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_58
}

/*predicate func_60(Variable v__mptr_7642, ExprStmt target_60) {
	target_60.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_7642
	and target_60.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="48"
}

*/
/*predicate func_62(Variable v__mptr_1_7642, ExprStmt target_62) {
	target_62.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_1_7642
	and target_62.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="48"
}

*/
/*predicate func_64(Variable v__mptr_2_7642, ExprStmt target_64) {
	target_64.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_2_7642
	and target_64.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="48"
}

*/
/*predicate func_65(Variable vevent_7623, ExprStmt target_65) {
	target_65.getExpr().(FunctionCall).getTarget().hasName("list_del")
	and target_65.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="migrate_entry"
	and target_65.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
}

*/
/*predicate func_66(Variable vevent_7623, ExprStmt target_72, RelationalOperation target_66) {
	 (target_66 instanceof GEExpr or target_66 instanceof LEExpr)
	and target_66.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="state"
	and target_66.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
	and target_66.getParent().(IfStmt).getThen()=target_72
}

*/
/*predicate func_67(Variable vevent_7623, AssignExpr target_67) {
	target_67.getLValue().(PointerFieldAccess).getTarget().getName()="state"
	and target_67.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vevent_7623
}

*/
/*predicate func_68(Variable vevent_7623, Parameter vdst_cpu_7619, ExprStmt target_68) {
	target_68.getExpr().(FunctionCall).getTarget().hasName("account_event_cpu")
	and target_68.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_7623
	and target_68.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vdst_cpu_7619
}

*/
/*predicate func_69(Variable vevent_7623, Parameter vdst_cpu_7619, Variable vdst_ctx_7622, ExprStmt target_69) {
	target_69.getExpr().(FunctionCall).getTarget().hasName("perf_install_in_context")
	and target_69.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdst_ctx_7622
	and target_69.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vevent_7623
	and target_69.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vdst_cpu_7619
}

*/
/*predicate func_70(Variable vdst_ctx_7622, ExprStmt target_70) {
	target_70.getExpr().(FunctionCall).getTarget().hasName("get_ctx")
	and target_70.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdst_ctx_7622
}

*/
predicate func_71(Variable vdst_ctx_7622, Function func, ExprStmt target_71) {
	target_71.getExpr().(FunctionCall).getTarget().hasName("mutex_unlock")
	and target_71.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="mutex"
	and target_71.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdst_ctx_7622
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_71
}

predicate func_72(Function func, ExprStmt target_72) {
	target_72.getExpr() instanceof AssignExpr
	and target_72.getEnclosingFunction() = func
}

predicate func_75(Variable vsrc_ctx_7621, ExprStmt target_75) {
	target_75.getExpr().(FunctionCall).getTarget().hasName("mutex_unlock")
	and target_75.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="mutex"
	and target_75.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsrc_ctx_7621
}

predicate func_76(Variable vevents_1_7624, AddressOfExpr target_76) {
	target_76.getOperand().(VariableAccess).getTarget()=vevents_1_7624
	and target_76.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

from Function func, Variable vevent_7623, Variable vtmp_7623, Variable vevents_1_7624, Variable v__vpp_verify_7626, Variable v__ptr_7626, Variable v__per_cpu_offset, Variable v__vpp_verify_7627, Variable v__ptr_7627, Variable v__mptr_7630, Variable v__mptr_1_7630, Variable v__mptr_2_7630, Variable v__mptr_7642, Variable v__mptr_1_7642, Variable v__mptr_2_7642, Parameter vsrc_cpu_7619, Parameter vdst_cpu_7619, Variable vsrc_ctx_7621, Variable vdst_ctx_7622, Parameter vpmu_7619, Initializer target_0, PointerFieldAccess target_2, FunctionCall target_3, PointerFieldAccess target_4, VariableAccess target_17, VariableAccess target_18, VariableAccess target_19, VariableAccess target_20, VariableAccess target_22, DeclStmt target_26, ExprStmt target_29, AssignExpr target_37, AsmStmt target_43, ForStmt target_45, ExprStmt target_53, ExprStmt target_56, ExprStmt target_57, ForStmt target_58, ExprStmt target_71, ExprStmt target_72, ExprStmt target_75, AddressOfExpr target_76
where
func_0(func, target_0)
and func_2(vsrc_ctx_7621, target_2)
and func_3(vevent_7623, target_3)
and func_4(vsrc_ctx_7621, target_4)
and not func_5(func)
and not func_9(vevent_7623)
and not func_11(vevent_7623, target_72, target_53)
and not func_13(vevent_7623)
and not func_14(vevents_1_7624, target_45, func)
and not func_16(vevents_1_7624, target_75, target_76, func)
and func_17(vevent_7623, target_17)
and func_18(vevent_7623, target_18)
and func_19(vevent_7623, target_19)
and func_20(vevent_7623, target_20)
and func_22(vevent_7623, target_22)
and func_26(func, target_26)
and func_29(vsrc_ctx_7621, func, target_29)
and func_37(vdst_ctx_7622, target_37)
and func_43(v__ptr_7627, vpmu_7619, target_43)
and func_45(vevent_7623, vtmp_7623, vevents_1_7624, vsrc_cpu_7619, vsrc_ctx_7621, func, target_45)
and func_53(vevent_7623, vsrc_cpu_7619, target_53)
and func_56(func, target_56)
and func_57(vdst_ctx_7622, func, target_57)
and func_58(vevent_7623, vtmp_7623, vevents_1_7624, vdst_cpu_7619, vdst_ctx_7622, func, target_58)
and func_71(vdst_ctx_7622, func, target_71)
and func_72(func, target_72)
and func_75(vsrc_ctx_7621, target_75)
and func_76(vevents_1_7624, target_76)
and vevent_7623.getType().hasName("perf_event *")
and vtmp_7623.getType().hasName("perf_event *")
and vevents_1_7624.getType().hasName("list_head")
and v__vpp_verify_7626.getType().hasName("const void *")
and v__ptr_7626.getType().hasName("unsigned long")
and v__per_cpu_offset.getType() instanceof ArrayType
and v__vpp_verify_7627.getType().hasName("const void *")
and v__ptr_7627.getType().hasName("unsigned long")
and v__mptr_7630.getType().hasName("const list_head *")
and v__mptr_1_7630.getType().hasName("const list_head *")
and v__mptr_2_7630.getType().hasName("const list_head *")
and v__mptr_7642.getType().hasName("const list_head *")
and v__mptr_1_7642.getType().hasName("const list_head *")
and v__mptr_2_7642.getType().hasName("const list_head *")
and vsrc_cpu_7619.getType().hasName("int")
and vdst_cpu_7619.getType().hasName("int")
and vsrc_ctx_7621.getType().hasName("perf_event_context *")
and vdst_ctx_7622.getType().hasName("perf_event_context *")
and vpmu_7619.getType().hasName("pmu *")
and vevent_7623.(LocalVariable).getFunction() = func
and vtmp_7623.(LocalVariable).getFunction() = func
and vevents_1_7624.(LocalVariable).getFunction() = func
and v__vpp_verify_7626.(LocalVariable).getFunction() = func
and v__ptr_7626.(LocalVariable).getFunction() = func
and not v__per_cpu_offset.getParentScope+() = func
and v__vpp_verify_7627.(LocalVariable).getFunction() = func
and v__ptr_7627.(LocalVariable).getFunction() = func
and v__mptr_7630.(LocalVariable).getFunction() = func
and v__mptr_1_7630.(LocalVariable).getFunction() = func
and v__mptr_2_7630.(LocalVariable).getFunction() = func
and v__mptr_7642.(LocalVariable).getFunction() = func
and v__mptr_1_7642.(LocalVariable).getFunction() = func
and v__mptr_2_7642.(LocalVariable).getFunction() = func
and vsrc_cpu_7619.getFunction() = func
and vdst_cpu_7619.getFunction() = func
and vsrc_ctx_7621.(LocalVariable).getFunction() = func
and vdst_ctx_7622.(LocalVariable).getFunction() = func
and vpmu_7619.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
