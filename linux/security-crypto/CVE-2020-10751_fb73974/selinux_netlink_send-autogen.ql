/**
 * @name linux-fb73974172ffaaf57a7c42f35424d9aece1a5af6-selinux_netlink_send
 * @id cpp/linux/fb73974172ffaaf57a7c42f35424d9aece1a5af6/selinux-netlink-send
 * @description linux-fb73974172ffaaf57a7c42f35424d9aece1a5af6-security/selinux/hooks.c-selinux_netlink_send CVE-2020-10751
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Initializer target_0) {
	target_0.getExpr().(Literal).getValue()="0"
	and target_0.getExpr().getEnclosingFunction() = func
}

predicate func_1(Variable verr_5845, BlockStmt target_40, VariableAccess target_1) {
	target_1.getTarget()=verr_5845
	and target_1.getParent().(EQExpr).getRightOperand().(UnaryMinusExpr).getValue()="-22"
	and target_1.getParent().(EQExpr).getParent().(IfStmt).getThen()=target_40
}

predicate func_2(Variable verr_5845, VariableAccess target_2) {
	target_2.getTarget()=verr_5845
	and target_2.getParent().(AssignExpr).getLValue() = target_2
	and target_2.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_3(Variable verr_5845, ExprStmt target_41, VariableAccess target_3) {
	target_3.getTarget()=verr_5845
	and target_3.getParent().(EQExpr).getRightOperand().(UnaryMinusExpr).getValue()="-2"
	and target_3.getParent().(EQExpr).getParent().(IfStmt).getThen()=target_41
}

predicate func_4(Variable verr_5845, VariableAccess target_4) {
	target_4.getTarget()=verr_5845
	and target_4.getParent().(AssignExpr).getLValue() = target_4
	and target_4.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_5(Variable verr_5845, Variable vperm_5846, VariableAccess target_5) {
	target_5.getTarget()=verr_5845
	and target_5.getParent().(AssignExpr).getLValue() = target_5
	and target_5.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("sock_has_perm")
	and target_5.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("sock *")
	and target_5.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vperm_5846
}

predicate func_6(Variable verr_5845, VariableAccess target_6) {
	target_6.getTarget()=verr_5845
}

predicate func_7(Variable verr_5845, VariableAccess target_7) {
	target_7.getTarget()=verr_5845
	and target_7.getParent().(AssignExpr).getLValue() = target_7
	and target_7.getParent().(AssignExpr).getRValue() instanceof UnaryMinusExpr
}

predicate func_8(Function func, Literal target_8) {
	target_8.getValue()="22"
	and not target_8.getValue()="0"
	and target_8.getParent().(UnaryMinusExpr).getParent().(AssignExpr).getRValue() instanceof UnaryMinusExpr
	and target_8.getEnclosingFunction() = func
}

predicate func_9(Variable verr_5845, BlockStmt target_42, VariableAccess target_9) {
	target_9.getTarget()=verr_5845
	and target_9.getParent().(IfStmt).getThen()=target_42
}

predicate func_10(Function func, DeclStmt target_10) {
	target_10.getFollowingStmt() instanceof DeclStmt
	and target_10.getEnclosingFunction() = func
}

predicate func_11(Variable vperm_5846, Variable vnlh_5847, IfStmt target_43, DeclStmt target_10, ExprStmt target_44, ExprStmt target_45, Function func) {
exists(WhileStmt target_11 |
	target_11.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getTarget().hasName("nlmsg_total_size")
	and target_11.getCondition().(RelationalOperation).getLesserOperand().(FunctionCall).getArgument(0).(Literal).getValue()="0"
	and target_11.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnlh_5847
	and target_11.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("unsigned char *")
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="nlmsg_len"
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(BitwiseAndExpr).getValue()="16"
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="nlmsg_len"
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ReturnStmt).getExpr().(Literal).getValue()="0"
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("selinux_nlmsg_lookup")
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("u16")
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="nlmsg_type"
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vperm_5846
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getCondition().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("sock_has_perm")
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ReturnStmt).getExpr().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getRightOperand().(UnaryMinusExpr).getValue()="-22"
	and target_11.getStmt().(BlockStmt).getStmt(3).(IfStmt).getElse().(IfStmt).getElse().(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_11.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_11.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294967292"
	and target_11.getStmt().(BlockStmt).getStmt(5).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getStmt().(BlockStmt).getStmt(5).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getStmt().(BlockStmt).getStmt(5).(IfStmt).getThen().(ReturnStmt).getExpr().(Literal).getValue()="0"
	and target_11.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getType().hasName("unsigned int")
	and target_11.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getType().hasName("unsigned char *")
	and target_11.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getType().hasName("unsigned int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_11
	and target_11.getLocation().isBefore(target_43.getLocation())
	and target_11.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getLocation().isBefore(target_44.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
	and target_11.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_45.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_13(Variable vnlh_5847) {
exists(PointerFieldAccess target_13 |
	target_13.getTarget().getName()="nlmsg_len"
	and target_13.getQualifier().(VariableAccess).getTarget()=vnlh_5847)
}

*/
/*predicate func_14(Variable vnlh_5847, ExprStmt target_47, ExprStmt target_45) {
exists(RelationalOperation target_14 |
	 (target_14 instanceof GTExpr or target_14 instanceof LTExpr)
	and target_14.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="nlmsg_len"
	and target_14.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_14.getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_14.getParent().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand() instanceof FunctionCall
	and target_14.getParent().(LogicalOrExpr).getRightOperand() instanceof FunctionCall
	and target_14.getParent().(LogicalOrExpr).getParent().(IfStmt).getThen()=target_47
	and target_45.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_14.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_15(FunctionCall target_28, Function func) {
exists(ReturnStmt target_15 |
	target_15.getExpr().(Literal).getValue()="0"
	and target_15.getParent().(IfStmt).getCondition()=target_28
	and target_15.getEnclosingFunction() = func)
}

*/
/*predicate func_17(BlockStmt target_48, Function func) {
exists(EqualityOperation target_17 |
	target_17.getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_17.getRightOperand().(Literal).getValue()="0"
	and target_17.getParent().(IfStmt).getThen()=target_48
	and target_17.getEnclosingFunction() = func)
}

*/
/*predicate func_20(BlockStmt target_40, Function func) {
exists(LogicalAndExpr target_20 |
	target_20.getLeftOperand() instanceof FunctionCall
	and target_20.getRightOperand().(NotExpr).getOperand() instanceof FunctionCall
	and target_20.getParent().(IfStmt).getThen()=target_40
	and target_20.getEnclosingFunction() = func)
}

*/
/*predicate func_21(EqualityOperation target_49, Function func) {
exists(ReturnStmt target_21 |
	target_21.getExpr().(VariableAccess).getType().hasName("int")
	and target_21.getParent().(IfStmt).getCondition()=target_49
	and target_21.getEnclosingFunction() = func)
}

*/
/*predicate func_22(VariableAccess target_9, Function func) {
exists(IfStmt target_22 |
	target_22.getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getType().hasName("int")
	and target_22.getCondition().(EqualityOperation).getRightOperand().(UnaryMinusExpr).getValue()="-2"
	and target_22.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_22.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_22.getElse().(BlockStmt).getStmt(0).(ReturnStmt).getExpr().(VariableAccess).getType().hasName("int")
	and target_22.getParent().(IfStmt).getCondition()=target_9
	and target_22.getEnclosingFunction() = func)
}

*/
/*predicate func_23(Variable vnlh_5847, RelationalOperation target_50) {
exists(ExprStmt target_23 |
	target_23.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_23.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(SubExpr).getLeftOperand().(AddExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="nlmsg_len"
	and target_23.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(SubExpr).getLeftOperand().(AddExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_23.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(SubExpr).getLeftOperand().(AddExpr).getRightOperand().(Literal).getValue()="4"
	and target_23.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_23.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294967292"
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(4)=target_23
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_50)
}

*/
/*predicate func_24(RelationalOperation target_50, Function func) {
exists(IfStmt target_24 |
	target_24.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_24.getThen().(ReturnStmt).getExpr().(Literal).getValue()="0"
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(5)=target_24
	and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_50
	and target_24.getEnclosingFunction() = func)
}

*/
/*predicate func_25(Function func) {
exists(AssignSubExpr target_25 |
	target_25.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_25.getRValue().(VariableAccess).getType().hasName("unsigned int")
	and target_25.getEnclosingFunction() = func)
}

*/
/*predicate func_26(RelationalOperation target_50, Function func) {
exists(ExprStmt target_26 |
	target_26.getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getType().hasName("unsigned char *")
	and target_26.getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getType().hasName("unsigned int")
	and target_26.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(7)=target_26
	and target_26.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_50
	and target_26.getEnclosingFunction() = func)
}

*/
predicate func_27(IfStmt target_43, Function func) {
exists(ReturnStmt target_27 |
	target_27.getExpr().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
	and target_27.getLocation().isBefore(target_43.getLocation()))
}

predicate func_28(Variable v_rs_5859, Variable v__func__, ExprStmt target_45, FunctionCall target_28) {
	target_28.getTarget().hasName("___ratelimit")
	and target_28.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v_rs_5859
	and target_28.getArgument(1).(VariableAccess).getTarget()=v__func__
	and target_28.getParent().(IfStmt).getThen()=target_45
}

predicate func_29(Parameter vskb_5843, BlockStmt target_48, PointerFieldAccess target_29) {
	target_29.getTarget().getName()="len"
	and target_29.getQualifier().(VariableAccess).getTarget()=vskb_5843
	and target_29.getParent().(LTExpr).getGreaterOperand().(BitwiseAndExpr).getValue()="16"
	and target_29.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_48
}

predicate func_30(Variable vperm_5846, Variable vnlh_5847, Variable vsksec_5848, PointerFieldAccess target_30) {
	target_30.getTarget().getName()="sclass"
	and target_30.getQualifier().(VariableAccess).getTarget()=vsksec_5848
	and target_30.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("selinux_nlmsg_lookup")
	and target_30.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="nlmsg_type"
	and target_30.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_30.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vperm_5846
}

/*predicate func_31(Variable vselinux_state, FunctionCall target_31) {
	target_31.getTarget().hasName("enforcing_enabled")
	and target_31.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vselinux_state
}

*/
predicate func_32(Variable vselinux_state, ExprStmt target_47, FunctionCall target_32) {
	target_32.getTarget().hasName("security_get_allow_unknown")
	and target_32.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vselinux_state
	and target_32.getParent().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("enforcing_enabled")
	and target_32.getParent().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vselinux_state
	and target_32.getParent().(LogicalOrExpr).getParent().(IfStmt).getThen()=target_47
}

predicate func_33(Parameter vskb_5843, VariableAccess target_33) {
	target_33.getTarget()=vskb_5843
	and target_33.getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_34(Variable verr_5845, UnaryMinusExpr target_34) {
	target_34.getValue()="-22"
	and target_34.getParent().(AssignExpr).getRValue() = target_34
	and target_34.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
}

predicate func_35(RelationalOperation target_50, Function func, GotoStmt target_35) {
	target_35.getName() ="out"
	and target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_50
	and target_35.getEnclosingFunction() = func
}

predicate func_36(Parameter vskb_5843, Variable vnlh_5847, FunctionCall target_36) {
	target_36.getTarget().hasName("nlmsg_hdr")
	and target_36.getArgument(0).(VariableAccess).getTarget()=vskb_5843
	and target_36.getParent().(AssignExpr).getRValue() = target_36
	and target_36.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnlh_5847
}

predicate func_37(Variable verr_5845, Variable vperm_5846, Variable vnlh_5847, Variable vsksec_5848, AssignExpr target_37) {
	target_37.getLValue().(VariableAccess).getTarget()=verr_5845
	and target_37.getRValue().(FunctionCall).getTarget().hasName("selinux_nlmsg_lookup")
	and target_37.getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="sclass"
	and target_37.getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsksec_5848
	and target_37.getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="nlmsg_type"
	and target_37.getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_37.getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vperm_5846
}

predicate func_38(Variable vsksec_5848, PointerFieldAccess target_38) {
	target_38.getTarget().getName()="sclass"
	and target_38.getQualifier().(VariableAccess).getTarget()=vsksec_5848
}

predicate func_39(VariableAccess target_9, Function func, GotoStmt target_39) {
	target_39.getName() ="out"
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_9
	and target_39.getEnclosingFunction() = func
}

predicate func_40(Variable verr_5845, BlockStmt target_40) {
	target_40.getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition() instanceof FunctionCall
	and target_40.getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_40.getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand() instanceof FunctionCall
	and target_40.getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand() instanceof FunctionCall
	and target_40.getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_40.getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_41(Variable verr_5845, EqualityOperation target_52, ExprStmt target_41) {
	target_41.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_41.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_41.getParent().(IfStmt).getCondition()=target_52
}

predicate func_42(Variable verr_5845, BlockStmt target_42) {
	target_42.getStmt(0).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=verr_5845
	and target_42.getStmt(0).(IfStmt).getCondition().(EqualityOperation).getRightOperand().(UnaryMinusExpr).getValue()="-22"
	and target_42.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand() instanceof FunctionCall
	and target_42.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand() instanceof FunctionCall
	and target_42.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_42.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_43(Parameter vskb_5843, Variable verr_5845, IfStmt target_43) {
	target_43.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="len"
	and target_43.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_5843
	and target_43.getCondition().(RelationalOperation).getGreaterOperand().(BitwiseAndExpr).getValue()="16"
	and target_43.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_43.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof UnaryMinusExpr
	and target_43.getThen().(BlockStmt).getStmt(1) instanceof GotoStmt
}

predicate func_44(Variable verr_5845, Variable vperm_5846, ExprStmt target_44) {
	target_44.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_44.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("sock_has_perm")
	and target_44.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("sock *")
	and target_44.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vperm_5846
}

predicate func_45(Variable vnlh_5847, Variable vsksec_5848, ExprStmt target_45) {
	target_45.getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_45.getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="4SELinux: unrecognized netlink message: protocol=%hu nlmsg_type=%hu sclass=%s pid=%d comm=%s\n"
	and target_45.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="sk_protocol"
	and target_45.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("sock *")
	and target_45.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="nlmsg_type"
	and target_45.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnlh_5847
	and target_45.getExpr().(FunctionCall).getArgument(3).(ValueFieldAccess).getTarget().getName()="name"
	and target_45.getExpr().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget().getType() instanceof ArrayType
	and target_45.getExpr().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="sclass"
	and target_45.getExpr().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsksec_5848
	and target_45.getExpr().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(SubExpr).getRightOperand().(Literal).getValue()="1"
	and target_45.getExpr().(FunctionCall).getArgument(4).(FunctionCall).getTarget().hasName("task_pid_nr")
	and target_45.getExpr().(FunctionCall).getArgument(4).(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("get_current")
	and target_45.getExpr().(FunctionCall).getArgument(5).(PointerFieldAccess).getTarget().getName()="comm"
	and target_45.getExpr().(FunctionCall).getArgument(5).(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("get_current")
}

predicate func_47(Variable verr_5845, LogicalOrExpr target_53, ExprStmt target_47) {
	target_47.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_47.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_47.getParent().(IfStmt).getCondition()=target_53
}

predicate func_48(Variable verr_5845, BlockStmt target_48) {
	target_48.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_5845
	and target_48.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof UnaryMinusExpr
	and target_48.getStmt(1) instanceof GotoStmt
}

predicate func_49(Variable verr_5845, EqualityOperation target_49) {
	target_49.getLeftOperand().(VariableAccess).getTarget()=verr_5845
	and target_49.getRightOperand().(UnaryMinusExpr).getValue()="-22"
}

predicate func_50(Parameter vskb_5843, RelationalOperation target_50) {
	 (target_50 instanceof GTExpr or target_50 instanceof LTExpr)
	and target_50.getLesserOperand().(PointerFieldAccess).getTarget().getName()="len"
	and target_50.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_5843
	and target_50.getGreaterOperand().(BitwiseAndExpr).getValue()="16"
}

predicate func_52(Variable verr_5845, EqualityOperation target_52) {
	target_52.getLeftOperand().(VariableAccess).getTarget()=verr_5845
	and target_52.getRightOperand().(UnaryMinusExpr).getValue()="-2"
}

predicate func_53(Function func, LogicalOrExpr target_53) {
	target_53.getLeftOperand().(NotExpr).getOperand() instanceof FunctionCall
	and target_53.getRightOperand() instanceof FunctionCall
	and target_53.getEnclosingFunction() = func
}

from Function func, Parameter vskb_5843, Variable verr_5845, Variable vperm_5846, Variable vnlh_5847, Variable vsksec_5848, Variable v_rs_5859, Variable v__func__, Variable vselinux_state, Initializer target_0, VariableAccess target_1, VariableAccess target_2, VariableAccess target_3, VariableAccess target_4, VariableAccess target_5, VariableAccess target_6, VariableAccess target_7, Literal target_8, VariableAccess target_9, DeclStmt target_10, FunctionCall target_28, PointerFieldAccess target_29, PointerFieldAccess target_30, FunctionCall target_32, VariableAccess target_33, UnaryMinusExpr target_34, GotoStmt target_35, FunctionCall target_36, AssignExpr target_37, PointerFieldAccess target_38, GotoStmt target_39, BlockStmt target_40, ExprStmt target_41, BlockStmt target_42, IfStmt target_43, ExprStmt target_44, ExprStmt target_45, ExprStmt target_47, BlockStmt target_48, EqualityOperation target_49, RelationalOperation target_50, EqualityOperation target_52, LogicalOrExpr target_53
where
func_0(func, target_0)
and func_1(verr_5845, target_40, target_1)
and func_2(verr_5845, target_2)
and func_3(verr_5845, target_41, target_3)
and func_4(verr_5845, target_4)
and func_5(verr_5845, vperm_5846, target_5)
and func_6(verr_5845, target_6)
and func_7(verr_5845, target_7)
and func_8(func, target_8)
and func_9(verr_5845, target_42, target_9)
and func_10(func, target_10)
and not func_11(vperm_5846, vnlh_5847, target_43, target_10, target_44, target_45, func)
and not func_27(target_43, func)
and func_28(v_rs_5859, v__func__, target_45, target_28)
and func_29(vskb_5843, target_48, target_29)
and func_30(vperm_5846, vnlh_5847, vsksec_5848, target_30)
and func_32(vselinux_state, target_47, target_32)
and func_33(vskb_5843, target_33)
and func_34(verr_5845, target_34)
and func_35(target_50, func, target_35)
and func_36(vskb_5843, vnlh_5847, target_36)
and func_37(verr_5845, vperm_5846, vnlh_5847, vsksec_5848, target_37)
and func_38(vsksec_5848, target_38)
and func_39(target_9, func, target_39)
and func_40(verr_5845, target_40)
and func_41(verr_5845, target_52, target_41)
and func_42(verr_5845, target_42)
and func_43(vskb_5843, verr_5845, target_43)
and func_44(verr_5845, vperm_5846, target_44)
and func_45(vnlh_5847, vsksec_5848, target_45)
and func_47(verr_5845, target_53, target_47)
and func_48(verr_5845, target_48)
and func_49(verr_5845, target_49)
and func_50(vskb_5843, target_50)
and func_52(verr_5845, target_52)
and func_53(func, target_53)
and vskb_5843.getType().hasName("sk_buff *")
and verr_5845.getType().hasName("int")
and vperm_5846.getType().hasName("u32")
and vnlh_5847.getType().hasName("nlmsghdr *")
and vsksec_5848.getType().hasName("sk_security_struct *")
and v_rs_5859.getType().hasName("ratelimit_state")
and v__func__.getType() instanceof ArrayType
and vselinux_state.getType().hasName("selinux_state")
and vskb_5843.getFunction() = func
and verr_5845.(LocalVariable).getFunction() = func
and vperm_5846.(LocalVariable).getFunction() = func
and vnlh_5847.(LocalVariable).getFunction() = func
and vsksec_5848.(LocalVariable).getFunction() = func
and v_rs_5859.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
and not vselinux_state.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
