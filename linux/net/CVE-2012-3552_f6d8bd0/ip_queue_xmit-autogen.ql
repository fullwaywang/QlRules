/**
 * @name linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-ip_queue_xmit
 * @id cpp/linux/f6d8bd051c391c1c0458a30b2a7abcd939329259/ip-queue-xmit
 * @description linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-net/ipv4/ip_output.c-ip_queue_xmit CVE-2012-3552
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vinet_318, Initializer target_0) {
	target_0.getExpr().(PointerFieldAccess).getTarget().getName()="opt"
	and target_0.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
}

predicate func_2(ExprStmt target_39, Function func) {
exists(ExprStmt target_2 |
	target_2.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_2.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_2.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(DoStmt).getCondition() instanceof Literal
	and target_2.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(VariableAccess).getType().hasName("ip_options_rcu *")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_2
	and target_2.getLocation().isBefore(target_39.getLocation()))
}

predicate func_3(Variable vinet_318, ExprStmt target_40) {
exists(PointerDereferenceExpr target_3 |
	target_3.getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="inet_opt"
	and target_3.getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
	and target_3.getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_40.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_4(LogicalAndExpr target_41, Function func) {
exists(DoStmt target_4 |
	target_4.getCondition() instanceof Literal
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(LogicalOrExpr).getRightOperand() instanceof Literal
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("bool")
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_dereference")
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
	and target_4.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_4.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_4
	and target_4.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_41
	and target_4.getEnclosingFunction() = func)
}

*/
/*predicate func_5(Function func) {
exists(FunctionCall target_5 |
	target_5.getTarget().hasName("debug_lockdep_rcu_enabled")
	and target_5.getEnclosingFunction() = func)
}

*/
/*predicate func_6(Function func) {
exists(NotExpr target_6 |
	target_6.getOperand().(VariableAccess).getType().hasName("bool")
	and target_6.getEnclosingFunction() = func)
}

*/
/*predicate func_7(Variable vopt_319, ExprStmt target_42) {
exists(NotExpr target_7 |
	target_7.getOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
	and target_7.getOperand().(LogicalOrExpr).getRightOperand() instanceof Literal
	and target_7.getParent().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=vopt_319
	and target_7.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="srr"
	and target_7.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_7.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_42)
}

*/
/*predicate func_8(Function func) {
exists(AssignExpr target_8 |
	target_8.getLValue().(VariableAccess).getType().hasName("bool")
	and target_8.getEnclosingFunction() = func)
}

*/
/*predicate func_9(Function func) {
exists(FunctionCall target_9 |
	target_9.getTarget().hasName("lockdep_rcu_dereference")
	and target_9.getArgument(0) instanceof StringLiteral
	and target_9.getArgument(1) instanceof Literal
	and target_9.getEnclosingFunction() = func)
}

*/
/*predicate func_10(LogicalAndExpr target_41, Function func) {
exists(EmptyStmt target_10 |
	target_10.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_10
	and target_10.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_41
	and target_10.getEnclosingFunction() = func)
}

*/
/*predicate func_11(LogicalAndExpr target_41, Function func) {
exists(DoStmt target_11 |
	target_11.getCondition() instanceof Literal
	and target_11.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_11
	and target_11.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_41
	and target_11.getEnclosingFunction() = func)
}

*/
/*predicate func_12(LogicalAndExpr target_41, Function func) {
exists(ExprStmt target_12 |
	target_12.getExpr().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(4)=target_12
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_41
	and target_12.getEnclosingFunction() = func)
}

*/
predicate func_14(Function func) {
exists(ValueFieldAccess target_14 |
	target_14.getTarget().getName()="srr"
	and target_14.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_14.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_14.getEnclosingFunction() = func)
}

predicate func_15(Function func) {
exists(ValueFieldAccess target_15 |
	target_15.getTarget().getName()="faddr"
	and target_15.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_15.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_15.getEnclosingFunction() = func)
}

predicate func_16(IfStmt target_43, Function func) {
exists(IfStmt target_16 |
	target_16.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_16.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(ValueFieldAccess).getTarget().getName()="is_strictroute"
	and target_16.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_16.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_16.getCondition().(LogicalAndExpr).getRightOperand() instanceof EqualityOperation
	and target_16.getThen().(GotoStmt).getName() ="no_route"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
	and target_16.getLocation().isBefore(target_43.getLocation()))
}

/*predicate func_17(Variable vopt_319, BlockStmt target_44) {
exists(LogicalAndExpr target_17 |
	target_17.getLeftOperand().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_17.getRightOperand().(ValueFieldAccess).getTarget().getName()="is_strictroute"
	and target_17.getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_17.getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_17.getParent().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=vopt_319
	and target_17.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_17.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_17.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_44)
}

*/
predicate func_19(Function func) {
exists(ValueFieldAccess target_19 |
	target_19.getTarget().getName()="optlen"
	and target_19.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_19.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_19.getEnclosingFunction() = func)
}

predicate func_20(BlockStmt target_44, Function func) {
exists(LogicalAndExpr target_20 |
	target_20.getLeftOperand().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_20.getRightOperand().(ValueFieldAccess).getTarget().getName()="optlen"
	and target_20.getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_20.getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_20.getParent().(IfStmt).getThen()=target_44
	and target_20.getEnclosingFunction() = func)
}

predicate func_21(Variable viph_321, LogicalAndExpr target_41, ExprStmt target_45, ExprStmt target_46) {
exists(ExprStmt target_21 |
	target_21.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ihl"
	and target_21.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=viph_321
	and target_21.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="optlen"
	and target_21.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_21.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_21.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="2"
	and target_21.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_21
	and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_41
	and target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_21.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_21.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_46.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

/*predicate func_22(Function func) {
exists(ValueFieldAccess target_22 |
	target_22.getTarget().getName()="optlen"
	and target_22.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_22.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_22.getEnclosingFunction() = func)
}

*/
predicate func_23(Parameter vskb_315, Variable vinet_318, Variable vrt_320, LogicalAndExpr target_41, LogicalAndExpr target_47, SubExpr target_48, ExprStmt target_49, ExprStmt target_45, AddressOfExpr target_50) {
exists(ExprStmt target_23 |
	target_23.getExpr().(FunctionCall).getTarget().hasName("ip_options_build")
	and target_23.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_315
	and target_23.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="opt"
	and target_23.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_23.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="skc_daddr"
	and target_23.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
	and target_23.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
	and target_23.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
	and target_23.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrt_320
	and target_23.getExpr().(FunctionCall).getArgument(4).(Literal).getValue()="0"
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_23
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_41
	and target_47.getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_23.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_23.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_48.getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_23.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_45.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_23.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
	and target_23.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_50.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_24(Parameter vskb_315, Variable vinet_318, Variable vopt_319, Variable vrt_320) {
exists(AddressOfExpr target_24 |
	target_24.getOperand().(PointerFieldAccess).getTarget().getName()="opt"
	and target_24.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ip_options_build")
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_315
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vopt_319
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="skc_daddr"
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrt_320
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(Literal).getValue()="0")
}

*/
predicate func_25(Variable vopt_319, Variable vrt_320, EqualityOperation target_25) {
	target_25.getLeftOperand().(PointerFieldAccess).getTarget().getName()="rt_dst"
	and target_25.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
	and target_25.getRightOperand().(PointerFieldAccess).getTarget().getName()="rt_gateway"
	and target_25.getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
	and target_25.getParent().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=vopt_319
	and target_25.getParent().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="is_strictroute"
	and target_25.getParent().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_25.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_26(Variable vinet_318, VariableAccess target_26) {
	target_26.getTarget()=vinet_318
}

predicate func_28(Variable vopt_319, ExprStmt target_42, VariableAccess target_28) {
	target_28.getTarget()=vopt_319
	and target_28.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="srr"
	and target_28.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_28.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_42
}

/*predicate func_29(Variable vopt_319, PointerFieldAccess target_29) {
	target_29.getTarget().getName()="srr"
	and target_29.getQualifier().(VariableAccess).getTarget()=vopt_319
}

*/
predicate func_30(Variable vopt_319, PointerFieldAccess target_30) {
	target_30.getTarget().getName()="faddr"
	and target_30.getQualifier().(VariableAccess).getTarget()=vopt_319
}

predicate func_31(Variable vopt_319, ExprStmt target_42, VariableAccess target_31) {
	target_31.getTarget()=vopt_319
	and target_42.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_31.getLocation())
}

predicate func_32(Variable vopt_319, PointerFieldAccess target_32) {
	target_32.getTarget().getName()="is_strictroute"
	and target_32.getQualifier().(VariableAccess).getTarget()=vopt_319
}

predicate func_33(Variable vopt_319, LogicalAndExpr target_52, VariableAccess target_33) {
	target_33.getTarget()=vopt_319
	and target_52.getLeftOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_33.getLocation())
}

predicate func_34(Variable vopt_319, LogicalAndExpr target_41, PointerFieldAccess target_34) {
	target_34.getTarget().getName()="optlen"
	and target_34.getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_34.getQualifier().(VariableAccess).getLocation().isBefore(target_41.getLeftOperand().(VariableAccess).getLocation())
}

predicate func_35(Variable vopt_319, BlockStmt target_44, AddExpr target_53, VariableAccess target_35) {
	target_35.getTarget()=vopt_319
	and target_35.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_35.getParent().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_35.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_44
	and target_53.getRightOperand().(ConditionalExpr).getCondition().(VariableAccess).getLocation().isBefore(target_35.getLocation())
}

/*predicate func_36(Variable vopt_319, ExprStmt target_54, PointerFieldAccess target_36) {
	target_36.getTarget().getName()="optlen"
	and target_36.getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_36.getQualifier().(VariableAccess).getLocation().isBefore(target_54.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
predicate func_37(Variable vopt_319, LogicalAndExpr target_41, ExprStmt target_55, PointerFieldAccess target_37) {
	target_37.getTarget().getName()="optlen"
	and target_37.getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_41.getLeftOperand().(VariableAccess).getLocation().isBefore(target_37.getQualifier().(VariableAccess).getLocation())
	and target_37.getQualifier().(VariableAccess).getLocation().isBefore(target_55.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
}

predicate func_38(Parameter vskb_315, Variable vinet_318, Variable vopt_319, Variable vrt_320, LogicalAndExpr target_47, SubExpr target_48, ExprStmt target_49, ExprStmt target_54, ExprStmt target_45, AddressOfExpr target_50, VariableAccess target_38) {
	target_38.getTarget()=vopt_319
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ip_options_build")
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_315
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="skc_daddr"
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrt_320
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(Literal).getValue()="0"
	and target_47.getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_48.getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_54.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_38.getLocation())
	and target_45.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
	and target_38.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_50.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_39(Parameter vskb_315, Variable vrt_320, ExprStmt target_39) {
	target_39.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vrt_320
	and target_39.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_rtable")
	and target_39.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_315
}

predicate func_40(Variable vinet_318, ExprStmt target_40) {
	target_40.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("__be32")
	and target_40.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="skc_daddr"
	and target_40.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
	and target_40.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
	and target_40.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
}

predicate func_41(Variable vopt_319, LogicalAndExpr target_41) {
	target_41.getLeftOperand().(VariableAccess).getTarget()=vopt_319
	and target_41.getRightOperand().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_41.getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
}

predicate func_42(Variable vopt_319, ExprStmt target_42) {
	target_42.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("__be32")
	and target_42.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="faddr"
	and target_42.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
}

predicate func_43(Variable vopt_319, IfStmt target_43) {
	target_43.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=vopt_319
	and target_43.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="is_strictroute"
	and target_43.getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_43.getCondition().(LogicalAndExpr).getRightOperand() instanceof EqualityOperation
	and target_43.getThen().(GotoStmt).getName() ="no_route"
}

predicate func_44(Variable vopt_319, Variable viph_321, BlockStmt target_44) {
	target_44.getStmt(0).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ihl"
	and target_44.getStmt(0).(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=viph_321
	and target_44.getStmt(0).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_44.getStmt(0).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_44.getStmt(0).(ExprStmt).getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="2"
}

predicate func_45(Variable vrt_320, Variable viph_321, ExprStmt target_45) {
	target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="daddr"
	and target_45.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=viph_321
	and target_45.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="rt_dst"
	and target_45.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
}

predicate func_46(Variable vrt_320, Variable viph_321, ExprStmt target_46) {
	target_46.getExpr().(FunctionCall).getTarget().hasName("ip_select_ident_more")
	and target_46.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=viph_321
	and target_46.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="dst"
	and target_46.getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
	and target_46.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget().getType().hasName("sock *")
	and target_46.getExpr().(FunctionCall).getArgument(3).(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="gso_segs"
	and target_46.getExpr().(FunctionCall).getArgument(3).(SubExpr).getLeftOperand().(ConditionalExpr).getElse().(Literal).getValue()="1"
	and target_46.getExpr().(FunctionCall).getArgument(3).(SubExpr).getRightOperand().(Literal).getValue()="1"
}

predicate func_47(Parameter vskb_315, Variable vrt_320, LogicalAndExpr target_47) {
	target_47.getLeftOperand().(FunctionCall).getTarget().hasName("ip_dont_fragment")
	and target_47.getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("sock *")
	and target_47.getLeftOperand().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="dst"
	and target_47.getLeftOperand().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
	and target_47.getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getTarget().getName()="local_df"
	and target_47.getRightOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_315
}

predicate func_48(Parameter vskb_315, SubExpr target_48) {
	target_48.getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="gso_segs"
	and target_48.getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("skb_end_pointer")
	and target_48.getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_315
	and target_48.getLeftOperand().(ConditionalExpr).getElse().(Literal).getValue()="1"
	and target_48.getRightOperand().(Literal).getValue()="1"
}

predicate func_49(Variable vinet_318, Variable vrt_320, Variable viph_321, ExprStmt target_49) {
	target_49.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ttl"
	and target_49.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=viph_321
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("ip_select_ttl")
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vinet_318
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="dst"
	and target_49.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
}

predicate func_50(Variable vrt_320, Variable viph_321, AddressOfExpr target_50) {
	target_50.getOperand().(PointerFieldAccess).getTarget().getName()="dst"
	and target_50.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vrt_320
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ip_select_ident_more")
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=viph_321
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget().getType().hasName("sock *")
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="gso_segs"
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(SubExpr).getLeftOperand().(ConditionalExpr).getElse().(Literal).getValue()="1"
	and target_50.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(SubExpr).getRightOperand().(Literal).getValue()="1"
}

predicate func_52(Variable vopt_319, LogicalAndExpr target_52) {
	target_52.getLeftOperand().(LogicalAndExpr).getLeftOperand().(VariableAccess).getTarget()=vopt_319
	and target_52.getLeftOperand().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="is_strictroute"
	and target_52.getLeftOperand().(LogicalAndExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_52.getRightOperand() instanceof EqualityOperation
}

predicate func_53(Variable vopt_319, AddExpr target_53) {
	target_53.getLeftOperand().(SizeofTypeOperator).getType() instanceof LongType
	and target_53.getLeftOperand().(SizeofTypeOperator).getValue()="20"
	and target_53.getRightOperand().(ConditionalExpr).getCondition().(VariableAccess).getTarget()=vopt_319
	and target_53.getRightOperand().(ConditionalExpr).getThen().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_53.getRightOperand().(ConditionalExpr).getThen().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_53.getRightOperand().(ConditionalExpr).getElse().(Literal).getValue()="0"
}

predicate func_54(Variable vopt_319, Variable viph_321, ExprStmt target_54) {
	target_54.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ihl"
	and target_54.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=viph_321
	and target_54.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_54.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_319
	and target_54.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="2"
}

predicate func_55(Parameter vskb_315, Variable vinet_318, Variable vopt_319, Variable vrt_320, ExprStmt target_55) {
	target_55.getExpr().(FunctionCall).getTarget().hasName("ip_options_build")
	and target_55.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_315
	and target_55.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vopt_319
	and target_55.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="skc_daddr"
	and target_55.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
	and target_55.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
	and target_55.getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_318
	and target_55.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vrt_320
	and target_55.getExpr().(FunctionCall).getArgument(4).(Literal).getValue()="0"
}

from Function func, Parameter vskb_315, Variable vinet_318, Variable vopt_319, Variable vrt_320, Variable viph_321, Initializer target_0, EqualityOperation target_25, VariableAccess target_26, VariableAccess target_28, PointerFieldAccess target_30, VariableAccess target_31, PointerFieldAccess target_32, VariableAccess target_33, PointerFieldAccess target_34, VariableAccess target_35, PointerFieldAccess target_37, VariableAccess target_38, ExprStmt target_39, ExprStmt target_40, LogicalAndExpr target_41, ExprStmt target_42, IfStmt target_43, BlockStmt target_44, ExprStmt target_45, ExprStmt target_46, LogicalAndExpr target_47, SubExpr target_48, ExprStmt target_49, AddressOfExpr target_50, LogicalAndExpr target_52, AddExpr target_53, ExprStmt target_54, ExprStmt target_55
where
func_0(vinet_318, target_0)
and not func_2(target_39, func)
and not func_3(vinet_318, target_40)
and not func_14(func)
and not func_15(func)
and not func_16(target_43, func)
and not func_19(func)
and not func_20(target_44, func)
and not func_21(viph_321, target_41, target_45, target_46)
and not func_23(vskb_315, vinet_318, vrt_320, target_41, target_47, target_48, target_49, target_45, target_50)
and func_25(vopt_319, vrt_320, target_25)
and func_26(vinet_318, target_26)
and func_28(vopt_319, target_42, target_28)
and func_30(vopt_319, target_30)
and func_31(vopt_319, target_42, target_31)
and func_32(vopt_319, target_32)
and func_33(vopt_319, target_52, target_33)
and func_34(vopt_319, target_41, target_34)
and func_35(vopt_319, target_44, target_53, target_35)
and func_37(vopt_319, target_41, target_55, target_37)
and func_38(vskb_315, vinet_318, vopt_319, vrt_320, target_47, target_48, target_49, target_54, target_45, target_50, target_38)
and func_39(vskb_315, vrt_320, target_39)
and func_40(vinet_318, target_40)
and func_41(vopt_319, target_41)
and func_42(vopt_319, target_42)
and func_43(vopt_319, target_43)
and func_44(vopt_319, viph_321, target_44)
and func_45(vrt_320, viph_321, target_45)
and func_46(vrt_320, viph_321, target_46)
and func_47(vskb_315, vrt_320, target_47)
and func_48(vskb_315, target_48)
and func_49(vinet_318, vrt_320, viph_321, target_49)
and func_50(vrt_320, viph_321, target_50)
and func_52(vopt_319, target_52)
and func_53(vopt_319, target_53)
and func_54(vopt_319, viph_321, target_54)
and func_55(vskb_315, vinet_318, vopt_319, vrt_320, target_55)
and vskb_315.getType().hasName("sk_buff *")
and vinet_318.getType().hasName("inet_sock *")
and vopt_319.getType().hasName("ip_options *")
and vrt_320.getType().hasName("rtable *")
and viph_321.getType().hasName("iphdr *")
and vskb_315.getFunction() = func
and vinet_318.(LocalVariable).getFunction() = func
and vopt_319.(LocalVariable).getFunction() = func
and vrt_320.(LocalVariable).getFunction() = func
and viph_321.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
