/**
 * @name linux-05cb7c41fa1a7a7b2c2a6b81bbe7c67f5c11932b-mana_get_rxbuf_cfg
 * @id cpp/linux/05cb7c41fa1a7a7b2c2a6b81bbe7c67f5c11932b/mana-get-rxbuf-cfg
 * @description linux-05cb7c41fa1a7a7b2c2a6b81bbe7c67f5c11932b-drivers/net/ethernet/microsoft/mana/mana_en.c-mana_get_rxbuf_cfg CVE-2024-35901
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vmtu_594, AddExpr target_0) {
	target_0.getLeftOperand().(VariableAccess).getTarget()=vmtu_594
	and target_0.getRightOperand().(Literal).getValue()="14"
}

predicate func_1(Function func, BitwiseAndExpr target_1) {
	target_1.getLeftOperand().(AddExpr).getLeftOperand() instanceof AddExpr
	and target_1.getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getValue()="63"
	and target_1.getRightOperand().(ComplementExpr).getValue()="-64"
	and target_1.getParent().(AssignExpr).getRValue() = target_1
	and target_1.getParent().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget().getType().hasName("u32 *")
	and target_1.getEnclosingFunction() = func
}

from Function func, Parameter vmtu_594, AddExpr target_0, BitwiseAndExpr target_1
where
func_0(vmtu_594, target_0)
and func_1(func, target_1)
and vmtu_594.getType().hasName("int")
and vmtu_594.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
