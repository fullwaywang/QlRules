/**
 * @name linux-880a3a5325489a143269a8e172e7563ebf9897bc-nfsd4_decode_bind_conn_to_session
 * @id cpp/linux/880a3a5325489a143269a8e172e7563ebf9897bc/nfsd4-decode-bind-conn-to-session
 * @description linux-880a3a5325489a143269a8e172e7563ebf9897bc-fs/nfsd/nfs4xdr.c-nfsd4_decode_bind_conn_to_session CVE-2020-35513
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
		target_0.getValue()="619"
		and not target_0.getValue()="618"
		and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("printk")
		and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="dNFSD: xdr error (%s:%d)\n"
		and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="fs/nfsd/nfs4xdr.c"
		and target_0.getEnclosingFunction() = func
}

from Function func, Literal target_0
where
func_0(func, target_0)
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
