commit c4d2f15b8f97076c8fd0f9aa5814b94db698b75c	c4d2f15b8f97076c8fd0f9aa5814b94db698b75c
Author: Paul Semel <paulsemel@chromium.org>
Date:   Wed Nov 29 14:23:04 2023 +0000

    ImageBitmapFactory: fix empty context dcheck
    
    Fixed: 1502102
    Change-Id: Ib42d2897d62136ae835561bcf56884b5624060a5
    Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/5071252
    Commit-Queue: Paul Semel <paulsemel@chromium.org>
    Reviewed-by: Jean-Philippe Gravel <jpgravel@chromium.org>
    Cr-Commit-Position: refs/heads/main@{#1230617}

diff --git a/third_party/blink/renderer/modules/canvas/imagebitmap/image_bitmap_factories.cc b/third_party/blink/renderer/modules/canvas/imagebitmap/image_bitmap_factories.cc
index 8ddc44f56414e..665217c106710 100644
--- a/third_party/blink/renderer/modules/canvas/imagebitmap/image_bitmap_factories.cc
+++ b/third_party/blink/renderer/modules/canvas/imagebitmap/image_bitmap_factories.cc
@@ -155,7 +155,9 @@ ScriptPromise ImageBitmapFactories::CreateImageBitmapFromBlob(
     ImageBitmapSource* bitmap_source,
     absl::optional<gfx::Rect> crop_rect,
     const ImageBitmapOptions* options) {
-  DCHECK(script_state->ContextIsValid());
+  if (!script_state->ContextIsValid()) {
+    return ScriptPromise();
+  }
 
   // imageOrientation: 'from-image' will be used to replace imageOrientation:
   // 'none'. Adding a deprecation warning when 'none' is called in
