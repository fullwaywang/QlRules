/**
 * @name linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-do_ip_setsockopt
 * @id cpp/linux/f6d8bd051c391c1c0458a30b2a7abcd939329259/do-ip-setsockopt
 * @description linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-net/ipv4/ip_sockglue.c-do_ip_setsockopt CVE-2012-3552
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(Function func, Literal target_1) {
	target_1.getValue()="1"
	and not target_1.getValue()="0"
	and target_1.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(0) instanceof SwitchCase
	and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, Literal target_2) {
	target_2.getValue()="2"
	and not target_2.getValue()="514"
	and target_2.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(2) instanceof SwitchCase
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
	target_3.getValue()="4"
	and not target_3.getValue()="0"
	and target_3.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(4) instanceof SwitchCase
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, FunctionCall target_4) {
	target_4.getTarget().hasName("__xchg_wrong_size")
	and not target_4.getTarget().hasName("lockdep_rcu_dereference")
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Variable vopt_500, FunctionCall target_5) {
	target_5.getTarget().hasName("kfree")
	and not target_5.getTarget().hasName("call_rcu_sched")
	and target_5.getArgument(0).(VariableAccess).getTarget()=vopt_500
}

predicate func_26(IfStmt target_77, Function func, ExprStmt target_26) {
	target_26.getExpr() instanceof AssignExpr
	and target_77.getLocation().isBefore(target_26.getLocation())
	and target_26.getEnclosingFunction() = func
}

predicate func_28(Variable vinet_462, ExprStmt target_78) {
exists(AssignExpr target_28 |
	target_28.getLValue().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_28.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_28.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getTarget().getName()="inet_opt"
	and target_28.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_28.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_78.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_29(Function func) {
exists(DoStmt target_29 |
	target_29.getCondition() instanceof Literal
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getLeftOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getLeftOperand().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="owned"
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_lock"
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("bool")
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_dereference")
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
	and target_29.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_29.getFollowingStmt() instanceof DeclStmt
	and target_29.getEnclosingFunction() = func)
}

*/
/*predicate func_31(Parameter vsk_459, BlockStmt target_79, FunctionCall target_80, LogicalOrExpr target_45) {
exists(LogicalAndExpr target_31 |
	target_31.getLeftOperand().(LogicalAndExpr).getLeftOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
	and target_31.getLeftOperand().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
	and target_31.getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="owned"
	and target_31.getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_lock"
	and target_31.getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_459
	and target_31.getParent().(IfStmt).getThen()=target_79
	and target_80.getArgument(0).(VariableAccess).getLocation().isBefore(target_31.getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_31.getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_45.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_32(Function func) {
exists(AssignExpr target_32 |
	target_32.getLValue().(VariableAccess).getType().hasName("bool")
	and target_32.getEnclosingFunction() = func)
}

*/
/*predicate func_33(Function func) {
exists(EmptyStmt target_33 |
	target_33.getFollowingStmt() instanceof DeclStmt
	and target_33.getEnclosingFunction() = func)
}

*/
/*predicate func_34(Variable vinet_462, ExprStmt target_78) {
exists(ExprStmt target_34 |
	target_34.getExpr().(PointerFieldAccess).getTarget().getName()="inet_opt"
	and target_34.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_34.getFollowingStmt() instanceof DeclStmt
	and target_34.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_78.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_36(Function func) {
exists(ValueFieldAccess target_36 |
	target_36.getTarget().getName()="optlen"
	and target_36.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_36.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_36.getEnclosingFunction() = func)
}

predicate func_37(Variable vopt_500, Variable vicsk_508, LogicalOrExpr target_45, AddressOfExpr target_81, ExprStmt target_82, ExprStmt target_78, ExprStmt target_83) {
exists(IfStmt target_37 |
	target_37.getCondition().(VariableAccess).getTarget()=vopt_500
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(ValueFieldAccess).getTarget().getName()="optlen"
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_37
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_45
	and target_81.getOperand().(VariableAccess).getLocation().isBefore(target_37.getCondition().(VariableAccess).getLocation())
	and target_37.getCondition().(VariableAccess).getLocation().isBefore(target_82.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_78.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_83.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_38(Variable vopt_500, IfStmt target_84, ExprStmt target_82) {
exists(ValueFieldAccess target_38 |
	target_38.getTarget().getName()="optlen"
	and target_38.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_38.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
	and target_84.getCondition().(VariableAccess).getLocation().isBefore(target_38.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
	and target_38.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_82.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_39(Variable vinet_462, Variable vopt_500) {
exists(StmtExpr target_39 |
	target_39.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("__builtin_constant_p")
	and target_39.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vopt_500
	and target_39.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vopt_500
	and target_39.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_39.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="inet_opt"
	and target_39.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_39.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_500)
}

/*predicate func_40(Variable vopt_500) {
exists(IfStmt target_40 |
	target_40.getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("__builtin_constant_p")
	and target_40.getCondition().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vopt_500
	and target_40.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vopt_500
	and target_40.getCondition().(LogicalOrExpr).getRightOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_40.getFollowingStmt() instanceof DeclStmt)
}

*/
/*predicate func_41(Variable vinet_462, Variable vopt_500) {
exists(ExprStmt target_41 |
	target_41.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="inet_opt"
	and target_41.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_41.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_500
	and target_41.getFollowingStmt() instanceof DeclStmt)
}

*/
predicate func_42(Function func) {
exists(IfStmt target_42 |
	target_42.getCondition().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_42.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("call_rcu_sched")
	and target_42.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
	and target_42.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_42.getFollowingStmt() instanceof BreakStmt
	and target_42.getEnclosingFunction() = func)
}

/*predicate func_43(Function func) {
exists(AddressOfExpr target_43 |
	target_43.getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
	and target_43.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
	and target_43.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_43.getEnclosingFunction() = func)
}

*/
predicate func_45(Parameter vsk_459, Variable vinet_462, BlockStmt target_79, LogicalOrExpr target_45) {
	target_45.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="skc_family"
	and target_45.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
	and target_45.getLeftOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_459
	and target_45.getLeftOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="2"
	and target_45.getRightOperand().(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(Literal).getValue()="1"
	and target_45.getRightOperand().(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="skc_state"
	and target_45.getRightOperand().(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
	and target_45.getRightOperand().(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="1152"
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getTarget().getName()="skc_daddr"
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getLeftOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(ConditionalExpr).getCondition().(Literal).getValue()="1"
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(ConditionalExpr).getThen().(BitwiseOrExpr).getValue()="100663423"
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("__fswab32")
	and target_45.getRightOperand().(LogicalAndExpr).getRightOperand().(EqualityOperation).getRightOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(Literal).getValue()="2130706438"
	and target_45.getParent().(IfStmt).getThen()=target_79
}

predicate func_46(Variable vinet_462, ExprStmt target_78, VariableAccess target_46) {
	target_46.getTarget()=vinet_462
	and target_46.getParent().(PointerFieldAccess).getParent().(IfStmt).getThen()=target_78
}

predicate func_47(Variable vinet_462, VariableAccess target_47) {
	target_47.getTarget()=vinet_462
}

predicate func_50(Variable vinet_462, ExprStmt target_78, PointerFieldAccess target_50) {
	target_50.getTarget().getName()="opt"
	and target_50.getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_50.getQualifier().(VariableAccess).getLocation().isBefore(target_78.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_51(Variable vinet_462, PointerFieldAccess target_51) {
	target_51.getTarget().getName()="optlen"
	and target_51.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_51.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_52(Variable vopt_500, ExprStmt target_82, VariableAccess target_52) {
	target_52.getTarget()=vopt_500
	and target_52.getParent().(IfStmt).getThen()=target_82
}

predicate func_53(Variable vopt_500, PointerFieldAccess target_53) {
	target_53.getTarget().getName()="optlen"
	and target_53.getQualifier().(VariableAccess).getTarget()=vopt_500
}

predicate func_54(Variable vopt_500, Variable v__x_524, AssignExpr target_54) {
	target_54.getLValue().(VariableAccess).getTarget()=vopt_500
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getExpr().(SizeofExprOperator).getValue()="8"
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr() instanceof Literal
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof Literal
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(2) instanceof BreakStmt
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="8"
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(8).(SwitchCase).toString() = "default: "
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr() instanceof FunctionCall
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2) instanceof LabelStmt
	and target_54.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__x_524
}

/*predicate func_56(Variable v__x_524, Variable v__ptr_524, Variable v__ptr_1_524, Variable v__ptr_2_524, Variable v__ptr_3_524, SwitchStmt target_56) {
	target_56.getExpr().(SizeofExprOperator).getValue()="8"
	and target_56.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
	and target_56.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_524
	and target_56.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr() instanceof Literal
	and target_56.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1_524
	and target_56.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof Literal
	and target_56.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_2_524
	and target_56.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(2) instanceof BreakStmt
	and target_56.getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="8"
	and target_56.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_3_524
	and target_56.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
	and target_56.getStmt().(BlockStmt).getStmt(8).(SwitchCase).toString() = "default: "
	and target_56.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr() instanceof FunctionCall
}

*/
/*predicate func_57(Function func, SwitchCase target_57) {
	target_57.getExpr() instanceof Literal
	and target_57.getEnclosingFunction() = func
}

*/
/*predicate func_59(Variable v__x_524, VariableAccess target_59) {
	target_59.getTarget()=v__x_524
}

*/
/*predicate func_60(Variable v__ptr_524, PointerDereferenceExpr target_60) {
	target_60.getOperand().(VariableAccess).getTarget()=v__ptr_524
}

*/
/*predicate func_61(Variable v__x_524, VariableAccess target_61) {
	target_61.getTarget()=v__x_524
}

*/
/*predicate func_63(Function func, SwitchCase target_63) {
	target_63.getExpr() instanceof Literal
	and target_63.getEnclosingFunction() = func
}

*/
/*predicate func_65(Variable v__x_524, Variable v__ptr_1_524, AsmStmt target_65) {
	target_65.getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_65.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1_524
	and target_65.getChild(2).(VariableAccess).getTarget()=v__x_524
}

*/
/*predicate func_67(Function func, SwitchCase target_67) {
	target_67.getExpr() instanceof Literal
	and target_67.getEnclosingFunction() = func
}

*/
/*predicate func_69(Variable v__x_524, Variable v__ptr_2_524, AsmStmt target_69) {
	target_69.getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_69.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_2_524
	and target_69.getChild(2).(VariableAccess).getTarget()=v__x_524
}

*/
/*predicate func_70(Function func, SwitchCase target_70) {
	target_70.getExpr().(Literal).getValue()="8"
	and target_70.getEnclosingFunction() = func
}

*/
/*predicate func_72(Variable v__x_524, Variable v__ptr_3_524, AsmStmt target_72) {
	target_72.getChild(0).(VariableAccess).getTarget()=v__x_524
	and target_72.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_3_524
	and target_72.getChild(2).(VariableAccess).getTarget()=v__x_524
}

*/
/*predicate func_74(Function func, SwitchCase target_74) {
	target_74.toString() = "default: "
	and target_74.getEnclosingFunction() = func
}

*/
/*predicate func_75(Variable v__x_524, VariableAccess target_75) {
	target_75.getTarget()=v__x_524
}

*/
predicate func_76(VariableAccess target_89, Function func, BreakStmt target_76) {
	target_76.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_89
	and target_76.getEnclosingFunction() = func
}

predicate func_77(Parameter vsk_459, Variable vinet_462, Variable vopt_500, IfStmt target_77) {
	target_77.getCondition().(PointerFieldAccess).getTarget().getName()="is_icsk"
	and target_77.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition() instanceof LogicalOrExpr
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="opt"
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getTarget()=vopt_500
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="icsk_sync_mss"
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vsk_459
	and target_77.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="icsk_pmtu_cookie"
}

predicate func_78(Variable vinet_462, Variable vicsk_508, ExprStmt target_78) {
	target_78.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
	and target_78.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
	and target_78.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_78.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_78.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_79(Variable vinet_462, Variable vicsk_508, BlockStmt target_79) {
	target_79.getStmt(0).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="opt"
	and target_79.getStmt(0).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
	and target_79.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
	and target_79.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
	and target_79.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_79.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
	and target_79.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_80(Parameter vsk_459, FunctionCall target_80) {
	target_80.getTarget().hasName("inet_csk")
	and target_80.getArgument(0).(VariableAccess).getTarget()=vsk_459
}

predicate func_81(Variable vopt_500, AddressOfExpr target_81) {
	target_81.getOperand().(VariableAccess).getTarget()=vopt_500
}

predicate func_82(Variable vopt_500, Variable vicsk_508, ExprStmt target_82) {
	target_82.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
	and target_82.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
	and target_82.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_82.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
}

predicate func_83(Parameter vsk_459, Variable vicsk_508, ExprStmt target_83) {
	target_83.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="icsk_sync_mss"
	and target_83.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
	and target_83.getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vsk_459
	and target_83.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="icsk_pmtu_cookie"
	and target_83.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
}

predicate func_84(Variable vopt_500, Variable vicsk_508, IfStmt target_84) {
	target_84.getCondition().(VariableAccess).getTarget()=vopt_500
	and target_84.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
	and target_84.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
	and target_84.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
	and target_84.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
}

predicate func_89(Parameter voptname_460, VariableAccess target_89) {
	target_89.getTarget()=voptname_460
}

from Function func, Parameter vsk_459, Parameter voptname_460, Variable vinet_462, Variable vopt_500, Variable vicsk_508, Variable v__x_524, Variable v__ptr_524, Variable v__ptr_1_524, Variable v__ptr_2_524, Variable v__ptr_3_524, Literal target_1, Literal target_2, Literal target_3, FunctionCall target_4, FunctionCall target_5, ExprStmt target_26, LogicalOrExpr target_45, VariableAccess target_46, VariableAccess target_47, PointerFieldAccess target_50, PointerFieldAccess target_51, VariableAccess target_52, PointerFieldAccess target_53, AssignExpr target_54, BreakStmt target_76, IfStmt target_77, ExprStmt target_78, BlockStmt target_79, FunctionCall target_80, AddressOfExpr target_81, ExprStmt target_82, ExprStmt target_83, IfStmt target_84, VariableAccess target_89
where
func_1(func, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(vopt_500, target_5)
and func_26(target_77, func, target_26)
and not func_28(vinet_462, target_78)
and not func_36(func)
and not func_37(vopt_500, vicsk_508, target_45, target_81, target_82, target_78, target_83)
and not func_39(vinet_462, vopt_500)
and not func_42(func)
and func_45(vsk_459, vinet_462, target_79, target_45)
and func_46(vinet_462, target_78, target_46)
and func_47(vinet_462, target_47)
and func_50(vinet_462, target_78, target_50)
and func_51(vinet_462, target_51)
and func_52(vopt_500, target_82, target_52)
and func_53(vopt_500, target_53)
and func_54(vopt_500, v__x_524, target_54)
and func_76(target_89, func, target_76)
and func_77(vsk_459, vinet_462, vopt_500, target_77)
and func_78(vinet_462, vicsk_508, target_78)
and func_79(vinet_462, vicsk_508, target_79)
and func_80(vsk_459, target_80)
and func_81(vopt_500, target_81)
and func_82(vopt_500, vicsk_508, target_82)
and func_83(vsk_459, vicsk_508, target_83)
and func_84(vopt_500, vicsk_508, target_84)
and func_89(voptname_460, target_89)
and vsk_459.getType().hasName("sock *")
and voptname_460.getType().hasName("int")
and vinet_462.getType().hasName("inet_sock *")
and vopt_500.getType().hasName("ip_options *")
and vicsk_508.getType().hasName("inet_connection_sock *")
and v__x_524.getType().hasName("ip_options *")
and v__ptr_524.getType().hasName("volatile u8 *")
and v__ptr_1_524.getType().hasName("volatile u16 *")
and v__ptr_2_524.getType().hasName("volatile u32 *")
and v__ptr_3_524.getType().hasName("volatile u64 *")
and vsk_459.getFunction() = func
and voptname_460.getFunction() = func
and vinet_462.(LocalVariable).getFunction() = func
and vopt_500.(LocalVariable).getFunction() = func
and vicsk_508.(LocalVariable).getFunction() = func
and v__x_524.(LocalVariable).getFunction() = func
and v__ptr_524.(LocalVariable).getFunction() = func
and v__ptr_1_524.(LocalVariable).getFunction() = func
and v__ptr_2_524.(LocalVariable).getFunction() = func
and v__ptr_3_524.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
