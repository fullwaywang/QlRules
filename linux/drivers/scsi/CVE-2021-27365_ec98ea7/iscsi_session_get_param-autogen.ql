/**
 * @name linux-ec98ea7070e94cc25a422ec97d1421e28d97b7ee-iscsi_session_get_param
 * @id cpp/linux/ec98ea7070e94cc25a422ec97d1421e28d97b7ee/iscsi-session-get-param
 * @description linux-ec98ea7070e94cc25a422ec97d1421e28d97b7ee-drivers/scsi/libiscsi.c-iscsi_session_get_param CVE-2021-27365
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_0) {
	target_0.getTarget().hasName("sprintf")
	and not target_0.getTarget().hasName("sysfs_emit")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_0.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_0.getArgument(2).(PointerFieldAccess).getTarget().getName()="fast_abort"
	and target_0.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_0.getParent().(AssignExpr).getRValue() = target_0
	and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_1(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_1) {
	target_1.getTarget().hasName("sprintf")
	and not target_1.getTarget().hasName("sysfs_emit")
	and target_1.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_1.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_1.getArgument(2).(PointerFieldAccess).getTarget().getName()="abort_timeout"
	and target_1.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_1.getParent().(AssignExpr).getRValue() = target_1
	and target_1.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_2(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_2) {
	target_2.getTarget().hasName("sprintf")
	and not target_2.getTarget().hasName("sysfs_emit")
	and target_2.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_2.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_2.getArgument(2).(PointerFieldAccess).getTarget().getName()="lu_reset_timeout"
	and target_2.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_2.getParent().(AssignExpr).getRValue() = target_2
	and target_2.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_3(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_3) {
	target_3.getTarget().hasName("sprintf")
	and not target_3.getTarget().hasName("sysfs_emit")
	and target_3.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_3.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_3.getArgument(2).(PointerFieldAccess).getTarget().getName()="tgt_reset_timeout"
	and target_3.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_3.getParent().(AssignExpr).getRValue() = target_3
	and target_3.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_4(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_4) {
	target_4.getTarget().hasName("sprintf")
	and not target_4.getTarget().hasName("sysfs_emit")
	and target_4.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_4.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_4.getArgument(2).(PointerFieldAccess).getTarget().getName()="initial_r2t_en"
	and target_4.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_4.getParent().(AssignExpr).getRValue() = target_4
	and target_4.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_5(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_5) {
	target_5.getTarget().hasName("sprintf")
	and not target_5.getTarget().hasName("sysfs_emit")
	and target_5.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_5.getArgument(1).(StringLiteral).getValue()="%hu\n"
	and target_5.getArgument(2).(PointerFieldAccess).getTarget().getName()="max_r2t"
	and target_5.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_5.getParent().(AssignExpr).getRValue() = target_5
	and target_5.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_6(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_6) {
	target_6.getTarget().hasName("sprintf")
	and not target_6.getTarget().hasName("sysfs_emit")
	and target_6.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_6.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_6.getArgument(2).(PointerFieldAccess).getTarget().getName()="imm_data_en"
	and target_6.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_6.getParent().(AssignExpr).getRValue() = target_6
	and target_6.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_7(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_7) {
	target_7.getTarget().hasName("sprintf")
	and not target_7.getTarget().hasName("sysfs_emit")
	and target_7.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_7.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_7.getArgument(2).(PointerFieldAccess).getTarget().getName()="first_burst"
	and target_7.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_7.getParent().(AssignExpr).getRValue() = target_7
	and target_7.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_8(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_8) {
	target_8.getTarget().hasName("sprintf")
	and not target_8.getTarget().hasName("sysfs_emit")
	and target_8.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_8.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_8.getArgument(2).(PointerFieldAccess).getTarget().getName()="max_burst"
	and target_8.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_8.getParent().(AssignExpr).getRValue() = target_8
	and target_8.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_9(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_9) {
	target_9.getTarget().hasName("sprintf")
	and not target_9.getTarget().hasName("sysfs_emit")
	and target_9.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_9.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_9.getArgument(2).(PointerFieldAccess).getTarget().getName()="pdu_inorder_en"
	and target_9.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_9.getParent().(AssignExpr).getRValue() = target_9
	and target_9.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_10(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_10) {
	target_10.getTarget().hasName("sprintf")
	and not target_10.getTarget().hasName("sysfs_emit")
	and target_10.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_10.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_10.getArgument(2).(PointerFieldAccess).getTarget().getName()="dataseq_inorder_en"
	and target_10.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_10.getParent().(AssignExpr).getRValue() = target_10
	and target_10.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_11(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_11) {
	target_11.getTarget().hasName("sprintf")
	and not target_11.getTarget().hasName("sysfs_emit")
	and target_11.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_11.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_11.getArgument(2).(PointerFieldAccess).getTarget().getName()="def_taskmgmt_tmo"
	and target_11.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_11.getParent().(AssignExpr).getRValue() = target_11
	and target_11.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_12(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_12) {
	target_12.getTarget().hasName("sprintf")
	and not target_12.getTarget().hasName("sysfs_emit")
	and target_12.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_12.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_12.getArgument(2).(PointerFieldAccess).getTarget().getName()="erl"
	and target_12.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_12.getParent().(AssignExpr).getRValue() = target_12
	and target_12.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_13(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_13) {
	target_13.getTarget().hasName("sprintf")
	and not target_13.getTarget().hasName("sysfs_emit")
	and target_13.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_13.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_13.getArgument(2).(PointerFieldAccess).getTarget().getName()="targetname"
	and target_13.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_13.getParent().(AssignExpr).getRValue() = target_13
	and target_13.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_14(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_14) {
	target_14.getTarget().hasName("sprintf")
	and not target_14.getTarget().hasName("sysfs_emit")
	and target_14.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_14.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_14.getArgument(2).(PointerFieldAccess).getTarget().getName()="targetalias"
	and target_14.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_14.getParent().(AssignExpr).getRValue() = target_14
	and target_14.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_15(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_15) {
	target_15.getTarget().hasName("sprintf")
	and not target_15.getTarget().hasName("sysfs_emit")
	and target_15.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_15.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_15.getArgument(2).(PointerFieldAccess).getTarget().getName()="tpgt"
	and target_15.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_15.getParent().(AssignExpr).getRValue() = target_15
	and target_15.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_16(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_16) {
	target_16.getTarget().hasName("sprintf")
	and not target_16.getTarget().hasName("sysfs_emit")
	and target_16.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_16.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_16.getArgument(2).(PointerFieldAccess).getTarget().getName()="username"
	and target_16.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_16.getParent().(AssignExpr).getRValue() = target_16
	and target_16.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_17(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_17) {
	target_17.getTarget().hasName("sprintf")
	and not target_17.getTarget().hasName("sysfs_emit")
	and target_17.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_17.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_17.getArgument(2).(PointerFieldAccess).getTarget().getName()="username_in"
	and target_17.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_17.getParent().(AssignExpr).getRValue() = target_17
	and target_17.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_18(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_18) {
	target_18.getTarget().hasName("sprintf")
	and not target_18.getTarget().hasName("sysfs_emit")
	and target_18.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_18.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_18.getArgument(2).(PointerFieldAccess).getTarget().getName()="password"
	and target_18.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_18.getParent().(AssignExpr).getRValue() = target_18
	and target_18.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_19(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_19) {
	target_19.getTarget().hasName("sprintf")
	and not target_19.getTarget().hasName("sysfs_emit")
	and target_19.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_19.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_19.getArgument(2).(PointerFieldAccess).getTarget().getName()="password_in"
	and target_19.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_19.getParent().(AssignExpr).getRValue() = target_19
	and target_19.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_20(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_20) {
	target_20.getTarget().hasName("sprintf")
	and not target_20.getTarget().hasName("sysfs_emit")
	and target_20.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_20.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_20.getArgument(2).(PointerFieldAccess).getTarget().getName()="ifacename"
	and target_20.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_20.getParent().(AssignExpr).getRValue() = target_20
	and target_20.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_21(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_21) {
	target_21.getTarget().hasName("sprintf")
	and not target_21.getTarget().hasName("sysfs_emit")
	and target_21.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_21.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_21.getArgument(2).(PointerFieldAccess).getTarget().getName()="initiatorname"
	and target_21.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_21.getParent().(AssignExpr).getRValue() = target_21
	and target_21.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_22(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_22) {
	target_22.getTarget().hasName("sprintf")
	and not target_22.getTarget().hasName("sysfs_emit")
	and target_22.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_22.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_22.getArgument(2).(PointerFieldAccess).getTarget().getName()="boot_root"
	and target_22.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_22.getParent().(AssignExpr).getRValue() = target_22
	and target_22.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_23(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_23) {
	target_23.getTarget().hasName("sprintf")
	and not target_23.getTarget().hasName("sysfs_emit")
	and target_23.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_23.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_23.getArgument(2).(PointerFieldAccess).getTarget().getName()="boot_nic"
	and target_23.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_23.getParent().(AssignExpr).getRValue() = target_23
	and target_23.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_24(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_24) {
	target_24.getTarget().hasName("sprintf")
	and not target_24.getTarget().hasName("sysfs_emit")
	and target_24.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_24.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_24.getArgument(2).(PointerFieldAccess).getTarget().getName()="boot_target"
	and target_24.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_24.getParent().(AssignExpr).getRValue() = target_24
	and target_24.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_25(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_25) {
	target_25.getTarget().hasName("sprintf")
	and not target_25.getTarget().hasName("sysfs_emit")
	and target_25.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_25.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_25.getArgument(2).(PointerFieldAccess).getTarget().getName()="auto_snd_tgt_disable"
	and target_25.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_25.getParent().(AssignExpr).getRValue() = target_25
	and target_25.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_26(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_26) {
	target_26.getTarget().hasName("sprintf")
	and not target_26.getTarget().hasName("sysfs_emit")
	and target_26.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_26.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_26.getArgument(2).(PointerFieldAccess).getTarget().getName()="discovery_sess"
	and target_26.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_26.getParent().(AssignExpr).getRValue() = target_26
	and target_26.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_27(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_27) {
	target_27.getTarget().hasName("sprintf")
	and not target_27.getTarget().hasName("sysfs_emit")
	and target_27.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_27.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_27.getArgument(2).(PointerFieldAccess).getTarget().getName()="portal_type"
	and target_27.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_27.getParent().(AssignExpr).getRValue() = target_27
	and target_27.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_28(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_28) {
	target_28.getTarget().hasName("sprintf")
	and not target_28.getTarget().hasName("sysfs_emit")
	and target_28.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_28.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_28.getArgument(2).(PointerFieldAccess).getTarget().getName()="chap_auth_en"
	and target_28.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_28.getParent().(AssignExpr).getRValue() = target_28
	and target_28.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_29(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_29) {
	target_29.getTarget().hasName("sprintf")
	and not target_29.getTarget().hasName("sysfs_emit")
	and target_29.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_29.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_29.getArgument(2).(PointerFieldAccess).getTarget().getName()="discovery_logout_en"
	and target_29.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_29.getParent().(AssignExpr).getRValue() = target_29
	and target_29.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_30(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_30) {
	target_30.getTarget().hasName("sprintf")
	and not target_30.getTarget().hasName("sysfs_emit")
	and target_30.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_30.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_30.getArgument(2).(PointerFieldAccess).getTarget().getName()="bidi_chap_en"
	and target_30.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_30.getParent().(AssignExpr).getRValue() = target_30
	and target_30.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_31(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_31) {
	target_31.getTarget().hasName("sprintf")
	and not target_31.getTarget().hasName("sysfs_emit")
	and target_31.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_31.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_31.getArgument(2).(PointerFieldAccess).getTarget().getName()="discovery_auth_optional"
	and target_31.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_31.getParent().(AssignExpr).getRValue() = target_31
	and target_31.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_32(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_32) {
	target_32.getTarget().hasName("sprintf")
	and not target_32.getTarget().hasName("sysfs_emit")
	and target_32.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_32.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_32.getArgument(2).(PointerFieldAccess).getTarget().getName()="time2wait"
	and target_32.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_32.getParent().(AssignExpr).getRValue() = target_32
	and target_32.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_33(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_33) {
	target_33.getTarget().hasName("sprintf")
	and not target_33.getTarget().hasName("sysfs_emit")
	and target_33.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_33.getArgument(1).(StringLiteral).getValue()="%d\n"
	and target_33.getArgument(2).(PointerFieldAccess).getTarget().getName()="time2retain"
	and target_33.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_33.getParent().(AssignExpr).getRValue() = target_33
	and target_33.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_34(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_34) {
	target_34.getTarget().hasName("sprintf")
	and not target_34.getTarget().hasName("sysfs_emit")
	and target_34.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_34.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_34.getArgument(2).(PointerFieldAccess).getTarget().getName()="tsid"
	and target_34.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_34.getParent().(AssignExpr).getRValue() = target_34
	and target_34.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_35(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_35) {
	target_35.getTarget().hasName("sprintf")
	and not target_35.getTarget().hasName("sysfs_emit")
	and target_35.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_35.getArgument(1).(StringLiteral).getValue()="%02x%02x%02x%02x%02x%02x\n"
	and target_35.getArgument(2).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="isid"
	and target_35.getArgument(2).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_35.getArgument(2).(ArrayExpr).getArrayOffset().(Literal).getValue()="0"
	and target_35.getArgument(3).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="isid"
	and target_35.getArgument(3).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_35.getArgument(3).(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_35.getArgument(4).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="isid"
	and target_35.getArgument(4).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_35.getArgument(4).(ArrayExpr).getArrayOffset().(Literal).getValue()="2"
	and target_35.getArgument(5).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="isid"
	and target_35.getArgument(5).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_35.getArgument(5).(ArrayExpr).getArrayOffset().(Literal).getValue()="3"
	and target_35.getArgument(6).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="isid"
	and target_35.getArgument(6).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_35.getArgument(6).(ArrayExpr).getArrayOffset().(Literal).getValue()="4"
	and target_35.getArgument(7).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="isid"
	and target_35.getArgument(7).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_35.getArgument(7).(ArrayExpr).getArrayOffset().(Literal).getValue()="5"
	and target_35.getParent().(AssignExpr).getRValue() = target_35
	and target_35.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_36(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_36) {
	target_36.getTarget().hasName("sprintf")
	and not target_36.getTarget().hasName("sysfs_emit")
	and target_36.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_36.getArgument(1).(StringLiteral).getValue()="%u\n"
	and target_36.getArgument(2).(PointerFieldAccess).getTarget().getName()="discovery_parent_idx"
	and target_36.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_36.getParent().(AssignExpr).getRValue() = target_36
	and target_36.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_37(Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_37) {
	target_37.getTarget().hasName("sprintf")
	and not target_37.getTarget().hasName("sysfs_emit")
	and target_37.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_37.getArgument(1).(StringLiteral).getValue()="%s\n"
	and target_37.getArgument(2).(PointerFieldAccess).getTarget().getName()="discovery_parent_type"
	and target_37.getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsession_3428
	and target_37.getParent().(AssignExpr).getRValue() = target_37
	and target_37.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_38(Parameter vbuf_3426, FunctionCall target_38) {
	target_38.getTarget().hasName("sprintf")
	and not target_38.getTarget().hasName("sysfs_emit")
	and target_38.getArgument(0).(VariableAccess).getTarget()=vbuf_3426
	and target_38.getArgument(1).(StringLiteral).getValue()="\n"
	and target_38.getParent().(AssignExpr).getRValue() = target_38
	and target_38.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("int")
}

from Function func, Parameter vbuf_3426, Variable vsession_3428, FunctionCall target_0, FunctionCall target_1, FunctionCall target_2, FunctionCall target_3, FunctionCall target_4, FunctionCall target_5, FunctionCall target_6, FunctionCall target_7, FunctionCall target_8, FunctionCall target_9, FunctionCall target_10, FunctionCall target_11, FunctionCall target_12, FunctionCall target_13, FunctionCall target_14, FunctionCall target_15, FunctionCall target_16, FunctionCall target_17, FunctionCall target_18, FunctionCall target_19, FunctionCall target_20, FunctionCall target_21, FunctionCall target_22, FunctionCall target_23, FunctionCall target_24, FunctionCall target_25, FunctionCall target_26, FunctionCall target_27, FunctionCall target_28, FunctionCall target_29, FunctionCall target_30, FunctionCall target_31, FunctionCall target_32, FunctionCall target_33, FunctionCall target_34, FunctionCall target_35, FunctionCall target_36, FunctionCall target_37, FunctionCall target_38
where
func_0(vbuf_3426, vsession_3428, target_0)
and func_1(vbuf_3426, vsession_3428, target_1)
and func_2(vbuf_3426, vsession_3428, target_2)
and func_3(vbuf_3426, vsession_3428, target_3)
and func_4(vbuf_3426, vsession_3428, target_4)
and func_5(vbuf_3426, vsession_3428, target_5)
and func_6(vbuf_3426, vsession_3428, target_6)
and func_7(vbuf_3426, vsession_3428, target_7)
and func_8(vbuf_3426, vsession_3428, target_8)
and func_9(vbuf_3426, vsession_3428, target_9)
and func_10(vbuf_3426, vsession_3428, target_10)
and func_11(vbuf_3426, vsession_3428, target_11)
and func_12(vbuf_3426, vsession_3428, target_12)
and func_13(vbuf_3426, vsession_3428, target_13)
and func_14(vbuf_3426, vsession_3428, target_14)
and func_15(vbuf_3426, vsession_3428, target_15)
and func_16(vbuf_3426, vsession_3428, target_16)
and func_17(vbuf_3426, vsession_3428, target_17)
and func_18(vbuf_3426, vsession_3428, target_18)
and func_19(vbuf_3426, vsession_3428, target_19)
and func_20(vbuf_3426, vsession_3428, target_20)
and func_21(vbuf_3426, vsession_3428, target_21)
and func_22(vbuf_3426, vsession_3428, target_22)
and func_23(vbuf_3426, vsession_3428, target_23)
and func_24(vbuf_3426, vsession_3428, target_24)
and func_25(vbuf_3426, vsession_3428, target_25)
and func_26(vbuf_3426, vsession_3428, target_26)
and func_27(vbuf_3426, vsession_3428, target_27)
and func_28(vbuf_3426, vsession_3428, target_28)
and func_29(vbuf_3426, vsession_3428, target_29)
and func_30(vbuf_3426, vsession_3428, target_30)
and func_31(vbuf_3426, vsession_3428, target_31)
and func_32(vbuf_3426, vsession_3428, target_32)
and func_33(vbuf_3426, vsession_3428, target_33)
and func_34(vbuf_3426, vsession_3428, target_34)
and func_35(vbuf_3426, vsession_3428, target_35)
and func_36(vbuf_3426, vsession_3428, target_36)
and func_37(vbuf_3426, vsession_3428, target_37)
and func_38(vbuf_3426, target_38)
and vbuf_3426.getType().hasName("char *")
and vsession_3428.getType().hasName("iscsi_session *")
and vbuf_3426.getFunction() = func
and vsession_3428.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
