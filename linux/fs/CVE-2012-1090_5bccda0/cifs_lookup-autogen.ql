/**
 * @name linux-5bccda0ebc7c0331b81ac47d39e4b920b198b2cd-cifs_lookup
 * @id cpp/linux/5bccda0ebc7c0331b81ac47d39e4b920b198b2cd/cifs-lookup
 * @description linux-5bccda0ebc7c0331b81ac47d39e4b920b198b2cd-fs/cifs/dir.c-cifs_lookup CVE-2012-1090
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, UnaryMinusExpr target_0) {
		target_0.getValue()="-22"
		and target_0.getEnclosingFunction() = func
}

predicate func_1(Variable vrc_494, VariableAccess target_1) {
		target_1.getTarget()=vrc_494
}

predicate func_2(Variable vrc_494, Variable vfileHandle_496, Variable vpTcon_500, Variable vnewInode_502, LogicalAndExpr target_17, ExprStmt target_18, AddressOfExpr target_19, ExprStmt target_20, ExprStmt target_11, AddressOfExpr target_21) {
	exists(SwitchStmt target_2 |
		target_2.getExpr().(VariableAccess).getTarget()=vrc_494
		and target_2.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(VariableAccess).getTarget()=vnewInode_502
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="32768"
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("CIFSSMBClose")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("int")
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpTcon_500
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vfileHandle_496
		and target_2.getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr().(UnaryMinusExpr).getValue()="-2"
		and target_2.getStmt().(BlockStmt).getStmt(3) instanceof ExprStmt
		and target_2.getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof UnaryMinusExpr
		and target_2.getStmt().(BlockStmt).getStmt(6).(SwitchCase).toString() = "default: "
		and target_2.getStmt().(BlockStmt).getStmt(7) instanceof ExprStmt
		and target_2.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_2
		and target_2.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_17
		and target_18.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_2.getExpr().(VariableAccess).getLocation())
		and target_19.getOperand().(VariableAccess).getLocation().isBefore(target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation())
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_20.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation())
		and target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_11.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_21.getOperand().(VariableAccess).getLocation().isBefore(target_2.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(VariableAccess).getLocation()))
}

/*predicate func_3(Variable vnewInode_502, ExprStmt target_9, AddressOfExpr target_21, AddressOfExpr target_22) {
	exists(LogicalAndExpr target_3 |
		target_3.getAnOperand().(VariableAccess).getTarget()=vnewInode_502
		and target_3.getAnOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="i_mode"
		and target_3.getAnOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnewInode_502
		and target_3.getAnOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="61440"
		and target_3.getAnOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="32768"
		and target_3.getParent().(IfStmt).getThen()=target_9
		and target_21.getOperand().(VariableAccess).getLocation().isBefore(target_3.getAnOperand().(VariableAccess).getLocation())
		and target_3.getAnOperand().(VariableAccess).getLocation().isBefore(target_22.getOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_4(Variable vnewInode_502, AddressOfExpr target_22) {
	exists(BitwiseAndExpr target_4 |
		target_4.getLeftOperand().(PointerFieldAccess).getTarget().getName()="i_mode"
		and target_4.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vnewInode_502
		and target_4.getRightOperand().(Literal).getValue()="61440"
		and target_4.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_22.getOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_6(Variable vfileHandle_496, Variable vpTcon_500, LogicalOrExpr target_14, AddressOfExpr target_19, ExprStmt target_20, LogicalAndExpr target_17, ExprStmt target_11) {
	exists(ExprStmt target_6 |
		target_6.getExpr().(FunctionCall).getTarget().hasName("CIFSSMBClose")
		and target_6.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("int")
		and target_6.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpTcon_500
		and target_6.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vfileHandle_496
		and target_6.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(0)=target_6
		and target_6.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_14
		and target_19.getOperand().(VariableAccess).getLocation().isBefore(target_6.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation())
		and target_6.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_20.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation())
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_6.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
		and target_6.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_11.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_7(LogicalOrExpr target_14, Function func) {
	exists(BreakStmt target_7 |
		target_7.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_7
		and target_7.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_14
		and target_7.getEnclosingFunction() = func)
}

*/
predicate func_8(Function func, UnaryMinusExpr target_8) {
		target_8.getValue()="-2"
		and target_8.getEnclosingFunction() = func
}

predicate func_9(Variable vposix_open_497, LogicalOrExpr target_14, ExprStmt target_9) {
		target_9.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vposix_open_497
		and target_9.getParent().(IfStmt).getCondition()=target_14
}

predicate func_10(Function func, UnaryMinusExpr target_10) {
		target_10.getValue()="-95"
		and target_10.getEnclosingFunction() = func
}

predicate func_11(Variable vpTcon_500, LogicalOrExpr target_14, ExprStmt target_11) {
		target_11.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="broken_posix_open"
		and target_11.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpTcon_500
		and target_11.getParent().(IfStmt).getParent().(IfStmt).getCondition()=target_14
}

predicate func_12(Variable vrc_494, VariableAccess target_12) {
		target_12.getTarget()=vrc_494
}

predicate func_14(Variable vrc_494, ExprStmt target_9, LogicalOrExpr target_14) {
		target_14.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vrc_494
		and target_14.getAnOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_14.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vrc_494
		and target_14.getAnOperand().(EqualityOperation).getAnOperand() instanceof UnaryMinusExpr
		and target_14.getParent().(IfStmt).getThen()=target_9
}

predicate func_15(Variable vrc_494, LogicalOrExpr target_14, IfStmt target_15) {
		target_15.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vrc_494
		and target_15.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand() instanceof UnaryMinusExpr
		and target_15.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vrc_494
		and target_15.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand() instanceof UnaryMinusExpr
		and target_15.getThen() instanceof ExprStmt
		and target_15.getParent().(IfStmt).getCondition()=target_14
}

predicate func_17(Variable vpTcon_500, LogicalAndExpr target_17) {
		target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(VariableAccess).getTarget().getType().hasName("nameidata *")
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="2"
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("nameidata *")
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="256"
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(PointerFieldAccess).getTarget().getName()="broken_posix_open"
		and target_17.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpTcon_500
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="f_flags"
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="open"
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="intent"
		and target_17.getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("nameidata *")
		and target_17.getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
}

predicate func_18(Variable vrc_494, Variable vfileHandle_496, Variable vnewInode_502, ExprStmt target_18) {
		target_18.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vrc_494
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cifs_posix_open")
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("char *")
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vnewInode_502
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="i_sb"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("inode *")
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getTarget().getName()="create_mode"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="open"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="intent"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("nameidata *")
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="f_flags"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="open"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="intent"
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("__u32")
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vfileHandle_496
		and target_18.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(7).(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_19(Variable vfileHandle_496, AddressOfExpr target_19) {
		target_19.getOperand().(VariableAccess).getTarget()=vfileHandle_496
}

predicate func_20(Variable vfileHandle_496, Variable vpTcon_500, FunctionCall target_23, ExprStmt target_20) {
		target_20.getExpr().(FunctionCall).getTarget().hasName("CIFSSMBClose")
		and target_20.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("int")
		and target_20.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vpTcon_500
		and target_20.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vfileHandle_496
		and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_23
}

predicate func_21(Variable vfileHandle_496, Variable vnewInode_502, AddressOfExpr target_21) {
		target_21.getOperand().(VariableAccess).getTarget()=vnewInode_502
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cifs_posix_open")
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("char *")
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="i_sb"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("inode *")
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getTarget().getName()="create_mode"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="open"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="intent"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("nameidata *")
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="f_flags"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="open"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="intent"
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("nameidata *")
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("__u32")
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vfileHandle_496
		and target_21.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(7).(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_22(Variable vnewInode_502, AddressOfExpr target_22) {
		target_22.getOperand().(VariableAccess).getTarget()=vnewInode_502
		and target_22.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cifs_get_inode_info_unix")
		and target_22.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget().getType().hasName("char *")
		and target_22.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="i_sb"
		and target_22.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("inode *")
		and target_22.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_23(Function func, FunctionCall target_23) {
		target_23.getTarget().hasName("IS_ERR")
		and target_23.getArgument(0).(VariableAccess).getTarget().getType().hasName("file *")
		and target_23.getEnclosingFunction() = func
}

from Function func, Variable vrc_494, Variable vfileHandle_496, Variable vposix_open_497, Variable vpTcon_500, Variable vnewInode_502, UnaryMinusExpr target_0, VariableAccess target_1, UnaryMinusExpr target_8, ExprStmt target_9, UnaryMinusExpr target_10, ExprStmt target_11, VariableAccess target_12, LogicalOrExpr target_14, IfStmt target_15, LogicalAndExpr target_17, ExprStmt target_18, AddressOfExpr target_19, ExprStmt target_20, AddressOfExpr target_21, AddressOfExpr target_22, FunctionCall target_23
where
func_0(func, target_0)
and func_1(vrc_494, target_1)
and not func_2(vrc_494, vfileHandle_496, vpTcon_500, vnewInode_502, target_17, target_18, target_19, target_20, target_11, target_21)
and func_8(func, target_8)
and func_9(vposix_open_497, target_14, target_9)
and func_10(func, target_10)
and func_11(vpTcon_500, target_14, target_11)
and func_12(vrc_494, target_12)
and func_14(vrc_494, target_9, target_14)
and func_15(vrc_494, target_14, target_15)
and func_17(vpTcon_500, target_17)
and func_18(vrc_494, vfileHandle_496, vnewInode_502, target_18)
and func_19(vfileHandle_496, target_19)
and func_20(vfileHandle_496, vpTcon_500, target_23, target_20)
and func_21(vfileHandle_496, vnewInode_502, target_21)
and func_22(vnewInode_502, target_22)
and func_23(func, target_23)
and vrc_494.getType().hasName("int")
and vfileHandle_496.getType().hasName("__u16")
and vposix_open_497.getType().hasName("bool")
and vpTcon_500.getType().hasName("cifs_tcon *")
and vnewInode_502.getType().hasName("inode *")
and vrc_494.(LocalVariable).getFunction() = func
and vfileHandle_496.(LocalVariable).getFunction() = func
and vposix_open_497.(LocalVariable).getFunction() = func
and vpTcon_500.(LocalVariable).getFunction() = func
and vnewInode_502.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
