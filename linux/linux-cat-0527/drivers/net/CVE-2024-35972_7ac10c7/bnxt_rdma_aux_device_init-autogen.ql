/**
 * @name linux-7ac10c7d728d75bc9daaa8fade3c7a3273b9a9ff-bnxt_rdma_aux_device_init
 * @id cpp/linux/7ac10c7d728d75bc9daaa8fade3c7a3273b9a9ff/bnxt-rdma-aux-device-init
 * @description linux-7ac10c7d728d75bc9daaa8fade3c7a3273b9a9ff-drivers/net/ethernet/broadcom/bnxt/bnxt_ulp.c-bnxt_rdma_aux_device_init CVE-2024-35972
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vaux_priv_353, Variable vedev_354, ExprStmt target_1, ExprStmt target_0) {
	target_0.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="edev"
	and target_0.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vaux_priv_353
	and target_0.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vedev_354
	and target_1.getLocation().isBefore(target_0.getLocation())
}

predicate func_1(Variable vedev_354, ExprStmt target_1) {
	target_1.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ulp_tbl"
	and target_1.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vedev_354
	and target_1.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget().getType().hasName("bnxt_ulp *")
}

from Function func, Variable vaux_priv_353, Variable vedev_354, ExprStmt target_0, ExprStmt target_1
where
func_0(vaux_priv_353, vedev_354, target_1, target_0)
and func_1(vedev_354, target_1)
and vaux_priv_353.getType().hasName("bnxt_aux_priv *")
and vedev_354.getType().hasName("bnxt_en_dev *")
and vaux_priv_353.(LocalVariable).getFunction() = func
and vedev_354.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
