/**
 * @name linux-0e5cc9a40ada6046e6bc3bdfcd0c0d7e4b706b14-udf_get_filename
 * @id cpp/linux/0e5cc9a40ada6046e6bc3bdfcd0c0d7e4b706b14/udf-get-filename
 * @description linux-0e5cc9a40ada6046e6bc3bdfcd0c0d7e4b706b14-fs/udf/unicode.c-udf_get_filename CVE-2014-9731
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vflen_337, VariableAccess target_0) {
	target_0.getTarget()=vflen_337
	and vflen_337.getIndex() = 3
	and target_0.getParent().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("ustr *")
	and target_0.getParent().(FunctionCall).getArgument(1).(VariableAccess).getTarget().getType().hasName("uint8_t *")
	and target_0.getParent().(FunctionCall).getParent().(IfStmt).getThen() instanceof GotoStmt
}

from Function func, Parameter vflen_337, VariableAccess target_0
where
func_0(vflen_337, target_0)
and vflen_337.getType().hasName("int")
and vflen_337.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
