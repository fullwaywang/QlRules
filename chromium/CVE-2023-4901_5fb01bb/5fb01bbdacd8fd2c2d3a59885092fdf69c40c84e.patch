commit 5fb01bbdacd8fd2c2d3a59885092fdf69c40c84e	5fb01bbdacd8fd2c2d3a59885092fdf69c40c84e
Author: Alesandro Ortiz <alesandro@alesandroortiz.com>
Date:   Wed Jul 19 22:40:10 2023 +0000

    Use committed origin instead of committed URL in device chooser dialogs
    
    Bug: 1463149,1459281
    Change-Id: Ia1d81b82b654d22d44215ecde73d8d24d27ce983
    Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/4672069
    Reviewed-by: Reilly Grant <reillyg@chromium.org>
    Commit-Queue: Zelin Liu <zelin@chromium.org>
    Commit-Queue: Reilly Grant <reillyg@chromium.org>
    Cr-Commit-Position: refs/heads/main@{#1172637}

diff --git a/chrome/browser/chooser_controller/title_util.cc b/chrome/browser/chooser_controller/title_util.cc
index 974b6db056599..07984caeb4167 100644
--- a/chrome/browser/chooser_controller/title_util.cc
+++ b/chrome/browser/chooser_controller/title_util.cc
@@ -32,7 +32,7 @@ std::u16string CreateChooserTitle(content::RenderFrameHost* render_frame_host,
   // Ensure the permission request is attributed to the main frame.
   render_frame_host = render_frame_host->GetMainFrame();
 
-  const GURL& url = render_frame_host->GetLastCommittedURL();
+  const GURL& url = render_frame_host->GetLastCommittedOrigin().GetURL();
   Profile* profile =
       Profile::FromBrowserContext(render_frame_host->GetBrowserContext());
 
diff --git a/chrome/browser/chooser_controller/title_util_browsertest.cc b/chrome/browser/chooser_controller/title_util_browsertest.cc
index 20c0d4a1b80f2..86a2f68083e30 100644
--- a/chrome/browser/chooser_controller/title_util_browsertest.cc
+++ b/chrome/browser/chooser_controller/title_util_browsertest.cc
@@ -40,7 +40,7 @@ GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST(
     CreateChooserTitlePopUpBrowserTest);
 
 IN_PROC_BROWSER_TEST_F(CreateChooserTitlePopUpBrowserTest,
-                       DISABLED_UseOriginNotUrl) {
+                       UseOriginNotUrl) {
   ASSERT_TRUE(
       NavigateToURL(browser()->tab_strip_model()->GetActiveWebContents(),
                     server()->GetURL("/simple.html")));
