/**
 * @name linux-1be7107fbe18eed3e319a6c3e83c78254b693acb-faultin_page
 * @id cpp/linux/1be7107fbe18eed3e319a6c3e83c78254b693acb/faultin-page
 * @description linux-1be7107fbe18eed3e319a6c3e83c78254b693acb-mm/gup.c-faultin_page CVE-2017-1000364
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
	target_0.getValue()="0"
	and not target_0.getValue()="4194304"
	and target_0.getParent() instanceof Initializer
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Parameter vaddress_382, VariableAccess target_1) {
	target_1.getTarget()=vaddress_382
	and vaddress_382.getIndex() = 2
	and target_1.getParent().(FunctionCall).getParent().(LogicalOrExpr).getLeftOperand() instanceof FunctionCall
}

predicate func_2(Function func) {
exists(FunctionCall target_2 |
	target_2.getTarget().hasName("in_compat_syscall")
	and target_2.getEnclosingFunction() = func)
}

predicate func_3(Function func) {
exists(AssignExpr target_3 |
	target_3.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned long *")
	and target_3.getRValue().(HexLiteral).getValue()="1073741824"
	and target_3.getEnclosingFunction() = func)
}

predicate func_4(Function func) {
exists(AssignExpr target_4 |
	target_4.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned long *")
	and target_4.getRValue().(HexLiteral).getValue()="2147483648"
	and target_4.getEnclosingFunction() = func)
}

predicate func_5(Function func) {
exists(PointerFieldAccess target_5 |
	target_5.getTarget().getName()="flags"
	and target_5.getQualifier().(FunctionCall).getTarget().hasName("get_current")
	and target_5.getEnclosingFunction() = func)
}

predicate func_6(Function func) {
exists(AssignExpr target_6 |
	target_6.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned long *")
	and target_6.getRValue().(FunctionCall).getTarget().hasName("randomize_page")
	and target_6.getRValue().(FunctionCall).getArgument(0).(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned long *")
	and target_6.getRValue().(FunctionCall).getArgument(1).(HexLiteral).getValue()="33554432"
	and target_6.getEnclosingFunction() = func)
}

predicate func_7(Function func) {
exists(AssignExpr target_7 |
	target_7.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned long *")
	and target_7.getRValue().(FunctionCall).getTarget().hasName("get_mmap_base")
	and target_7.getRValue().(FunctionCall).getArgument(0) instanceof Literal
	and target_7.getEnclosingFunction() = func)
}

predicate func_8(Function func) {
exists(AssignExpr target_8 |
	target_8.getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("unsigned long *")
	and target_8.getRValue().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("in_compat_syscall")
	and target_8.getRValue().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("tasksize_32bit")
	and target_8.getRValue().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("tasksize_64bit")
	and target_8.getEnclosingFunction() = func)
}

predicate func_11(Function func, DeclStmt target_11) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_11
}

predicate func_12(Function func, DeclStmt target_12) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_12
}

predicate func_13(Parameter vflags_382, ReturnStmt target_53, EqualityOperation target_13) {
	target_13.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_13.getLeftOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="4160"
	and target_13.getRightOperand().(Literal).getValue()="4096"
	and target_13.getParent().(IfStmt).getThen()=target_53
}

predicate func_14(Function func, UnaryMinusExpr target_14) {
	target_14.getValue()="-2"
	and target_14.getEnclosingFunction() = func
}

predicate func_15(Parameter vvma_381, Parameter vaddress_382, Parameter vflags_382, Function func, IfStmt target_15) {
	target_15.getCondition().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_15.getCondition().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand() instanceof Literal
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getTarget().hasName("stack_guard_page_start")
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddress_382
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getTarget().hasName("stack_guard_page_end")
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getArgument(1).(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vaddress_382
	and target_15.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getArgument(1).(AddExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_15.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-2"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

/*predicate func_16(Parameter vvma_381, Parameter vaddress_382, Parameter vflags_382, ReturnStmt target_54, BitwiseAndExpr target_16) {
	target_16.getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_16.getRightOperand() instanceof Literal
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getTarget().hasName("stack_guard_page_start")
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddress_382
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getTarget().hasName("stack_guard_page_end")
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getArgument(1).(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vaddress_382
	and target_16.getParent().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(FunctionCall).getArgument(1).(AddExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_16.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_54
}

*/
/*predicate func_17(Parameter vvma_381, Parameter vaddress_382, Parameter vflags_382, ReturnStmt target_54, LogicalOrExpr target_17) {
	target_17.getLeftOperand().(FunctionCall).getTarget().hasName("stack_guard_page_start")
	and target_17.getLeftOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_17.getLeftOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddress_382
	and target_17.getRightOperand().(FunctionCall).getTarget().hasName("stack_guard_page_end")
	and target_17.getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_17.getRightOperand().(FunctionCall).getArgument(1).(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vaddress_382
	and target_17.getRightOperand().(FunctionCall).getArgument(1).(AddExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="4096"
	and target_17.getParent().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_17.getParent().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand() instanceof Literal
	and target_17.getParent().(LogicalAndExpr).getParent().(IfStmt).getThen()=target_54
}

*/
/*predicate func_18(Function func, UnaryMinusExpr target_18) {
	target_18.getValue()="-2"
	and target_18.getEnclosingFunction() = func
}

*/
predicate func_19(Parameter vflags_382, Variable vfault_flags_384, Function func, IfStmt target_19) {
	target_19.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_19.getCondition().(BitwiseAndExpr).getRightOperand() instanceof Literal
	and target_19.getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(VariableAccess).getTarget()=vfault_flags_384
	and target_19.getThen().(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_19
}

/*predicate func_20(Parameter vflags_382, ExprStmt target_55, PointerDereferenceExpr target_20) {
	target_20.getOperand().(VariableAccess).getTarget()=vflags_382
	and target_20.getParent().(BitwiseAndExpr).getRightOperand() instanceof Literal
	and target_20.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen()=target_55
}

*/
predicate func_21(Parameter vflags_382, Variable vfault_flags_384, Function func, IfStmt target_21) {
	target_21.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_21.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8192"
	and target_21.getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(VariableAccess).getTarget()=vfault_flags_384
	and target_21.getThen().(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="128"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
}

predicate func_22(Parameter vnonblocking_382, Variable vfault_flags_384, Function func, IfStmt target_22) {
	target_22.getCondition().(VariableAccess).getTarget()=vnonblocking_382
	and target_22.getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(VariableAccess).getTarget()=vfault_flags_384
	and target_22.getThen().(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="4"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_22
}

predicate func_23(Parameter vflags_382, Variable vfault_flags_384, Function func, IfStmt target_23) {
	target_23.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_23.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32"
	and target_23.getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(VariableAccess).getTarget()=vfault_flags_384
	and target_23.getThen().(ExprStmt).getExpr().(AssignOrExpr).getRValue().(BitwiseOrExpr).getValue()="12"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

predicate func_24(Parameter vflags_382, Variable vfault_flags_384, Function func, IfStmt target_24) {
	target_24.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_24.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="2048"
	and target_24.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_24.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_24.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(VariableAccess).getTarget()=vfault_flags_384
	and target_24.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
}

/*predicate func_25(Variable v__ret_warn_on_404, StmtExpr target_25) {
	target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_404
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getCondition() instanceof Literal
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof StringLiteral
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(1) instanceof Literal
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_25.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getValue()="12"
	and target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_404
	and target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_27(Variable v__ret_warn_on_404, IfStmt target_27) {
	target_27.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_27.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_404
	and target_27.getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_27.getThen().(DoStmt).getCondition() instanceof Literal
	and target_27.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof StringLiteral
	and target_27.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(1) instanceof Literal
	and target_27.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(2).(BitwiseOrExpr).getValue()="2307"
	and target_27.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_27.getThen().(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getValue()="12"
}

*/
/*predicate func_28(Function func, AsmStmt target_28) {
	target_28.getChild(0) instanceof StringLiteral
	and target_28.getChild(1) instanceof Literal
	and target_28.getChild(2).(BitwiseOrExpr).getValue()="2307"
	and target_28.getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_28.getChild(3).(SizeofTypeOperator).getValue()="12"
	and target_28.getEnclosingFunction() = func
}

*/
/*predicate func_29(Variable v__ret_warn_on_404, FunctionCall target_29) {
	target_29.getTarget().hasName("__builtin_expect")
	and target_29.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_404
	and target_29.getArgument(1) instanceof Literal
}

*/
/*predicate func_30(Variable vfault_flags_384, AssignOrExpr target_30) {
	target_30.getLValue().(VariableAccess).getTarget()=vfault_flags_384
	and target_30.getRValue().(Literal).getValue()="32"
}

*/
predicate func_31(Parameter vvma_381, Parameter vaddress_382, Variable vfault_flags_384, Variable vret_385, Function func, ExprStmt target_31) {
	target_31.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_385
	and target_31.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("handle_mm_fault")
	and target_31.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_381
	and target_31.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddress_382
	and target_31.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vfault_flags_384
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_31
}

predicate func_32(Variable vret_385, Variable verr_410, Function func, IfStmt target_32) {
	target_32.getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_32.getCondition().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="2163"
	and target_32.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getTarget()=verr_410
	and target_32.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=verr_410
	and target_32.getThen().(BlockStmt).getStmt(2).(DoStmt).getCondition() instanceof Literal
	and target_32.getThen().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_32.getThen().(BlockStmt).getStmt(2).(DoStmt).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_32
}

predicate func_33(BitwiseAndExpr target_58, Function func, DeclStmt target_33) {
	target_33.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_58
	and target_33.getEnclosingFunction() = func
}

/*predicate func_34(Variable verr_410, BitwiseAndExpr target_58, IfStmt target_34) {
	target_34.getCondition().(VariableAccess).getTarget()=verr_410
	and target_34.getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=verr_410
	and target_34.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_58
}

*/
/*predicate func_35(BitwiseAndExpr target_58, Function func, DoStmt target_35) {
	target_35.getCondition() instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof StringLiteral
	and target_35.getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(1) instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(2) instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_35.getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getValue()="12"
	and target_35.getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_35.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
	and target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_58
	and target_35.getEnclosingFunction() = func
}

*/
/*predicate func_36(Function func, DoStmt target_36) {
	target_36.getCondition() instanceof Literal
	and target_36.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof StringLiteral
	and target_36.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(1) instanceof Literal
	and target_36.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(2) instanceof Literal
	and target_36.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_36.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(3).(SizeofTypeOperator).getValue()="12"
	and target_36.getEnclosingFunction() = func
}

*/
/*predicate func_37(Function func, AsmStmt target_37) {
	target_37.getChild(0) instanceof StringLiteral
	and target_37.getChild(1) instanceof Literal
	and target_37.getChild(2) instanceof Literal
	and target_37.getChild(3).(SizeofTypeOperator).getType() instanceof LongType
	and target_37.getChild(3).(SizeofTypeOperator).getValue()="12"
	and target_37.getEnclosingFunction() = func
}

*/
/*predicate func_38(Function func, DoStmt target_38) {
	target_38.getCondition() instanceof Literal
	and target_38.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_38.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_unreachable")
	and target_38.getEnclosingFunction() = func
}

*/
/*predicate func_39(Function func, StmtExpr target_39) {
	target_39.getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_39.getEnclosingFunction() = func
}

*/
/*predicate func_40(Function func, AsmStmt target_40) {
	target_40.getChild(0) instanceof Literal
	and target_40.getEnclosingFunction() = func
}

*/
/*predicate func_41(Function func, FunctionCall target_41) {
	target_41.getTarget().hasName("__builtin_unreachable")
	and target_41.getEnclosingFunction() = func
}

*/
predicate func_42(Variable vret_385, Parameter vtsk_381, Function func, IfStmt target_42) {
	target_42.getCondition().(VariableAccess).getTarget()=vtsk_381
	and target_42.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_42.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="4"
	and target_42.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getTarget().getName()="maj_flt"
	and target_42.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtsk_381
	and target_42.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getTarget().getName()="min_flt"
	and target_42.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtsk_381
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_42
}

/*predicate func_43(Variable vret_385, ExprStmt target_44, BitwiseAndExpr target_43) {
	target_43.getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_43.getRightOperand().(Literal).getValue()="4"
	and target_43.getParent().(IfStmt).getThen()=target_44
}

*/
/*predicate func_44(Parameter vtsk_381, BitwiseAndExpr target_43, ExprStmt target_44) {
	target_44.getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getTarget().getName()="maj_flt"
	and target_44.getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtsk_381
	and target_44.getParent().(IfStmt).getCondition()=target_43
}

*/
/*predicate func_45(Parameter vtsk_381, BitwiseAndExpr target_43, ExprStmt target_45) {
	target_45.getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getTarget().getName()="min_flt"
	and target_45.getExpr().(PostfixIncrExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtsk_381
	and target_45.getParent().(IfStmt).getCondition()=target_43
}

*/
predicate func_46(Parameter vnonblocking_382, Variable vret_385, Function func, IfStmt target_46) {
	target_46.getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_46.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="1024"
	and target_46.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(VariableAccess).getTarget()=vnonblocking_382
	and target_46.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vnonblocking_382
	and target_46.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_46.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-16"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

/*predicate func_47(Parameter vnonblocking_382, BitwiseAndExpr target_59, IfStmt target_47) {
	target_47.getCondition().(VariableAccess).getTarget()=vnonblocking_382
	and target_47.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vnonblocking_382
	and target_47.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_47.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
}

*/
/*predicate func_48(BitwiseAndExpr target_59, Function func, ReturnStmt target_48) {
	target_48.getExpr().(UnaryMinusExpr).getValue()="-16"
	and target_48.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
	and target_48.getEnclosingFunction() = func
}

*/
predicate func_49(Parameter vvma_381, Parameter vflags_382, Variable vret_385, Function func, IfStmt target_49) {
	target_49.getCondition().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_49.getCondition().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8"
	and target_49.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_49.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_381
	and target_49.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="2"
	and target_49.getThen().(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vflags_382
	and target_49.getThen().(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="16384"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
}

/*predicate func_50(Parameter vvma_381, PointerFieldAccess target_50) {
	target_50.getTarget().getName()="vm_flags"
	and target_50.getQualifier().(VariableAccess).getTarget()=vvma_381
}

*/
predicate func_52(Function func, ReturnStmt target_52) {
	target_52.getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_52
}

predicate func_53(EqualityOperation target_13, Function func, ReturnStmt target_53) {
	target_53.getExpr() instanceof UnaryMinusExpr
	and target_53.getParent().(IfStmt).getCondition()=target_13
	and target_53.getEnclosingFunction() = func
}

predicate func_54(LogicalAndExpr target_60, Function func, ReturnStmt target_54) {
	target_54.getExpr() instanceof UnaryMinusExpr
	and target_54.getParent().(IfStmt).getCondition()=target_60
	and target_54.getEnclosingFunction() = func
}

predicate func_55(Function func, ExprStmt target_55) {
	target_55.getExpr() instanceof AssignOrExpr
	and target_55.getEnclosingFunction() = func
}

predicate func_58(Variable vret_385, BitwiseAndExpr target_58) {
	target_58.getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_58.getRightOperand() instanceof BitwiseOrExpr
}

predicate func_59(Variable vret_385, BitwiseAndExpr target_59) {
	target_59.getLeftOperand().(VariableAccess).getTarget()=vret_385
	and target_59.getRightOperand() instanceof Literal
}

predicate func_60(Function func, LogicalAndExpr target_60) {
	target_60.getLeftOperand() instanceof BitwiseAndExpr
	and target_60.getRightOperand() instanceof LogicalOrExpr
	and target_60.getEnclosingFunction() = func
}

from Function func, Parameter vvma_381, Parameter vaddress_382, Parameter vflags_382, Parameter vnonblocking_382, Variable vfault_flags_384, Variable vret_385, Variable v__ret_warn_on_404, Variable verr_410, Parameter vtsk_381, Literal target_0, VariableAccess target_1, DeclStmt target_11, DeclStmt target_12, EqualityOperation target_13, UnaryMinusExpr target_14, IfStmt target_15, IfStmt target_19, IfStmt target_21, IfStmt target_22, IfStmt target_23, IfStmt target_24, ExprStmt target_31, IfStmt target_32, DeclStmt target_33, IfStmt target_42, IfStmt target_46, IfStmt target_49, ReturnStmt target_52, ReturnStmt target_53, ReturnStmt target_54, ExprStmt target_55, BitwiseAndExpr target_58, BitwiseAndExpr target_59, LogicalAndExpr target_60
where
func_0(func, target_0)
and func_1(vaddress_382, target_1)
and not func_2(func)
and not func_3(func)
and not func_4(func)
and not func_5(func)
and not func_6(func)
and not func_7(func)
and not func_8(func)
and func_11(func, target_11)
and func_12(func, target_12)
and func_13(vflags_382, target_53, target_13)
and func_14(func, target_14)
and func_15(vvma_381, vaddress_382, vflags_382, func, target_15)
and func_19(vflags_382, vfault_flags_384, func, target_19)
and func_21(vflags_382, vfault_flags_384, func, target_21)
and func_22(vnonblocking_382, vfault_flags_384, func, target_22)
and func_23(vflags_382, vfault_flags_384, func, target_23)
and func_24(vflags_382, vfault_flags_384, func, target_24)
and func_31(vvma_381, vaddress_382, vfault_flags_384, vret_385, func, target_31)
and func_32(vret_385, verr_410, func, target_32)
and func_33(target_58, func, target_33)
and func_42(vret_385, vtsk_381, func, target_42)
and func_46(vnonblocking_382, vret_385, func, target_46)
and func_49(vvma_381, vflags_382, vret_385, func, target_49)
and func_52(func, target_52)
and func_53(target_13, func, target_53)
and func_54(target_60, func, target_54)
and func_55(func, target_55)
and func_58(vret_385, target_58)
and func_59(vret_385, target_59)
and func_60(func, target_60)
and vvma_381.getType().hasName("vm_area_struct *")
and vaddress_382.getType().hasName("unsigned long")
and vflags_382.getType().hasName("unsigned int *")
and vnonblocking_382.getType().hasName("int *")
and vfault_flags_384.getType().hasName("unsigned int")
and vret_385.getType().hasName("int")
and v__ret_warn_on_404.getType().hasName("int")
and verr_410.getType().hasName("int")
and vtsk_381.getType().hasName("task_struct *")
and vvma_381.getFunction() = func
and vaddress_382.getFunction() = func
and vflags_382.getFunction() = func
and vnonblocking_382.getFunction() = func
and vfault_flags_384.(LocalVariable).getFunction() = func
and vret_385.(LocalVariable).getFunction() = func
and v__ret_warn_on_404.(LocalVariable).getFunction() = func
and verr_410.(LocalVariable).getFunction() = func
and vtsk_381.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
