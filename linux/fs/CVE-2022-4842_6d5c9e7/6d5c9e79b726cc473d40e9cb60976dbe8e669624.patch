commit 6d5c9e79b726cc473d40e9cb60976dbe8e669624
Author: Alon Zahavi <zahavi.alon@gmail.com>
Date:   Mon Aug 15 14:07:12 2022 +0300

    fs/ntfs3: Fix attr_punch_hole() null pointer derenference
    
    The bug occours due to a misuse of `attr` variable instead of `attr_b`.
    `attr` is being initialized as NULL, then being derenfernced
    as `attr->res.data_size`.
    
    This bug causes a crash of the ntfs3 driver itself,
    If compiled directly to the kernel, it crashes the whole system.
    
    Signed-off-by: Alon Zahavi <zahavi.alon@gmail.com>
    Co-developed-by: Tal Lossos <tallossos@gmail.com>
    Signed-off-by: Tal Lossos <tallossos@gmail.com>
    Signed-off-by: Konstantin Komarov <almaz.alexandrovich@paragon-software.com>

diff --git a/fs/ntfs3/attrib.c b/fs/ntfs3/attrib.c
index 578c2bcfb1d9..63169529b52c 100644
--- a/fs/ntfs3/attrib.c
+++ b/fs/ntfs3/attrib.c
@@ -2038,7 +2038,7 @@ int attr_punch_hole(struct ntfs_inode *ni, u64 vbo, u64 bytes, u32 *frame_size)
 		return -ENOENT;
 
 	if (!attr_b->non_res) {
-		u32 data_size = le32_to_cpu(attr->res.data_size);
+		u32 data_size = le32_to_cpu(attr_b->res.data_size);
 		u32 from, to;
 
 		if (vbo > data_size)
