/**
 * @name linux-0b0509508beff65c1d50541861bc0d4973487dc5-binder_transaction
 * @id cpp/linux/0b0509508beff65c1d50541861bc0d4973487dc5/binder-transaction
 * @description linux-0b0509508beff65c1d50541861bc0d4973487dc5-drivers/android/binder.c-binder_transaction CVE-2019-2181
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vreturn_error_line_2873, Literal target_0) {
	target_0.getValue()="3130"
	and not target_0.getValue()="3131"
	and target_0.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_1(Variable vreturn_error_line_2873, Literal target_1) {
	target_1.getValue()="3148"
	and not target_1.getValue()="3157"
	and target_1.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_2(Variable vreturn_error_line_2873, Literal target_2) {
	target_2.getValue()="3180"
	and not target_2.getValue()="3189"
	and target_2.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_3(Variable vreturn_error_line_2873, Literal target_3) {
	target_3.getValue()="3194"
	and not target_3.getValue()="3203"
	and target_3.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_4(Variable vreturn_error_line_2873, Literal target_4) {
	target_4.getValue()="3202"
	and not target_4.getValue()="3211"
	and target_4.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_5(Variable vreturn_error_line_2873, Literal target_5) {
	target_5.getValue()="3211"
	and not target_5.getValue()="3220"
	and target_5.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_6(Variable vreturn_error_line_2873, Literal target_6) {
	target_6.getValue()="3242"
	and not target_6.getValue()="3251"
	and target_6.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_7(Variable vreturn_error_line_2873, Literal target_7) {
	target_7.getValue()="3258"
	and not target_7.getValue()="3267"
	and target_7.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_8(Variable vreturn_error_line_2873, Literal target_8) {
	target_8.getValue()="3274"
	and not target_8.getValue()="3283"
	and target_8.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_9(Variable vreturn_error_line_2873, Literal target_9) {
	target_9.getValue()="3292"
	and not target_9.getValue()="3301"
	and target_9.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_10(Variable vreturn_error_line_2873, Literal target_10) {
	target_10.getValue()="3318"
	and not target_10.getValue()="3327"
	and target_10.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_11(Variable vreturn_error_line_2873, Literal target_11) {
	target_11.getValue()="3331"
	and not target_11.getValue()="3340"
	and target_11.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_12(Variable vreturn_error_line_2873, Literal target_12) {
	target_12.getValue()="3339"
	and not target_12.getValue()="3348"
	and target_12.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_13(Variable vreturn_error_line_2873, Literal target_13) {
	target_13.getValue()="3357"
	and not target_13.getValue()="3366"
	and target_13.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_14(Variable vreturn_error_line_2873, Literal target_14) {
	target_14.getValue()="3371"
	and not target_14.getValue()="3380"
	and target_14.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_15(Variable vreturn_error_line_2873, Literal target_15) {
	target_15.getValue()="3389"
	and not target_15.getValue()="3398"
	and target_15.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_16(Variable vreturn_error_line_2873, ExprStmt target_27, Literal target_16) {
	target_16.getValue()="3403"
	and not target_16.getValue()="3412"
	and target_16.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_16.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
}

predicate func_17(Variable vreturn_error_line_2873, ExprStmt target_28, VariableAccess target_17) {
	target_17.getTarget()=vreturn_error_line_2873
	and target_17.getParent().(AssignExpr).getLValue() = target_17
	and target_17.getParent().(AssignExpr).getRValue().(Literal).getValue()="3466"
	and target_17.getLocation().isBefore(target_28.getExpr().(FunctionCall).getArgument(7).(VariableAccess).getLocation())
}

/*predicate func_18(Variable vreturn_error_line_2873, ExprStmt target_28, Literal target_18) {
	target_18.getValue()="3466"
	and not target_18.getValue()="22"
	and target_18.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_18.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_28.getExpr().(FunctionCall).getArgument(7).(VariableAccess).getLocation())
}

*/
predicate func_19(Function func) {
exists(AssignExpr target_19 |
	target_19.getLValue().(VariableAccess).getType().hasName("size_t")
	and target_19.getRValue() instanceof BitwiseAndExpr
	and target_19.getEnclosingFunction() = func)
}

predicate func_20(Parameter vextra_buffers_size_2856, LogicalAndExpr target_29, ExprStmt target_30) {
exists(ExprStmt target_20 |
	target_20.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vextra_buffers_size_2856
	and target_20.getExpr().(AssignAddExpr).getRValue().(VariableAccess).getType().hasName("size_t")
	and target_20.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(6)=target_20
	and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_29
	and target_30.getExpr().(FunctionCall).getArgument(10).(VariableAccess).getLocation().isBefore(target_20.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation()))
}

predicate func_22(Variable vreturn_error_2871, Variable vreturn_error_line_2873, Parameter vextra_buffers_size_2856, LogicalAndExpr target_29, ExprStmt target_31, ExprStmt target_32, ExprStmt target_33, ExprStmt target_34) {
exists(IfStmt target_22 |
	target_22.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vextra_buffers_size_2856
	and target_22.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
	and target_22.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_2871
	and target_22.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("uint32_t")
	and target_22.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="22"
	and target_22.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_22.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3140"
	and target_22.getThen().(BlockStmt).getStmt(3).(GotoStmt).getName() ="err_bad_extra_size"
	and target_22.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(7)=target_22
	and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_29
	and target_31.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_22.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_32.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_22.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation())
	and target_33.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation().isBefore(target_22.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getLocation())
	and target_22.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getLocation().isBefore(target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation()))
}

predicate func_23(Variable vreturn_error_line_2873, NotExpr target_35) {
exists(ExprStmt target_23 |
	target_23.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_23.getExpr().(AssignExpr).getRValue().(Literal).getValue()="3220"
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(3)=target_23
	and target_23.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_35)
}

predicate func_24(Variable vreturn_error_line_2873, ExprStmt target_36, ExprStmt target_37, Function func) {
exists(ExprStmt target_24 |
	target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_24.getExpr().(AssignExpr).getRValue().(Literal).getValue()="3475"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
	and target_24.getLocation().isBefore(target_36.getLocation())
	and target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation()))
}

predicate func_25(Variable vreturn_error_line_2873, NotExpr target_35, ExprStmt target_25) {
	target_25.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_25.getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_25.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_35
}

predicate func_26(Variable vsecctx_sz_2879, Parameter vextra_buffers_size_2856, BitwiseAndExpr target_26) {
	target_26.getLeftOperand().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vsecctx_sz_2879
	and target_26.getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getValue()="7"
	and target_26.getRightOperand().(ComplementExpr).getValue()="4294967288"
	and target_26.getParent().(AssignAddExpr).getRValue() = target_26
	and target_26.getParent().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vextra_buffers_size_2856
}

predicate func_27(Variable vreturn_error_line_2873, ExprStmt target_27) {
	target_27.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_27.getExpr().(AssignExpr).getRValue() instanceof Literal
}

predicate func_28(Variable vreturn_error_2871, Variable vreturn_error_line_2873, ExprStmt target_28) {
	target_28.getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_28.getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="6binder: %d:%d transaction failed %d/%d, size %lld-%lld line %d\n"
	and target_28.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="pid"
	and target_28.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_proc *")
	and target_28.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="pid"
	and target_28.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_thread *")
	and target_28.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vreturn_error_2871
	and target_28.getExpr().(FunctionCall).getArgument(4).(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_28.getExpr().(FunctionCall).getArgument(5).(PointerFieldAccess).getTarget().getName()="data_size"
	and target_28.getExpr().(FunctionCall).getArgument(5).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_28.getExpr().(FunctionCall).getArgument(6).(PointerFieldAccess).getTarget().getName()="offsets_size"
	and target_28.getExpr().(FunctionCall).getArgument(6).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_28.getExpr().(FunctionCall).getArgument(7).(VariableAccess).getTarget()=vreturn_error_line_2873
}

predicate func_29(Function func, LogicalAndExpr target_29) {
	target_29.getLeftOperand().(VariableAccess).getTarget().getType().hasName("binder_node *")
	and target_29.getRightOperand().(ValueFieldAccess).getTarget().getName()="txn_security_ctx"
	and target_29.getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_29.getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_node *")
	and target_29.getEnclosingFunction() = func
}

predicate func_30(Parameter vextra_buffers_size_2856, ExprStmt target_30) {
	target_30.getExpr().(FunctionCall).getTarget().hasName("printk")
	and target_30.getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="6binder: %d:%d BC_TRANSACTION %d -> %d - node %d, data %016llx-%016llx size %lld-%lld-%lld\n"
	and target_30.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="pid"
	and target_30.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_proc *")
	and target_30.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="pid"
	and target_30.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_thread *")
	and target_30.getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getTarget().getName()="debug_id"
	and target_30.getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction *")
	and target_30.getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="pid"
	and target_30.getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_proc *")
	and target_30.getExpr().(FunctionCall).getArgument(5).(PointerFieldAccess).getTarget().getName()="debug_id"
	and target_30.getExpr().(FunctionCall).getArgument(5).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_node *")
	and target_30.getExpr().(FunctionCall).getArgument(6).(ValueFieldAccess).getTarget().getName()="buffer"
	and target_30.getExpr().(FunctionCall).getArgument(6).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="ptr"
	and target_30.getExpr().(FunctionCall).getArgument(6).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="data"
	and target_30.getExpr().(FunctionCall).getArgument(6).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_30.getExpr().(FunctionCall).getArgument(7).(ValueFieldAccess).getTarget().getName()="offsets"
	and target_30.getExpr().(FunctionCall).getArgument(7).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="ptr"
	and target_30.getExpr().(FunctionCall).getArgument(7).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="data"
	and target_30.getExpr().(FunctionCall).getArgument(7).(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_30.getExpr().(FunctionCall).getArgument(8).(PointerFieldAccess).getTarget().getName()="data_size"
	and target_30.getExpr().(FunctionCall).getArgument(8).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_30.getExpr().(FunctionCall).getArgument(9).(PointerFieldAccess).getTarget().getName()="offsets_size"
	and target_30.getExpr().(FunctionCall).getArgument(9).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_30.getExpr().(FunctionCall).getArgument(10).(VariableAccess).getTarget()=vextra_buffers_size_2856
}

predicate func_31(Variable vreturn_error_2871, VariableAccess target_38, ExprStmt target_31) {
	target_31.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_2871
	and target_31.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_38
}

predicate func_32(Variable vreturn_error_line_2873, ExprStmt target_32) {
	target_32.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_32.getExpr().(AssignExpr).getRValue() instanceof Literal
}

predicate func_33(Parameter vextra_buffers_size_2856, ExprStmt target_33) {
	target_33.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vextra_buffers_size_2856
	and target_33.getExpr().(AssignAddExpr).getRValue() instanceof BitwiseAndExpr
}

predicate func_34(Parameter vextra_buffers_size_2856, ExprStmt target_34) {
	target_34.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="buffer"
	and target_34.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction *")
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("binder_alloc_new_buf")
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="alloc"
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_proc *")
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data_size"
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="offsets_size"
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction_data *")
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vextra_buffers_size_2856
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(LogicalAndExpr).getLeftOperand().(NotExpr).getOperand().(VariableAccess).getTarget().getType().hasName("int")
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(LogicalAndExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_34.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(LogicalAndExpr).getRightOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("binder_transaction *")
}

predicate func_35(Parameter vextra_buffers_size_2856, NotExpr target_35) {
	target_35.getOperand().(EqualityOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vextra_buffers_size_2856
	and target_35.getOperand().(EqualityOperation).getLeftOperand().(BitwiseAndExpr).getRightOperand().(SubExpr).getValue()="7"
	and target_35.getOperand().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
}

predicate func_36(Variable vreturn_error_line_2873, ExprStmt target_36) {
	target_36.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_36.getExpr().(AssignExpr).getRValue() instanceof Literal
}

predicate func_37(Variable vreturn_error_line_2873, ExprStmt target_37) {
	target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_37.getExpr().(AssignExpr).getRValue() instanceof Literal
}

predicate func_38(Variable vret_2858, BlockStmt target_39, VariableAccess target_38) {
	target_38.getTarget()=vret_2858
	and target_38.getParent().(IfStmt).getThen()=target_39
}

predicate func_39(Variable vreturn_error_2871, Variable vreturn_error_line_2873, Variable vret_2858, BlockStmt target_39) {
	target_39.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_2871
	and target_39.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("uint32_t")
	and target_39.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vret_2858
	and target_39.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vreturn_error_line_2873
	and target_39.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
}

from Function func, Variable vreturn_error_2871, Variable vreturn_error_line_2873, Variable vsecctx_sz_2879, Parameter vextra_buffers_size_2856, Variable vret_2858, Literal target_0, Literal target_1, Literal target_2, Literal target_3, Literal target_4, Literal target_5, Literal target_6, Literal target_7, Literal target_8, Literal target_9, Literal target_10, Literal target_11, Literal target_12, Literal target_13, Literal target_14, Literal target_15, Literal target_16, VariableAccess target_17, ExprStmt target_25, BitwiseAndExpr target_26, ExprStmt target_27, ExprStmt target_28, LogicalAndExpr target_29, ExprStmt target_30, ExprStmt target_31, ExprStmt target_32, ExprStmt target_33, ExprStmt target_34, NotExpr target_35, ExprStmt target_36, ExprStmt target_37, VariableAccess target_38, BlockStmt target_39
where
func_0(vreturn_error_line_2873, target_0)
and func_1(vreturn_error_line_2873, target_1)
and func_2(vreturn_error_line_2873, target_2)
and func_3(vreturn_error_line_2873, target_3)
and func_4(vreturn_error_line_2873, target_4)
and func_5(vreturn_error_line_2873, target_5)
and func_6(vreturn_error_line_2873, target_6)
and func_7(vreturn_error_line_2873, target_7)
and func_8(vreturn_error_line_2873, target_8)
and func_9(vreturn_error_line_2873, target_9)
and func_10(vreturn_error_line_2873, target_10)
and func_11(vreturn_error_line_2873, target_11)
and func_12(vreturn_error_line_2873, target_12)
and func_13(vreturn_error_line_2873, target_13)
and func_14(vreturn_error_line_2873, target_14)
and func_15(vreturn_error_line_2873, target_15)
and func_16(vreturn_error_line_2873, target_27, target_16)
and func_17(vreturn_error_line_2873, target_28, target_17)
and not func_19(func)
and not func_20(vextra_buffers_size_2856, target_29, target_30)
and not func_22(vreturn_error_2871, vreturn_error_line_2873, vextra_buffers_size_2856, target_29, target_31, target_32, target_33, target_34)
and not func_23(vreturn_error_line_2873, target_35)
and not func_24(vreturn_error_line_2873, target_36, target_37, func)
and func_25(vreturn_error_line_2873, target_35, target_25)
and func_26(vsecctx_sz_2879, vextra_buffers_size_2856, target_26)
and func_27(vreturn_error_line_2873, target_27)
and func_28(vreturn_error_2871, vreturn_error_line_2873, target_28)
and func_29(func, target_29)
and func_30(vextra_buffers_size_2856, target_30)
and func_31(vreturn_error_2871, target_38, target_31)
and func_32(vreturn_error_line_2873, target_32)
and func_33(vextra_buffers_size_2856, target_33)
and func_34(vextra_buffers_size_2856, target_34)
and func_35(vextra_buffers_size_2856, target_35)
and func_36(vreturn_error_line_2873, target_36)
and func_37(vreturn_error_line_2873, target_37)
and func_38(vret_2858, target_39, target_38)
and func_39(vreturn_error_2871, vreturn_error_line_2873, vret_2858, target_39)
and vreturn_error_2871.getType().hasName("uint32_t")
and vreturn_error_line_2873.getType().hasName("uint32_t")
and vsecctx_sz_2879.getType().hasName("u32")
and vextra_buffers_size_2856.getType().hasName("binder_size_t")
and vret_2858.getType().hasName("int")
and vreturn_error_2871.(LocalVariable).getFunction() = func
and vreturn_error_line_2873.(LocalVariable).getFunction() = func
and vsecctx_sz_2879.(LocalVariable).getFunction() = func
and vextra_buffers_size_2856.getFunction() = func
and vret_2858.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
