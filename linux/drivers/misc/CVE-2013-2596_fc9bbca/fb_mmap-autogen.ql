/**
 * @name linux-fc9bbca8f650e5f738af8806317c0a041a48ae4a-fb_mmap
 * @id cpp/linux/fc9bbca8f650e5f738af8806317c0a041a48ae4a/fb-mmap
 * @description linux-fc9bbca8f650e5f738af8806317c0a041a48ae4a-drivers/video/fbmem.c-fb_mmap CVE-2013-2596
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vvma_1372, Variable voff_1376, ExprStmt target_40, FunctionCall target_4, ExprStmt target_29, BinaryBitwiseOperation target_41, VariableAccess target_0) {
	target_0.getTarget()=voff_1376
	and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("fb_pgprotect")
	and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("file *")
	and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vvma_1372
	and target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
	and target_0.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_4.getArgument(0).(VariableAccess).getLocation())
	and target_29.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getLocation().isBefore(target_0.getLocation())
	and target_0.getLocation().isBefore(target_41.getLeftOperand().(VariableAccess).getLocation())
}

predicate func_1(Variable voff_1376, VariableAccess target_1) {
	target_1.getTarget()=voff_1376
	and target_1.getParent().(AssignExpr).getLValue() = target_1
	and target_1.getParent().(AssignExpr).getRValue() instanceof BinaryBitwiseOperation
}

predicate func_2(Variable voff_1376, Variable vlen_1378, BlockStmt target_42, VariableAccess target_2) {
	target_2.getTarget()=voff_1376
	and target_2.getParent().(GEExpr).getLesserOperand().(VariableAccess).getTarget()=vlen_1378
	and target_2.getParent().(GEExpr).getParent().(IfStmt).getThen()=target_42
}

predicate func_3(Variable voff_1376, VariableAccess target_3) {
	target_3.getTarget()=voff_1376
}

predicate func_4(Parameter vvma_1372, Variable voff_1376, ReturnStmt target_43, FunctionCall target_4) {
	target_4.getTarget().hasName("remap_pfn_range")
	and not target_4.getTarget().hasName("vm_iomap_memory")
	and target_4.getArgument(0).(VariableAccess).getTarget()=vvma_1372
	and target_4.getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_4.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_4.getArgument(2).(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voff_1376
	and target_4.getArgument(2).(BinaryBitwiseOperation).getRightOperand() instanceof Literal
	and target_4.getArgument(3).(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_end"
	and target_4.getArgument(3).(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_4.getArgument(3).(SubExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_4.getArgument(3).(SubExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_4.getArgument(4).(PointerFieldAccess).getTarget().getName()="vm_page_prot"
	and target_4.getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_4.getParent().(IfStmt).getThen()=target_43
}

predicate func_5(Variable voff_1376, ExprStmt target_44, ExprStmt target_5) {
	target_5.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voff_1376
	and target_5.getExpr().(AssignExpr).getRValue() instanceof BinaryBitwiseOperation
	and target_5.getLocation().isBefore(target_44.getLocation())
}

predicate func_6(Parameter vvma_1372, ReturnStmt target_45, PointerFieldAccess target_6) {
	target_6.getTarget().getName()="vm_pgoff"
	and target_6.getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_6.getParent().(GTExpr).getLesserOperand() instanceof BinaryBitwiseOperation
	and target_6.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_45
}

predicate func_7(Variable vinfo_1374, ValueFieldAccess target_7) {
	target_7.getTarget().getName()="smem_len"
	and target_7.getQualifier().(PointerFieldAccess).getTarget().getName()="fix"
	and target_7.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
}

predicate func_8(Function func, ComplementExpr target_8) {
	target_8.getValue()="18446744073709547520"
	and target_8.getEnclosingFunction() = func
}

predicate func_9(Variable vinfo_1374, ValueFieldAccess target_46, ExprStmt target_9) {
	target_9.getExpr().(FunctionCall).getTarget().hasName("mutex_unlock")
	and target_9.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="mm_lock"
	and target_9.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
	and target_9.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_46
}

predicate func_10(Variable vinfo_1374, ValueFieldAccess target_10) {
	target_10.getTarget().getName()="mmio_len"
	and target_10.getQualifier().(PointerFieldAccess).getTarget().getName()="fix"
	and target_10.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
}

predicate func_11(Parameter vvma_1372, Variable voff_1376, PointerFieldAccess target_11) {
	target_11.getTarget().getName()="vm_pgoff"
	and target_11.getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_11.getParent().(AssignExpr).getLValue() = target_11
	and target_11.getParent().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voff_1376
	and target_11.getParent().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand() instanceof Literal
}

predicate func_13(Variable voff_1376, Variable vlen_1378, BlockStmt target_42, VariableAccess target_13) {
	target_13.getTarget()=vlen_1378
	and target_13.getParent().(GEExpr).getGreaterOperand().(VariableAccess).getTarget()=voff_1376
	and target_13.getParent().(GEExpr).getParent().(IfStmt).getThen()=target_42
}

predicate func_14(Variable voff_1376, Variable vlen_1378, VariableAccess target_14) {
	target_14.getTarget()=vlen_1378
	and target_14.getParent().(AssignSubExpr).getRValue() = target_14
	and target_14.getParent().(AssignSubExpr).getLValue().(VariableAccess).getTarget()=voff_1376
}

predicate func_15(Variable vstart_1377, VariableAccess target_15) {
	target_15.getTarget()=vstart_1377
}

predicate func_16(Parameter vvma_1372, Function func, IfStmt target_16) {
	target_16.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_16.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_16.getCondition().(RelationalOperation).getLesserOperand().(BinaryBitwiseOperation).getValue()="4503599627370495"
	and target_16.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

/*predicate func_17(Function func, UnaryMinusExpr target_17) {
	target_17.getValue()="-22"
	and target_17.getEnclosingFunction() = func
}

*/
predicate func_18(Parameter vvma_1372, Variable voff_1376, BinaryBitwiseOperation target_18) {
	target_18.getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_18.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_18.getRightOperand().(Literal).getValue()="12"
	and target_18.getParent().(AssignExpr).getRValue() = target_18
	and target_18.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=voff_1376
}

predicate func_19(Variable vstart_1377, Variable vlen_1378, BitwiseAndExpr target_19) {
	target_19.getLeftOperand().(AddExpr).getLeftOperand().(AddExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vstart_1377
	and target_19.getLeftOperand().(AddExpr).getLeftOperand().(AddExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4095"
	and target_19.getLeftOperand().(AddExpr).getLeftOperand().(AddExpr).getRightOperand() instanceof ValueFieldAccess
	and target_19.getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getValue()="4095"
	and target_19.getRightOperand() instanceof ComplementExpr
	and target_19.getParent().(AssignExpr).getRValue() = target_19
	and target_19.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlen_1378
}

predicate func_20(Variable voff_1376, Variable vlen_1378, RelationalOperation target_47, VariableAccess target_20) {
	target_20.getTarget()=voff_1376
	and target_20.getParent().(AssignSubExpr).getLValue() = target_20
	and target_20.getParent().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vlen_1378
	and target_47.getGreaterOperand().(VariableAccess).getLocation().isBefore(target_20.getLocation())
}

predicate func_21(Variable vinfo_1374, RelationalOperation target_47, IfStmt target_21) {
	target_21.getCondition().(ValueFieldAccess).getTarget().getName()="accel_flags"
	and target_21.getCondition().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="var"
	and target_21.getCondition().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
	and target_21.getThen().(BlockStmt).getStmt(0) instanceof ExprStmt
	and target_21.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_47
}

/*predicate func_22(ValueFieldAccess target_46, Function func, ReturnStmt target_22) {
	target_22.getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_22.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_46
	and target_22.getEnclosingFunction() = func
}

*/
predicate func_23(Variable vstart_1377, Variable vlen_1378, BitwiseAndExpr target_23) {
	target_23.getLeftOperand().(AddExpr).getLeftOperand().(AddExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vstart_1377
	and target_23.getLeftOperand().(AddExpr).getLeftOperand().(AddExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4095"
	and target_23.getLeftOperand().(AddExpr).getLeftOperand().(AddExpr).getRightOperand() instanceof ValueFieldAccess
	and target_23.getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getValue()="4095"
	and target_23.getRightOperand().(ComplementExpr).getValue()="18446744073709547520"
	and target_23.getParent().(AssignExpr).getRValue() = target_23
	and target_23.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vlen_1378
}

/*predicate func_24(Function func, ComplementExpr target_24) {
	target_24.getValue()="4095"
	and target_24.getEnclosingFunction() = func
}

*/
predicate func_25(Variable vinfo_1374, Function func, ExprStmt target_25) {
	target_25.getExpr().(FunctionCall).getTarget().hasName("mutex_unlock")
	and target_25.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="mm_lock"
	and target_25.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
}

predicate func_26(Variable vstart_1377, Function func, ExprStmt target_26) {
	target_26.getExpr().(AssignAndExpr).getLValue().(VariableAccess).getTarget()=vstart_1377
	and target_26.getExpr().(AssignAndExpr).getRValue().(ComplementExpr).getValue()="18446744073709547520"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_26
}

predicate func_27(Parameter vvma_1372, Variable voff_1376, Variable vlen_1378, Function func, IfStmt target_27) {
	target_27.getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_end"
	and target_27.getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_27.getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getLeftOperand().(SubExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_27.getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getLeftOperand().(SubExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_27.getCondition().(RelationalOperation).getGreaterOperand().(AddExpr).getRightOperand().(VariableAccess).getTarget()=voff_1376
	and target_27.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vlen_1378
	and target_27.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
}

predicate func_28(Variable voff_1376, Variable vstart_1377, Function func, ExprStmt target_28) {
	target_28.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=voff_1376
	and target_28.getExpr().(AssignAddExpr).getRValue().(VariableAccess).getTarget()=vstart_1377
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

predicate func_29(Parameter vvma_1372, Variable voff_1376, Function func, ExprStmt target_29) {
	target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_29.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voff_1376
	and target_29.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="12"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

/*predicate func_30(Variable voff_1376, ExprStmt target_28, ExprStmt target_50, VariableAccess target_30) {
	target_30.getTarget()=voff_1376
	and target_28.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation().isBefore(target_30.getLocation())
	and target_30.getLocation().isBefore(target_50.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation())
}

*/
predicate func_32(Function func, IfStmt target_32) {
	target_32.getCondition() instanceof FunctionCall
	and target_32.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-11"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_32
}

predicate func_33(Parameter vvma_1372, SubExpr target_51, VariableAccess target_33) {
	target_33.getTarget()=vvma_1372
	and target_33.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
	and target_33.getLocation().isBefore(target_51.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_34(Variable voff_1376, ExprStmt target_50, VariableAccess target_34) {
	target_34.getTarget()=voff_1376
	and target_34.getParent().(RShiftExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
	and target_50.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_34.getLocation())
}

predicate func_36(Parameter vvma_1372, FunctionCall target_4, PointerFieldAccess target_36) {
	target_36.getTarget().getName()="vm_end"
	and target_36.getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_4.getArgument(0).(VariableAccess).getLocation().isBefore(target_36.getQualifier().(VariableAccess).getLocation())
}

predicate func_37(Parameter vvma_1372, PointerFieldAccess target_37) {
	target_37.getTarget().getName()="vm_start"
	and target_37.getQualifier().(VariableAccess).getTarget()=vvma_1372
}

predicate func_38(Parameter vvma_1372, VariableAccess target_38) {
	target_38.getTarget()=vvma_1372
	and target_38.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
}

predicate func_39(Function func, ReturnStmt target_39) {
	target_39.getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_39
}

predicate func_40(Parameter vvma_1372, ExprStmt target_40) {
	target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vm_page_prot"
	and target_40.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_40.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vm_get_page_prot")
	and target_40.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="vm_flags"
	and target_40.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
}

predicate func_41(Parameter vvma_1372, Variable voff_1376, ReturnStmt target_43, BinaryBitwiseOperation target_41) {
	target_41.getLeftOperand().(VariableAccess).getTarget()=voff_1376
	and target_41.getRightOperand() instanceof Literal
	and target_41.getParent().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_1372
	and target_41.getParent().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_41.getParent().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_41.getParent().(FunctionCall).getArgument(3).(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_end"
	and target_41.getParent().(FunctionCall).getArgument(3).(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_41.getParent().(FunctionCall).getArgument(3).(SubExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_41.getParent().(FunctionCall).getArgument(3).(SubExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_41.getParent().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="vm_page_prot"
	and target_41.getParent().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_41.getParent().(FunctionCall).getParent().(IfStmt).getThen()=target_43
}

predicate func_42(Variable vinfo_1374, Variable voff_1376, Variable vstart_1377, Variable vlen_1378, BlockStmt target_42) {
	target_42.getStmt(0).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(VariableAccess).getTarget()=voff_1376
	and target_42.getStmt(0).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vlen_1378
	and target_42.getStmt(1) instanceof IfStmt
	and target_42.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstart_1377
	and target_42.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="mmio_start"
	and target_42.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="fix"
	and target_42.getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
}

predicate func_43(Function func, ReturnStmt target_43) {
	target_43.getExpr() instanceof UnaryMinusExpr
	and target_43.getEnclosingFunction() = func
}

predicate func_44(Variable vinfo_1374, ExprStmt target_44) {
	target_44.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("fb_ops *")
	and target_44.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="fbops"
	and target_44.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
}

predicate func_45(RelationalOperation target_52, Function func, ReturnStmt target_45) {
	target_45.getExpr() instanceof UnaryMinusExpr
	and target_45.getParent().(IfStmt).getCondition()=target_52
	and target_45.getEnclosingFunction() = func
}

predicate func_46(Variable vinfo_1374, ValueFieldAccess target_46) {
	target_46.getTarget().getName()="accel_flags"
	and target_46.getQualifier().(PointerFieldAccess).getTarget().getName()="var"
	and target_46.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinfo_1374
}

predicate func_47(Variable voff_1376, Variable vlen_1378, RelationalOperation target_47) {
	 (target_47 instanceof GEExpr or target_47 instanceof LEExpr)
	and target_47.getGreaterOperand().(VariableAccess).getTarget()=voff_1376
	and target_47.getLesserOperand().(VariableAccess).getTarget()=vlen_1378
}

predicate func_50(Parameter vvma_1372, Variable voff_1376, ExprStmt target_50) {
	target_50.getExpr().(FunctionCall).getTarget().hasName("fb_pgprotect")
	and target_50.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("file *")
	and target_50.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vvma_1372
	and target_50.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=voff_1376
}

predicate func_51(Parameter vvma_1372, Variable voff_1376, ReturnStmt target_43, SubExpr target_51) {
	target_51.getLeftOperand().(PointerFieldAccess).getTarget().getName()="vm_end"
	and target_51.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_51.getRightOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_51.getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_51.getParent().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vvma_1372
	and target_51.getParent().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_51.getParent().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_51.getParent().(FunctionCall).getArgument(2).(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getTarget()=voff_1376
	and target_51.getParent().(FunctionCall).getArgument(2).(BinaryBitwiseOperation).getRightOperand() instanceof Literal
	and target_51.getParent().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="vm_page_prot"
	and target_51.getParent().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_51.getParent().(FunctionCall).getParent().(IfStmt).getThen()=target_43
}

predicate func_52(Parameter vvma_1372, RelationalOperation target_52) {
	 (target_52 instanceof GTExpr or target_52 instanceof LTExpr)
	and target_52.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_pgoff"
	and target_52.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_1372
	and target_52.getLesserOperand() instanceof BinaryBitwiseOperation
}

from Function func, Parameter vvma_1372, Variable vinfo_1374, Variable voff_1376, Variable vstart_1377, Variable vlen_1378, VariableAccess target_0, VariableAccess target_1, VariableAccess target_2, VariableAccess target_3, FunctionCall target_4, ExprStmt target_5, PointerFieldAccess target_6, ValueFieldAccess target_7, ComplementExpr target_8, ExprStmt target_9, ValueFieldAccess target_10, PointerFieldAccess target_11, VariableAccess target_13, VariableAccess target_14, VariableAccess target_15, IfStmt target_16, BinaryBitwiseOperation target_18, BitwiseAndExpr target_19, VariableAccess target_20, IfStmt target_21, BitwiseAndExpr target_23, ExprStmt target_25, ExprStmt target_26, IfStmt target_27, ExprStmt target_28, ExprStmt target_29, IfStmt target_32, VariableAccess target_33, VariableAccess target_34, PointerFieldAccess target_36, PointerFieldAccess target_37, VariableAccess target_38, ReturnStmt target_39, ExprStmt target_40, BinaryBitwiseOperation target_41, BlockStmt target_42, ReturnStmt target_43, ExprStmt target_44, ReturnStmt target_45, ValueFieldAccess target_46, RelationalOperation target_47, ExprStmt target_50, SubExpr target_51, RelationalOperation target_52
where
func_0(vvma_1372, voff_1376, target_40, target_4, target_29, target_41, target_0)
and func_1(voff_1376, target_1)
and func_2(voff_1376, vlen_1378, target_42, target_2)
and func_3(voff_1376, target_3)
and func_4(vvma_1372, voff_1376, target_43, target_4)
and func_5(voff_1376, target_44, target_5)
and func_6(vvma_1372, target_45, target_6)
and func_7(vinfo_1374, target_7)
and func_8(func, target_8)
and func_9(vinfo_1374, target_46, target_9)
and func_10(vinfo_1374, target_10)
and func_11(vvma_1372, voff_1376, target_11)
and func_13(voff_1376, vlen_1378, target_42, target_13)
and func_14(voff_1376, vlen_1378, target_14)
and func_15(vstart_1377, target_15)
and func_16(vvma_1372, func, target_16)
and func_18(vvma_1372, voff_1376, target_18)
and func_19(vstart_1377, vlen_1378, target_19)
and func_20(voff_1376, vlen_1378, target_47, target_20)
and func_21(vinfo_1374, target_47, target_21)
and func_23(vstart_1377, vlen_1378, target_23)
and func_25(vinfo_1374, func, target_25)
and func_26(vstart_1377, func, target_26)
and func_27(vvma_1372, voff_1376, vlen_1378, func, target_27)
and func_28(voff_1376, vstart_1377, func, target_28)
and func_29(vvma_1372, voff_1376, func, target_29)
and func_32(func, target_32)
and func_33(vvma_1372, target_51, target_33)
and func_34(voff_1376, target_50, target_34)
and func_36(vvma_1372, target_4, target_36)
and func_37(vvma_1372, target_37)
and func_38(vvma_1372, target_38)
and func_39(func, target_39)
and func_40(vvma_1372, target_40)
and func_41(vvma_1372, voff_1376, target_43, target_41)
and func_42(vinfo_1374, voff_1376, vstart_1377, vlen_1378, target_42)
and func_43(func, target_43)
and func_44(vinfo_1374, target_44)
and func_45(target_52, func, target_45)
and func_46(vinfo_1374, target_46)
and func_47(voff_1376, vlen_1378, target_47)
and func_50(vvma_1372, voff_1376, target_50)
and func_51(vvma_1372, voff_1376, target_43, target_51)
and func_52(vvma_1372, target_52)
and vvma_1372.getType().hasName("vm_area_struct *")
and vinfo_1374.getType().hasName("fb_info *")
and voff_1376.getType().hasName("unsigned long")
and vstart_1377.getType().hasName("unsigned long")
and vlen_1378.getType().hasName("u32")
and vvma_1372.getFunction() = func
and vinfo_1374.(LocalVariable).getFunction() = func
and voff_1376.(LocalVariable).getFunction() = func
and vstart_1377.(LocalVariable).getFunction() = func
and vlen_1378.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
