/**
 * @name linux-0f2122045b946241a9e549c2a76cea54fa58a7ff-io_init_req
 * @id cpp/linux/0f2122045b946241a9e549c2a76cea54fa58a7ff/io-init-req
 * @description linux-0f2122045b946241a9e549c2a76cea54fa58a7ff-fs/io_uring.c-io_init_req CVE-2020-29534
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_2(Parameter vreq_6445, FunctionCall target_2) {
	target_2.getTarget().hasName("refcount_set")
	and not target_2.getTarget().hasName("put_task_struct_many")
	and target_2.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="refs"
	and target_2.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_2.getArgument(1).(Literal).getValue()="2"
}

predicate func_3(Function func) {
exists(PointerFieldAccess target_3 |
	target_3.getTarget().getName()="to_free"
	and target_3.getQualifier().(VariableAccess).getType().hasName("req_batch *")
	and target_3.getEnclosingFunction() = func)
}

predicate func_5(Function func) {
exists(PointerFieldAccess target_5 |
	target_5.getTarget().getName()="task"
	and target_5.getQualifier().(VariableAccess).getType().hasName("req_batch *")
	and target_5.getEnclosingFunction() = func)
}

predicate func_6(Function func) {
exists(PointerFieldAccess target_6 |
	target_6.getTarget().getName()="task_refs"
	and target_6.getQualifier().(VariableAccess).getType().hasName("req_batch *")
	and target_6.getEnclosingFunction() = func)
}

predicate func_7(Function func) {
exists(AddressOfExpr target_7 |
	target_7.getOperand().(PointerFieldAccess).getTarget().getName()="req_complete"
	and target_7.getOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="io_uring"
	and target_7.getOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="task"
	and target_7.getOperand().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("req_batch *")
	and target_7.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_7.getEnclosingFunction() = func)
}

predicate func_9(Function func) {
exists(PointerFieldAccess target_9 |
	target_9.getTarget().getName()="task_refs"
	and target_9.getQualifier().(VariableAccess).getType().hasName("req_batch *")
	and target_9.getEnclosingFunction() = func)
}

predicate func_12(Parameter vctx_6445, VariableAccess target_12) {
	target_12.getTarget()=vctx_6445
	and target_12.getParent().(FunctionCall).getParent().(NotExpr).getOperand() instanceof FunctionCall
}

predicate func_13(Function func, DeclStmt target_13) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_13
}

predicate func_14(Function func, DeclStmt target_14) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(Parameter vreq_6445, AssignExpr target_15) {
	target_15.getLValue().(PointerFieldAccess).getTarget().getName()="opcode"
	and target_15.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_15.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_15.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="opcode"
}

/*predicate func_16(Function func, DoStmt target_16) {
	target_16.getCondition().(Literal).getValue()="0"
	and target_16.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_16.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_16.getEnclosingFunction() = func
}

*/
/*predicate func_18(ExprStmt target_65, Function func, NotExpr target_18) {
	target_18.getValue()="0"
	and target_18.getParent().(IfStmt).getThen()=target_65
	and target_18.getEnclosingFunction() = func
}

*/
/*predicate func_19(Parameter vsqe_6446, PointerDereferenceExpr target_19) {
	target_19.getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="opcode"
	and target_19.getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsqe_6446
}

*/
predicate func_20(Parameter vreq_6445, Function func, ExprStmt target_20) {
	target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="user_data"
	and target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_20.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
}

/*predicate func_21(Function func, DoStmt target_21) {
	target_21.getCondition().(Literal).getValue()="0"
	and target_21.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_21.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_21.getEnclosingFunction() = func
}

*/
/*predicate func_23(ExprStmt target_24, Function func, NotExpr target_23) {
	target_23.getValue()="0"
	and target_23.getParent().(IfStmt).getThen()=target_24
	and target_23.getEnclosingFunction() = func
}

*/
/*predicate func_24(NotExpr target_23, Function func, ExprStmt target_24) {
	target_24.getExpr() instanceof FunctionCall
	and target_24.getParent().(IfStmt).getCondition()=target_23
	and target_24.getEnclosingFunction() = func
}

*/
/*predicate func_25(Parameter vsqe_6446, ExprStmt target_25) {
	target_25.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="user_data"
	and target_25.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsqe_6446
}

*/
predicate func_26(Parameter vreq_6445, Function func, ExprStmt target_26) {
	target_26.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="io"
	and target_26.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_26.getExpr().(AssignExpr).getRValue() instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_26
}

predicate func_27(Parameter vreq_6445, Function func, ExprStmt target_27) {
	target_27.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="file"
	and target_27.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_27.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_27.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
}

predicate func_28(Parameter vctx_6445, Parameter vreq_6445, Function func, ExprStmt target_28) {
	target_28.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ctx"
	and target_28.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_28.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vctx_6445
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
}

predicate func_29(Parameter vreq_6445, Function func, ExprStmt target_29) {
	target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_29.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

predicate func_30(Function func, ExprStmt target_30) {
	target_30.getExpr() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

predicate func_31(Parameter vreq_6445, PointerFieldAccess target_31) {
	target_31.getTarget().getName()="refs"
	and target_31.getQualifier().(VariableAccess).getTarget()=vreq_6445
}

predicate func_32(Parameter vreq_6445, Function func, ExprStmt target_32) {
	target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="task"
	and target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_32.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("get_current")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_32
}

/*predicate func_33(Parameter vreq_6445, AddressOfExpr target_66, ExprStmt target_35, VariableAccess target_33) {
	target_33.getTarget()=vreq_6445
	and target_66.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_33.getLocation())
	and target_33.getLocation().isBefore(target_35.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
/*predicate func_34(Parameter vreq_6445, FunctionCall target_34) {
	target_34.getTarget().hasName("get_current")
	and target_34.getParent().(AssignExpr).getRValue() = target_34
	and target_34.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="task"
	and target_34.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
}

*/
predicate func_35(Parameter vreq_6445, Function func, ExprStmt target_35) {
	target_35.getExpr().(FunctionCall).getTarget().hasName("get_task_struct")
	and target_35.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="task"
	and target_35.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
}

/*predicate func_36(Parameter vreq_6445, ExprStmt target_32, ExprStmt target_37, VariableAccess target_36) {
	target_36.getTarget()=vreq_6445
	and target_36.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("get_task_struct")
	and target_36.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="task"
	and target_32.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_36.getLocation())
	and target_36.getLocation().isBefore(target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

*/
predicate func_37(Parameter vreq_6445, Function func, ExprStmt target_37) {
	target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="result"
	and target_37.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_37.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_37
}

predicate func_38(Parameter vreq_6445, Function func, IfStmt target_38) {
	target_38.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_38.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="opcode"
	and target_38.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_38.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_38.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

/*predicate func_39(Function func, UnaryMinusExpr target_39) {
	target_39.getValue()="-22"
	and target_39.getEnclosingFunction() = func
}

*/
predicate func_40(Parameter vctx_6445, Parameter vreq_6445, Function func, IfStmt target_40) {
	target_40.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_40.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("io_sq_thread_acquire_mm")
	and target_40.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_6445
	and target_40.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vreq_6445
	and target_40.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_40.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_40
}

predicate func_41(Variable vsqe_flags_6449, Function func, ExprStmt target_41) {
	target_41.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsqe_flags_6449
	and target_41.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_41
}

/*predicate func_42(Function func, DoStmt target_42) {
	target_42.getCondition().(Literal).getValue()="0"
	and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_42.getEnclosingFunction() = func
}

*/
/*predicate func_44(Function func, IfStmt target_44) {
	target_44.getCondition().(NotExpr).getValue()="0"
	and target_44.getEnclosingFunction() = func
}

*/
/*predicate func_45(Parameter vsqe_6446, ExprStmt target_45) {
	target_45.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_45.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsqe_6446
}

*/
predicate func_46(Variable vsqe_flags_6449, Function func, IfStmt target_46) {
	target_46.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_46.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vsqe_flags_6449
	and target_46.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294967232"
	and target_46.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_46.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

predicate func_47(Variable vsqe_flags_6449, Variable vio_op_defs, Parameter vreq_6445, Function func, IfStmt target_47) {
	target_47.getCondition().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vsqe_flags_6449
	and target_47.getCondition().(LogicalAndExpr).getLeftOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="32"
	and target_47.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="buffer_select"
	and target_47.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vio_op_defs
	and target_47.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getTarget().getName()="opcode"
	and target_47.getCondition().(LogicalAndExpr).getRightOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_47.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-95"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_47
}

predicate func_48(Variable vid_6450, Function func, ExprStmt target_48) {
	target_48.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vid_6450
	and target_48.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

/*predicate func_49(Function func, DoStmt target_49) {
	target_49.getCondition().(Literal).getValue()="0"
	and target_49.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_49.getEnclosingFunction() = func
}

*/
/*predicate func_51(Function func, IfStmt target_51) {
	target_51.getCondition().(NotExpr).getValue()="0"
	and target_51.getEnclosingFunction() = func
}

*/
/*predicate func_52(Parameter vsqe_6446, ExprStmt target_52) {
	target_52.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="personality"
	and target_52.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="(unknown field)"
	and target_52.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_52.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsqe_6446
}

*/
predicate func_53(Variable vid_6450, Parameter vreq_6445, Function func, IfStmt target_53) {
	target_53.getCondition().(VariableAccess).getTarget()=vid_6450
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("io_req_init_async")
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vreq_6445
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="creds"
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="work"
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("idr_find")
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="personality_idr"
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vid_6450
	and target_53.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_53.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_53.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_53.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("get_cred")
	and target_53.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="creds"
	and target_53.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="work"
	and target_53.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_53
}

/*predicate func_54(Parameter vreq_6445, FunctionCall target_54) {
	target_54.getTarget().hasName("io_req_init_async")
	and target_54.getArgument(0).(VariableAccess).getTarget()=vreq_6445
}

*/
/*predicate func_55(Variable vid_6450, Parameter vctx_6445, Parameter vreq_6445, VariableAccess target_67, ExprStmt target_55) {
	target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="creds"
	and target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="work"
	and target_55.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("idr_find")
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="personality_idr"
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_6445
	and target_55.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vid_6450
	and target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
}

*/
/*predicate func_56(VariableAccess target_67, Function func, IfStmt target_56) {
	target_56.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_56.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="creds"
	and target_56.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="work"
	and target_56.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_56.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_56.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
	and target_56.getEnclosingFunction() = func
}

*/
/*predicate func_57(Parameter vreq_6445, VariableAccess target_67, ExprStmt target_57) {
	target_57.getExpr().(FunctionCall).getTarget().hasName("get_cred")
	and target_57.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="creds"
	and target_57.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="work"
	and target_57.getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_57.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
}

*/
predicate func_58(Variable vsqe_flags_6449, Parameter vreq_6445, Function func, ExprStmt target_58) {
	target_58.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_58.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_58.getExpr().(AssignOrExpr).getRValue().(VariableAccess).getTarget()=vsqe_flags_6449
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_58
}

predicate func_59(Variable vio_op_defs, Parameter vreq_6445, Function func, IfStmt target_59) {
	target_59.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="needs_file"
	and target_59.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vio_op_defs
	and target_59.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getTarget().getName()="opcode"
	and target_59.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
	and target_59.getThen().(ReturnStmt).getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_59
}

predicate func_60(Parameter vstate_6447, Parameter vreq_6445, Function func, ReturnStmt target_60) {
	target_60.getExpr().(FunctionCall).getTarget().hasName("io_req_set_file")
	and target_60.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vstate_6447
	and target_60.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vreq_6445
	and target_60.getExpr().(FunctionCall).getArgument(2).(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_60
}

/*predicate func_61(Function func, DoStmt target_61) {
	target_61.getCondition().(Literal).getValue()="0"
	and target_61.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_61.getEnclosingFunction() = func
}

*/
/*predicate func_63(Function func, IfStmt target_63) {
	target_63.getCondition().(NotExpr).getValue()="0"
	and target_63.getEnclosingFunction() = func
}

*/
/*predicate func_64(Parameter vsqe_6446, ExprStmt target_64) {
	target_64.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="fd"
	and target_64.getExpr().(PointerDereferenceExpr).getOperand().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsqe_6446
}

*/
predicate func_65(Function func, ExprStmt target_65) {
	target_65.getExpr() instanceof FunctionCall
	and target_65.getEnclosingFunction() = func
}

predicate func_66(Parameter vreq_6445, AddressOfExpr target_66) {
	target_66.getOperand().(PointerFieldAccess).getTarget().getName()="refs"
	and target_66.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreq_6445
}

predicate func_67(Variable vid_6450, BlockStmt target_68, VariableAccess target_67) {
	target_67.getTarget()=vid_6450
	and target_67.getParent().(IfStmt).getThen()=target_68
}

predicate func_68(Function func, BlockStmt target_68) {
	target_68.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_68.getStmt(1) instanceof ExprStmt
	and target_68.getStmt(2) instanceof IfStmt
	and target_68.getStmt(3) instanceof ExprStmt
	and target_68.getEnclosingFunction() = func
}

from Function func, Parameter vsqe_6446, Parameter vstate_6447, Variable vsqe_flags_6449, Variable vid_6450, Variable vio_op_defs, Parameter vctx_6445, Parameter vreq_6445, FunctionCall target_2, VariableAccess target_12, DeclStmt target_13, DeclStmt target_14, AssignExpr target_15, ExprStmt target_20, ExprStmt target_26, ExprStmt target_27, ExprStmt target_28, ExprStmt target_29, ExprStmt target_30, PointerFieldAccess target_31, ExprStmt target_32, ExprStmt target_35, ExprStmt target_37, IfStmt target_38, IfStmt target_40, ExprStmt target_41, IfStmt target_46, IfStmt target_47, ExprStmt target_48, IfStmt target_53, ExprStmt target_58, IfStmt target_59, ReturnStmt target_60, ExprStmt target_65, AddressOfExpr target_66, VariableAccess target_67, BlockStmt target_68
where
func_2(vreq_6445, target_2)
and not func_3(func)
and not func_5(func)
and not func_6(func)
and not func_7(func)
and not func_9(func)
and func_12(vctx_6445, target_12)
and func_13(func, target_13)
and func_14(func, target_14)
and func_15(vreq_6445, target_15)
and func_20(vreq_6445, func, target_20)
and func_26(vreq_6445, func, target_26)
and func_27(vreq_6445, func, target_27)
and func_28(vctx_6445, vreq_6445, func, target_28)
and func_29(vreq_6445, func, target_29)
and func_30(func, target_30)
and func_31(vreq_6445, target_31)
and func_32(vreq_6445, func, target_32)
and func_35(vreq_6445, func, target_35)
and func_37(vreq_6445, func, target_37)
and func_38(vreq_6445, func, target_38)
and func_40(vctx_6445, vreq_6445, func, target_40)
and func_41(vsqe_flags_6449, func, target_41)
and func_46(vsqe_flags_6449, func, target_46)
and func_47(vsqe_flags_6449, vio_op_defs, vreq_6445, func, target_47)
and func_48(vid_6450, func, target_48)
and func_53(vid_6450, vreq_6445, func, target_53)
and func_58(vsqe_flags_6449, vreq_6445, func, target_58)
and func_59(vio_op_defs, vreq_6445, func, target_59)
and func_60(vstate_6447, vreq_6445, func, target_60)
and func_65(func, target_65)
and func_66(vreq_6445, target_66)
and func_67(vid_6450, target_68, target_67)
and func_68(func, target_68)
and vsqe_6446.getType().hasName("const io_uring_sqe *")
and vstate_6447.getType().hasName("io_submit_state *")
and vsqe_flags_6449.getType().hasName("unsigned int")
and vid_6450.getType().hasName("int")
and vio_op_defs.getType() instanceof ArrayType
and vctx_6445.getType().hasName("io_ring_ctx *")
and vreq_6445.getType().hasName("io_kiocb *")
and vsqe_6446.getFunction() = func
and vstate_6447.getFunction() = func
and vsqe_flags_6449.(LocalVariable).getFunction() = func
and vid_6450.(LocalVariable).getFunction() = func
and not vio_op_defs.getParentScope+() = func
and vctx_6445.getFunction() = func
and vreq_6445.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
