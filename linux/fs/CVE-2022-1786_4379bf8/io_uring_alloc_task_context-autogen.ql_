/**
 * @name linux-4379bf8bd70b5de6bba7d53015b0c36c57a634ee-io_uring_alloc_task_context
 * @id cpp/linux/4379bf8bd70b5de6bba7d53015b0c36c57a634ee/io-uring-alloc-task-context
 * @description linux-4379bf8bd70b5de6bba7d53015b0c36c57a634ee-fs/io_uring.c-io_uring_alloc_task_context CVE-2022-1786
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
	target_0.getValue()="12"
	and not target_0.getValue()="2"
	and target_0.getParent().(UnaryMinusExpr).getParent().(ReturnStmt).getExpr() instanceof UnaryMinusExpr
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Variable vret_7914, VariableAccess target_1) {
	target_1.getTarget()=vret_7914
	and target_1.getParent().(AssignExpr).getLValue() = target_1
	and target_1.getParent().(AssignExpr).getRValue() instanceof StmtExpr
}

predicate func_2(Function func, Literal target_2) {
	target_2.getValue()="0"
	and not target_2.getValue()="2"
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Variable vret_7914, VariableAccess target_3) {
	target_3.getTarget()=vret_7914
	and target_3.getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
}

predicate func_4(Function func, Literal target_4) {
	target_4.getValue()="0"
	and not target_4.getValue()="1"
	and target_4.getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Variable vtctx_7913, FunctionCall target_5) {
	target_5.getTarget().hasName("kfree")
	and not target_5.getTarget().hasName("seq_printf")
	and target_5.getArgument(0).(VariableAccess).getTarget()=vtctx_7913
}

predicate func_6(Variable vret_7914, VariableAccess target_6) {
	target_6.getTarget()=vret_7914
}

predicate func_7(Variable vret_7914, VariableAccess target_7) {
	target_7.getTarget()=vret_7914
	and target_7.getParent().(AssignExpr).getLValue() = target_7
	and target_7.getParent().(AssignExpr).getRValue() instanceof FunctionCall
}

predicate func_8(Variable vtctx_7913, FunctionCall target_8) {
	target_8.getTarget().hasName("percpu_counter_destroy")
	and not target_8.getTarget().hasName("seq_put_decimal_ull")
	and target_8.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="inflight"
	and target_8.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_9(Variable vtctx_7913, FunctionCall target_9) {
	target_9.getTarget().hasName("kfree")
	and not target_9.getTarget().hasName("seq_put_decimal_ull")
	and target_9.getArgument(0).(VariableAccess).getTarget()=vtctx_7913
}

predicate func_10(Variable vret_7914, VariableAccess target_10) {
	target_10.getTarget()=vret_7914
}

predicate func_11(Variable vtctx_7913, FunctionCall target_11) {
	target_11.getTarget().hasName("xa_init")
	and not target_11.getTarget().hasName("seq_put_decimal_ull")
	and target_11.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="xa"
	and target_11.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_12(Function func, Literal target_12) {
	target_12.getValue()="0"
	and not target_12.getValue()="8"
	and target_12.getParent().(DoStmt).getParent().(BlockStmt).getStmt(9) instanceof DoStmt
	and target_12.getEnclosingFunction() = func
}

predicate func_13(Variable vtctx_7913, Variable v__key_7935, FunctionCall target_13) {
	target_13.getTarget().hasName("__init_waitqueue_head")
	and not target_13.getTarget().hasName("seq_put_decimal_ull")
	and target_13.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="wait"
	and target_13.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_13.getArgument(1).(StringLiteral).getValue()="&tctx->wait"
	and target_13.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_7935
}

predicate func_14(Variable vtctx_7913, FunctionCall target_14) {
	target_14.getTarget().hasName("atomic_set")
	and not target_14.getTarget().hasName("seq_put_decimal_ull")
	and target_14.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="in_idle"
	and target_14.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_14.getArgument(1).(Literal).getValue()="0"
}

predicate func_15(Variable vtctx_7913, FunctionCall target_15) {
	target_15.getTarget().hasName("io_init_identity")
	and not target_15.getTarget().hasName("seq_put_decimal_ull")
	and target_15.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="__identity"
	and target_15.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_16(Variable v__key_7942, FunctionCall target_16) {
	target_16.getTarget().hasName("__raw_spin_lock_init")
	and not target_16.getTarget().hasName("seq_put_decimal_ull")
	and target_16.getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
	and target_16.getArgument(0).(FunctionCall).getArgument(0) instanceof AddressOfExpr
	and target_16.getArgument(1).(StringLiteral).getValue()="&tctx->task_lock"
	and target_16.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_7942
}

predicate func_17(Variable vtctx_7913, FunctionCall target_17) {
	target_17.getTarget().hasName("init_task_work")
	and not target_17.getTarget().hasName("seq_put_decimal_ull")
	and target_17.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="task_work"
	and target_17.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_18(IfStmt target_72, Function func, ExprStmt target_18) {
	target_18.getExpr() instanceof AssignExpr
	and target_18.getLocation().isBefore(target_72.getLocation())
	and target_18.getEnclosingFunction() = func
}

predicate func_19(DoStmt target_77, Function func, ExprStmt target_19) {
	target_19.getExpr() instanceof FunctionCall
	and target_19.getLocation().isBefore(target_77.getLocation())
	and target_19.getEnclosingFunction() = func
}

predicate func_28(Function func) {
exists(FunctionCall target_28 |
	target_28.getTarget().hasName("from_kuid_munged")
	and target_28.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_28.getArgument(1).(PointerFieldAccess).getTarget().getName()="uid"
	and target_28.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_28.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_28.getEnclosingFunction() = func)
}

predicate func_31(Function func) {
exists(FunctionCall target_31 |
	target_31.getTarget().hasName("from_kuid_munged")
	and target_31.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_31.getArgument(1).(PointerFieldAccess).getTarget().getName()="euid"
	and target_31.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_31.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_31.getEnclosingFunction() = func)
}

predicate func_34(Function func) {
exists(FunctionCall target_34 |
	target_34.getTarget().hasName("from_kuid_munged")
	and target_34.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_34.getArgument(1).(PointerFieldAccess).getTarget().getName()="suid"
	and target_34.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_34.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_34.getEnclosingFunction() = func)
}

predicate func_37(Function func) {
exists(FunctionCall target_37 |
	target_37.getTarget().hasName("from_kuid_munged")
	and target_37.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_37.getArgument(1).(PointerFieldAccess).getTarget().getName()="fsuid"
	and target_37.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_37.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_37.getEnclosingFunction() = func)
}

predicate func_40(Function func) {
exists(FunctionCall target_40 |
	target_40.getTarget().hasName("from_kgid_munged")
	and target_40.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_40.getArgument(1).(PointerFieldAccess).getTarget().getName()="gid"
	and target_40.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_40.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_40.getEnclosingFunction() = func)
}

predicate func_43(Function func) {
exists(FunctionCall target_43 |
	target_43.getTarget().hasName("from_kgid_munged")
	and target_43.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_43.getArgument(1).(PointerFieldAccess).getTarget().getName()="egid"
	and target_43.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_43.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_43.getEnclosingFunction() = func)
}

predicate func_46(Function func) {
exists(FunctionCall target_46 |
	target_46.getTarget().hasName("from_kgid_munged")
	and target_46.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_46.getArgument(1).(PointerFieldAccess).getTarget().getName()="sgid"
	and target_46.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_46.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_46.getEnclosingFunction() = func)
}

predicate func_49(Function func) {
exists(FunctionCall target_49 |
	target_49.getTarget().hasName("from_kgid_munged")
	and target_49.getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_49.getArgument(1).(PointerFieldAccess).getTarget().getName()="fsgid"
	and target_49.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_49.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_49.getEnclosingFunction() = func)
}

predicate func_50(Function func) {
exists(FunctionCall target_50 |
	target_50.getTarget().hasName("seq_puts")
	and target_50.getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_50.getArgument(1).(StringLiteral).getValue()="\n\tGroups:\t"
	and target_50.getEnclosingFunction() = func)
}

predicate func_51(Function func) {
exists(AssignExpr target_51 |
	target_51.getLValue().(VariableAccess).getType().hasName("group_info *")
	and target_51.getRValue().(PointerFieldAccess).getTarget().getName()="group_info"
	and target_51.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_51.getEnclosingFunction() = func)
}

predicate func_52(DoStmt target_87, Function func) {
exists(ForStmt target_52 |
	target_52.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_52.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_52.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_52.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="ngroups"
	and target_52.getCondition().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("group_info *")
	and target_52.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("seq_put_decimal_ull")
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ConditionalExpr).getCondition().(VariableAccess).getType().hasName("int")
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ConditionalExpr).getThen().(StringLiteral).getValue()=" "
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ConditionalExpr).getElse().(StringLiteral).getValue()=""
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="gid"
	and target_52.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_52
	and target_52.getLocation().isBefore(target_87.getLocation()))
}

/*predicate func_53(Function func) {
exists(FunctionCall target_53 |
	target_53.getTarget().hasName("seq_put_decimal_ull")
	and target_53.getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_53.getArgument(1).(ConditionalExpr).getCondition().(VariableAccess).getType().hasName("int")
	and target_53.getArgument(1).(ConditionalExpr).getThen().(StringLiteral).getValue()=" "
	and target_53.getArgument(1).(ConditionalExpr).getElse().(StringLiteral).getValue()=""
	and target_53.getArgument(2).(FunctionCall).getTarget().hasName("from_kgid_munged")
	and target_53.getArgument(2).(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("user_namespace *")
	and target_53.getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="gid"
	and target_53.getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("group_info *")
	and target_53.getArgument(2).(FunctionCall).getArgument(1).(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_53.getEnclosingFunction() = func)
}

*/
predicate func_54(Function func) {
exists(FunctionCall target_54 |
	target_54.getTarget().hasName("seq_puts")
	and target_54.getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_54.getArgument(1).(StringLiteral).getValue()="\n\tCapEff:\t"
	and target_54.getEnclosingFunction() = func)
}

predicate func_55(Function func) {
exists(AssignExpr target_55 |
	target_55.getLValue().(VariableAccess).getType().hasName("kernel_cap_t")
	and target_55.getRValue().(PointerFieldAccess).getTarget().getName()="cap_effective"
	and target_55.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("const cred *")
	and target_55.getEnclosingFunction() = func)
}

predicate func_56(ExprStmt target_94, Function func) {
exists(ForStmt target_56 |
	target_56.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_56.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_56.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_56.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="2"
	and target_56.getUpdate().(PrefixIncrExpr).getOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("seq_put_hex_ll")
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayBase().(ValueFieldAccess).getTarget().getName()="cap"
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("kernel_cap_t")
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayOffset().(SubExpr).getLeftOperand().(SubExpr).getValue()="1"
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ArrayExpr).getArrayOffset().(SubExpr).getRightOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_56.getStmt().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(Literal).getValue()="8"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_56
	and target_56.getLocation().isBefore(target_94.getLocation()))
}

/*predicate func_57(Function func) {
exists(AssignExpr target_57 |
	target_57.getLValue().(VariableAccess).getType().hasName("unsigned int")
	and target_57.getRValue() instanceof Literal
	and target_57.getEnclosingFunction() = func)
}

*/
/*predicate func_58(Function func) {
exists(FunctionCall target_58 |
	target_58.getTarget().hasName("seq_put_hex_ll")
	and target_58.getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_58.getArgument(1) instanceof Literal
	and target_58.getArgument(2).(ArrayExpr).getArrayBase().(ValueFieldAccess).getTarget().getName()="cap"
	and target_58.getArgument(2).(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("kernel_cap_t")
	and target_58.getArgument(2).(ArrayExpr).getArrayOffset().(SubExpr).getLeftOperand().(SubExpr).getValue()="1"
	and target_58.getArgument(2).(ArrayExpr).getArrayOffset().(SubExpr).getRightOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_58.getArgument(3).(Literal).getValue()="8"
	and target_58.getEnclosingFunction() = func)
}

*/
predicate func_59(Function func) {
exists(FunctionCall target_59 |
	target_59.getTarget().hasName("seq_putc")
	and target_59.getArgument(0).(VariableAccess).getType().hasName("seq_file *")
	and target_59.getArgument(1).(CharLiteral).getValue()="10"
	and target_59.getEnclosingFunction() = func)
}

predicate func_64(Variable vtctx_7913, AssignExpr target_64) {
	target_64.getLValue().(VariableAccess).getTarget()=vtctx_7913
	and target_64.getRValue().(FunctionCall).getTarget().hasName("kmalloc")
	and target_64.getRValue().(FunctionCall).getArgument(0).(SizeofExprOperator).getValue()="496"
	and target_64.getRValue().(FunctionCall).getArgument(1).(BitwiseOrExpr).getValue()="3264"
}

predicate func_65(Variable vtctx_7913, Function func, IfStmt target_65) {
	target_65.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_65.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vtctx_7913
	and target_65.getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_65.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-12"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_65
}

predicate func_66(Variable vtctx_7913, Variable vret_7914, Variable v__key_7920, StmtExpr target_66) {
	target_66.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__percpu_counter_init")
	and target_66.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="inflight"
	and target_66.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_66.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_66.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(BitwiseOrExpr).getValue()="3264"
	and target_66.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_7920
	and target_66.getParent().(AssignExpr).getRValue() = target_66
	and target_66.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7914
}

/*predicate func_68(Variable vtctx_7913, Variable v__key_7920, FunctionCall target_68) {
	target_68.getTarget().hasName("__percpu_counter_init")
	and target_68.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="inflight"
	and target_68.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_68.getArgument(1) instanceof Literal
	and target_68.getArgument(2).(BitwiseOrExpr).getValue()="3264"
	and target_68.getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__key_7920
}

*/
predicate func_69(Variable vret_7914, Function func, IfStmt target_69) {
	target_69.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_69.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vret_7914
	and target_69.getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_69.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_69.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_7914
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_69
}

/*predicate func_70(Variable vret_7914, FunctionCall target_96, ReturnStmt target_70) {
	target_70.getExpr().(VariableAccess).getTarget()=vret_7914
	and target_70.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_96
}

*/
predicate func_71(Parameter vctx_7911, Variable vtctx_7913, AssignExpr target_71) {
	target_71.getLValue().(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_71.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_71.getRValue().(FunctionCall).getTarget().hasName("io_init_wq_offload")
	and target_71.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_7911
}

predicate func_72(Variable vtctx_7913, Variable vret_7914, Function func, IfStmt target_72) {
	target_72.getCondition().(FunctionCall).getTarget().hasName("IS_ERR")
	and target_72.getCondition().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_72.getCondition().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_72.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_7914
	and target_72.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("PTR_ERR")
	and target_72.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_72.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_72.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
	and target_72.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr() instanceof FunctionCall
	and target_72.getThen().(BlockStmt).getStmt(3).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_7914
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_72
}

/*predicate func_73(Variable vtctx_7913, Variable vret_7914, AssignExpr target_73) {
	target_73.getLValue().(VariableAccess).getTarget()=vret_7914
	and target_73.getRValue().(FunctionCall).getTarget().hasName("PTR_ERR")
	and target_73.getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_73.getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

*/
predicate func_74(Variable vtctx_7913, PointerFieldAccess target_74) {
	target_74.getTarget().getName()="inflight"
	and target_74.getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

/*predicate func_75(Variable vret_7914, FunctionCall target_100, ReturnStmt target_75) {
	target_75.getExpr().(VariableAccess).getTarget()=vret_7914
	and target_75.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_100
}

*/
predicate func_76(Variable vtctx_7913, PointerFieldAccess target_76) {
	target_76.getTarget().getName()="xa"
	and target_76.getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_77(Function func, DoStmt target_77) {
	target_77.getCondition() instanceof Literal
	and target_77.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_77
}

predicate func_79(Variable vtctx_7913, PointerFieldAccess target_79) {
	target_79.getTarget().getName()="wait"
	and target_79.getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_80(Variable v__key_7935, VariableAccess target_80) {
	target_80.getTarget()=v__key_7935
	and target_80.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_81(Variable vtctx_7913, AssignExpr target_81) {
	target_81.getLValue().(PointerFieldAccess).getTarget().getName()="last"
	and target_81.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_81.getRValue() instanceof Literal
}

predicate func_82(Variable vtctx_7913, PointerFieldAccess target_82) {
	target_82.getTarget().getName()="in_idle"
	and target_82.getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_83(Variable vtctx_7913, AssignExpr target_83) {
	target_83.getLValue().(PointerFieldAccess).getTarget().getName()="sqpoll"
	and target_83.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_84(Variable vtctx_7913, PointerFieldAccess target_84) {
	target_84.getTarget().getName()="__identity"
	and target_84.getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_85(Variable vtctx_7913, AssignExpr target_85) {
	target_85.getLValue().(PointerFieldAccess).getTarget().getName()="identity"
	and target_85.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_85.getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="__identity"
	and target_85.getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_86(Parameter vtask_7910, Variable vtctx_7913, AssignExpr target_86) {
	target_86.getLValue().(PointerFieldAccess).getTarget().getName()="io_uring"
	and target_86.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtask_7910
	and target_86.getRValue().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_87(Function func, DoStmt target_87) {
	target_87.getCondition().(Literal).getValue()="0"
	and target_87.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_87
}

predicate func_89(Variable vtctx_7913, AddressOfExpr target_89) {
	target_89.getOperand().(PointerFieldAccess).getTarget().getName()="task_lock"
	and target_89.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_89.getParent().(FunctionCall).getParent().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
}

predicate func_90(Variable v__key_7942, VariableAccess target_90) {
	target_90.getTarget()=v__key_7942
	and target_90.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_91(Function func, DoStmt target_91) {
	target_91.getCondition().(Literal).getValue()="0"
	and target_91.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="first"
	and target_91.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="task_list"
	and target_91.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_91.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="last"
	and target_91.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="task_list"
	and target_91.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_91
}

/*predicate func_92(Variable vtctx_7913, ExprStmt target_92) {
	target_92.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="first"
	and target_92.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="task_list"
	and target_92.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_92.getExpr().(AssignExpr).getRValue() instanceof Literal
}

*/
/*predicate func_93(Variable vtctx_7913, ExprStmt target_93) {
	target_93.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="last"
	and target_93.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="task_list"
	and target_93.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_93.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
}

*/
predicate func_94(Variable vtctx_7913, Function func, ExprStmt target_94) {
	target_94.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="task_state"
	and target_94.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
	and target_94.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_94
}

predicate func_95(Variable vtctx_7913, PointerFieldAccess target_95) {
	target_95.getTarget().getName()="task_work"
	and target_95.getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

predicate func_96(Function func, FunctionCall target_96) {
	target_96.getTarget().hasName("__builtin_expect")
	and target_96.getArgument(0) instanceof NotExpr
	and target_96.getArgument(1) instanceof Literal
	and target_96.getEnclosingFunction() = func
}

predicate func_100(Variable vtctx_7913, FunctionCall target_100) {
	target_100.getTarget().hasName("IS_ERR")
	and target_100.getArgument(0).(PointerFieldAccess).getTarget().getName()="io_wq"
	and target_100.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtctx_7913
}

from Function func, Parameter vtask_7910, Parameter vctx_7911, Variable vtctx_7913, Variable vret_7914, Variable v__key_7920, Variable v__key_7935, Variable v__key_7942, Literal target_0, VariableAccess target_1, Literal target_2, VariableAccess target_3, Literal target_4, FunctionCall target_5, VariableAccess target_6, VariableAccess target_7, FunctionCall target_8, FunctionCall target_9, VariableAccess target_10, FunctionCall target_11, Literal target_12, FunctionCall target_13, FunctionCall target_14, FunctionCall target_15, FunctionCall target_16, FunctionCall target_17, ExprStmt target_18, ExprStmt target_19, AssignExpr target_64, IfStmt target_65, StmtExpr target_66, IfStmt target_69, AssignExpr target_71, IfStmt target_72, PointerFieldAccess target_74, PointerFieldAccess target_76, DoStmt target_77, PointerFieldAccess target_79, VariableAccess target_80, AssignExpr target_81, PointerFieldAccess target_82, AssignExpr target_83, PointerFieldAccess target_84, AssignExpr target_85, AssignExpr target_86, DoStmt target_87, AddressOfExpr target_89, VariableAccess target_90, DoStmt target_91, ExprStmt target_94, PointerFieldAccess target_95, FunctionCall target_96, FunctionCall target_100
where
func_0(func, target_0)
and func_1(vret_7914, target_1)
and func_2(func, target_2)
and func_3(vret_7914, target_3)
and func_4(func, target_4)
and func_5(vtctx_7913, target_5)
and func_6(vret_7914, target_6)
and func_7(vret_7914, target_7)
and func_8(vtctx_7913, target_8)
and func_9(vtctx_7913, target_9)
and func_10(vret_7914, target_10)
and func_11(vtctx_7913, target_11)
and func_12(func, target_12)
and func_13(vtctx_7913, v__key_7935, target_13)
and func_14(vtctx_7913, target_14)
and func_15(vtctx_7913, target_15)
and func_16(v__key_7942, target_16)
and func_17(vtctx_7913, target_17)
and func_18(target_72, func, target_18)
and func_19(target_77, func, target_19)
and not func_28(func)
and not func_31(func)
and not func_34(func)
and not func_37(func)
and not func_40(func)
and not func_43(func)
and not func_46(func)
and not func_49(func)
and not func_50(func)
and not func_51(func)
and not func_52(target_87, func)
and not func_54(func)
and not func_55(func)
and not func_56(target_94, func)
and not func_59(func)
and func_64(vtctx_7913, target_64)
and func_65(vtctx_7913, func, target_65)
and func_66(vtctx_7913, vret_7914, v__key_7920, target_66)
and func_69(vret_7914, func, target_69)
and func_71(vctx_7911, vtctx_7913, target_71)
and func_72(vtctx_7913, vret_7914, func, target_72)
and func_74(vtctx_7913, target_74)
and func_76(vtctx_7913, target_76)
and func_77(func, target_77)
and func_79(vtctx_7913, target_79)
and func_80(v__key_7935, target_80)
and func_81(vtctx_7913, target_81)
and func_82(vtctx_7913, target_82)
and func_83(vtctx_7913, target_83)
and func_84(vtctx_7913, target_84)
and func_85(vtctx_7913, target_85)
and func_86(vtask_7910, vtctx_7913, target_86)
and func_87(func, target_87)
and func_89(vtctx_7913, target_89)
and func_90(v__key_7942, target_90)
and func_91(func, target_91)
and func_94(vtctx_7913, func, target_94)
and func_95(vtctx_7913, target_95)
and func_96(func, target_96)
and func_100(vtctx_7913, target_100)
and vtask_7910.getType().hasName("task_struct *")
and vctx_7911.getType().hasName("io_ring_ctx *")
and vtctx_7913.getType().hasName("io_uring_task *")
and vret_7914.getType().hasName("int")
and v__key_7920.getType().hasName("lock_class_key")
and v__key_7935.getType().hasName("lock_class_key")
and v__key_7942.getType().hasName("lock_class_key")
and vtask_7910.getFunction() = func
and vctx_7911.getFunction() = func
and vtctx_7913.(LocalVariable).getFunction() = func
and vret_7914.(LocalVariable).getFunction() = func
and v__key_7920.(LocalVariable).getFunction() = func
and v__key_7935.(LocalVariable).getFunction() = func
and v__key_7942.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
