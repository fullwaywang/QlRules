/**
 * @name v8-d125c7329f6e22af4523de3c55de3a22f168acc9-v8__internal__JSObject__DefineOwnPropertyIgnoreAttributes
 * @id cpp/v8/d125c7329f6e22af4523de3c55de3a22f168acc9/v8internaljsobjectdefineownpropertyignoreattributes
 * @description v8-d125c7329f6e22af4523de3c55de3a22f168acc9-src/objects/js-objects.cc-v8__internal__JSObject__DefineOwnPropertyIgnoreAttributes CVE-2023-2935
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable visolate_3711, Variable vreceiver_3712, Variable vc_3713, Parameter vit_3652) {
exists(FunctionCall target_0 |
	target_0.getTarget().hasName("GetKey")
	and target_0.getQualifier().(VariableAccess).getTarget()=vit_3652
	and target_0.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(0).(VariableAccess).getTarget()=visolate_3711
	and target_0.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(1).(VariableAccess).getTarget()=vreceiver_3712
	and target_0.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(2) instanceof FunctionCall
	and target_0.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(3).(VariableAccess).getTarget()=vc_3713)
}

predicate func_1(Parameter vit_3652, VariableAccess target_1) {
	target_1.getTarget()=vit_3652
}

predicate func_5(Variable visolate_3711, Variable vreceiver_3712, Variable vc_3713, Parameter vit_3652, ConditionalExpr target_5) {
	target_5.getCondition().(FunctionCall).getTarget().hasName("IsElement")
	and target_5.getCondition().(FunctionCall).getQualifier().(VariableAccess).getTarget()=vit_3652
	and target_5.getThen().(ConstructorCall).getArgument(0).(VariableAccess).getTarget()=visolate_3711
	and target_5.getThen().(ConstructorCall).getArgument(1).(VariableAccess).getTarget()=vreceiver_3712
	and target_5.getThen().(ConstructorCall).getArgument(2).(FunctionCall).getTarget().hasName("index")
	and target_5.getThen().(ConstructorCall).getArgument(2).(FunctionCall).getQualifier().(VariableAccess).getTarget()=vit_3652
	and target_5.getThen().(ConstructorCall).getArgument(3).(VariableAccess).getTarget()=vc_3713
	and target_5.getElse().(ConstructorCall).getArgument(0).(VariableAccess).getTarget()=visolate_3711
	and target_5.getElse().(ConstructorCall).getArgument(1).(VariableAccess).getTarget()=vreceiver_3712
	and target_5.getElse().(ConstructorCall).getArgument(2).(FunctionCall).getTarget().hasName("name")
	and target_5.getElse().(ConstructorCall).getArgument(2).(FunctionCall).getQualifier().(VariableAccess).getTarget()=vit_3652
	and target_5.getElse().(ConstructorCall).getArgument(3).(VariableAccess).getTarget()=vc_3713
}

/*predicate func_6(Variable visolate_3711, Variable vreceiver_3712, Variable vc_3713, Parameter vit_3652, FunctionCall target_6) {
	target_6.getTarget().hasName("index")
	and target_6.getQualifier().(VariableAccess).getTarget()=vit_3652
	and target_6.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(0).(VariableAccess).getTarget()=visolate_3711
	and target_6.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(1).(VariableAccess).getTarget()=vreceiver_3712
	and target_6.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(3).(VariableAccess).getTarget()=vc_3713
}

*/
/*predicate func_7(Variable visolate_3711, Variable vreceiver_3712, Variable vc_3713, Parameter vit_3652, ConditionalExpr target_5, FunctionCall target_11, VariableAccess target_7) {
	target_7.getTarget()=vc_3713
	and target_7.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(0).(VariableAccess).getTarget()=visolate_3711
	and target_7.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(1).(VariableAccess).getTarget()=vreceiver_3712
	and target_7.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(2).(FunctionCall).getTarget().hasName("index")
	and target_7.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(2).(FunctionCall).getQualifier().(VariableAccess).getTarget()=vit_3652
	and target_7.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_5.getThen().(ConstructorCall).getArgument(0).(VariableAccess).getLocation())
	and target_7.getParent().(ConstructorCall).getParent().(ConditionalExpr).getThen().(ConstructorCall).getArgument(2).(FunctionCall).getQualifier().(VariableAccess).getLocation().isBefore(target_11.getQualifier().(VariableAccess).getLocation())
}

*/
predicate func_11(Parameter vit_3652, FunctionCall target_11) {
	target_11.getTarget().hasName("name")
	and target_11.getQualifier().(VariableAccess).getTarget()=vit_3652
}

from Function func, Variable visolate_3711, Variable vreceiver_3712, Variable vc_3713, Parameter vit_3652, VariableAccess target_1, ConditionalExpr target_5, FunctionCall target_11
where
not func_0(visolate_3711, vreceiver_3712, vc_3713, vit_3652)
and func_1(vit_3652, target_1)
and func_5(visolate_3711, vreceiver_3712, vc_3713, vit_3652, target_5)
and func_11(vit_3652, target_11)
and visolate_3711.getType().hasName("Isolate *")
and vreceiver_3712.getType().hasName("Handle<Object>")
and vc_3713.getType().hasName("Configuration")
and vit_3652.getType().hasName("LookupIterator *")
and visolate_3711.(LocalVariable).getFunction() = func
and vreceiver_3712.(LocalVariable).getFunction() = func
and vc_3713.(LocalVariable).getFunction() = func
and vit_3652.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
