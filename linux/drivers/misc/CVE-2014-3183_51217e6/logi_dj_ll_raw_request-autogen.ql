/**
 * @name linux-51217e69697fba92a06e07e16f55c9a52d8e8945-logi_dj_ll_raw_request
 * @id cpp/linux/51217e69697fba92a06e07e16f55c9a52d8e8945/logi-dj-ll-raw-request
 * @description linux-51217e69697fba92a06e07e16f55c9a52d8e8945-drivers/hid/hid-logitech-dj.c-logi_dj_ll_raw_request CVE-2014-3183
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vcount_545, ExprStmt target_4) {
exists(RelationalOperation target_0 |
	 (target_0 instanceof GTExpr or target_0 instanceof LTExpr)
	and target_0.getGreaterOperand().(VariableAccess).getTarget()=vcount_545
	and target_0.getLesserOperand() instanceof SubExpr
	and target_0.getParent().(IfStmt).getThen()=target_4)
}

predicate func_1(Parameter vcount_545, ExprStmt target_4, SubExpr target_1) {
	target_1.getValue()="13"
	and target_1.getParent().(LTExpr).getLesserOperand().(VariableAccess).getTarget()=vcount_545
	and target_1.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_4
}

/*predicate func_2(Parameter vcount_545, ExprStmt target_4, VariableAccess target_2) {
	target_2.getTarget()=vcount_545
	and target_2.getParent().(LTExpr).getGreaterOperand().(SubExpr).getValue()="13"
	and target_2.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_4
}

*/
predicate func_3(Parameter vcount_545, ExprStmt target_4, RelationalOperation target_3) {
	 (target_3 instanceof GTExpr or target_3 instanceof LTExpr)
	and target_3.getLesserOperand().(VariableAccess).getTarget()=vcount_545
	and target_3.getGreaterOperand() instanceof SubExpr
	and target_3.getParent().(IfStmt).getThen()=target_4
}

predicate func_4(Parameter vcount_545, ExprStmt target_4) {
	target_4.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcount_545
	and target_4.getExpr().(AssignExpr).getRValue().(SubExpr).getValue()="13"
}

from Function func, Parameter vcount_545, SubExpr target_1, RelationalOperation target_3, ExprStmt target_4
where
not func_0(vcount_545, target_4)
and func_1(vcount_545, target_4, target_1)
and func_3(vcount_545, target_4, target_3)
and func_4(vcount_545, target_4)
and vcount_545.getType().hasName("size_t")
and vcount_545.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
