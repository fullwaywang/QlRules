/**
 * @name linux-f63a8daa5812afef4f06c962351687e1ff9ccb2b-perf_ioctl
 * @id cpp/linux/f63a8daa5812afef4f06c962351687e1ff9ccb2b/perf-ioctl
 * @description linux-f63a8daa5812afef4f06c962351687e1ff9ccb2b-kernel/events/core.c-perf_ioctl CVE-2016-6787
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(Variable voutput_3848, FunctionCall target_1) {
	target_1.getTarget().hasName("fdput")
	and not target_1.getTarget().hasName("perf_event_ctx_unlock")
	and target_1.getArgument(0).(VariableAccess).getTarget()=voutput_3848
}

predicate func_3(Variable vevent_3813, FunctionCall target_50) {
exists(AssignExpr target_3 |
	target_3.getLValue().(VariableAccess).getType().hasName("perf_event_context *")
	and target_3.getRValue().(FunctionCall).getTarget().hasName("perf_event_ctx_lock")
	and target_3.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_3.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_50.getArgument(0).(VariableAccess).getLocation()))
}

predicate func_4(Parameter varg_3811, Variable vevent_3813, Parameter vcmd_3811, FunctionCall target_51, FunctionCall target_52) {
exists(AssignExpr target_4 |
	target_4.getLValue().(VariableAccess).getType().hasName("long")
	and target_4.getRValue().(FunctionCall).getTarget().hasName("_perf_ioctl")
	and target_4.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_4.getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vcmd_3811
	and target_4.getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=varg_3811
	and target_4.getRValue().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_51.getArgument(1).(VariableAccess).getLocation())
	and target_4.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_52.getArgument(0).(VariableAccess).getLocation()))
}

predicate func_7(Variable vret_3845, VariableAccess target_53, ReturnStmt target_7) {
	target_7.getExpr().(VariableAccess).getTarget()=vret_3845
	and target_7.getParent().(IfStmt).getCondition()=target_53
}

predicate func_8(Variable vevent_3813, VariableAccess target_8) {
	target_8.getTarget()=vevent_3813
	and target_8.getParent().(FunctionCall).getParent().(ReturnStmt).getExpr() instanceof FunctionCall
}

predicate func_9(Variable vevent_3813, VariableAccess target_9) {
	target_9.getTarget()=vevent_3813
	and target_9.getParent().(FunctionCall).getParent().(ReturnStmt).getExpr() instanceof FunctionCall
}

predicate func_10(Variable vevent_3813, VariableAccess target_10) {
	target_10.getTarget()=vevent_3813
	and target_10.getParent().(FunctionCall).getParent().(Initializer).getExpr() instanceof FunctionCall
}

predicate func_11(Parameter varg_3811, VariableAccess target_11) {
	target_11.getTarget()=varg_3811
}

predicate func_12(Parameter vcmd_3811, VariableAccess target_12) {
	target_12.getTarget()=vcmd_3811
}

predicate func_14(Function func, DeclStmt target_14) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(Parameter varg_3811, Variable vevent_3813, Parameter vcmd_3811, Variable vfunc_3814, Variable vid_3836, Variable vret_3845, Function func, SwitchStmt target_15) {
	target_15.getExpr().(VariableAccess).getTarget()=vcmd_3811
	and target_15.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="9216"
	and target_15.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vfunc_3814
	and target_15.getStmt().(BlockStmt).getStmt(3).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="9217"
	and target_15.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vfunc_3814
	and target_15.getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="9219"
	and target_15.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vfunc_3814
	and target_15.getStmt().(BlockStmt).getStmt(9).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="9218"
	and target_15.getStmt().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_refresh")
	and target_15.getStmt().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_15.getStmt().(BlockStmt).getStmt(10).(ReturnStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=varg_3811
	and target_15.getStmt().(BlockStmt).getStmt(11).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="1074275332"
	and target_15.getStmt().(BlockStmt).getStmt(12).(ReturnStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_period")
	and target_15.getStmt().(BlockStmt).getStmt(12).(ReturnStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_15.getStmt().(BlockStmt).getStmt(12).(ReturnStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=varg_3811
	and target_15.getStmt().(BlockStmt).getStmt(13).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="2148017159"
	and target_15.getStmt().(BlockStmt).getStmt(14).(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_15.getStmt().(BlockStmt).getStmt(14).(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=varg_3811
	and target_15.getStmt().(BlockStmt).getStmt(14).(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vid_3836
	and target_15.getStmt().(BlockStmt).getStmt(14).(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="8"
	and target_15.getStmt().(BlockStmt).getStmt(14).(BlockStmt).getStmt(1).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
	and target_15.getStmt().(BlockStmt).getStmt(14).(BlockStmt).getStmt(2).(ReturnStmt).getExpr().(Literal).getValue()="0"
	and target_15.getStmt().(BlockStmt).getStmt(15).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="9221"
	and target_15.getStmt().(BlockStmt).getStmt(16).(BlockStmt).getStmt(1).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=varg_3811
	and target_15.getStmt().(BlockStmt).getStmt(16).(BlockStmt).getStmt(1).(IfStmt).getCondition().(EqualityOperation).getRightOperand().(UnaryMinusExpr).getValue()="18446744073709551615"
	and target_15.getStmt().(BlockStmt).getStmt(16).(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_3845
	and target_15.getStmt().(BlockStmt).getStmt(16).(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(3).(IfStmt).getThen() instanceof ReturnStmt
	and target_15.getStmt().(BlockStmt).getStmt(16).(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr() instanceof FunctionCall
	and target_15.getStmt().(BlockStmt).getStmt(16).(BlockStmt).getStmt(2).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_3845
	and target_15.getStmt().(BlockStmt).getStmt(17).(SwitchCase).getExpr().(BitwiseOrExpr).getValue()="1074275334"
	and target_15.getStmt().(BlockStmt).getStmt(18).(ReturnStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_set_filter")
	and target_15.getStmt().(BlockStmt).getStmt(18).(ReturnStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_15.getStmt().(BlockStmt).getStmt(18).(ReturnStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=varg_3811
	and target_15.getStmt().(BlockStmt).getStmt(19).(SwitchCase).toString() = "default: "
	and target_15.getStmt().(BlockStmt).getStmt(20).(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-25"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

/*predicate func_16(Function func, SwitchCase target_16) {
	target_16.getExpr().(BitwiseOrExpr).getValue()="9216"
	and target_16.getEnclosingFunction() = func
}

*/
/*predicate func_17(Variable vfunc_3814, AssignExpr target_17) {
	target_17.getLValue().(VariableAccess).getTarget()=vfunc_3814
}

*/
/*predicate func_18(VariableAccess target_12, Function func, BreakStmt target_18) {
	target_18.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
	and target_18.getEnclosingFunction() = func
}

*/
/*predicate func_19(Function func, SwitchCase target_19) {
	target_19.getExpr().(BitwiseOrExpr).getValue()="9217"
	and target_19.getEnclosingFunction() = func
}

*/
/*predicate func_20(Variable vfunc_3814, AssignExpr target_20) {
	target_20.getLValue().(VariableAccess).getTarget()=vfunc_3814
}

*/
/*predicate func_21(VariableAccess target_12, Function func, BreakStmt target_21) {
	target_21.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
	and target_21.getEnclosingFunction() = func
}

*/
/*predicate func_22(Function func, SwitchCase target_22) {
	target_22.getExpr().(BitwiseOrExpr).getValue()="9219"
	and target_22.getEnclosingFunction() = func
}

*/
/*predicate func_23(Variable vfunc_3814, VariableAccess target_12, ExprStmt target_23) {
	target_23.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vfunc_3814
	and target_23.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
}

*/
/*predicate func_24(VariableAccess target_12, Function func, BreakStmt target_24) {
	target_24.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
	and target_24.getEnclosingFunction() = func
}

*/
/*predicate func_25(Function func, SwitchCase target_25) {
	target_25.getExpr().(BitwiseOrExpr).getValue()="9218"
	and target_25.getEnclosingFunction() = func
}

*/
/*predicate func_26(Parameter varg_3811, Variable vevent_3813, VariableAccess target_12, ReturnStmt target_26) {
	target_26.getExpr().(FunctionCall).getTarget().hasName("perf_event_refresh")
	and target_26.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_26.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=varg_3811
	and target_26.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
}

*/
/*predicate func_27(Function func, SwitchCase target_27) {
	target_27.getExpr().(BitwiseOrExpr).getValue()="1074275332"
	and target_27.getEnclosingFunction() = func
}

*/
/*predicate func_28(Parameter varg_3811, Variable vevent_3813, VariableAccess target_12, ReturnStmt target_28) {
	target_28.getExpr().(FunctionCall).getTarget().hasName("perf_event_period")
	and target_28.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_28.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=varg_3811
	and target_28.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
}

*/
/*predicate func_29(Function func, SwitchCase target_29) {
	target_29.getExpr().(BitwiseOrExpr).getValue()="2148017159"
	and target_29.getEnclosingFunction() = func
}

*/
/*predicate func_31(Parameter varg_3811, Variable vid_3836, IfStmt target_31) {
	target_31.getCondition().(FunctionCall).getTarget().hasName("copy_to_user")
	and target_31.getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=varg_3811
	and target_31.getCondition().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vid_3836
	and target_31.getCondition().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="8"
	and target_31.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-14"
}

*/
/*predicate func_32(Function func, ReturnStmt target_32) {
	target_32.getExpr().(Literal).getValue()="0"
	and target_32.getEnclosingFunction() = func
}

*/
/*predicate func_33(Function func, SwitchCase target_33) {
	target_33.getExpr().(BitwiseOrExpr).getValue()="9221"
	and target_33.getEnclosingFunction() = func
}

*/
/*predicate func_34(Parameter varg_3811, Variable vevent_3813, Variable vret_3845, Variable voutput_event_3847, Variable voutput_3848, IfStmt target_34) {
	target_34.getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=varg_3811
	and target_34.getCondition().(EqualityOperation).getRightOperand().(UnaryMinusExpr).getValue()="18446744073709551615"
	and target_34.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3845
	and target_34.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("perf_fget_light")
	and target_34.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=varg_3811
	and target_34.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=voutput_3848
	and target_34.getThen().(BlockStmt).getStmt(3).(IfStmt).getCondition().(VariableAccess).getTarget()=vret_3845
	and target_34.getThen().(BlockStmt).getStmt(3).(IfStmt).getThen() instanceof ReturnStmt
	and target_34.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voutput_event_3847
	and target_34.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="private_data"
	and target_34.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
	and target_34.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=voutput_3848
	and target_34.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3845
	and target_34.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("perf_event_set_output")
	and target_34.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_34.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=voutput_event_3847
	and target_34.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr() instanceof FunctionCall
	and target_34.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3845
	and target_34.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("perf_event_set_output")
	and target_34.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_34.getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
}

*/
predicate func_35(EqualityOperation target_54, Function func, DeclStmt target_35) {
	target_35.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
	and target_35.getEnclosingFunction() = func
}

predicate func_36(EqualityOperation target_54, Function func, DeclStmt target_36) {
	target_36.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
	and target_36.getEnclosingFunction() = func
}

/*predicate func_37(Parameter varg_3811, Variable vret_3845, Variable voutput_3848, EqualityOperation target_54, ExprStmt target_37) {
	target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3845
	and target_37.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("perf_fget_light")
	and target_37.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=varg_3811
	and target_37.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=voutput_3848
	and target_37.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
}

*/
/*predicate func_38(Variable vret_3845, EqualityOperation target_54, IfStmt target_38) {
	target_38.getCondition().(VariableAccess).getTarget()=vret_3845
	and target_38.getThen() instanceof ReturnStmt
	and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
}

*/
/*predicate func_39(Variable voutput_event_3847, Variable voutput_3848, EqualityOperation target_54, ExprStmt target_39) {
	target_39.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=voutput_event_3847
	and target_39.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="private_data"
	and target_39.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="file"
	and target_39.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=voutput_3848
	and target_39.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
}

*/
/*predicate func_40(Variable vevent_3813, Variable vret_3845, Variable voutput_event_3847, AssignExpr target_40) {
	target_40.getLValue().(VariableAccess).getTarget()=vret_3845
	and target_40.getRValue().(FunctionCall).getTarget().hasName("perf_event_set_output")
	and target_40.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_40.getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=voutput_event_3847
}

*/
/*predicate func_41(EqualityOperation target_54, Function func, ExprStmt target_41) {
	target_41.getExpr() instanceof FunctionCall
	and target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
	and target_41.getEnclosingFunction() = func
}

*/
/*predicate func_42(Variable vevent_3813, Variable vret_3845, EqualityOperation target_54, ExprStmt target_42) {
	target_42.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_3845
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("perf_event_set_output")
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_42.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
}

*/
/*predicate func_43(Variable vret_3845, ReturnStmt target_43) {
	target_43.getExpr().(VariableAccess).getTarget()=vret_3845
}

*/
/*predicate func_44(Function func, SwitchCase target_44) {
	target_44.getExpr().(BitwiseOrExpr).getValue()="1074275334"
	and target_44.getEnclosingFunction() = func
}

*/
/*predicate func_45(Parameter varg_3811, Variable vevent_3813, VariableAccess target_12, ReturnStmt target_45) {
	target_45.getExpr().(FunctionCall).getTarget().hasName("perf_event_set_filter")
	and target_45.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_45.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=varg_3811
	and target_45.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
}

*/
/*predicate func_46(Function func, SwitchCase target_46) {
	target_46.toString() = "default: "
	and target_46.getEnclosingFunction() = func
}

*/
/*predicate func_47(VariableAccess target_12, Function func, ReturnStmt target_47) {
	target_47.getExpr().(UnaryMinusExpr).getValue()="-25"
	and target_47.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_12
	and target_47.getEnclosingFunction() = func
}

*/
predicate func_48(Variable vevent_3813, Variable vfunc_3814, Variable vflags_3815, Function func, IfStmt target_48) {
	target_48.getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3815
	and target_48.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_for_each")
	and target_48.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_48.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vfunc_3814
	and target_48.getElse().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("perf_event_for_each_child")
	and target_48.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_48.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vfunc_3814
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Function func, ReturnStmt target_49) {
	target_49.getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_49
}

predicate func_50(Parameter varg_3811, Variable vevent_3813, FunctionCall target_50) {
	target_50.getTarget().hasName("perf_event_period")
	and target_50.getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_50.getArgument(1).(VariableAccess).getTarget()=varg_3811
}

predicate func_51(Parameter varg_3811, Variable vevent_3813, FunctionCall target_51) {
	target_51.getTarget().hasName("perf_event_refresh")
	and target_51.getArgument(0).(VariableAccess).getTarget()=vevent_3813
	and target_51.getArgument(1).(VariableAccess).getTarget()=varg_3811
}

predicate func_52(Variable vevent_3813, FunctionCall target_52) {
	target_52.getTarget().hasName("primary_event_id")
	and target_52.getArgument(0).(VariableAccess).getTarget()=vevent_3813
}

predicate func_53(Variable vret_3845, ReturnStmt target_7, VariableAccess target_53) {
	target_53.getTarget()=vret_3845
	and target_53.getParent().(IfStmt).getThen()=target_7
}

predicate func_54(Parameter varg_3811, EqualityOperation target_54) {
	target_54.getLeftOperand().(VariableAccess).getTarget()=varg_3811
	and target_54.getRightOperand() instanceof UnaryMinusExpr
}

from Function func, Parameter varg_3811, Variable vevent_3813, Parameter vcmd_3811, Variable vfunc_3814, Variable vflags_3815, Variable vid_3836, Variable vret_3845, Variable voutput_event_3847, Variable voutput_3848, FunctionCall target_1, ReturnStmt target_7, VariableAccess target_8, VariableAccess target_9, VariableAccess target_10, VariableAccess target_11, VariableAccess target_12, DeclStmt target_14, SwitchStmt target_15, DeclStmt target_35, DeclStmt target_36, IfStmt target_48, ReturnStmt target_49, FunctionCall target_50, FunctionCall target_51, FunctionCall target_52, VariableAccess target_53, EqualityOperation target_54
where
func_1(voutput_3848, target_1)
and not func_3(vevent_3813, target_50)
and not func_4(varg_3811, vevent_3813, vcmd_3811, target_51, target_52)
and func_7(vret_3845, target_53, target_7)
and func_8(vevent_3813, target_8)
and func_9(vevent_3813, target_9)
and func_10(vevent_3813, target_10)
and func_11(varg_3811, target_11)
and func_12(vcmd_3811, target_12)
and func_14(func, target_14)
and func_15(varg_3811, vevent_3813, vcmd_3811, vfunc_3814, vid_3836, vret_3845, func, target_15)
and func_35(target_54, func, target_35)
and func_36(target_54, func, target_36)
and func_48(vevent_3813, vfunc_3814, vflags_3815, func, target_48)
and func_49(func, target_49)
and func_50(varg_3811, vevent_3813, target_50)
and func_51(varg_3811, vevent_3813, target_51)
and func_52(vevent_3813, target_52)
and func_53(vret_3845, target_7, target_53)
and func_54(varg_3811, target_54)
and varg_3811.getType().hasName("unsigned long")
and vevent_3813.getType().hasName("perf_event *")
and vcmd_3811.getType().hasName("unsigned int")
and vfunc_3814.getType().hasName("..(*)(..)")
and vflags_3815.getType().hasName("u32")
and vid_3836.getType().hasName("u64")
and vret_3845.getType().hasName("int")
and voutput_event_3847.getType().hasName("perf_event *")
and voutput_3848.getType().hasName("fd")
and varg_3811.getFunction() = func
and vevent_3813.(LocalVariable).getFunction() = func
and vcmd_3811.getFunction() = func
and vfunc_3814.(LocalVariable).getFunction() = func
and vflags_3815.(LocalVariable).getFunction() = func
and vid_3836.(LocalVariable).getFunction() = func
and vret_3845.(LocalVariable).getFunction() = func
and voutput_event_3847.(LocalVariable).getFunction() = func
and voutput_3848.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
