/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-pfkey_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/pfkey-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/key/af_key.c-pfkey_recvmsg CVE-2013-7267
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vlen_3607, Variable vcopied_3613, RelationalOperation target_67, ExprStmt target_68, VariableAccess target_0) {
		target_0.getTarget()=vcopied_3613
		and target_0.getParent().(AssignExpr).getLValue() = target_0
		and target_0.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_3607
		and target_67.getLesserOperand().(VariableAccess).getLocation().isBefore(target_0.getParent().(AssignExpr).getRValue().(VariableAccess).getLocation())
		and target_0.getLocation().isBefore(target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
}

/*predicate func_1(Parameter vlen_3607, Variable vcopied_3613, VariableAccess target_1) {
		target_1.getTarget()=vlen_3607
		and vlen_3607.getIndex() = 3
		and target_1.getParent().(AssignExpr).getRValue() = target_1
		and target_1.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_3613
}

*/
predicate func_2(Parameter vflags_3608, Literal target_2) {
		target_2.getValue()="32"
		and not target_2.getValue()="1"
		and target_2.getParent().(BitwiseAndExpr).getParent().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
}

predicate func_3(Function func, Literal target_3) {
		target_3.getValue()="2"
		and not target_3.getValue()="8192"
		and target_3.getParent().(BitwiseOrExpr).getParent().(BitwiseOrExpr).getLeftOperand() instanceof BitwiseOrExpr
		and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, Literal target_4) {
		target_4.getValue()="64"
		and not target_4.getValue()="95"
		and target_4.getParent().(BitwiseOrExpr).getParent().(BitwiseOrExpr).getLeftOperand() instanceof BitwiseOrExpr
		and target_4.getEnclosingFunction() = func
}

predicate func_5(Function func, Literal target_5) {
		target_5.getValue()="32"
		and not target_5.getValue()="11"
		and target_5.getParent().(BitwiseOrExpr).getParent().(BitwiseOrExpr).getLeftOperand() instanceof BitwiseOrExpr
		and target_5.getEnclosingFunction() = func
}

predicate func_6(Variable vskb_3612, Variable vcopied_3613, VariableAccess target_6) {
		target_6.getTarget()=vcopied_3613
		and target_6.getParent().(AssignExpr).getLValue() = target_6
		and target_6.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_6.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
}

predicate func_7(Parameter vlen_3607, Variable vcopied_3613, BlockStmt target_69, VariableAccess target_7) {
		target_7.getTarget()=vcopied_3613
		and target_7.getParent().(GTExpr).getLesserOperand().(VariableAccess).getTarget()=vlen_3607
		and target_7.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_69
}

predicate func_8(Variable vskb_3612, FunctionCall target_8) {
		target_8.getTarget().hasName("skb_reset_transport_header")
		and not target_8.getTarget().hasName("vsock_addr_init")
		and target_8.getArgument(0).(VariableAccess).getTarget()=vskb_3612
}

predicate func_9(Parameter vmsg_3607, Variable vskb_3612, Variable vcopied_3613, ExprStmt target_41, ExprStmt target_73, VariableAccess target_9) {
		target_9.getTarget()=vcopied_3613
		and target_9.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_9.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_3612
		and target_9.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
		and target_9.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_9.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_41.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_9.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_73.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_9.getLocation())
}

predicate func_10(Variable vcopied_3613, ExprStmt target_68, VariableAccess target_10) {
		target_10.getTarget()=vcopied_3613
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_10.getLocation())
}

predicate func_12(Parameter vflags_3608, BitwiseAndExpr target_39, ExprStmt target_75) {
	exists(LogicalOrExpr target_12 |
		target_12.getAnOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_12.getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="1"
		and target_12.getAnOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_12.getAnOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="8192"
		and target_12.getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_39.getLeftOperand().(VariableAccess).getLocation().isBefore(target_12.getAnOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation())
		and target_12.getAnOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation().isBefore(target_75.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

predicate func_13(BitwiseAndExpr target_55, Function func) {
	exists(ReturnStmt target_13 |
		target_13.getExpr().(UnaryMinusExpr).getValue()="-95"
		and target_13.getParent().(IfStmt).getCondition()=target_55
		and target_13.getEnclosingFunction() = func)
}

predicate func_14(Parameter vflags_3608, Variable vsk_3610, Variable verr_3613) {
	exists(AddressOfExpr target_14 |
		target_14.getOperand().(PointerFieldAccess).getTarget().getName()="sk"
		and target_14.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vsock_sock *")
		and target_14.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_14.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_14.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_14.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2) instanceof BitwiseAndExpr
		and target_14.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613)
}

predicate func_15(Variable vskb_3612, BlockStmt target_69, ExprStmt target_75, ExprStmt target_76) {
	exists(NotExpr target_15 |
		target_15.getOperand().(VariableAccess).getTarget()=vskb_3612
		and target_15.getParent().(IfStmt).getThen()=target_69
		and target_75.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_15.getOperand().(VariableAccess).getLocation())
		and target_15.getOperand().(VariableAccess).getLocation().isBefore(target_76.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_16(RelationalOperation target_67, Function func) {
	exists(ReturnStmt target_16 |
		target_16.getExpr().(UnaryMinusExpr).getValue()="-11"
		and target_16.getParent().(IfStmt).getCondition()=target_67
		and target_16.getEnclosingFunction() = func)
}

predicate func_17(Variable vskb_3612, ExprStmt target_78) {
	exists(AssignExpr target_17 |
		target_17.getLValue().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_17.getRValue().(PointerFieldAccess).getTarget().getName()="data"
		and target_17.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
		and target_17.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_78.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

predicate func_18(ExprStmt target_79, Function func) {
	exists(NotExpr target_18 |
		target_18.getOperand().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_18.getParent().(IfStmt).getThen()=target_79
		and target_18.getEnclosingFunction() = func)
}

predicate func_19(Function func) {
	exists(AssignExpr target_19 |
		target_19.getLValue().(VariableAccess).getType().hasName("size_t")
		and target_19.getRValue().(PointerFieldAccess).getTarget().getName()="payload_size"
		and target_19.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_19.getEnclosingFunction() = func)
}

predicate func_20(Variable vskb_3612, EqualityOperation target_57, Function func) {
	exists(IfStmt target_20 |
		target_20.getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getType().hasName("size_t")
		and target_20.getCondition().(EqualityOperation).getAnOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_20.getCondition().(EqualityOperation).getAnOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
		and target_20.getCondition().(EqualityOperation).getAnOperand().(SubExpr).getRightOperand().(SizeofExprOperator).getValue()="24"
		and target_20.getThen().(BlockStmt).getStmt(0) instanceof ExprStmt
		and target_20.getThen().(BlockStmt).getStmt(1) instanceof GotoStmt
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
		and target_57.getAnOperand().(VariableAccess).getLocation().isBefore(target_20.getCondition().(EqualityOperation).getAnOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_22(Variable vskb_3612, EqualityOperation target_57) {
	exists(SubExpr target_22 |
		target_22.getLeftOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_22.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
		and target_22.getRightOperand().(SizeofExprOperator).getValue()="24"
		and target_57.getAnOperand().(VariableAccess).getLocation().isBefore(target_22.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_23(Parameter vlen_3607, Function func) {
	exists(IfStmt target_23 |
		target_23.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_23.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vlen_3607
		and target_23.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("size_t")
		and target_23.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_3607
		and target_23.getThen().(BlockStmt).getStmt(1) instanceof ExprStmt
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_23)
}

/*predicate func_25(Parameter vlen_3607, ExprStmt target_73) {
	exists(AssignExpr target_25 |
		target_25.getLValue().(VariableAccess).getType().hasName("size_t")
		and target_25.getRValue().(VariableAccess).getTarget()=vlen_3607
		and target_73.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_25.getRValue().(VariableAccess).getLocation()))
}

*/
predicate func_26(Function func) {
	exists(SizeofExprOperator target_26 |
		target_26.getValue()="24"
		and target_26.getEnclosingFunction() = func)
}

predicate func_28(Parameter vmsg_3607, ExprStmt target_68, ExprStmt target_41, Function func) {
	exists(IfStmt target_28 |
		target_28.getCondition().(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_28.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_28.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("sockaddr_vm *")
		and target_28.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_28.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vsock_addr_init")
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("sockaddr_vm *")
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getTarget().getName()="context"
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="src"
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getTarget().getName()="resource"
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="src"
		and target_28.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_28.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_28.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_28.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofExprOperator).getValue()="16"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_28.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_28.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_41.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_29(Parameter vmsg_3607) {
	exists(AssignExpr target_29 |
		target_29.getLValue().(VariableAccess).getType().hasName("sockaddr_vm *")
		and target_29.getRValue().(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_29.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607)
}

*/
/*predicate func_31(Function func) {
	exists(ValueFieldAccess target_31 |
		target_31.getTarget().getName()="context"
		and target_31.getQualifier().(PointerFieldAccess).getTarget().getName()="src"
		and target_31.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_31.getEnclosingFunction() = func)
}

*/
/*predicate func_32(Function func) {
	exists(ValueFieldAccess target_32 |
		target_32.getTarget().getName()="resource"
		and target_32.getQualifier().(PointerFieldAccess).getTarget().getName()="src"
		and target_32.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmci_datagram *")
		and target_32.getEnclosingFunction() = func)
}

*/
/*predicate func_33(Function func) {
	exists(SizeofExprOperator target_33 |
		target_33.getValue()="16"
		and target_33.getEnclosingFunction() = func)
}

*/
predicate func_34(Variable vskb_3612, Function func) {
	exists(ExprStmt target_34 |
		target_34.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_34.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="sk"
		and target_34.getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vsock_sock *")
		and target_34.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_3612
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_34)
}

/*predicate func_35(Variable vsk_3610, Variable vskb_3612) {
	exists(AddressOfExpr target_35 |
		target_35.getOperand().(PointerFieldAccess).getTarget().getName()="sk"
		and target_35.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vsock_sock *")
		and target_35.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_35.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_35.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_3612)
}

*/
predicate func_37(Parameter vmsg_3607, PointerFieldAccess target_37) {
		target_37.getTarget().getName()="msg_namelen"
		and target_37.getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_37.getParent().(AssignExpr).getLValue() = target_37
		and target_37.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_38(Variable verr_3613, Function func, ExprStmt target_38) {
		target_38.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_3613
		and target_38.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-22"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

predicate func_39(Parameter vflags_3608, Variable vsk_3610, Variable verr_3613, BitwiseAndExpr target_39) {
		target_39.getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_39.getRightOperand().(Literal).getValue()="64"
		and target_39.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_39.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_39.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_39.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613
}

predicate func_40(Variable vskb_3612, Variable vcopied_3613, PointerFieldAccess target_40) {
		target_40.getTarget().getName()="len"
		and target_40.getQualifier().(VariableAccess).getTarget()=vskb_3612
		and target_40.getParent().(AssignExpr).getRValue() = target_40
		and target_40.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_3613
}

predicate func_41(Parameter vmsg_3607, RelationalOperation target_67, ExprStmt target_41) {
		target_41.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_41.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_41.getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
		and target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_67
}

predicate func_42(Variable verr_3613, Function func, ReturnStmt target_42) {
		target_42.getExpr().(VariableAccess).getTarget()=verr_3613
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_42
}

predicate func_43(Parameter vflags_3608, VariableAccess target_43) {
		target_43.getTarget()=vflags_3608
		and target_43.getParent().(BitwiseAndExpr).getRightOperand() instanceof ComplementExpr
		and target_43.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_45(Variable vskb_3612, VariableAccess target_45) {
		target_45.getTarget()=vskb_3612
		and target_45.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_46(Parameter vmsg_3607, Variable vskb_3612, Variable vcopied_3613, Variable verr_3613, VariableAccess target_46) {
		target_46.getTarget()=verr_3613
		and target_46.getParent().(AssignExpr).getLValue() = target_46
		and target_46.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_46.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_3612
		and target_46.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
		and target_46.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_46.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_46.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_3613
}

predicate func_47(Variable verr_3613, VariableAccess target_47) {
		target_47.getTarget()=verr_3613
		and target_47.getParent().(AssignExpr).getLValue() = target_47
		and target_47.getParent().(AssignExpr).getRValue() instanceof ConditionalExpr
}

predicate func_48(Variable vskb_3612, VariableAccess target_48) {
		target_48.getTarget()=vskb_3612
}

predicate func_50(Variable vskb_3612, VariableAccess target_50) {
		target_50.getTarget()=vskb_3612
		and target_50.getParent().(EQExpr).getAnOperand() instanceof Literal
		and target_50.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_51(Parameter vmsg_3607, VariableAccess target_51) {
		target_51.getTarget()=vmsg_3607
		and target_51.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_52(EqualityOperation target_57, Function func, GotoStmt target_52) {
		target_52.getParent().(IfStmt).getCondition()=target_57
		and target_52.getEnclosingFunction() = func
}

predicate func_55(Parameter vflags_3608, BitwiseAndExpr target_55) {
		target_55.getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_55.getRightOperand().(ComplementExpr).getValue()="2147483549"
		and target_55.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_56(Parameter vflags_3608, Variable vsk_3610, Variable verr_3613, BitwiseAndExpr target_55, FunctionCall target_84, ExprStmt target_38, VariableAccess target_56) {
		target_56.getTarget()=vsk_3610
		and target_56.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_56.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_56.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2) instanceof BitwiseAndExpr
		and target_56.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613
		and target_55.getLeftOperand().(VariableAccess).getLocation().isBefore(target_56.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
		and target_84.getArgument(0).(VariableAccess).getLocation().isBefore(target_56.getLocation())
		and target_38.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_56.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getLocation())
}

predicate func_57(Variable vskb_3612, EqualityOperation target_57) {
		target_57.getAnOperand().(VariableAccess).getTarget()=vskb_3612
		and target_57.getAnOperand().(Literal).getValue()="0"
		and target_57.getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_58(Parameter vmsg_3607, Variable vskb_3612, Variable vcopied_3613, ExprStmt target_41, ExprStmt target_73, VariableAccess target_58) {
		target_58.getTarget()=vskb_3612
		and target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_3613
		and target_41.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_73.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_58.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
}

predicate func_60(Parameter vmsg_3607, Variable vsk_3610, Variable vskb_3612, FunctionCall target_60) {
		target_60.getTarget().hasName("sock_recv_ts_and_drops")
		and target_60.getArgument(0).(VariableAccess).getTarget()=vmsg_3607
		and target_60.getArgument(1).(VariableAccess).getTarget()=vsk_3610
		and target_60.getArgument(2).(VariableAccess).getTarget()=vskb_3612
}

predicate func_61(Parameter vflags_3608, Variable vskb_3612, Variable vcopied_3613, Variable verr_3613, ConditionalExpr target_61) {
		target_61.getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_3608
		and target_61.getCondition().(BitwiseAndExpr).getRightOperand() instanceof Literal
		and target_61.getThen().(PointerFieldAccess).getTarget().getName()="len"
		and target_61.getThen().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
		and target_61.getElse().(VariableAccess).getTarget()=vcopied_3613
		and target_61.getParent().(AssignExpr).getRValue() = target_61
		and target_61.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_3613
}

predicate func_62(Variable vsk_3610, Variable vpfk_3611, ExprStmt target_79, LogicalAndExpr target_62) {
		target_62.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="dump"
		and target_62.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="dump"
		and target_62.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpfk_3611
		and target_62.getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_62.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getLeftOperand().(Literal).getValue()="3"
		and target_62.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getRightOperand().(FunctionCall).getTarget().hasName("atomic_read")
		and target_62.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getRightOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="rmem_alloc"
		and target_62.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getRightOperand().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_backlog"
		and target_62.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="sk_rcvbuf"
		and target_62.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_3610
		and target_62.getParent().(IfStmt).getThen()=target_79
}

/*predicate func_63(Variable vpfk_3611, ValueFieldAccess target_63) {
		target_63.getTarget().getName()="dump"
		and target_63.getQualifier().(PointerFieldAccess).getTarget().getName()="dump"
		and target_63.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpfk_3611
}

*/
predicate func_65(Variable vpfk_3611, FunctionCall target_65) {
		target_65.getTarget().hasName("pfkey_do_dump")
		and target_65.getArgument(0).(VariableAccess).getTarget()=vpfk_3611
}

predicate func_66(Variable vsk_3610, Variable vskb_3612, LogicalAndExpr target_62, VariableAccess target_66) {
		target_66.getTarget()=vsk_3610
		and target_66.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_66.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_3612
		and target_62.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_66.getLocation())
}

predicate func_67(Parameter vlen_3607, Variable vcopied_3613, RelationalOperation target_67) {
		 (target_67 instanceof GTExpr or target_67 instanceof LTExpr)
		and target_67.getGreaterOperand().(VariableAccess).getTarget()=vcopied_3613
		and target_67.getLesserOperand().(VariableAccess).getTarget()=vlen_3607
}

predicate func_68(Parameter vmsg_3607, Variable vskb_3612, Variable vcopied_3613, Variable verr_3613, ExprStmt target_68) {
		target_68.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_3613
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_3612
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_3607
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_3613
}

predicate func_69(Parameter vlen_3607, Variable vcopied_3613, BlockStmt target_69) {
		target_69.getStmt(0) instanceof ExprStmt
		and target_69.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_3613
		and target_69.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_3607
}

predicate func_73(Parameter vlen_3607, Variable vcopied_3613, ExprStmt target_73) {
		target_73.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_3613
		and target_73.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_3607
}

predicate func_75(Parameter vflags_3608, Variable vsk_3610, Variable vskb_3612, Variable verr_3613, ExprStmt target_75) {
		target_75.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vskb_3612
		and target_75.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_75.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_75.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_3608
		and target_75.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2) instanceof BitwiseAndExpr
		and target_75.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_3613
}

predicate func_76(Variable vskb_3612, Variable vcopied_3613, ExprStmt target_76) {
		target_76.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_3613
		and target_76.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_76.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_3612
}

predicate func_78(Variable vsk_3610, Variable vskb_3612, ExprStmt target_78) {
		target_78.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_78.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_3610
		and target_78.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_3612
}

predicate func_79(Function func, ExprStmt target_79) {
		target_79.getExpr() instanceof FunctionCall
		and target_79.getEnclosingFunction() = func
}

predicate func_84(Variable vsk_3610, FunctionCall target_84) {
		target_84.getTarget().hasName("pfkey_sk")
		and target_84.getArgument(0).(VariableAccess).getTarget()=vsk_3610
}

from Function func, Parameter vmsg_3607, Parameter vlen_3607, Parameter vflags_3608, Variable vsk_3610, Variable vpfk_3611, Variable vskb_3612, Variable vcopied_3613, Variable verr_3613, VariableAccess target_0, Literal target_2, Literal target_3, Literal target_4, Literal target_5, VariableAccess target_6, VariableAccess target_7, FunctionCall target_8, VariableAccess target_9, VariableAccess target_10, PointerFieldAccess target_37, ExprStmt target_38, BitwiseAndExpr target_39, PointerFieldAccess target_40, ExprStmt target_41, ReturnStmt target_42, VariableAccess target_43, VariableAccess target_45, VariableAccess target_46, VariableAccess target_47, VariableAccess target_48, VariableAccess target_50, VariableAccess target_51, GotoStmt target_52, BitwiseAndExpr target_55, VariableAccess target_56, EqualityOperation target_57, VariableAccess target_58, FunctionCall target_60, ConditionalExpr target_61, LogicalAndExpr target_62, FunctionCall target_65, VariableAccess target_66, RelationalOperation target_67, ExprStmt target_68, BlockStmt target_69, ExprStmt target_73, ExprStmt target_75, ExprStmt target_76, ExprStmt target_78, ExprStmt target_79, FunctionCall target_84
where
func_0(vlen_3607, vcopied_3613, target_67, target_68, target_0)
and func_2(vflags_3608, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(vskb_3612, vcopied_3613, target_6)
and func_7(vlen_3607, vcopied_3613, target_69, target_7)
and func_8(vskb_3612, target_8)
and func_9(vmsg_3607, vskb_3612, vcopied_3613, target_41, target_73, target_9)
and func_10(vcopied_3613, target_68, target_10)
and not func_12(vflags_3608, target_39, target_75)
and not func_13(target_55, func)
and not func_14(vflags_3608, vsk_3610, verr_3613)
and not func_15(vskb_3612, target_69, target_75, target_76)
and not func_16(target_67, func)
and not func_17(vskb_3612, target_78)
and not func_18(target_79, func)
and not func_19(func)
and not func_20(vskb_3612, target_57, func)
and not func_23(vlen_3607, func)
and not func_26(func)
and not func_28(vmsg_3607, target_68, target_41, func)
and not func_34(vskb_3612, func)
and func_37(vmsg_3607, target_37)
and func_38(verr_3613, func, target_38)
and func_39(vflags_3608, vsk_3610, verr_3613, target_39)
and func_40(vskb_3612, vcopied_3613, target_40)
and func_41(vmsg_3607, target_67, target_41)
and func_42(verr_3613, func, target_42)
and func_43(vflags_3608, target_43)
and func_45(vskb_3612, target_45)
and func_46(vmsg_3607, vskb_3612, vcopied_3613, verr_3613, target_46)
and func_47(verr_3613, target_47)
and func_48(vskb_3612, target_48)
and func_50(vskb_3612, target_50)
and func_51(vmsg_3607, target_51)
and func_52(target_57, func, target_52)
and func_55(vflags_3608, target_55)
and func_56(vflags_3608, vsk_3610, verr_3613, target_55, target_84, target_38, target_56)
and func_57(vskb_3612, target_57)
and func_58(vmsg_3607, vskb_3612, vcopied_3613, target_41, target_73, target_58)
and func_60(vmsg_3607, vsk_3610, vskb_3612, target_60)
and func_61(vflags_3608, vskb_3612, vcopied_3613, verr_3613, target_61)
and func_62(vsk_3610, vpfk_3611, target_79, target_62)
and func_65(vpfk_3611, target_65)
and func_66(vsk_3610, vskb_3612, target_62, target_66)
and func_67(vlen_3607, vcopied_3613, target_67)
and func_68(vmsg_3607, vskb_3612, vcopied_3613, verr_3613, target_68)
and func_69(vlen_3607, vcopied_3613, target_69)
and func_73(vlen_3607, vcopied_3613, target_73)
and func_75(vflags_3608, vsk_3610, vskb_3612, verr_3613, target_75)
and func_76(vskb_3612, vcopied_3613, target_76)
and func_78(vsk_3610, vskb_3612, target_78)
and func_79(func, target_79)
and func_84(vsk_3610, target_84)
and vmsg_3607.getType().hasName("msghdr *")
and vlen_3607.getType().hasName("size_t")
and vflags_3608.getType().hasName("int")
and vsk_3610.getType().hasName("sock *")
and vpfk_3611.getType().hasName("pfkey_sock *")
and vskb_3612.getType().hasName("sk_buff *")
and vcopied_3613.getType().hasName("int")
and verr_3613.getType().hasName("int")
and vmsg_3607.getFunction() = func
and vlen_3607.getFunction() = func
and vflags_3608.getFunction() = func
and vsk_3610.(LocalVariable).getFunction() = func
and vpfk_3611.(LocalVariable).getFunction() = func
and vskb_3612.(LocalVariable).getFunction() = func
and vcopied_3613.(LocalVariable).getFunction() = func
and verr_3613.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
