/**
 * @name linux-fcd91dd449867c6bfe56a81cabba76b829fd05cd-vxlan_gro_receive
 * @id cpp/linux/fcd91dd449867c6bfe56a81cabba76b829fd05cd/vxlan-gro-receive
 * @description linux-fcd91dd449867c6bfe56a81cabba76b829fd05cd-drivers/net/vxlan.c-vxlan_gro_receive CVE-2016-7039
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vhead_536, Parameter vskb_537, FunctionCall target_0) {
	target_0.getTarget().hasName("eth_gro_receive")
	and not target_0.getTarget().hasName("call_gro_receive")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vhead_536
	and target_0.getArgument(1).(VariableAccess).getTarget()=vskb_537
	and target_0.getParent().(AssignExpr).getRValue() = target_0
	and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("sk_buff **")
}

from Function func, Parameter vhead_536, Parameter vskb_537, FunctionCall target_0
where
func_0(vhead_536, vskb_537, target_0)
and vhead_536.getType().hasName("sk_buff **")
and vskb_537.getType().hasName("sk_buff *")
and vhead_536.getFunction() = func
and vskb_537.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
