/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-pppol2tp_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/pppol2tp-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/l2tp/l2tp_ppp.c-pppol2tp_recvmsg CVE-2013-7270
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable verr_1_0, UnaryMinusExpr target_0) {
		target_0.getValue()="-5"
		and target_0.getParent().(AssignExpr).getRValue() = target_0
		and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_1_0
}

predicate func_1(Variable verr_1_0, VariableAccess target_1) {
		target_1.getTarget()=verr_1_0
		and target_1.getParent().(AssignExpr).getLValue() = target_1
		and target_1.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_2(Parameter vlen_189, Variable verr_1_0, VariableAccess target_2) {
		target_2.getTarget()=verr_1_0
		and target_2.getParent().(AssignExpr).getLValue() = target_2
		and target_2.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_189
}

/*predicate func_3(Parameter vlen_189, Variable verr_1_0, VariableAccess target_3) {
		target_3.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_3.getParent().(AssignExpr).getRValue() = target_3
		and target_3.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_1_0
}

*/
predicate func_4(Variable vskb_193, FunctionCall target_4) {
		target_4.getTarget().hasName("kfree_skb")
		and not target_4.getTarget().hasName("skb_reset_transport_header")
		and target_4.getArgument(0).(VariableAccess).getTarget()=vskb_193
}

predicate func_6(Parameter vlen_189, Variable vskb_193, ExprStmt target_50, VariableAccess target_6) {
		target_6.getTarget()=vlen_189
		and vlen_189.getIndex() = 3
		and target_6.getParent().(GTExpr).getLesserOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_6.getParent().(GTExpr).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_6.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_50
}

predicate func_7(Variable vskb_193, PointerFieldAccess target_7) {
		target_7.getTarget().getName()="len"
		and target_7.getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_8(Variable verr_1_0, VariableAccess target_8) {
		target_8.getTarget()=verr_1_0
		and target_8.getParent().(EQExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
}

predicate func_9(Variable vsk_194, BitwiseAndExpr target_44, Function func) {
	exists(ExprStmt target_9 |
		target_9.getExpr().(FunctionCall).getTarget().hasName("lock_sock")
		and target_9.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_9)
}

predicate func_10(Variable vsk_194) {
	exists(LogicalAndExpr target_10 |
		target_10.getAnOperand().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="sk_type"
		and target_10.getAnOperand().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_194
		and target_10.getAnOperand().(EqualityOperation).getAnOperand() instanceof ValueFieldAccess
		and target_10.getParent().(IfStmt).getThen() instanceof GotoStmt)
}

predicate func_12(Variable vskb_193) {
	exists(EqualityOperation target_12 |
		target_12.getAnOperand().(VariableAccess).getTarget()=vskb_193
		and target_12.getAnOperand() instanceof Literal
		and target_12.getParent().(IfStmt).getThen() instanceof GotoStmt)
}

predicate func_13(Variable vsk_194, ExprStmt target_53) {
	exists(PointerFieldAccess target_13 |
		target_13.getTarget().getName()="pidincl"
		and target_13.getQualifier().(PointerFieldAccess).getTarget().getName()="sk_protinfo"
		and target_13.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_194
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_13.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_14(Variable vskb_193, ExprStmt target_53, RelationalOperation target_54) {
	exists(FunctionCall target_14 |
		target_14.getTarget().hasName("skb_pull")
		and target_14.getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_14.getArgument(1) instanceof Literal
		and target_53.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_14.getArgument(0).(VariableAccess).getLocation())
		and target_14.getArgument(0).(VariableAccess).getLocation().isBefore(target_54.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_16(Parameter vmsg_189, Variable vskb_193, ExprStmt target_50, Function func) {
	exists(ExprStmt target_16 |
		target_16.getExpr().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_16.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_16.getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_16.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_16.getExpr().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_16.getExpr().(FunctionCall).getArgument(3).(VariableAccess).getType().hasName("int")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_16)
}

predicate func_19(Parameter vmsg_189, ExprStmt target_33, Function func) {
	exists(IfStmt target_19 |
		target_19.getCondition().(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_19.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_19.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("memset")
		and target_19.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_19.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_19.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofTypeOperator).getType() instanceof LongType
		and target_19.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofTypeOperator).getValue()="72"
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ax25_addr_parse")
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(VariableAccess).getType().hasName("const unsigned char *")
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerArithmeticOperation).getAnOperand().(Literal).getValue()="1"
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="data"
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getType().hasName("const unsigned char *")
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(SubExpr).getRightOperand().(Literal).getValue()="1"
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("ax25_address")
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(3).(Literal).getValue()="0"
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("ax25_digi")
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(5).(Literal).getValue()="0"
		and target_19.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(6).(Literal).getValue()="0"
		and target_19.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sax25_family"
		and target_19.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_19.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="3"
		and target_19.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sax25_ndigis"
		and target_19.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_19.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="ndigi"
		and target_19.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ax25_digi")
		and target_19.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sax25_call"
		and target_19.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_19.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("ax25_address")
		and target_19.getThen().(BlockStmt).getStmt(9).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getTarget().getName()="sax25_ndigis"
		and target_19.getThen().(BlockStmt).getStmt(9).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_19.getThen().(BlockStmt).getStmt(9).(IfStmt).getCondition().(EqualityOperation).getAnOperand() instanceof Literal
		and target_19.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(2).(ForStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
		and target_19.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(2).(ForStmt).getCondition().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getTarget().getName()="ndigi"
		and target_19.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(2).(ForStmt).getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
		and target_19.getThen().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_19.getThen().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_19.getThen().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getType() instanceof LongType
		and target_19.getThen().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getValue()="72"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_19
		and target_33.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_19.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_20(Variable vskb_193, RelationalOperation target_54, RelationalOperation target_55) {
	exists(FunctionCall target_20 |
		target_20.getTarget().hasName("ax25_addr_parse")
		and target_20.getArgument(0).(PointerArithmeticOperation).getAnOperand().(VariableAccess).getType().hasName("const unsigned char *")
		and target_20.getArgument(0).(PointerArithmeticOperation).getAnOperand().(Literal).getValue()="1"
		and target_20.getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="data"
		and target_20.getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_20.getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getRightOperand().(VariableAccess).getType().hasName("const unsigned char *")
		and target_20.getArgument(1).(SubExpr).getRightOperand().(Literal).getValue()="1"
		and target_20.getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("ax25_address")
		and target_20.getArgument(3).(Literal).getValue()="0"
		and target_20.getArgument(4).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("ax25_digi")
		and target_20.getArgument(5).(Literal).getValue()="0"
		and target_20.getArgument(6).(Literal).getValue()="0"
		and target_54.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_20.getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_20.getArgument(1).(SubExpr).getLeftOperand().(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_55.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_21(Function func) {
	exists(PointerFieldAccess target_21 |
		target_21.getTarget().getName()="sax25_ndigis"
		and target_21.getQualifier().(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_21.getEnclosingFunction() = func)
}

*/
/*predicate func_22(Function func) {
	exists(ValueFieldAccess target_22 |
		target_22.getTarget().getName()="ndigi"
		and target_22.getQualifier().(VariableAccess).getType().hasName("ax25_digi")
		and target_22.getEnclosingFunction() = func)
}

*/
/*predicate func_23(ExprStmt target_50, Function func) {
	exists(EqualityOperation target_23 |
		target_23.getAnOperand().(PointerFieldAccess).getTarget().getName()="sax25_ndigis"
		and target_23.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("sockaddr_ax25 *")
		and target_23.getAnOperand() instanceof Literal
		and target_23.getParent().(IfStmt).getThen()=target_50
		and target_23.getEnclosingFunction() = func)
}

*/
/*predicate func_24(RelationalOperation target_54, Function func) {
	exists(ForStmt target_24 |
		target_24.getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_24.getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_24.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
		and target_24.getCondition().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getTarget().getName()="ndigi"
		and target_24.getCondition().(RelationalOperation).getGreaterOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ax25_digi")
		and target_24.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getType().hasName("int")
		and target_24.getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getTarget().getName()="fsa_digipeater"
		and target_24.getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayBase().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("full_sockaddr_ax25 *")
		and target_24.getStmt().(ExprStmt).getExpr().(AssignExpr).getLValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
		and target_24.getStmt().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getTarget().getName()="calls"
		and target_24.getStmt().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayBase().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("ax25_digi")
		and target_24.getStmt().(ExprStmt).getExpr().(AssignExpr).getRValue().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
		and target_24.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_24
		and target_24.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_54
		and target_24.getEnclosingFunction() = func)
}

*/
/*predicate func_26(Function func) {
	exists(ValueFieldAccess target_26 |
		target_26.getTarget().getName()="ndigi"
		and target_26.getQualifier().(VariableAccess).getType().hasName("ax25_digi")
		and target_26.getEnclosingFunction() = func)
}

*/
predicate func_27(Variable vskb_193, Variable vsk_194, ExprStmt target_56, Function func) {
	exists(ExprStmt target_27 |
		target_27.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_27.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and target_27.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_193
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
		and target_27.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

predicate func_28(Function func) {
	exists(ExprStmt target_28 |
		target_28.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
		and target_28.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("int")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_28)
}

predicate func_29(Variable vsk_194, Function func) {
	exists(ExprStmt target_29 |
		target_29.getExpr().(FunctionCall).getTarget().hasName("release_sock")
		and target_29.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_29)
}

predicate func_30(Parameter vmsg_189, PointerFieldAccess target_30) {
		target_30.getTarget().getName()="msg_namelen"
		and target_30.getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_30.getParent().(AssignExpr).getLValue() = target_30
		and target_30.getParent().(AssignExpr).getRValue().(Literal).getValue()="0"
}

predicate func_31(Variable vsk_194, ValueFieldAccess target_31) {
		target_31.getTarget().getName()="skc_state"
		and target_31.getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
		and target_31.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_194
}

predicate func_32(Parameter vlen_189, Variable vskb_193, ExprStmt target_50, PointerFieldAccess target_32) {
		target_32.getTarget().getName()="len"
		and target_32.getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_32.getParent().(GTExpr).getGreaterOperand().(VariableAccess).getTarget()=vlen_189
		and target_32.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_50
}

predicate func_33(Parameter vmsg_189, RelationalOperation target_54, ExprStmt target_33) {
		target_33.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_33.getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_33.getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
		and target_33.getParent().(IfStmt).getParent().(IfStmt).getCondition()=target_54
}

predicate func_34(Variable vskb_193, VariableAccess target_34) {
		target_34.getTarget()=vskb_193
}

predicate func_35(Parameter vmsg_189, Parameter vlen_189, Variable vskb_193, Variable verr_1_0, VariableAccess target_35) {
		target_35.getTarget()=verr_1_0
		and target_35.getParent().(AssignExpr).getLValue() = target_35
		and target_35.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_35.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_35.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_35.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_35.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_35.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vlen_189
}

/*predicate func_36(Parameter vmsg_189, Parameter vlen_189, Variable vskb_193, VariableAccess target_36) {
		target_36.getTarget()=vskb_193
		and target_36.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_36.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_36.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_36.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_36.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vlen_189
}

*/
predicate func_41(Variable vskb_193, VariableAccess target_41) {
		target_41.getTarget()=vskb_193
		and target_41.getParent().(NotExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

predicate func_42(Variable vskb_193, VariableAccess target_42) {
		target_42.getTarget()=vskb_193
}

predicate func_43(BitwiseAndExpr target_44, Function func, GotoStmt target_43) {
		target_43.getParent().(IfStmt).getCondition()=target_44
		and target_43.getEnclosingFunction() = func
}

predicate func_44(Function func, BitwiseAndExpr target_44) {
		target_44.getLeftOperand() instanceof ValueFieldAccess
		and target_44.getRightOperand() instanceof EnumConstantAccess
		and target_44.getParent().(IfStmt).getThen() instanceof GotoStmt
		and target_44.getEnclosingFunction() = func
}

predicate func_45(Parameter vlen_189, Variable vskb_193, AssignExpr target_45) {
		target_45.getLValue().(VariableAccess).getTarget()=vlen_189
		and target_45.getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_45.getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_46(Parameter vlen_189, Variable vskb_193, ExprStmt target_33, ExprStmt target_50, ExprStmt target_56, VariableAccess target_46) {
		target_46.getTarget()=vlen_189
		and target_46.getParent().(LTExpr).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_46.getParent().(LTExpr).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
		and target_46.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_33
		and target_46.getLocation().isBefore(target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation())
}

/*predicate func_47(Variable vskb_193, ExprStmt target_50, PointerFieldAccess target_47) {
		target_47.getTarget().getName()="len"
		and target_47.getQualifier().(VariableAccess).getTarget()=vskb_193
}

*/
predicate func_48(Parameter vmsg_189, Parameter vlen_189, Variable vskb_193, RelationalOperation target_55, ExprStmt target_57, VariableAccess target_48) {
		target_48.getTarget()=vlen_189
		and target_48.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_48.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_48.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
		and target_48.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_48.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_55.getLesserOperand().(VariableAccess).getLocation().isBefore(target_48.getLocation())
		and target_48.getLocation().isBefore(target_57.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
}

predicate func_49(Variable verr_1_0, ExprStmt target_57, FunctionCall target_49) {
		target_49.getTarget().hasName("__builtin_expect")
		and target_49.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=verr_1_0
		and target_49.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_49.getArgument(1) instanceof Literal
		and target_49.getParent().(IfStmt).getThen()=target_57
}

predicate func_50(Function func, ExprStmt target_50) {
		target_50.getExpr() instanceof AssignExpr
		and target_50.getEnclosingFunction() = func
}

predicate func_53(Variable vskb_193, Variable vsk_194, Variable verr_1_0, ExprStmt target_53) {
		target_53.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vskb_193
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_194
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="-65"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget().getType().hasName("int")
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
		and target_53.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_1_0
}

predicate func_54(Parameter vlen_189, Variable vskb_193, RelationalOperation target_54) {
		 (target_54 instanceof GTExpr or target_54 instanceof LTExpr)
		and target_54.getGreaterOperand().(VariableAccess).getTarget()=vlen_189
		and target_54.getLesserOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_54.getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_55(Parameter vlen_189, Variable vskb_193, RelationalOperation target_55) {
		 (target_55 instanceof GTExpr or target_55 instanceof LTExpr)
		and target_55.getLesserOperand().(VariableAccess).getTarget()=vlen_189
		and target_55.getGreaterOperand().(PointerFieldAccess).getTarget().getName()="len"
		and target_55.getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_193
}

predicate func_56(Parameter vmsg_189, Parameter vlen_189, Variable vskb_193, Variable verr_1_0, ExprStmt target_56) {
		target_56.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_1_0
		and target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_193
		and target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof Literal
		and target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_189
		and target_56.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vlen_189
}

predicate func_57(Parameter vlen_189, Variable verr_1_0, ExprStmt target_57) {
		target_57.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verr_1_0
		and target_57.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_189
}

from Function func, Parameter vmsg_189, Parameter vlen_189, Variable vskb_193, Variable vsk_194, Variable verr_1_0, UnaryMinusExpr target_0, VariableAccess target_1, VariableAccess target_2, FunctionCall target_4, VariableAccess target_6, PointerFieldAccess target_7, VariableAccess target_8, PointerFieldAccess target_30, ValueFieldAccess target_31, PointerFieldAccess target_32, ExprStmt target_33, VariableAccess target_34, VariableAccess target_35, VariableAccess target_41, VariableAccess target_42, GotoStmt target_43, BitwiseAndExpr target_44, AssignExpr target_45, VariableAccess target_46, VariableAccess target_48, FunctionCall target_49, ExprStmt target_50, ExprStmt target_53, RelationalOperation target_54, RelationalOperation target_55, ExprStmt target_56, ExprStmt target_57
where
func_0(verr_1_0, target_0)
and func_1(verr_1_0, target_1)
and func_2(vlen_189, verr_1_0, target_2)
and func_4(vskb_193, target_4)
and func_6(vlen_189, vskb_193, target_50, target_6)
and func_7(vskb_193, target_7)
and func_8(verr_1_0, target_8)
and not func_9(vsk_194, target_44, func)
and not func_10(vsk_194)
and not func_12(vskb_193)
and not func_13(vsk_194, target_53)
and not func_14(vskb_193, target_53, target_54)
and not func_16(vmsg_189, vskb_193, target_50, func)
and not func_19(vmsg_189, target_33, func)
and not func_27(vskb_193, vsk_194, target_56, func)
and not func_28(func)
and not func_29(vsk_194, func)
and func_30(vmsg_189, target_30)
and func_31(vsk_194, target_31)
and func_32(vlen_189, vskb_193, target_50, target_32)
and func_33(vmsg_189, target_54, target_33)
and func_34(vskb_193, target_34)
and func_35(vmsg_189, vlen_189, vskb_193, verr_1_0, target_35)
and func_41(vskb_193, target_41)
and func_42(vskb_193, target_42)
and func_43(target_44, func, target_43)
and func_44(func, target_44)
and func_45(vlen_189, vskb_193, target_45)
and func_46(vlen_189, vskb_193, target_33, target_50, target_56, target_46)
and func_48(vmsg_189, vlen_189, vskb_193, target_55, target_57, target_48)
and func_49(verr_1_0, target_57, target_49)
and func_50(func, target_50)
and func_53(vskb_193, vsk_194, verr_1_0, target_53)
and func_54(vlen_189, vskb_193, target_54)
and func_55(vlen_189, vskb_193, target_55)
and func_56(vmsg_189, vlen_189, vskb_193, verr_1_0, target_56)
and func_57(vlen_189, verr_1_0, target_57)
and vmsg_189.getType().hasName("msghdr *")
and vlen_189.getType().hasName("size_t")
and vskb_193.getType().hasName("sk_buff *")
and vsk_194.getType().hasName("sock *")
and verr_1_0.getType().hasName("int")
and vmsg_189.getFunction() = func
and vlen_189.getFunction() = func
and vskb_193.(LocalVariable).getFunction() = func
and vsk_194.(LocalVariable).getFunction() = func
and verr_1_0.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
