/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-vcc_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/vcc-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/atm/common.c-vcc_recvmsg CVE-2013-7268
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
		target_0.getValue()="64"
		and not target_0.getValue()="2"
		and target_0.getParent().(BitwiseOrExpr).getParent().(ComplementExpr).getOperand().(BitwiseOrExpr).getValue()="66"
		and target_0.getEnclosingFunction() = func
}

predicate func_1(Function func, Literal target_1) {
		target_1.getValue()="2"
		and not target_1.getValue()="64"
		and target_1.getParent().(BitwiseOrExpr).getParent().(ComplementExpr).getOperand().(BitwiseOrExpr).getValue()="66"
		and target_1.getEnclosingFunction() = func
}

predicate func_2(Parameter vflags_527, Variable vsk_529, Variable verror_532, VariableAccess target_2) {
		target_2.getTarget()=verror_532
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_529
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_527
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_2.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
}

predicate func_3(Variable verror_532, VariableAccess target_3) {
		target_3.getTarget()=verror_532
}

predicate func_4(Parameter vsize_527, Variable vcopied_532, BlockStmt target_52, VariableAccess target_4) {
		target_4.getTarget()=vsize_527
		and vsize_527.getIndex() = 3
		and target_4.getParent().(GTExpr).getGreaterOperand().(VariableAccess).getTarget()=vcopied_532
		and target_4.getParent().(GTExpr).getParent().(IfStmt).getThen()=target_52
}

predicate func_5(Parameter vsize_527, Variable vcopied_532, VariableAccess target_5) {
		target_5.getTarget()=vsize_527
		and vsize_527.getIndex() = 3
		and target_5.getParent().(AssignExpr).getRValue() = target_5
		and target_5.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_532
}

predicate func_6(Parameter vmsg_526, Variable vskb_531, Variable vcopied_532, Variable verror_532, VariableAccess target_6) {
		target_6.getTarget()=verror_532
		and target_6.getParent().(AssignExpr).getLValue() = target_6
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_531
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_526
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_532
}

predicate func_7(Parameter vflags_527, BitwiseAndExpr target_53, Literal target_7) {
		target_7.getValue()="2"
		and not target_7.getValue()="32"
		and target_7.getParent().(BitwiseAndExpr).getParent().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_53.getLeftOperand().(VariableAccess).getLocation().isBefore(target_7.getParent().(BitwiseAndExpr).getParent().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation())
}

predicate func_8(Variable vskb_531, ExprStmt target_54, PointerFieldAccess target_8) {
		target_8.getTarget().getName()="truesize"
		and target_8.getQualifier().(VariableAccess).getTarget()=vskb_531
		and target_54.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_8.getQualifier().(VariableAccess).getLocation())
}

predicate func_9(Function func, Initializer target_9) {
		target_9.getExpr() instanceof UnaryMinusExpr
		and target_9.getExpr().getEnclosingFunction() = func
}

predicate func_10(Function func, Literal target_10) {
		target_10.getValue()="107"
		and not target_10.getValue()="32"
		and target_10.getParent().(UnaryMinusExpr).getParent().(ReturnStmt).getExpr() instanceof UnaryMinusExpr
		and target_10.getEnclosingFunction() = func
}

predicate func_11(Function func, Literal target_11) {
		target_11.getValue()="95"
		and not target_11.getValue()="3"
		and target_11.getParent().(UnaryMinusExpr).getParent().(ReturnStmt).getExpr() instanceof UnaryMinusExpr
		and target_11.getEnclosingFunction() = func
}

predicate func_12(Variable vvcc_530, FunctionCall target_12) {
		target_12.getTarget().hasName("constant_test_bit")
		and not target_12.getTarget().hasName("pfkey_do_dump")
		and target_12.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_12.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvcc_530
}

predicate func_13(Variable verror_532, ReturnStmt target_45, VariableAccess target_13) {
		target_13.getTarget()=verror_532
		and target_13.getParent().(IfStmt).getThen()=target_45
}

predicate func_14(Variable vvcc_530, Variable vskb_531, FunctionCall target_14) {
		target_14.getTarget().hasName("atm_return")
		and not target_14.getTarget().hasName("skb_reset_transport_header")
		and target_14.getArgument(0).(VariableAccess).getTarget()=vvcc_530
		and target_14.getArgument(1).(PointerFieldAccess).getTarget().getName()="truesize"
		and target_14.getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_531
}

predicate func_16(Variable vsk_529) {
	exists(FunctionCall target_16 |
		target_16.getTarget().hasName("pfkey_sk")
		and target_16.getArgument(0).(VariableAccess).getTarget()=vsk_529)
}

predicate func_18(Parameter vflags_527, ReturnStmt target_38, ExprStmt target_57) {
	exists(BitwiseAndExpr target_18 |
		target_18.getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_18.getRightOperand().(ComplementExpr).getValue()="2147483549"
		and target_18.getParent().(IfStmt).getThen()=target_38
		and target_18.getLeftOperand().(VariableAccess).getLocation().isBefore(target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation()))
}

predicate func_19(EqualityOperation target_58, Function func) {
	exists(GotoStmt target_19 |
		target_19.getParent().(IfStmt).getCondition()=target_58
		and target_19.getEnclosingFunction() = func)
}

predicate func_20(Variable vskb_531, ReturnStmt target_59, ExprStmt target_57, ExprStmt target_60) {
	exists(EqualityOperation target_20 |
		target_20.getAnOperand().(VariableAccess).getTarget()=vskb_531
		and target_20.getAnOperand().(Literal).getValue()="0"
		and target_20.getParent().(IfStmt).getThen()=target_59
		and target_57.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_20.getAnOperand().(VariableAccess).getLocation())
		and target_20.getAnOperand().(VariableAccess).getLocation().isBefore(target_60.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_21(NotExpr target_44, Function func) {
	exists(GotoStmt target_21 |
		target_21.getParent().(IfStmt).getCondition()=target_44
		and target_21.getEnclosingFunction() = func)
}

predicate func_22(VariableAccess target_13, Function func) {
	exists(GotoStmt target_22 |
		target_22.getParent().(IfStmt).getCondition()=target_13
		and target_22.getEnclosingFunction() = func)
}

predicate func_23(Parameter vflags_527, Variable vskb_531, Variable vcopied_532, BitwiseAndExpr target_53, ExprStmt target_54, ExprStmt target_62) {
	exists(AssignExpr target_23 |
		target_23.getLValue().(VariableAccess).getType().hasName("int")
		and target_23.getRValue().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_23.getRValue().(ConditionalExpr).getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32"
		and target_23.getRValue().(ConditionalExpr).getThen().(PointerFieldAccess).getTarget().getName()="len"
		and target_23.getRValue().(ConditionalExpr).getThen().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_531
		and target_23.getRValue().(ConditionalExpr).getElse().(VariableAccess).getTarget()=vcopied_532
		and target_53.getLeftOperand().(VariableAccess).getLocation().isBefore(target_23.getRValue().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getLocation())
		and target_54.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getLocation().isBefore(target_23.getRValue().(ConditionalExpr).getThen().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getLocation().isBefore(target_23.getRValue().(ConditionalExpr).getElse().(VariableAccess).getLocation()))
}

predicate func_24(Variable vsk_529, ReturnStmt target_40, ExprStmt target_57) {
	exists(LogicalAndExpr target_24 |
		target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="dump"
		and target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="dump"
		and target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pfkey_sock *")
		and target_24.getAnOperand().(EqualityOperation).getAnOperand() instanceof Literal
		and target_24.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getLeftOperand().(Literal).getValue()="3"
		and target_24.getAnOperand().(RelationalOperation).getLesserOperand().(MulExpr).getRightOperand() instanceof FunctionCall
		and target_24.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="sk_rcvbuf"
		and target_24.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_529
		and target_24.getParent().(IfStmt).getThen()=target_40
		and target_24.getAnOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

/*predicate func_25(Function func) {
	exists(ValueFieldAccess target_25 |
		target_25.getTarget().getName()="dump"
		and target_25.getQualifier().(PointerFieldAccess).getTarget().getName()="dump"
		and target_25.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pfkey_sock *")
		and target_25.getEnclosingFunction() = func)
}

*/
predicate func_27(Function func, UnaryMinusExpr target_27) {
		target_27.getValue()="-22"
		and target_27.getEnclosingFunction() = func
}

predicate func_28(Variable vsk_529, FunctionCall target_28) {
		target_28.getTarget().hasName("atomic_read")
		and target_28.getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="rmem_alloc"
		and target_28.getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_backlog"
		and target_28.getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_529
		and target_28.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_29(Parameter vflags_527, ReturnStmt target_40, VariableAccess target_29) {
		target_29.getTarget()=vflags_527
		and target_29.getParent().(BitwiseAndExpr).getRightOperand() instanceof ComplementExpr
		and target_29.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen()=target_40
}

predicate func_31(Variable vskb_531, ReturnStmt target_59, VariableAccess target_31) {
		target_31.getTarget()=vskb_531
		and target_31.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_59
}

predicate func_32(Variable vskb_531, VariableAccess target_32) {
		target_32.getTarget()=vskb_531
		and target_32.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_33(Variable vcopied_532, VariableAccess target_33) {
		target_33.getTarget()=vcopied_532
}

predicate func_35(Parameter vmsg_526, PointerFieldAccess target_35) {
		target_35.getTarget().getName()="msg_namelen"
		and target_35.getQualifier().(VariableAccess).getTarget()=vmsg_526
}

predicate func_36(Parameter vsock_526, PointerFieldAccess target_36) {
		target_36.getTarget().getName()="state"
		and target_36.getQualifier().(VariableAccess).getTarget()=vsock_526
}

predicate func_38(EqualityOperation target_58, Function func, ReturnStmt target_38) {
		target_38.getExpr().(UnaryMinusExpr).getValue()="-107"
		and target_38.getParent().(IfStmt).getCondition()=target_58
		and target_38.getEnclosingFunction() = func
}

predicate func_39(Parameter vflags_527, ReturnStmt target_40, BitwiseAndExpr target_39) {
		target_39.getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_39.getRightOperand().(ComplementExpr).getValue()="-67"
		and target_39.getParent().(IfStmt).getThen()=target_40
}

predicate func_40(BitwiseAndExpr target_39, Function func, ReturnStmt target_40) {
		target_40.getExpr().(UnaryMinusExpr).getValue()="-95"
		and target_40.getParent().(IfStmt).getCondition()=target_39
		and target_40.getEnclosingFunction() = func
}

predicate func_41(Parameter vsock_526, Variable vvcc_530, AssignExpr target_41) {
		target_41.getLValue().(VariableAccess).getTarget()=vvcc_530
		and target_41.getRValue().(FunctionCall).getTarget().hasName("ATM_SD")
		and target_41.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsock_526
}

predicate func_42(Function func, IfStmt target_42) {
		target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getCondition().(Literal).getValue()="1"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getThen() instanceof FunctionCall
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("variable_test_bit")
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getCondition().(Literal).getValue()="1"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("constant_test_bit")
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getThen().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("variable_test_bit")
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(ConditionalExpr).getCondition().(Literal).getValue()="1"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("constant_test_bit")
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(ConditionalExpr).getThen().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("variable_test_bit")
		and target_42.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_42.getThen().(ReturnStmt).getExpr().(Literal).getValue()="0"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_42
}

predicate func_43(Variable vvcc_530, PointerFieldAccess target_43) {
		target_43.getTarget().getName()="flags"
		and target_43.getQualifier().(VariableAccess).getTarget()=vvcc_530
}

predicate func_44(Variable vskb_531, ReturnStmt target_59, NotExpr target_44) {
		target_44.getOperand().(VariableAccess).getTarget()=vskb_531
		and target_44.getParent().(IfStmt).getThen()=target_59
}

predicate func_45(Variable verror_532, VariableAccess target_13, IfStmt target_64, ReturnStmt target_45) {
		target_45.getExpr().(VariableAccess).getTarget()=verror_532
		and target_45.getParent().(IfStmt).getCondition()=target_13
		and target_64.getCondition().(VariableAccess).getLocation().isBefore(target_45.getExpr().(VariableAccess).getLocation())
}

predicate func_46(Parameter vflags_527, Function func, IfStmt target_46) {
		target_46.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_46.getCondition().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand() instanceof Literal
		and target_46.getThen().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
		and target_46.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_46.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_46.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__dynamic_pr_debug")
		and target_46.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr() instanceof FunctionCall
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_46
}

/*predicate func_47(Variable vskb_531, Variable vdescriptor_565, Variable v__func__, NotExpr target_65, DoStmt target_47) {
		target_47.getCondition() instanceof Literal
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__dynamic_pr_debug")
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdescriptor_565
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="atm:%s: %d -= %d\n"
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3) instanceof FunctionCall
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="truesize"
		and target_47.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_531
		and target_47.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_65
}

*/
/*predicate func_49(Variable vskb_531, Variable vdescriptor_565, Variable v__func__, IfStmt target_49) {
		target_49.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_49.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
		and target_49.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vdescriptor_565
		and target_49.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
		and target_49.getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__dynamic_pr_debug")
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdescriptor_565
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="atm:%s: %d -= %d\n"
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3) instanceof FunctionCall
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getTarget().getName()="truesize"
		and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_531
}

*/
/*predicate func_50(Variable vskb_531, Variable vdescriptor_565, Variable v__func__, FunctionCall target_50) {
		target_50.getTarget().hasName("__dynamic_pr_debug")
		and target_50.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdescriptor_565
		and target_50.getArgument(1).(StringLiteral).getValue()="atm:%s: %d -= %d\n"
		and target_50.getArgument(2).(VariableAccess).getTarget()=v__func__
		and target_50.getArgument(3) instanceof FunctionCall
		and target_50.getArgument(4).(PointerFieldAccess).getTarget().getName()="truesize"
		and target_50.getArgument(4).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_531
}

*/
predicate func_51(Variable vcopied_532, Function func, ReturnStmt target_51) {
		target_51.getExpr().(VariableAccess).getTarget()=vcopied_532
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
}

predicate func_52(Parameter vmsg_526, Parameter vsize_527, Variable vcopied_532, BlockStmt target_52) {
		target_52.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_532
		and target_52.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vsize_527
		and target_52.getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_52.getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_526
		and target_52.getStmt(1).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
}

predicate func_53(Parameter vflags_527, BitwiseAndExpr target_53) {
		target_53.getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_53.getRightOperand().(Literal).getValue()="64"
}

predicate func_54(Parameter vmsg_526, Variable vsk_529, Variable vskb_531, ExprStmt target_54) {
		target_54.getExpr().(FunctionCall).getTarget().hasName("sock_recv_ts_and_drops")
		and target_54.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmsg_526
		and target_54.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsk_529
		and target_54.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vskb_531
}

predicate func_57(Parameter vflags_527, Variable vsk_529, Variable vskb_531, Variable verror_532, ExprStmt target_57) {
		target_57.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vskb_531
		and target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_529
		and target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_527
		and target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="64"
		and target_57.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verror_532
}

predicate func_58(Parameter vsock_526, EqualityOperation target_58) {
		target_58.getAnOperand().(PointerFieldAccess).getTarget().getName()="state"
		and target_58.getAnOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsock_526
		and target_58.getAnOperand() instanceof EnumConstantAccess
}

predicate func_59(Variable verror_532, NotExpr target_44, ReturnStmt target_59) {
		target_59.getExpr().(VariableAccess).getTarget()=verror_532
		and target_59.getParent().(IfStmt).getCondition()=target_44
}

predicate func_60(Variable vskb_531, Variable vcopied_532, ExprStmt target_60) {
		target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_532
		and target_60.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_60.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_531
}

predicate func_62(Parameter vmsg_526, Variable vskb_531, Variable vcopied_532, Variable verror_532, ExprStmt target_62) {
		target_62.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=verror_532
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_531
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_526
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_532
}

predicate func_64(Variable verror_532, IfStmt target_64) {
		target_64.getCondition().(VariableAccess).getTarget()=verror_532
		and target_64.getThen() instanceof ReturnStmt
}

predicate func_65(Parameter vflags_527, NotExpr target_65) {
		target_65.getOperand().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_527
		and target_65.getOperand().(BitwiseAndExpr).getRightOperand() instanceof Literal
}

from Function func, Parameter vsock_526, Parameter vmsg_526, Parameter vsize_527, Parameter vflags_527, Variable vsk_529, Variable vvcc_530, Variable vskb_531, Variable vcopied_532, Variable verror_532, Variable vdescriptor_565, Variable v__func__, Literal target_0, Literal target_1, VariableAccess target_2, VariableAccess target_3, VariableAccess target_4, VariableAccess target_5, VariableAccess target_6, Literal target_7, PointerFieldAccess target_8, Initializer target_9, Literal target_10, Literal target_11, FunctionCall target_12, VariableAccess target_13, FunctionCall target_14, UnaryMinusExpr target_27, FunctionCall target_28, VariableAccess target_29, VariableAccess target_31, VariableAccess target_32, VariableAccess target_33, PointerFieldAccess target_35, PointerFieldAccess target_36, ReturnStmt target_38, BitwiseAndExpr target_39, ReturnStmt target_40, AssignExpr target_41, IfStmt target_42, PointerFieldAccess target_43, NotExpr target_44, ReturnStmt target_45, IfStmt target_46, ReturnStmt target_51, BlockStmt target_52, BitwiseAndExpr target_53, ExprStmt target_54, ExprStmt target_57, EqualityOperation target_58, ReturnStmt target_59, ExprStmt target_60, ExprStmt target_62, IfStmt target_64, NotExpr target_65
where
func_0(func, target_0)
and func_1(func, target_1)
and func_2(vflags_527, vsk_529, verror_532, target_2)
and func_3(verror_532, target_3)
and func_4(vsize_527, vcopied_532, target_52, target_4)
and func_5(vsize_527, vcopied_532, target_5)
and func_6(vmsg_526, vskb_531, vcopied_532, verror_532, target_6)
and func_7(vflags_527, target_53, target_7)
and func_8(vskb_531, target_54, target_8)
and func_9(func, target_9)
and func_10(func, target_10)
and func_11(func, target_11)
and func_12(vvcc_530, target_12)
and func_13(verror_532, target_45, target_13)
and func_14(vvcc_530, vskb_531, target_14)
and not func_16(vsk_529)
and not func_18(vflags_527, target_38, target_57)
and not func_19(target_58, func)
and not func_20(vskb_531, target_59, target_57, target_60)
and not func_21(target_44, func)
and not func_22(target_13, func)
and not func_23(vflags_527, vskb_531, vcopied_532, target_53, target_54, target_62)
and not func_24(vsk_529, target_40, target_57)
and func_27(func, target_27)
and func_28(vsk_529, target_28)
and func_29(vflags_527, target_40, target_29)
and func_31(vskb_531, target_59, target_31)
and func_32(vskb_531, target_32)
and func_33(vcopied_532, target_33)
and func_35(vmsg_526, target_35)
and func_36(vsock_526, target_36)
and func_38(target_58, func, target_38)
and func_39(vflags_527, target_40, target_39)
and func_40(target_39, func, target_40)
and func_41(vsock_526, vvcc_530, target_41)
and func_42(func, target_42)
and func_43(vvcc_530, target_43)
and func_44(vskb_531, target_59, target_44)
and func_45(verror_532, target_13, target_64, target_45)
and func_46(vflags_527, func, target_46)
and func_51(vcopied_532, func, target_51)
and func_52(vmsg_526, vsize_527, vcopied_532, target_52)
and func_53(vflags_527, target_53)
and func_54(vmsg_526, vsk_529, vskb_531, target_54)
and func_57(vflags_527, vsk_529, vskb_531, verror_532, target_57)
and func_58(vsock_526, target_58)
and func_59(verror_532, target_44, target_59)
and func_60(vskb_531, vcopied_532, target_60)
and func_62(vmsg_526, vskb_531, vcopied_532, verror_532, target_62)
and func_64(verror_532, target_64)
and func_65(vflags_527, target_65)
and vsock_526.getType().hasName("socket *")
and vmsg_526.getType().hasName("msghdr *")
and vsize_527.getType().hasName("size_t")
and vflags_527.getType().hasName("int")
and vsk_529.getType().hasName("sock *")
and vvcc_530.getType().hasName("atm_vcc *")
and vskb_531.getType().hasName("sk_buff *")
and vcopied_532.getType().hasName("int")
and verror_532.getType().hasName("int")
and vdescriptor_565.getType().hasName("_ddebug")
and v__func__.getType() instanceof ArrayType
and vsock_526.getFunction() = func
and vmsg_526.getFunction() = func
and vsize_527.getFunction() = func
and vflags_527.getFunction() = func
and vsk_529.(LocalVariable).getFunction() = func
and vvcc_530.(LocalVariable).getFunction() = func
and vskb_531.(LocalVariable).getFunction() = func
and vcopied_532.(LocalVariable).getFunction() = func
and verror_532.(LocalVariable).getFunction() = func
and vdescriptor_565.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
