commit ecb31dbad39ccdc65868d5d2a37f0f0521250832
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Mon Aug 27 15:24:10 2018 -0400

    https://github.com/ImageMagick/ImageMagick/issues/1268

diff --git a/coders/bmp.c b/coders/bmp.c
index 8461e1a49..e20085fef 100644
--- a/coders/bmp.c
+++ b/coders/bmp.c
@@ -661,6 +661,8 @@ static Image *ReadBMPImage(const ImageInfo *image_info,ExceptionInfo *exception)
         bmp_info.x_pixels=ReadBlobLSBLong(image);
         bmp_info.y_pixels=ReadBlobLSBLong(image);
         bmp_info.number_colors=ReadBlobLSBLong(image);
+        if (bmp_info.number_colors > GetBlobSize(image))
+          ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
         bmp_info.colors_important=ReadBlobLSBLong(image);
         if (image->debug != MagickFalse)
           {
