/**
 * @name linux-a6e544b0a88b53114bfa5a57e21b7be7a8dfc9d0-__skb_flow_dissect
 * @id cpp/linux/a6e544b0a88b53114bfa5a57e21b7be7a8dfc9d0/--skb-flow-dissect
 * @description linux-a6e544b0a88b53114bfa5a57e21b7be7a8dfc9d0-net/core/flow_dissector.c-__skb_flow_dissect CVE-2017-13715
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(LogicalOrExpr target_45, Function func) {
exists(GotoStmt target_0 |
	target_0.getName() ="out_bad"
	and target_0.getParent().(IfStmt).getCondition()=target_45
	and target_0.getEnclosingFunction() = func)
}

predicate func_1(NotExpr target_46, Function func) {
exists(GotoStmt target_1 |
	target_1.getName() ="out_bad"
	and target_1.getParent().(IfStmt).getCondition()=target_46
	and target_1.getEnclosingFunction() = func)
}

predicate func_2(NotExpr target_47, Function func) {
exists(GotoStmt target_2 |
	target_2.getName() ="out_bad"
	and target_2.getParent().(IfStmt).getCondition()=target_47
	and target_2.getEnclosingFunction() = func)
}

predicate func_3(NotExpr target_48, Function func) {
exists(GotoStmt target_3 |
	target_3.getName() ="out_bad"
	and target_3.getParent().(IfStmt).getCondition()=target_48
	and target_3.getEnclosingFunction() = func)
}

predicate func_4(VariableAccess target_49, Function func) {
exists(GotoStmt target_4 |
	target_4.getName() ="out_bad"
	and target_4.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_49
	and target_4.getEnclosingFunction() = func)
}

predicate func_5(NotExpr target_50, Function func) {
exists(GotoStmt target_5 |
	target_5.getName() ="out_bad"
	and target_5.getParent().(IfStmt).getCondition()=target_50
	and target_5.getEnclosingFunction() = func)
}

predicate func_6(ExprStmt target_31, Function func) {
exists(GotoStmt target_6 |
	target_6.getName() ="out_good"
	and target_6.getLocation().isBefore(target_31.getLocation())
	and target_6.getEnclosingFunction() = func)
}

predicate func_7(NotExpr target_51, Function func) {
exists(GotoStmt target_7 |
	target_7.getName() ="out_bad"
	and target_7.getParent().(IfStmt).getCondition()=target_51
	and target_7.getEnclosingFunction() = func)
}

predicate func_8(EqualityOperation target_52, Function func) {
exists(GotoStmt target_8 |
	target_8.getName() ="out_good"
	and target_8.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_8
	and target_8.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_52
	and target_8.getEnclosingFunction() = func)
}

predicate func_10(VariableAccess target_53, Function func) {
exists(GotoStmt target_10 |
	target_10.getName() ="out_bad"
	and target_10.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_53
	and target_10.getEnclosingFunction() = func)
}

predicate func_11(NotExpr target_54, Function func) {
exists(GotoStmt target_11 |
	target_11.getName() ="out_bad"
	and target_11.getParent().(IfStmt).getCondition()=target_54
	and target_11.getEnclosingFunction() = func)
}

predicate func_12(NotExpr target_55, Function func) {
exists(GotoStmt target_12 |
	target_12.getName() ="out_bad"
	and target_12.getParent().(IfStmt).getCondition()=target_55
	and target_12.getEnclosingFunction() = func)
}

predicate func_13(NotExpr target_56, Function func) {
exists(GotoStmt target_13 |
	target_13.getName() ="out_bad"
	and target_13.getParent().(IfStmt).getCondition()=target_56
	and target_13.getEnclosingFunction() = func)
}

predicate func_14(NotExpr target_57, Function func) {
exists(GotoStmt target_14 |
	target_14.getName() ="out_bad"
	and target_14.getParent().(IfStmt).getCondition()=target_57
	and target_14.getEnclosingFunction() = func)
}

predicate func_15(Function func) {
exists(AssignExpr target_15 |
	target_15.getLValue().(VariableAccess).getType().hasName("bool")
	and target_15.getRValue() instanceof EnumConstantAccess
	and target_15.getEnclosingFunction() = func)
}

predicate func_17(Parameter vproto_124, Variable vkey_basic_127, PointerFieldAccess target_17) {
	target_17.getTarget().getName()="n_proto"
	and target_17.getQualifier().(VariableAccess).getTarget()=vkey_basic_127
	and target_17.getParent().(AssignExpr).getLValue() = target_17
	and target_17.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vproto_124
}

predicate func_18(Parameter vnhoff_124, Variable vkey_control_126, PointerFieldAccess target_18) {
	target_18.getTarget().getName()="thoff"
	and target_18.getQualifier().(VariableAccess).getTarget()=vkey_control_126
	and target_18.getParent().(AssignExpr).getLValue() = target_18
	and target_18.getParent().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnhoff_124
}

predicate func_19(Parameter vproto_124, Variable vkey_basic_127, EqualityOperation target_52, ExprStmt target_19) {
	target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="n_proto"
	and target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_basic_127
	and target_19.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vproto_124
	and target_19.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_52
}

predicate func_20(Variable vkey_basic_127, Variable vip_proto_132, EqualityOperation target_52, ExprStmt target_20) {
	target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ip_proto"
	and target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_basic_127
	and target_20.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vip_proto_132
	and target_20.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_52
}

predicate func_21(Parameter vnhoff_124, Variable vkey_control_126, EqualityOperation target_52, ExprStmt target_21) {
	target_21.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="thoff"
	and target_21.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_control_126
	and target_21.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnhoff_124
	and target_21.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_52
}

predicate func_24(LogicalOrExpr target_45, Function func, ReturnStmt target_24) {
	target_24.getExpr() instanceof EnumConstantAccess
	and target_24.getParent().(IfStmt).getCondition()=target_45
	and target_24.getEnclosingFunction() = func
}

predicate func_25(NotExpr target_46, Function func, ReturnStmt target_25) {
	target_25.getParent().(IfStmt).getCondition()=target_46
	and target_25.getEnclosingFunction() = func
}

predicate func_26(NotExpr target_47, Function func, ReturnStmt target_26) {
	target_26.getParent().(IfStmt).getCondition()=target_47
	and target_26.getEnclosingFunction() = func
}

predicate func_27(NotExpr target_48, Function func, ReturnStmt target_27) {
	target_27.getParent().(IfStmt).getCondition()=target_48
	and target_27.getEnclosingFunction() = func
}

predicate func_28(VariableAccess target_49, Function func, ReturnStmt target_28) {
	target_28.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_49
	and target_28.getEnclosingFunction() = func
}

predicate func_29(NotExpr target_50, Function func, ReturnStmt target_29) {
	target_29.getParent().(IfStmt).getCondition()=target_50
	and target_29.getEnclosingFunction() = func
}

predicate func_30(Parameter vproto_124, Variable vkey_basic_127, SwitchStmt target_58, ExprStmt target_19, AssignExpr target_30) {
	target_30.getLValue().(PointerFieldAccess).getTarget().getName()="n_proto"
	and target_30.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_basic_127
	and target_30.getRValue().(VariableAccess).getTarget()=vproto_124
	and target_58.getExpr().(VariableAccess).getLocation().isBefore(target_30.getRValue().(VariableAccess).getLocation())
	and target_30.getRValue().(VariableAccess).getLocation().isBefore(target_19.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
}

predicate func_31(Parameter vnhoff_124, Variable vkey_control_126, ExprStmt target_59, ExprStmt target_60, ExprStmt target_61, ExprStmt target_31) {
	target_31.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="thoff"
	and target_31.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_control_126
	and target_31.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnhoff_124
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation().isBefore(target_31.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
	and target_31.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
	and target_31.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_32(Function func, ReturnStmt target_32) {
	target_32.getExpr() instanceof EnumConstantAccess
	and target_32.getEnclosingFunction() = func
}

predicate func_33(NotExpr target_51, Function func, ReturnStmt target_33) {
	target_33.getParent().(IfStmt).getCondition()=target_51
	and target_33.getEnclosingFunction() = func
}

predicate func_36(VariableAccess target_53, Function func, ReturnStmt target_36) {
	target_36.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_53
	and target_36.getEnclosingFunction() = func
}

predicate func_37(NotExpr target_54, Function func, ReturnStmt target_37) {
	target_37.getParent().(IfStmt).getCondition()=target_54
	and target_37.getEnclosingFunction() = func
}

predicate func_38(NotExpr target_55, Function func, ReturnStmt target_38) {
	target_38.getParent().(IfStmt).getCondition()=target_55
	and target_38.getEnclosingFunction() = func
}

predicate func_39(NotExpr target_56, Function func, ReturnStmt target_39) {
	target_39.getParent().(IfStmt).getCondition()=target_56
	and target_39.getEnclosingFunction() = func
}

predicate func_40(NotExpr target_57, Function func, ReturnStmt target_40) {
	target_40.getParent().(IfStmt).getCondition()=target_57
	and target_40.getEnclosingFunction() = func
}

predicate func_41(Parameter vproto_124, Variable vkey_basic_127, Function func, ExprStmt target_41) {
	target_41.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="n_proto"
	and target_41.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_basic_127
	and target_41.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vproto_124
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_41
}

predicate func_42(Variable vkey_basic_127, Variable vip_proto_132, Function func, ExprStmt target_42) {
	target_42.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="ip_proto"
	and target_42.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_basic_127
	and target_42.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vip_proto_132
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_42
}

predicate func_43(Parameter vnhoff_124, Variable vkey_control_126, ExprStmt target_62, ExprStmt target_63, ExprStmt target_64, Function func, ExprStmt target_43) {
	target_43.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="thoff"
	and target_43.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_control_126
	and target_43.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vnhoff_124
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_43
	and target_62.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getLocation().isBefore(target_43.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation())
	and target_43.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getLocation())
	and target_64.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_43.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_44(Function func, ReturnStmt target_44) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_44
}

predicate func_45(Function func, LogicalOrExpr target_45) {
	target_45.getLeftOperand().(NotExpr).getOperand().(VariableAccess).getTarget().getType().hasName("const iphdr *")
	and target_45.getRightOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="ihl"
	and target_45.getRightOperand().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("const iphdr *")
	and target_45.getRightOperand().(RelationalOperation).getGreaterOperand().(Literal).getValue()="5"
	and target_45.getEnclosingFunction() = func
}

predicate func_46(Function func, NotExpr target_46) {
	target_46.getOperand().(VariableAccess).getTarget().getType().hasName("const ipv6hdr *")
	and target_46.getEnclosingFunction() = func
}

predicate func_47(Function func, NotExpr target_47) {
	target_47.getOperand().(VariableAccess).getTarget().getType().hasName("const vlan_hdr *")
	and target_47.getEnclosingFunction() = func
}

predicate func_48(ReturnStmt target_27, Function func, NotExpr target_48) {
	target_48.getOperand().(VariableAccess).getTarget().getType().hasName("struct <unnamed> *")
	and target_48.getParent().(IfStmt).getThen()=target_27
	and target_48.getEnclosingFunction() = func
}

predicate func_49(Parameter vproto_124, VariableAccess target_49) {
	target_49.getTarget()=vproto_124
}

predicate func_50(ReturnStmt target_29, Function func, NotExpr target_50) {
	target_50.getOperand().(VariableAccess).getTarget().getType().hasName("struct <unnamed> *")
	and target_50.getParent().(IfStmt).getThen()=target_29
	and target_50.getEnclosingFunction() = func
}

predicate func_51(Function func, NotExpr target_51) {
	target_51.getOperand().(VariableAccess).getTarget().getType().hasName("mpls_label *")
	and target_51.getEnclosingFunction() = func
}

predicate func_52(Function func, EqualityOperation target_52) {
	target_52.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("__builtin_constant_p")
	and target_52.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="entry"
	and target_52.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ConditionalExpr).getThen().(BitwiseOrExpr).getRightOperand().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="24"
	and target_52.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("__fswab32")
	and target_52.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getLeftOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="entry"
	and target_52.getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="4294963200"
	and target_52.getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="12"
	and target_52.getRightOperand().(Literal).getValue()="7"
	and target_52.getEnclosingFunction() = func
}

predicate func_53(Parameter vproto_124, VariableAccess target_53) {
	target_53.getTarget()=vproto_124
}

predicate func_54(Function func, NotExpr target_54) {
	target_54.getOperand().(VariableAccess).getTarget().getType().hasName("gre_hdr *")
	and target_54.getEnclosingFunction() = func
}

predicate func_55(Function func, NotExpr target_55) {
	target_55.getOperand().(VariableAccess).getTarget().getType().hasName("const __be32 *")
	and target_55.getEnclosingFunction() = func
}

predicate func_56(Function func, NotExpr target_56) {
	target_56.getOperand().(VariableAccess).getTarget().getType().hasName("const ethhdr *")
	and target_56.getEnclosingFunction() = func
}

predicate func_57(Function func, NotExpr target_57) {
	target_57.getOperand().(VariableAccess).getTarget().getType().hasName("u8 *")
	and target_57.getEnclosingFunction() = func
}

predicate func_58(Parameter vproto_124, SwitchStmt target_58) {
	target_58.getExpr().(VariableAccess).getTarget()=vproto_124
	and target_58.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr().(ConditionalExpr).getValue()="8448"
	and target_58.getStmt().(BlockStmt).getStmt(1).(GotoStmt).getName() ="ip"
	and target_58.getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr().(ConditionalExpr).getValue()="22272"
	and target_58.getStmt().(BlockStmt).getStmt(3).(GotoStmt).getName() ="ipv6"
	and target_58.getStmt().(BlockStmt).getStmt(4).(SwitchCase).toString() = "default: "
}

predicate func_59(Parameter vnhoff_124, ExprStmt target_59) {
	target_59.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("struct <unnamed> *")
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("__skb_header_pointer")
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("const sk_buff *")
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnhoff_124
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="16"
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget().getType().hasName("void *")
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(VariableAccess).getTarget().getType().hasName("int")
	and target_59.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("struct <unnamed>")
}

predicate func_60(Parameter vnhoff_124, ExprStmt target_60) {
	target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget().getType().hasName("mpls_label *")
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("__skb_header_pointer")
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("const sk_buff *")
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnhoff_124
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="8"
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget().getType().hasName("void *")
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(VariableAccess).getTarget().getType().hasName("int")
	and target_60.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("mpls_label[2]")
}

predicate func_61(Variable vkey_control_126, ExprStmt target_61) {
	target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="addr_type"
	and target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_control_126
}

predicate func_62(Parameter vnhoff_124, ExprStmt target_62) {
	target_62.getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vnhoff_124
	and target_62.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getLeftOperand().(ArrayExpr).getArrayBase().(VariableAccess).getTarget().getType().hasName("u8 *")
	and target_62.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getLeftOperand().(ArrayExpr).getArrayOffset().(Literal).getValue()="1"
	and target_62.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(AddExpr).getRightOperand().(Literal).getValue()="1"
	and target_62.getExpr().(AssignAddExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="3"
}

predicate func_63(Parameter vnhoff_124, Variable vip_proto_132, ExprStmt target_63) {
	target_63.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="ports"
	and target_63.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_63.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("flow_dissector_key_ports *")
	and target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("__skb_flow_get_ports")
	and target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget().getType().hasName("const sk_buff *")
	and target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vnhoff_124
	and target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vip_proto_132
	and target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget().getType().hasName("void *")
	and target_63.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(VariableAccess).getTarget().getType().hasName("int")
}

predicate func_64(Parameter vnhoff_124, Variable vkey_control_126, ExprStmt target_64) {
	target_64.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="thoff"
	and target_64.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_control_126
	and target_64.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vnhoff_124
	and target_64.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(Literal).getValue()="38"
}

from Function func, Parameter vproto_124, Parameter vnhoff_124, Variable vkey_control_126, Variable vkey_basic_127, Variable vip_proto_132, PointerFieldAccess target_17, PointerFieldAccess target_18, ExprStmt target_19, ExprStmt target_20, ExprStmt target_21, ReturnStmt target_24, ReturnStmt target_25, ReturnStmt target_26, ReturnStmt target_27, ReturnStmt target_28, ReturnStmt target_29, AssignExpr target_30, ExprStmt target_31, ReturnStmt target_32, ReturnStmt target_33, ReturnStmt target_36, ReturnStmt target_37, ReturnStmt target_38, ReturnStmt target_39, ReturnStmt target_40, ExprStmt target_41, ExprStmt target_42, ExprStmt target_43, ReturnStmt target_44, LogicalOrExpr target_45, NotExpr target_46, NotExpr target_47, NotExpr target_48, VariableAccess target_49, NotExpr target_50, NotExpr target_51, EqualityOperation target_52, VariableAccess target_53, NotExpr target_54, NotExpr target_55, NotExpr target_56, NotExpr target_57, SwitchStmt target_58, ExprStmt target_59, ExprStmt target_60, ExprStmt target_61, ExprStmt target_62, ExprStmt target_63, ExprStmt target_64
where
not func_0(target_45, func)
and not func_1(target_46, func)
and not func_2(target_47, func)
and not func_3(target_48, func)
and not func_4(target_49, func)
and not func_5(target_50, func)
and not func_6(target_31, func)
and not func_7(target_51, func)
and not func_8(target_52, func)
and not func_10(target_53, func)
and not func_11(target_54, func)
and not func_12(target_55, func)
and not func_13(target_56, func)
and not func_14(target_57, func)
and not func_15(func)
and func_17(vproto_124, vkey_basic_127, target_17)
and func_18(vnhoff_124, vkey_control_126, target_18)
and func_19(vproto_124, vkey_basic_127, target_52, target_19)
and func_20(vkey_basic_127, vip_proto_132, target_52, target_20)
and func_21(vnhoff_124, vkey_control_126, target_52, target_21)
and func_24(target_45, func, target_24)
and func_25(target_46, func, target_25)
and func_26(target_47, func, target_26)
and func_27(target_48, func, target_27)
and func_28(target_49, func, target_28)
and func_29(target_50, func, target_29)
and func_30(vproto_124, vkey_basic_127, target_58, target_19, target_30)
and func_31(vnhoff_124, vkey_control_126, target_59, target_60, target_61, target_31)
and func_32(func, target_32)
and func_33(target_51, func, target_33)
and func_36(target_53, func, target_36)
and func_37(target_54, func, target_37)
and func_38(target_55, func, target_38)
and func_39(target_56, func, target_39)
and func_40(target_57, func, target_40)
and func_41(vproto_124, vkey_basic_127, func, target_41)
and func_42(vkey_basic_127, vip_proto_132, func, target_42)
and func_43(vnhoff_124, vkey_control_126, target_62, target_63, target_64, func, target_43)
and func_44(func, target_44)
and func_45(func, target_45)
and func_46(func, target_46)
and func_47(func, target_47)
and func_48(target_27, func, target_48)
and func_49(vproto_124, target_49)
and func_50(target_29, func, target_50)
and func_51(func, target_51)
and func_52(func, target_52)
and func_53(vproto_124, target_53)
and func_54(func, target_54)
and func_55(func, target_55)
and func_56(func, target_56)
and func_57(func, target_57)
and func_58(vproto_124, target_58)
and func_59(vnhoff_124, target_59)
and func_60(vnhoff_124, target_60)
and func_61(vkey_control_126, target_61)
and func_62(vnhoff_124, target_62)
and func_63(vnhoff_124, vip_proto_132, target_63)
and func_64(vnhoff_124, vkey_control_126, target_64)
and vproto_124.getType().hasName("__be16")
and vnhoff_124.getType().hasName("int")
and vkey_control_126.getType().hasName("flow_dissector_key_control *")
and vkey_basic_127.getType().hasName("flow_dissector_key_basic *")
and vip_proto_132.getType().hasName("u8")
and vproto_124.getFunction() = func
and vnhoff_124.getFunction() = func
and vkey_control_126.(LocalVariable).getFunction() = func
and vkey_basic_127.(LocalVariable).getFunction() = func
and vip_proto_132.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
