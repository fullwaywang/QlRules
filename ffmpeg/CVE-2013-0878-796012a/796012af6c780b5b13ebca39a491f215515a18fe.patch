commit 796012af6c780b5b13ebca39a491f215515a18fe	796012af6c780b5b13ebca39a491f215515a18fe
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Feb 9 20:49:32 2013 +0100

    targa: Fix y check in advance_line
    
    Fixes out of array accesses
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/targa.c b/libavcodec/targa.c
index 11a8f213fd..2d1d3dfb13 100644
--- a/libavcodec/targa.c
+++ b/libavcodec/targa.c
@@ -40,7 +40,7 @@ static uint8_t *advance_line(uint8_t *start, uint8_t *line,
         return line + interleave * stride;
     } else {
         *y = (*y + 1) & (interleave - 1);
-        if (*y) {
+        if (*y && *y < h) {
             return start + *y * stride;
         } else {
             return NULL;
