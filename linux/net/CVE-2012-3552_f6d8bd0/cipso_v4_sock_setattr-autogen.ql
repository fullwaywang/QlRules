/**
 * @name linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-cipso_v4_sock_setattr
 * @id cpp/linux/f6d8bd051c391c1c0458a30b2a7abcd939329259/cipso-v4-sock-setattr
 * @description linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-net/ipv4/cipso_ipv4.c-cipso_v4_sock_setattr CVE-2012-3552
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(Function func, SizeofExprOperator target_1) {
		target_1.getValue()="12"
		and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, Literal target_2) {
		target_2.getValue()="1"
		and not target_2.getValue()="0"
		and target_2.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(0) instanceof SwitchCase
		and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
		target_3.getValue()="2"
		and not target_3.getValue()="1931"
		and target_3.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(2) instanceof SwitchCase
		and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, Literal target_4) {
		target_4.getValue()="4"
		and not target_4.getValue()="0"
		and target_4.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(4) instanceof SwitchCase
		and target_4.getEnclosingFunction() = func
}

predicate func_5(Function func, FunctionCall target_5) {
		target_5.getTarget().hasName("__xchg_wrong_size")
		and not target_5.getTarget().hasName("lockdep_rcu_dereference")
		and target_5.getEnclosingFunction() = func
}

predicate func_6(Variable vopt_1882, FunctionCall target_6) {
		target_6.getTarget().hasName("kfree")
		and not target_6.getTarget().hasName("call_rcu_sched")
		and target_6.getArgument(0).(VariableAccess).getTarget()=vopt_1882
}

predicate func_8(Variable vopt_len_1881, Variable vopt_1882, ExprStmt target_60, ExprStmt target_61) {
	exists(AssignExpr target_8 |
		target_8.getLValue().(VariableAccess).getTarget()=vopt_1882
		and target_8.getRValue().(FunctionCall).getTarget().hasName("kzalloc")
		and target_8.getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(SizeofExprOperator).getValue()="32"
		and target_8.getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(VariableAccess).getTarget()=vopt_len_1881
		and target_8.getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="32"
		and target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_8.getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(VariableAccess).getLocation())
		and target_8.getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(VariableAccess).getLocation().isBefore(target_61.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation()))
}

predicate func_9(Variable vopt_1882, EqualityOperation target_63, ExprStmt target_64) {
	exists(ValueFieldAccess target_9 |
		target_9.getTarget().getName()="__data"
		and target_9.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_9.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_63.getAnOperand().(VariableAccess).getLocation().isBefore(target_9.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_9.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_64.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_10(Variable vopt_1882, ExprStmt target_64, ExprStmt target_61) {
	exists(ValueFieldAccess target_10 |
		target_10.getTarget().getName()="optlen"
		and target_10.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_10.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_64.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_10.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_10.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_11(Variable vopt_1882, ExprStmt target_61, ExprStmt target_65) {
	exists(ValueFieldAccess target_11 |
		target_11.getTarget().getName()="cipso"
		and target_11.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_11.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_11.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_11.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_65.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_12(Variable vsk_inet_1883, IfStmt target_66, ExprStmt target_67) {
	exists(AssignExpr target_12 |
		target_12.getLValue().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
		and target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_12.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_67.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_13(Function func) {
	exists(DoStmt target_13 |
		target_13.getCondition() instanceof Literal
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="owned"
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_lock"
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("bool")
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_dereference")
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_13.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_13.getEnclosingFunction() = func)
}

*/
/*predicate func_15(Parameter vsk_1874, ExprStmt target_67, ExprStmt target_68, ExprStmt target_69) {
	exists(LogicalAndExpr target_15 |
		target_15.getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_15.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
		and target_15.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="owned"
		and target_15.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_lock"
		and target_15.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_1874
		and target_15.getParent().(IfStmt).getThen()=target_67
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_15.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_15.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_69.getExpr().(VariableCall).getArgument(0).(VariableAccess).getLocation()))
}

*/
/*predicate func_16(Function func) {
	exists(AssignExpr target_16 |
		target_16.getLValue().(VariableAccess).getType().hasName("bool")
		and target_16.getEnclosingFunction() = func)
}

*/
/*predicate func_18(Variable vsk_inet_1883, IfStmt target_66, ExprStmt target_67) {
	exists(PointerFieldAccess target_18 |
		target_18.getTarget().getName()="inet_opt"
		and target_18.getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_18.getQualifier().(VariableAccess).getLocation())
		and target_18.getQualifier().(VariableAccess).getLocation().isBefore(target_67.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_19(Variable vsk_conn_1884, PointerFieldAccess target_70, ExprStmt target_68, ExprStmt target_71) {
	exists(IfStmt target_19 |
		target_19.getCondition().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
		and target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(ValueFieldAccess).getTarget().getName()="optlen"
		and target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_19.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_19
		and target_19.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_70
		and target_68.getExpr().(AssignExpr).getLValue().(VariableAccess).getLocation().isBefore(target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_19.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_71.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_20(Function func) {
	exists(ValueFieldAccess target_20 |
		target_20.getTarget().getName()="optlen"
		and target_20.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_20.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_20.getEnclosingFunction() = func)
}

*/
predicate func_21(Variable vopt_1882, ExprStmt target_65, ExprStmt target_71) {
	exists(ValueFieldAccess target_21 |
		target_21.getTarget().getName()="optlen"
		and target_21.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_21.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_65.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_21.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_21.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_71.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_22(Variable vopt_1882, Variable vsk_inet_1883, ExprStmt target_72, IfStmt target_73, Function func) {
	exists(ExprStmt target_22 |
		target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("__builtin_constant_p")
		and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vopt_1882
		and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_1882
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_22
		and target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getLocation().isBefore(target_72.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
		and target_73.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_22.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_23(Variable vopt_1882) {
	exists(IfStmt target_23 |
		target_23.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("__builtin_constant_p")
		and target_23.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vopt_1882
		and target_23.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vopt_1882
		and target_23.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0")
}

*/
/*predicate func_24(Variable vopt_1882, Variable vsk_inet_1883, ExprStmt target_72, IfStmt target_73) {
	exists(ExprStmt target_24 |
		target_24.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_24.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_24.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_1882
		and target_24.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation().isBefore(target_72.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
		and target_73.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_24.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_25(Function func) {
	exists(IfStmt target_25 |
		target_25.getCondition().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_25.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("call_rcu_sched")
		and target_25.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
		and target_25.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_25)
}

/*predicate func_26(Function func) {
	exists(AddressOfExpr target_26 |
		target_26.getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
		and target_26.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_26.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
		and target_26.getEnclosingFunction() = func)
}

*/
predicate func_28(Variable vsk_inet_1883, ExprStmt target_67, VariableAccess target_28) {
		target_28.getTarget()=vsk_inet_1883
		and target_28.getParent().(PointerFieldAccess).getParent().(IfStmt).getThen()=target_67
}

predicate func_29(Variable vsk_inet_1883, VariableAccess target_29) {
		target_29.getTarget()=vsk_inet_1883
}

predicate func_30(Variable vopt_len_1881, Variable vopt_1882, AssignExpr target_30) {
		target_30.getLValue().(VariableAccess).getTarget()=vopt_1882
		and target_30.getRValue().(FunctionCall).getTarget().hasName("kzalloc")
		and target_30.getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand() instanceof SizeofExprOperator
		and target_30.getRValue().(FunctionCall).getArgument(0).(AddExpr).getAnOperand().(VariableAccess).getTarget()=vopt_len_1881
		and target_30.getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="32"
}

predicate func_31(Variable vopt_1882, PointerFieldAccess target_31) {
		target_31.getTarget().getName()="__data"
		and target_31.getQualifier().(VariableAccess).getTarget()=vopt_1882
}

predicate func_32(Variable vopt_1882, PointerFieldAccess target_32) {
		target_32.getTarget().getName()="optlen"
		and target_32.getQualifier().(VariableAccess).getTarget()=vopt_1882
}

predicate func_33(Variable vopt_1882, PointerFieldAccess target_33) {
		target_33.getTarget().getName()="cipso"
		and target_33.getQualifier().(VariableAccess).getTarget()=vopt_1882
}

predicate func_34(Variable vsk_inet_1883, IfStmt target_66, ExprStmt target_67, PointerFieldAccess target_34) {
		target_34.getTarget().getName()="opt"
		and target_34.getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_34.getQualifier().(VariableAccess).getLocation())
		and target_34.getQualifier().(VariableAccess).getLocation().isBefore(target_67.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_35(Variable vsk_inet_1883, PointerFieldAccess target_35) {
		target_35.getTarget().getName()="optlen"
		and target_35.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_35.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
}

predicate func_36(Variable vopt_1882, PointerFieldAccess target_36) {
		target_36.getTarget().getName()="optlen"
		and target_36.getQualifier().(VariableAccess).getTarget()=vopt_1882
}

predicate func_37(Variable vopt_1882, Variable v__x_1932, AssignExpr target_37) {
		target_37.getLValue().(VariableAccess).getTarget()=vopt_1882
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getExpr().(SizeofExprOperator).getValue()="8"
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr() instanceof Literal
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof Literal
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="8"
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(8).(SwitchCase).toString() = "default: "
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr() instanceof FunctionCall
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2) instanceof LabelStmt
		and target_37.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__x_1932
}

/*predicate func_39(Variable v__ptr_1_1932, Variable v__x_1932, Variable v__ptr_1932, Variable v__ptr_2_1932, Variable v__ptr_3_1932, SwitchStmt target_39) {
		target_39.getExpr().(SizeofExprOperator).getValue()="8"
		and target_39.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
		and target_39.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1932
		and target_39.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr() instanceof Literal
		and target_39.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1_1932
		and target_39.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof Literal
		and target_39.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_2_1932
		and target_39.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="8"
		and target_39.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_3_1932
		and target_39.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_1932
		and target_39.getStmt().(BlockStmt).getStmt(8).(SwitchCase).toString() = "default: "
		and target_39.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr() instanceof FunctionCall
}

*/
/*predicate func_40(Function func, SwitchCase target_40) {
		target_40.getExpr() instanceof Literal
		and target_40.getEnclosingFunction() = func
}

*/
/*predicate func_42(Variable v__x_1932, VariableAccess target_42) {
		target_42.getTarget()=v__x_1932
}

*/
/*predicate func_43(Variable v__ptr_1932, PointerDereferenceExpr target_43) {
		target_43.getOperand().(VariableAccess).getTarget()=v__ptr_1932
}

*/
/*predicate func_44(Variable v__x_1932, VariableAccess target_44) {
		target_44.getTarget()=v__x_1932
}

*/
/*predicate func_46(Function func, SwitchCase target_46) {
		target_46.getExpr() instanceof Literal
		and target_46.getEnclosingFunction() = func
}

*/
/*predicate func_48(Variable v__ptr_1_1932, Variable v__x_1932, AsmStmt target_48) {
		target_48.getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_48.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1_1932
		and target_48.getChild(2).(VariableAccess).getTarget()=v__x_1932
}

*/
/*predicate func_50(Function func, SwitchCase target_50) {
		target_50.getExpr() instanceof Literal
		and target_50.getEnclosingFunction() = func
}

*/
/*predicate func_52(Variable v__x_1932, Variable v__ptr_2_1932, AsmStmt target_52) {
		target_52.getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_52.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_2_1932
		and target_52.getChild(2).(VariableAccess).getTarget()=v__x_1932
}

*/
/*predicate func_54(Function func, SwitchCase target_54) {
		target_54.getExpr().(Literal).getValue()="8"
		and target_54.getEnclosingFunction() = func
}

*/
/*predicate func_56(Variable v__x_1932, Variable v__ptr_3_1932, AsmStmt target_56) {
		target_56.getChild(0).(VariableAccess).getTarget()=v__x_1932
		and target_56.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_3_1932
		and target_56.getChild(2).(VariableAccess).getTarget()=v__x_1932
}

*/
/*predicate func_58(Function func, SwitchCase target_58) {
		target_58.toString() = "default: "
		and target_58.getEnclosingFunction() = func
}

*/
/*predicate func_59(Variable v__x_1932, VariableAccess target_59) {
		target_59.getTarget()=v__x_1932
}

*/
predicate func_60(Variable vopt_len_1881, ExprStmt target_60) {
		target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vopt_len_1881
		and target_60.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(VariableAccess).getTarget().getType().hasName("u32")
		and target_60.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getAnOperand().(Literal).getValue()="3"
		and target_60.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294967292"
}

predicate func_61(Variable vopt_len_1881, Variable vopt_1882, ExprStmt target_61) {
		target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_61.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_61.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_len_1881
}

predicate func_63(Variable vopt_1882, EqualityOperation target_63) {
		target_63.getAnOperand().(VariableAccess).getTarget()=vopt_1882
		and target_63.getAnOperand().(Literal).getValue()="0"
}

predicate func_64(Variable vopt_1882, ExprStmt target_64) {
		target_64.getExpr().(FunctionCall).getTarget().hasName("memcpy")
		and target_64.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="__data"
		and target_64.getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_64.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget().getType().hasName("unsigned char *")
		and target_64.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget().getType().hasName("u32")
}

predicate func_65(Variable vopt_1882, ExprStmt target_65) {
		target_65.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="cipso"
		and target_65.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
		and target_65.getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getType() instanceof LongType
		and target_65.getExpr().(AssignExpr).getRValue().(SizeofTypeOperator).getValue()="20"
}

predicate func_66(Parameter vsk_1874, Variable vsk_inet_1883, Variable vsk_conn_1884, IfStmt target_66) {
		target_66.getCondition().(PointerFieldAccess).getTarget().getName()="is_icsk"
		and target_66.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_66.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsk_conn_1884
		and target_66.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("inet_csk")
		and target_66.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_1874
		and target_66.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="opt"
		and target_66.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_66.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_66.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
		and target_66.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_66.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
}

predicate func_67(Variable vsk_inet_1883, Variable vsk_conn_1884, ExprStmt target_67) {
		target_67.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_67.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
		and target_67.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_67.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_67.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
}

predicate func_68(Parameter vsk_1874, Variable vsk_conn_1884, ExprStmt target_68) {
		target_68.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsk_conn_1884
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("inet_csk")
		and target_68.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_1874
}

predicate func_69(Parameter vsk_1874, Variable vsk_conn_1884, ExprStmt target_69) {
		target_69.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="icsk_sync_mss"
		and target_69.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
		and target_69.getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vsk_1874
		and target_69.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="icsk_pmtu_cookie"
		and target_69.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
}

predicate func_70(Variable vsk_inet_1883, PointerFieldAccess target_70) {
		target_70.getTarget().getName()="is_icsk"
		and target_70.getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
}

predicate func_71(Variable vopt_1882, Variable vsk_conn_1884, ExprStmt target_71) {
		target_71.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_71.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
		and target_71.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_71.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_1882
}

predicate func_72(Variable vopt_1882, ExprStmt target_72) {
		target_72.getExpr().(FunctionCall).getTarget().hasName("kfree")
		and target_72.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vopt_1882
}

predicate func_73(Variable vsk_inet_1883, Variable vsk_conn_1884, IfStmt target_73) {
		target_73.getCondition().(PointerFieldAccess).getTarget().getName()="opt"
		and target_73.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
		and target_73.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_73.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_conn_1884
		and target_73.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_73.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_73.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_inet_1883
}

from Function func, Parameter vsk_1874, Variable vopt_len_1881, Variable vopt_1882, Variable vsk_inet_1883, Variable vsk_conn_1884, Variable v__ptr_1_1932, Variable v__x_1932, Variable v__ptr_1932, Variable v__ptr_2_1932, Variable v__ptr_3_1932, SizeofExprOperator target_1, Literal target_2, Literal target_3, Literal target_4, FunctionCall target_5, FunctionCall target_6, VariableAccess target_28, VariableAccess target_29, AssignExpr target_30, PointerFieldAccess target_31, PointerFieldAccess target_32, PointerFieldAccess target_33, PointerFieldAccess target_34, PointerFieldAccess target_35, PointerFieldAccess target_36, AssignExpr target_37, ExprStmt target_60, ExprStmt target_61, EqualityOperation target_63, ExprStmt target_64, ExprStmt target_65, IfStmt target_66, ExprStmt target_67, ExprStmt target_68, ExprStmt target_69, PointerFieldAccess target_70, ExprStmt target_71, ExprStmt target_72, IfStmt target_73
where
func_1(func, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(vopt_1882, target_6)
and not func_8(vopt_len_1881, vopt_1882, target_60, target_61)
and not func_9(vopt_1882, target_63, target_64)
and not func_10(vopt_1882, target_64, target_61)
and not func_11(vopt_1882, target_61, target_65)
and not func_12(vsk_inet_1883, target_66, target_67)
and not func_19(vsk_conn_1884, target_70, target_68, target_71)
and not func_21(vopt_1882, target_65, target_71)
and not func_22(vopt_1882, vsk_inet_1883, target_72, target_73, func)
and not func_25(func)
and func_28(vsk_inet_1883, target_67, target_28)
and func_29(vsk_inet_1883, target_29)
and func_30(vopt_len_1881, vopt_1882, target_30)
and func_31(vopt_1882, target_31)
and func_32(vopt_1882, target_32)
and func_33(vopt_1882, target_33)
and func_34(vsk_inet_1883, target_66, target_67, target_34)
and func_35(vsk_inet_1883, target_35)
and func_36(vopt_1882, target_36)
and func_37(vopt_1882, v__x_1932, target_37)
and func_60(vopt_len_1881, target_60)
and func_61(vopt_len_1881, vopt_1882, target_61)
and func_63(vopt_1882, target_63)
and func_64(vopt_1882, target_64)
and func_65(vopt_1882, target_65)
and func_66(vsk_1874, vsk_inet_1883, vsk_conn_1884, target_66)
and func_67(vsk_inet_1883, vsk_conn_1884, target_67)
and func_68(vsk_1874, vsk_conn_1884, target_68)
and func_69(vsk_1874, vsk_conn_1884, target_69)
and func_70(vsk_inet_1883, target_70)
and func_71(vopt_1882, vsk_conn_1884, target_71)
and func_72(vopt_1882, target_72)
and func_73(vsk_inet_1883, vsk_conn_1884, target_73)
and vsk_1874.getType().hasName("sock *")
and vopt_len_1881.getType().hasName("u32")
and vopt_1882.getType().hasName("ip_options *")
and vsk_inet_1883.getType().hasName("inet_sock *")
and vsk_conn_1884.getType().hasName("inet_connection_sock *")
and v__ptr_1_1932.getType().hasName("volatile u16 *")
and v__x_1932.getType().hasName("ip_options *")
and v__ptr_1932.getType().hasName("volatile u8 *")
and v__ptr_2_1932.getType().hasName("volatile u32 *")
and v__ptr_3_1932.getType().hasName("volatile u64 *")
and vsk_1874.getFunction() = func
and vopt_len_1881.(LocalVariable).getFunction() = func
and vopt_1882.(LocalVariable).getFunction() = func
and vsk_inet_1883.(LocalVariable).getFunction() = func
and vsk_conn_1884.(LocalVariable).getFunction() = func
and v__ptr_1_1932.(LocalVariable).getFunction() = func
and v__x_1932.(LocalVariable).getFunction() = func
and v__ptr_1932.(LocalVariable).getFunction() = func
and v__ptr_2_1932.(LocalVariable).getFunction() = func
and v__ptr_3_1932.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
