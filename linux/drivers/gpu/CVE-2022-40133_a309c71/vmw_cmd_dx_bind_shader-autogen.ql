/**
 * @name linux-a309c7194e8a2f8bd4539b9449917913f6c2cd50-vmw_cmd_dx_bind_shader
 * @id cpp/linux/a309c7194e8a2f8bd4539b9449917913f6c2cd50/vmw-cmd-dx-bind-shader
 * @description linux-a309c7194e8a2f8bd4539b9449917913f6c2cd50-drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c-vmw_cmd_dx_bind_shader CVE-2022-40133
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(BlockStmt target_55, Function func) {
exists(EqualityOperation target_1 |
	target_1.getLeftOperand().(ValueFieldAccess).getTarget().getName()="bo"
	and target_1.getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="map"
	and target_1.getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmw_buffer_object *")
	and target_1.getRightOperand() instanceof Literal
	and target_1.getParent().(IfStmt).getThen()=target_55
	and target_1.getEnclosingFunction() = func)
}

predicate func_2(Function func) {
exists(AddressOfExpr target_2 |
	target_2.getOperand().(PointerFieldAccess).getTarget().getName()="map"
	and target_2.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmw_buffer_object *")
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_2.getEnclosingFunction() = func)
}

predicate func_4(Function func, DeclStmt target_4) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_4
}

predicate func_5(Function func, DeclStmt target_5) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_5
}

predicate func_6(Function func, DeclStmt target_6) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_6
}

predicate func_9(Variable v__mptr_2754, ExprStmt target_9) {
	target_9.getExpr().(PointerArithmeticOperation).getLeftOperand().(VariableAccess).getTarget()=v__mptr_2754
	and target_9.getExpr().(PointerArithmeticOperation).getRightOperand().(BuiltInOperationBuiltInOffsetOf).getValue()="0"
}

predicate func_10(Function func, DeclStmt target_10) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_10
}

predicate func_11(Variable vcmd_2753, BlockStmt target_55, EqualityOperation target_11) {
	target_11.getLeftOperand().(ValueFieldAccess).getTarget().getName()="cid"
	and target_11.getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="body"
	and target_11.getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcmd_2753
	and target_11.getRightOperand().(UnaryMinusExpr).getValue()="4294967295"
	and target_11.getParent().(IfStmt).getThen()=target_55
}

predicate func_12(Variable vctx_2751, Variable vcmd_2753, Variable vret_2755, Variable vuser_context_converter, Parameter vdev_priv_2747, Parameter vsw_context_2748, EqualityOperation target_11, ExprStmt target_12) {
	target_12.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_2755
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_cmd_res_check")
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdev_priv_2747
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsw_context_2748
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(BinaryBitwiseOperation).getValue()="1"
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(4).(VariableAccess).getTarget()=vuser_context_converter
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="cid"
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="body"
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcmd_2753
	and target_12.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(6).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vctx_2751
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
}

predicate func_13(Variable vret_2755, EqualityOperation target_11, IfStmt target_13) {
	target_13.getCondition().(VariableAccess).getTarget()=vret_2755
	and target_13.getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_2755
	and target_13.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
}

/*predicate func_14(Variable vret_2755, IfStmt target_13, VariableAccess target_14) {
	target_14.getTarget()=vret_2755
	and target_13.getCondition().(VariableAccess).getLocation().isBefore(target_14.getLocation())
}

*/
predicate func_15(EqualityOperation target_11, Function func, DeclStmt target_15) {
	target_15.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
	and target_15.getEnclosingFunction() = func
}

predicate func_16(Parameter vsw_context_2748, ExprStmt target_16) {
	target_16.getExpr().(ConditionalExpr).getCondition().(PointerFieldAccess).getTarget().getName()="dx_ctx_node"
	and target_16.getExpr().(ConditionalExpr).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_2748
	and target_16.getExpr().(ConditionalExpr).getThen().(PointerFieldAccess).getTarget().getName()="dx_ctx_node"
	and target_16.getExpr().(ConditionalExpr).getThen().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_2748
	and target_16.getExpr().(ConditionalExpr).getElse().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_16.getExpr().(ConditionalExpr).getElse().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(PointerFieldAccess).getTarget().getName()="dx_ctx_node"
	and target_16.getExpr().(ConditionalExpr).getElse().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_2748
}

/*predicate func_17(Variable v__UNIQUE_ID_ddebug1073_2766, Variable v__func__, DoStmt target_17) {
	target_17.getCondition() instanceof Literal
	and target_17.getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_17.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_17.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_17.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_17.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_17.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug1073_2766
	and target_17.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="SM context is not set at %s\n"
	and target_17.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=v__func__
}

*/
/*predicate func_19(Function func, DoStmt target_19) {
	target_19.getCondition() instanceof Literal
	and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_19.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_19.getEnclosingFunction() = func
}

*/
/*predicate func_21(Function func, IfStmt target_21) {
	target_21.getCondition().(NotExpr).getValue()="0"
	and target_21.getThen().(ExprStmt).getExpr() instanceof FunctionCall
	and target_21.getEnclosingFunction() = func
}

*/
/*predicate func_22(Variable v__UNIQUE_ID_ddebug1073_2766, Variable v__func__, Variable vbranch_2766, IfStmt target_22) {
	target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BuiltInOperation).getValue()="0"
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2766
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_22.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_22.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_22.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug1073_2766
	and target_22.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="SM context is not set at %s\n"
	and target_22.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=v__func__
}

*/
/*predicate func_24(Variable vbranch_2766, IfStmt target_24) {
	target_24.getCondition().(BuiltInOperation).getValue()="0"
	and target_24.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2766
	and target_24.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
	and target_24.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
	and target_24.getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
	and target_24.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2766
	and target_24.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
	and target_24.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
	and target_24.getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2766
	and target_24.getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
}

*/
/*predicate func_25(Variable vbranch_2766, ExprStmt target_25) {
	target_25.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_25.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vbranch_2766
	and target_25.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_26(Parameter vsw_context_2748, ExprStmt target_42, PointerFieldAccess target_26) {
	target_26.getTarget().getName()="dx_ctx_node"
	and target_26.getQualifier().(VariableAccess).getTarget()=vsw_context_2748
	and target_26.getQualifier().(VariableAccess).getLocation().isBefore(target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation())
}

*/
predicate func_27(Variable vctx_node_2765, EqualityOperation target_11, IfStmt target_27) {
	target_27.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vctx_node_2765
	and target_27.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22"
	and target_27.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
}

/*predicate func_28(Function func, UnaryMinusExpr target_28) {
	target_28.getValue()="-22"
	and target_28.getEnclosingFunction() = func
}

*/
predicate func_29(Variable vctx_2751, Variable vctx_node_2765, EqualityOperation target_11, ExprStmt target_29) {
	target_29.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vctx_2751
	and target_29.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="ctx"
	and target_29.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vctx_node_2765
	and target_29.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_11
}

predicate func_30(Variable vctx_2751, Variable vres_2752, Variable vcmd_2753, Function func, ExprStmt target_30) {
	target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vres_2752
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_shader_lookup")
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("vmw_context_res_man")
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vctx_2751
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(ValueFieldAccess).getTarget().getName()="shid"
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="body"
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcmd_2753
	and target_30.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

predicate func_31(Variable vres_2752, Function func, IfStmt target_31) {
	target_31.getCondition().(FunctionCall).getTarget().hasName("IS_ERR")
	and target_31.getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vres_2752
	and target_31.getThen().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_31.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_31.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_31.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(FunctionCall).getTarget().hasName("PTR_ERR")
	and target_31.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vres_2752
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_31
}

/*predicate func_32(Variable v__UNIQUE_ID_ddebug1075_2776, FunctionCall target_56, DoStmt target_32) {
	target_32.getCondition() instanceof Literal
	and target_32.getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_32.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_32.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_32.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_32.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug1075_2776
	and target_32.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="Could not find shader to bind.\n"
	and target_32.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

*/
/*predicate func_34(Function func, DoStmt target_34) {
	target_34.getCondition() instanceof Literal
	and target_34.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_34.getEnclosingFunction() = func
}

*/
/*predicate func_36(Function func, IfStmt target_36) {
	target_36.getCondition().(NotExpr).getValue()="0"
	and target_36.getEnclosingFunction() = func
}

*/
/*predicate func_37(Variable v__UNIQUE_ID_ddebug1075_2776, Variable vbranch_2776, IfStmt target_37) {
	target_37.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BuiltInOperation).getValue()="0"
	and target_37.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2776
	and target_37.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
	and target_37.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
	and target_37.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_37.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug1075_2776
	and target_37.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="Could not find shader to bind.\n"
}

*/
/*predicate func_39(Variable vbranch_2776, IfStmt target_39) {
	target_39.getCondition().(BuiltInOperation).getValue()="0"
	and target_39.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2776
	and target_39.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
	and target_39.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
	and target_39.getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
	and target_39.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2776
	and target_39.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
	and target_39.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
	and target_39.getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2776
	and target_39.getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
}

*/
/*predicate func_40(Variable vbranch_2776, ExprStmt target_40) {
	target_40.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_40.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vbranch_2776
	and target_40.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_41(Variable vres_2752, FunctionCall target_56, ReturnStmt target_41) {
	target_41.getExpr().(FunctionCall).getTarget().hasName("PTR_ERR")
	and target_41.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vres_2752
	and target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_56
}

*/
predicate func_42(Variable vres_2752, Variable vret_2755, Parameter vsw_context_2748, Function func, ExprStmt target_42) {
	target_42.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_2755
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_execbuf_res_noctx_val_add")
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsw_context_2748
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vres_2752
	and target_42.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_42
}

predicate func_43(Variable vret_2755, Function func, IfStmt target_43) {
	target_43.getCondition().(VariableAccess).getTarget()=vret_2755
	and target_43.getThen().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_43.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_43.getThen().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_43.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_2755
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_43
}

/*predicate func_44(Variable v__UNIQUE_ID_ddebug1077_2783, VariableAccess target_57, DoStmt target_44) {
	target_44.getCondition() instanceof Literal
	and target_44.getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
	and target_44.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_44.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_44.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_44.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug1077_2783
	and target_44.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="Error creating resource validation node.\n"
	and target_44.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_57
}

*/
/*predicate func_46(Function func, DoStmt target_46) {
	target_46.getCondition() instanceof Literal
	and target_46.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_46.getEnclosingFunction() = func
}

*/
/*predicate func_48(Function func, IfStmt target_48) {
	target_48.getCondition().(NotExpr).getValue()="0"
	and target_48.getEnclosingFunction() = func
}

*/
/*predicate func_49(Variable v__UNIQUE_ID_ddebug1077_2783, Variable vbranch_2783, IfStmt target_49) {
	target_49.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BuiltInOperation).getValue()="0"
	and target_49.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2783
	and target_49.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
	and target_49.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
	and target_49.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_49.getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("___drm_dbg")
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug1077_2783
	and target_49.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="Error creating resource validation node.\n"
}

*/
/*predicate func_51(Variable vbranch_2783, IfStmt target_51) {
	target_51.getCondition().(BuiltInOperation).getValue()="0"
	and target_51.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2783
	and target_51.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
	and target_51.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
	and target_51.getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
	and target_51.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2783
	and target_51.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
	and target_51.getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
	and target_51.getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_2783
	and target_51.getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
}

*/
/*predicate func_52(Variable vbranch_2783, ExprStmt target_52) {
	target_52.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
	and target_52.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vbranch_2783
	and target_52.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_53(Variable vret_2755, VariableAccess target_57, IfStmt target_43, ReturnStmt target_53) {
	target_53.getExpr().(VariableAccess).getTarget()=vret_2755
	and target_53.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_57
	and target_43.getCondition().(VariableAccess).getLocation().isBefore(target_53.getExpr().(VariableAccess).getLocation())
}

*/
predicate func_54(Variable vres_2752, Variable vcmd_2753, Parameter vdev_priv_2747, Parameter vsw_context_2748, Function func, ReturnStmt target_54) {
	target_54.getExpr().(FunctionCall).getTarget().hasName("vmw_cmd_res_switch_backup")
	and target_54.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vdev_priv_2747
	and target_54.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vsw_context_2748
	and target_54.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vres_2752
	and target_54.getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="mobid"
	and target_54.getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="body"
	and target_54.getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcmd_2753
	and target_54.getExpr().(FunctionCall).getArgument(4).(ValueFieldAccess).getTarget().getName()="offsetInBytes"
	and target_54.getExpr().(FunctionCall).getArgument(4).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="body"
	and target_54.getExpr().(FunctionCall).getArgument(4).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vcmd_2753
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_54
}

predicate func_55(Function func, BlockStmt target_55) {
	target_55.getStmt(0) instanceof ExprStmt
	and target_55.getStmt(1) instanceof IfStmt
	and target_55.getEnclosingFunction() = func
}

predicate func_56(Variable vres_2752, FunctionCall target_56) {
	target_56.getTarget().hasName("IS_ERR")
	and target_56.getArgument(0).(VariableAccess).getTarget()=vres_2752
}

predicate func_57(Variable vret_2755, BlockStmt target_58, VariableAccess target_57) {
	target_57.getTarget()=vret_2755
	and target_57.getParent().(IfStmt).getThen()=target_58
}

predicate func_58(Function func, BlockStmt target_58) {
	target_58.getStmt(0) instanceof DoStmt
	and target_58.getStmt(1) instanceof ReturnStmt
	and target_58.getEnclosingFunction() = func
}

from Function func, Variable vctx_2751, Variable vres_2752, Variable vcmd_2753, Variable v__mptr_2754, Variable vret_2755, Variable vuser_context_converter, Variable vctx_node_2765, Variable v__UNIQUE_ID_ddebug1073_2766, Variable v__func__, Variable vbranch_2766, Variable v__UNIQUE_ID_ddebug1075_2776, Variable vbranch_2776, Variable v__UNIQUE_ID_ddebug1077_2783, Variable vbranch_2783, Parameter vdev_priv_2747, Parameter vsw_context_2748, DeclStmt target_4, DeclStmt target_5, DeclStmt target_6, ExprStmt target_9, DeclStmt target_10, EqualityOperation target_11, ExprStmt target_12, IfStmt target_13, DeclStmt target_15, ExprStmt target_16, IfStmt target_27, ExprStmt target_29, ExprStmt target_30, IfStmt target_31, ExprStmt target_42, IfStmt target_43, ReturnStmt target_54, BlockStmt target_55, FunctionCall target_56, VariableAccess target_57, BlockStmt target_58
where
not func_1(target_55, func)
and not func_2(func)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(func, target_6)
and func_9(v__mptr_2754, target_9)
and func_10(func, target_10)
and func_11(vcmd_2753, target_55, target_11)
and func_12(vctx_2751, vcmd_2753, vret_2755, vuser_context_converter, vdev_priv_2747, vsw_context_2748, target_11, target_12)
and func_13(vret_2755, target_11, target_13)
and func_15(target_11, func, target_15)
and func_16(vsw_context_2748, target_16)
and func_27(vctx_node_2765, target_11, target_27)
and func_29(vctx_2751, vctx_node_2765, target_11, target_29)
and func_30(vctx_2751, vres_2752, vcmd_2753, func, target_30)
and func_31(vres_2752, func, target_31)
and func_42(vres_2752, vret_2755, vsw_context_2748, func, target_42)
and func_43(vret_2755, func, target_43)
and func_54(vres_2752, vcmd_2753, vdev_priv_2747, vsw_context_2748, func, target_54)
and func_55(func, target_55)
and func_56(vres_2752, target_56)
and func_57(vret_2755, target_58, target_57)
and func_58(func, target_58)
and vctx_2751.getType().hasName("vmw_resource *")
and vres_2752.getType().hasName("vmw_resource *")
and vcmd_2753.getType().hasName("struct <unnamed> *")
and v__mptr_2754.getType().hasName("void *")
and vret_2755.getType().hasName("int")
and vuser_context_converter.getType().hasName("const vmw_user_resource_conv *")
and vctx_node_2765.getType().hasName("vmw_ctx_validation_info *")
and v__UNIQUE_ID_ddebug1073_2766.getType().hasName("_ddebug")
and v__func__.getType() instanceof ArrayType
and vbranch_2766.getType().hasName("bool")
and v__UNIQUE_ID_ddebug1075_2776.getType().hasName("_ddebug")
and vbranch_2776.getType().hasName("bool")
and v__UNIQUE_ID_ddebug1077_2783.getType().hasName("_ddebug")
and vbranch_2783.getType().hasName("bool")
and vdev_priv_2747.getType().hasName("vmw_private *")
and vsw_context_2748.getType().hasName("vmw_sw_context *")
and vctx_2751.(LocalVariable).getFunction() = func
and vres_2752.(LocalVariable).getFunction() = func
and vcmd_2753.(LocalVariable).getFunction() = func
and v__mptr_2754.(LocalVariable).getFunction() = func
and vret_2755.(LocalVariable).getFunction() = func
and not vuser_context_converter.getParentScope+() = func
and vctx_node_2765.(LocalVariable).getFunction() = func
and v__UNIQUE_ID_ddebug1073_2766.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
and vbranch_2766.(LocalVariable).getFunction() = func
and v__UNIQUE_ID_ddebug1075_2776.(LocalVariable).getFunction() = func
and vbranch_2776.(LocalVariable).getFunction() = func
and v__UNIQUE_ID_ddebug1077_2783.(LocalVariable).getFunction() = func
and vbranch_2783.(LocalVariable).getFunction() = func
and vdev_priv_2747.getFunction() = func
and vsw_context_2748.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
