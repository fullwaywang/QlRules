/**
 * @name linux-cadfad870154e14f745ec845708bc17d166065f2-native_tss_update_io_bitmap
 * @id cpp/linux/cadfad870154e14f745ec845708bc17d166065f2/native-tss-update-io-bitmap
 * @description linux-cadfad870154e14f745ec845708bc17d166065f2-arch/x86/kernel/process.c-native_tss_update_io_bitmap CVE-2020-15852
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vtss_378, FunctionCall target_0) {
	target_0.getTarget().hasName("tss_invalidate_io_bitmap")
	and not target_0.getTarget().hasName("native_tss_invalidate_io_bitmap")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vtss_378
}

from Function func, Variable vtss_378, FunctionCall target_0
where
func_0(vtss_378, target_0)
and vtss_378.getType().hasName("tss_struct *")
and vtss_378.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
