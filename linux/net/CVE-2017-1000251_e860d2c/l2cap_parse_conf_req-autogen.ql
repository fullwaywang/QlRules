/**
 * @name linux-e860d2c904d1a9f38a24eb44c9f34b8f915a6ea3-l2cap_parse_conf_req
 * @id cpp/linux/e860d2c904d1a9f38a24eb44c9f34b8f915a6ea3/l2cap-parse-conf-req
 * @description linux-e860d2c904d1a9f38a24eb44c9f34b8f915a6ea3-net/bluetooth/l2cap_core.c-l2cap_parse_conf_req CVE-2017-1000251
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vptr_3318, Variable vrfc_3323, Variable vremote_efs_3325, Variable vmtu_3326, Variable vresult_3327, Variable vsize_3328, Parameter vchan_3315, ExprStmt target_9, IfStmt target_0) {
	target_0.getCondition() instanceof EqualityOperation
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vmtu_3326
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="48"
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_3327
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="omtu"
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vmtu_3326
	and target_0.getThen().(BlockStmt).getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_0.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_0.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_0.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="1"
	and target_0.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="2"
	and target_0.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getTarget().getName()="omtu"
	and target_0.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
	and target_0.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(VariableAccess).getTarget()=vremote_efs_3325
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getExpr().(ValueFieldAccess).getTarget().getName()="mode"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getExpr().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vrfc_3323
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr().(Literal).getValue()="0"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="fcs"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr().(Literal).getValue()="3"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="remote_max_tx"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="max_transmit"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_3328
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="max_pdu_size"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vsize_3328
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="remote_mps"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vsize_3328
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__l2cap_set_ertm_timeouts")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vchan_3315
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(13).(IfStmt).getCondition().(ConditionalExpr).getCondition().(Literal).getValue()="1"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(13).(IfStmt).getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("constant_test_bit")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(13).(IfStmt).getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("variable_test_bit")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(15).(SwitchCase).getExpr().(Literal).getValue()="4"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(16).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsize_3328
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(17).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="max_pdu_size"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(17).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vsize_3328
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(18).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="remote_mps"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(18).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vsize_3328
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(19).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(20).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(20).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(22).(SwitchCase).toString() = "default: "
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_3327
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(23).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__memset")
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(24).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="0"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="mode"
	and target_0.getThen().(BlockStmt).getStmt(3).(SwitchStmt).getStmt().(BlockStmt).getStmt(25).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="mode"
	and target_0.getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(EqualityOperation).getLeftOperand().(VariableAccess).getTarget()=vresult_3327
	and target_0.getThen().(BlockStmt).getStmt(5).(IfStmt).getCondition().(EqualityOperation).getRightOperand().(Literal).getValue()="0"
	and target_0.getThen().(BlockStmt).getStmt(5).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_0.getThen().(BlockStmt).getStmt(5).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="conf_state"
	and target_0.getLocation().isBefore(target_9.getLocation())
}

predicate func_1(Variable vptr_3318, Variable vrfc_3323, AddressOfExpr target_10, AddressOfExpr target_11) {
exists(PointerArithmeticOperation target_1 |
	target_1.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_1.getRightOperand().(VariableAccess).getTarget()=vptr_3318
	and target_1.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_1.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_1.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_1.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="9"
	and target_1.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vrfc_3323
	and target_10.getOperand().(VariableAccess).getLocation().isBefore(target_1.getRightOperand().(VariableAccess).getLocation())
	and target_1.getRightOperand().(VariableAccess).getLocation().isBefore(target_11.getOperand().(VariableAccess).getLocation()))
}

predicate func_2(Variable vptr_3318, Parameter vchan_3315, AddressOfExpr target_11, AddressOfExpr target_12) {
exists(PointerArithmeticOperation target_2 |
	target_2.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_2.getRightOperand().(VariableAccess).getTarget()=vptr_3318
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="1"
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="2"
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getTarget().getName()="omtu"
	and target_2.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
	and target_11.getOperand().(VariableAccess).getLocation().isBefore(target_2.getRightOperand().(VariableAccess).getLocation())
	and target_2.getRightOperand().(VariableAccess).getLocation().isBefore(target_12.getOperand().(VariableAccess).getLocation()))
}

predicate func_3(Variable vptr_3318, AddressOfExpr target_12, AddressOfExpr target_13) {
exists(PointerArithmeticOperation target_3 |
	target_3.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_3.getRightOperand().(VariableAccess).getTarget()=vptr_3318
	and target_3.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_3.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_3.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="6"
	and target_3.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="16"
	and target_3.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("l2cap_conf_efs")
	and target_12.getOperand().(VariableAccess).getLocation().isBefore(target_3.getRightOperand().(VariableAccess).getLocation())
	and target_3.getRightOperand().(VariableAccess).getLocation().isBefore(target_13.getOperand().(VariableAccess).getLocation()))
}

predicate func_4(Variable vptr_3318, Variable vrfc_3323, AddressOfExpr target_13, AddressOfExpr target_14) {
exists(PointerArithmeticOperation target_4 |
	target_4.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_4.getRightOperand().(VariableAccess).getTarget()=vptr_3318
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="9"
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vrfc_3323
	and target_13.getOperand().(VariableAccess).getLocation().isBefore(target_4.getRightOperand().(VariableAccess).getLocation())
	and target_4.getRightOperand().(VariableAccess).getLocation().isBefore(target_14.getOperand().(VariableAccess).getLocation()))
}

predicate func_5(Variable vptr_3318, AddressOfExpr target_14, AddressOfExpr target_15) {
exists(PointerArithmeticOperation target_5 |
	target_5.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_5.getRightOperand().(VariableAccess).getTarget()=vptr_3318
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="6"
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="16"
	and target_5.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("l2cap_conf_efs")
	and target_14.getOperand().(VariableAccess).getLocation().isBefore(target_5.getRightOperand().(VariableAccess).getLocation())
	and target_5.getRightOperand().(VariableAccess).getLocation().isBefore(target_15.getOperand().(VariableAccess).getLocation()))
}

predicate func_6(Variable vptr_3318, Variable vrfc_3323, AddressOfExpr target_15, PointerArithmeticOperation target_16) {
exists(PointerArithmeticOperation target_6 |
	target_6.getLeftOperand().(VariableAccess).getType().hasName("void *")
	and target_6.getRightOperand().(VariableAccess).getTarget()=vptr_3318
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="9"
	and target_6.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vrfc_3323
	and target_15.getOperand().(VariableAccess).getLocation().isBefore(target_6.getRightOperand().(VariableAccess).getLocation())
	and target_6.getRightOperand().(VariableAccess).getLocation().isBefore(target_16.getLeftOperand().(VariableAccess).getLocation()))
}

predicate func_7(Variable vresult_3327, BlockStmt target_17, EqualityOperation target_7) {
	target_7.getLeftOperand().(VariableAccess).getTarget()=vresult_3327
	and target_7.getRightOperand().(Literal).getValue()="0"
	and target_7.getParent().(IfStmt).getThen()=target_17
}

predicate func_8(Variable vrfc_3323, Parameter vchan_3315, BlockStmt target_18, EqualityOperation target_8) {
	target_8.getLeftOperand().(PointerFieldAccess).getTarget().getName()="mode"
	and target_8.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
	and target_8.getRightOperand().(ValueFieldAccess).getTarget().getName()="mode"
	and target_8.getRightOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vrfc_3323
	and target_8.getParent().(IfStmt).getThen()=target_18
}

predicate func_9(Parameter vchan_3315, ExprStmt target_9) {
	target_9.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="scid"
	and target_9.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("l2cap_conf_rsp *")
	and target_9.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="dcid"
	and target_9.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
}

predicate func_10(Variable vptr_3318, AddressOfExpr target_10) {
	target_10.getOperand().(VariableAccess).getTarget()=vptr_3318
}

predicate func_11(Variable vptr_3318, Parameter vchan_3315, AddressOfExpr target_11) {
	target_11.getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_11.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_11.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="1"
	and target_11.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(Literal).getValue()="2"
	and target_11.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getTarget().getName()="omtu"
	and target_11.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
}

predicate func_12(Variable vptr_3318, AddressOfExpr target_12) {
	target_12.getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_12.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_12.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="6"
	and target_12.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="16"
	and target_12.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("l2cap_conf_efs")
}

predicate func_13(Variable vptr_3318, Variable vrfc_3323, AddressOfExpr target_13) {
	target_13.getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_13.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_13.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_13.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="9"
	and target_13.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vrfc_3323
}

predicate func_14(Variable vptr_3318, AddressOfExpr target_14) {
	target_14.getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_14.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_14.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="6"
	and target_14.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="16"
	and target_14.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget().getType().hasName("l2cap_conf_efs")
}

predicate func_15(Variable vptr_3318, Variable vrfc_3323, AddressOfExpr target_15) {
	target_15.getOperand().(VariableAccess).getTarget()=vptr_3318
	and target_15.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("l2cap_add_conf_opt")
	and target_15.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="4"
	and target_15.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(SizeofExprOperator).getValue()="9"
	and target_15.getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vrfc_3323
}

predicate func_16(Variable vptr_3318, PointerArithmeticOperation target_16) {
	target_16.getLeftOperand().(VariableAccess).getTarget()=vptr_3318
	and target_16.getRightOperand().(VariableAccess).getTarget().getType().hasName("void *")
}

predicate func_17(Variable vmtu_3326, Variable vresult_3327, Parameter vchan_3315, BlockStmt target_17) {
	target_17.getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vmtu_3326
	and target_17.getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="48"
	and target_17.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_3327
	and target_17.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_17.getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="omtu"
	and target_17.getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
	and target_17.getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vmtu_3326
	and target_17.getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("set_bit")
	and target_17.getStmt(0).(IfStmt).getElse().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="conf_state"
}

predicate func_18(Variable vrfc_3323, Variable vresult_3327, Parameter vchan_3315, BlockStmt target_18) {
	target_18.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vresult_3327
	and target_18.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_18.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="mode"
	and target_18.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vrfc_3323
	and target_18.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="mode"
	and target_18.getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vchan_3315
}

from Function func, Variable vptr_3318, Variable vrfc_3323, Variable vremote_efs_3325, Variable vmtu_3326, Variable vresult_3327, Variable vsize_3328, Parameter vchan_3315, IfStmt target_0, EqualityOperation target_7, EqualityOperation target_8, ExprStmt target_9, AddressOfExpr target_10, AddressOfExpr target_11, AddressOfExpr target_12, AddressOfExpr target_13, AddressOfExpr target_14, AddressOfExpr target_15, PointerArithmeticOperation target_16, BlockStmt target_17, BlockStmt target_18
where
func_0(vptr_3318, vrfc_3323, vremote_efs_3325, vmtu_3326, vresult_3327, vsize_3328, vchan_3315, target_9, target_0)
and not func_1(vptr_3318, vrfc_3323, target_10, target_11)
and not func_2(vptr_3318, vchan_3315, target_11, target_12)
and not func_3(vptr_3318, target_12, target_13)
and not func_4(vptr_3318, vrfc_3323, target_13, target_14)
and not func_5(vptr_3318, target_14, target_15)
and not func_6(vptr_3318, vrfc_3323, target_15, target_16)
and func_7(vresult_3327, target_17, target_7)
and func_8(vrfc_3323, vchan_3315, target_18, target_8)
and func_9(vchan_3315, target_9)
and func_10(vptr_3318, target_10)
and func_11(vptr_3318, vchan_3315, target_11)
and func_12(vptr_3318, target_12)
and func_13(vptr_3318, vrfc_3323, target_13)
and func_14(vptr_3318, target_14)
and func_15(vptr_3318, vrfc_3323, target_15)
and func_16(vptr_3318, target_16)
and func_17(vmtu_3326, vresult_3327, vchan_3315, target_17)
and func_18(vrfc_3323, vresult_3327, vchan_3315, target_18)
and vptr_3318.getType().hasName("void *")
and vrfc_3323.getType().hasName("l2cap_conf_rfc")
and vremote_efs_3325.getType().hasName("u8")
and vmtu_3326.getType().hasName("u16")
and vresult_3327.getType().hasName("u16")
and vsize_3328.getType().hasName("u16")
and vchan_3315.getType().hasName("l2cap_chan *")
and vptr_3318.(LocalVariable).getFunction() = func
and vrfc_3323.(LocalVariable).getFunction() = func
and vremote_efs_3325.(LocalVariable).getFunction() = func
and vmtu_3326.(LocalVariable).getFunction() = func
and vresult_3327.(LocalVariable).getFunction() = func
and vsize_3328.(LocalVariable).getFunction() = func
and vchan_3315.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
