/**
 * @name linux-1be7107fbe18eed3e319a6c3e83c78254b693acb-hugetlb_get_unmapped_area
 * @id cpp/linux/1be7107fbe18eed3e319a6c3e83c78254b693acb/hugetlb-get-unmapped-area
 * @description linux-1be7107fbe18eed3e319a6c3e83c78254b693acb-arch/tile/mm/hugetlbpage.c-hugetlb_get_unmapped_area CVE-2017-1000364
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, Literal target_0) {
	target_0.getValue()="22"
	and not target_0.getValue()="0"
	and target_0.getParent().(UnaryMinusExpr).getParent().(ReturnStmt).getExpr() instanceof UnaryMinusExpr
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Function func, Literal target_1) {
	target_1.getValue()="29"
	and not target_1.getValue()="0"
	and target_1.getParent().(FunctionCall).getParent().(ConditionalExpr).getCondition() instanceof FunctionCall
	and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, SubExpr target_2) {
	target_2.getValue()="140737488351232"
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Variable vh_132, FunctionCall target_3) {
	target_3.getTarget().hasName("huge_page_size")
	and not target_3.getTarget().hasName("get_mmap_base")
	and target_3.getArgument(0).(VariableAccess).getTarget()=vh_132
}

predicate func_4(Variable vh_132, FunctionCall target_4) {
	target_4.getTarget().hasName("huge_page_size")
	and not target_4.getTarget().hasName("tasksize_32bit")
	and target_4.getArgument(0).(VariableAccess).getTarget()=vh_132
}

predicate func_5(Parameter vpgoff_130, Parameter vflags_130, Parameter vfile_129, Parameter vaddr_129, Parameter vlen_130, FunctionCall target_5) {
	target_5.getTarget().hasName("hugetlb_get_unmapped_area_bottomup")
	and not target_5.getTarget().hasName("tasksize_64bit")
	and target_5.getArgument(0).(VariableAccess).getTarget()=vfile_129
	and target_5.getArgument(1).(VariableAccess).getTarget()=vaddr_129
	and target_5.getArgument(2).(VariableAccess).getTarget()=vlen_130
	and target_5.getArgument(3).(VariableAccess).getTarget()=vpgoff_130
	and target_5.getArgument(4).(VariableAccess).getTarget()=vflags_130
}

predicate func_6(Parameter vpgoff_130, Parameter vflags_130, Parameter vfile_129, Parameter vaddr_129, Parameter vlen_130, FunctionCall target_6) {
	target_6.getTarget().hasName("hugetlb_get_unmapped_area_topdown")
	and not target_6.getTarget().hasName("vm_unmapped_area")
	and target_6.getArgument(0).(VariableAccess).getTarget()=vfile_129
	and target_6.getArgument(1).(VariableAccess).getTarget()=vaddr_129
	and target_6.getArgument(2).(VariableAccess).getTarget()=vlen_130
	and target_6.getArgument(3).(VariableAccess).getTarget()=vpgoff_130
	and target_6.getArgument(4).(VariableAccess).getTarget()=vflags_130
}

predicate func_8(Function func) {
exists(ValueFieldAccess target_8 |
	target_8.getTarget().getName()="flags"
	and target_8.getQualifier().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_8.getEnclosingFunction() = func)
}

predicate func_9(Parameter vlen_130, RelationalOperation target_40) {
exists(AssignExpr target_9 |
	target_9.getLValue().(ValueFieldAccess).getTarget().getName()="length"
	and target_9.getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_9.getRValue().(VariableAccess).getTarget()=vlen_130
	and target_9.getRValue().(VariableAccess).getLocation().isBefore(target_40.getGreaterOperand().(VariableAccess).getLocation()))
}

predicate func_10(IfStmt target_25, Function func) {
exists(ExprStmt target_10 |
	target_10.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="low_limit"
	and target_10.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_10.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("get_mmap_base")
	and target_10.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0) instanceof Literal
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_10
	and target_10.getLocation().isBefore(target_25.getLocation()))
}

predicate func_11(IfStmt target_25, Function func) {
exists(ExprStmt target_11 |
	target_11.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="high_limit"
	and target_11.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_11.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("in_compat_syscall")
	and target_11.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("tasksize_32bit")
	and target_11.getExpr().(AssignExpr).getRValue().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("tasksize_64bit")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_11
	and target_11.getLocation().isBefore(target_25.getLocation()))
}

/*predicate func_12(Function func) {
exists(FunctionCall target_12 |
	target_12.getTarget().hasName("in_compat_syscall")
	and target_12.getEnclosingFunction() = func)
}

*/
predicate func_13(IfStmt target_25, Function func) {
exists(ExprStmt target_13 |
	target_13.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="align_mask"
	and target_13.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_13.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(ComplementExpr).getValue()="18446744073709547520"
	and target_13.getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand() instanceof ComplementExpr
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_13
	and target_13.getLocation().isBefore(target_25.getLocation()))
}

/*predicate func_14(Function func) {
exists(ComplementExpr target_14 |
	target_14.getValue()="18446744073709547520"
	and target_14.getEnclosingFunction() = func)
}

*/
predicate func_15(IfStmt target_25, Function func) {
exists(ExprStmt target_15 |
	target_15.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="align_offset"
	and target_15.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_15.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
	and target_15.getLocation().isBefore(target_25.getLocation()))
}

predicate func_16(Function func) {
exists(AddressOfExpr target_16 |
	target_16.getOperand().(VariableAccess).getType().hasName("vm_unmapped_area_info")
	and target_16.getParent().(FunctionCall).getParent().(ReturnStmt).getExpr() instanceof FunctionCall
	and target_16.getEnclosingFunction() = func)
}

predicate func_17(Variable vh_132, Parameter vlen_130, ReturnStmt target_41, ComplementExpr target_17) {
	target_17.getOperand().(FunctionCall).getTarget().hasName("huge_page_mask")
	and target_17.getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vh_132
	and target_17.getParent().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vlen_130
	and target_17.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen()=target_41
}

/*predicate func_19(Variable vh_132, Parameter vlen_130, ReturnStmt target_41, VariableAccess target_19) {
	target_19.getTarget()=vlen_130
	and target_19.getParent().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getOperand().(FunctionCall).getTarget().hasName("huge_page_mask")
	and target_19.getParent().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vh_132
	and target_19.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen()=target_41
}

*/
predicate func_22(Function func, DeclStmt target_22) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_22
}

predicate func_23(Parameter vlen_130, Function func, IfStmt target_23) {
	target_23.getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vlen_130
	and target_23.getCondition().(BitwiseAndExpr).getRightOperand() instanceof ComplementExpr
	and target_23.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="18446744073709551594"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

/*predicate func_24(Function func, UnaryMinusExpr target_24) {
	target_24.getValue()="18446744073709551594"
	and target_24.getEnclosingFunction() = func
}

*/
predicate func_25(Parameter vlen_130, Function func, IfStmt target_25) {
	target_25.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vlen_130
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("test_ti_thread_flag")
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("get_current")
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1) instanceof Literal
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getThen().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="personality"
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getThen().(ConditionalExpr).getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("get_current")
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getThen().(ConditionalExpr).getThen().(Literal).getValue()="3221225472"
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getThen().(ConditionalExpr).getElse().(Literal).getValue()="4294959104"
	and target_25.getCondition().(RelationalOperation).getLesserOperand().(ConditionalExpr).getElse() instanceof SubExpr
	and target_25.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="18446744073709551604"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_25
}

/*predicate func_26(Function func, FunctionCall target_26) {
	target_26.getTarget().hasName("test_ti_thread_flag")
	and target_26.getArgument(0).(FunctionCall).getTarget().hasName("get_current")
	and target_26.getArgument(1) instanceof Literal
	and target_26.getEnclosingFunction() = func
}

*/
/*predicate func_27(Function func, ConditionalExpr target_27) {
	target_27.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="personality"
	and target_27.getCondition().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(FunctionCall).getTarget().hasName("get_current")
	and target_27.getThen().(Literal).getValue()="3221225472"
	and target_27.getElse().(Literal).getValue()="4294959104"
	and target_27.getEnclosingFunction() = func
}

*/
predicate func_30(Parameter vflags_130, Parameter vfile_129, Parameter vaddr_129, Parameter vlen_130, Function func, IfStmt target_30) {
	target_30.getCondition().(BitwiseAndExpr).getLeftOperand().(VariableAccess).getTarget()=vflags_130
	and target_30.getCondition().(BitwiseAndExpr).getRightOperand().(Literal).getValue()="16"
	and target_30.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("prepare_hugepage_range")
	and target_30.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vfile_129
	and target_30.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_129
	and target_30.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vlen_130
	and target_30.getThen().(BlockStmt).getStmt(0).(IfStmt).getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="18446744073709551594"
	and target_30.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vaddr_129
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

/*predicate func_31(Parameter vfile_129, Parameter vaddr_129, Parameter vlen_130, BitwiseAndExpr target_42, IfStmt target_31) {
	target_31.getCondition().(FunctionCall).getTarget().hasName("prepare_hugepage_range")
	and target_31.getCondition().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vfile_129
	and target_31.getCondition().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_129
	and target_31.getCondition().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vlen_130
	and target_31.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="18446744073709551594"
	and target_31.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_42
}

*/
/*predicate func_32(Parameter vaddr_129, BitwiseAndExpr target_42, FunctionCall target_43, IfStmt target_33, ReturnStmt target_32) {
	target_32.getExpr().(VariableAccess).getTarget()=vaddr_129
	and target_32.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_42
	and target_43.getArgument(1).(VariableAccess).getLocation().isBefore(target_32.getExpr().(VariableAccess).getLocation())
	and target_32.getExpr().(VariableAccess).getLocation().isBefore(target_33.getCondition().(VariableAccess).getLocation())
}

*/
predicate func_33(Variable vmm_133, Variable vvma_134, Parameter vaddr_129, Parameter vlen_130, Function func, IfStmt target_33) {
	target_33.getCondition().(VariableAccess).getTarget()=vaddr_129
	and target_33.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddr_129
	and target_33.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vaddr_129
	and target_33.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vvma_134
	and target_33.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("find_vma")
	and target_33.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmm_133
	and target_33.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_129
	and target_33.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vlen_130
	and target_33.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vaddr_129
	and target_33.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vvma_134
	and target_33.getThen().(BlockStmt).getStmt(2).(IfStmt).getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_33.getThen().(BlockStmt).getStmt(2).(IfStmt).getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=vaddr_129
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_33
}

/*predicate func_34(Parameter vaddr_129, VariableAccess target_34) {
	target_34.getTarget()=vaddr_129
	and target_34.getParent().(AssignExpr).getLValue() = target_34
	and target_34.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vaddr_129
	and target_34.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getLeftOperand() instanceof FunctionCall
	and target_34.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand().(AddExpr).getRightOperand().(SubExpr).getRightOperand() instanceof Literal
	and target_34.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getOperand().(SubExpr).getLeftOperand() instanceof FunctionCall
	and target_34.getParent().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getOperand().(SubExpr).getRightOperand() instanceof Literal
}

*/
/*predicate func_35(Parameter vaddr_129, AddExpr target_35) {
	target_35.getLeftOperand().(VariableAccess).getTarget()=vaddr_129
	and target_35.getRightOperand().(SubExpr).getLeftOperand() instanceof FunctionCall
	and target_35.getRightOperand().(SubExpr).getRightOperand() instanceof Literal
}

*/
/*predicate func_36(Function func, ComplementExpr target_36) {
	target_36.getOperand().(SubExpr).getLeftOperand() instanceof FunctionCall
	and target_36.getOperand().(SubExpr).getRightOperand() instanceof Literal
	and target_36.getEnclosingFunction() = func
}

*/
/*predicate func_37(Variable vmm_133, Variable vvma_134, Parameter vaddr_129, AssignExpr target_37) {
	target_37.getLValue().(VariableAccess).getTarget()=vvma_134
	and target_37.getRValue().(FunctionCall).getTarget().hasName("find_vma")
	and target_37.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vmm_133
	and target_37.getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vaddr_129
}

*/
/*predicate func_38(Variable vvma_134, Parameter vaddr_129, Parameter vlen_130, VariableAccess target_44, IfStmt target_38) {
	target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getTarget().hasName("test_ti_thread_flag")
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("get_current")
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(ConditionalExpr).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="29"
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(ConditionalExpr).getThen().(ConditionalExpr).getThen().(Literal).getValue()="3221225472"
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(ConditionalExpr).getThen().(ConditionalExpr).getElse().(Literal).getValue()="4294959104"
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(ConditionalExpr).getElse().(SubExpr).getValue()="140737488351232"
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getGreaterOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vlen_130
	and target_38.getCondition().(LogicalAndExpr).getLeftOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vaddr_129
	and target_38.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getLeftOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vvma_134
	and target_38.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(RelationalOperation).getLesserOperand().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vaddr_129
	and target_38.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(RelationalOperation).getLesserOperand().(AddExpr).getRightOperand().(VariableAccess).getTarget()=vlen_130
	and target_38.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getTarget().getName()="vm_start"
	and target_38.getCondition().(LogicalAndExpr).getRightOperand().(LogicalOrExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvma_134
	and target_38.getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=vaddr_129
	and target_38.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_44
}

*/
predicate func_39(Variable vmm_133, Function func, IfStmt target_39) {
	target_39.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="get_unmapped_area"
	and target_39.getCondition().(EqualityOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmm_133
	and target_39.getThen().(ReturnStmt).getExpr() instanceof FunctionCall
	and target_39.getElse().(ReturnStmt).getExpr() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_39
}

predicate func_40(Parameter vlen_130, RelationalOperation target_40) {
	 (target_40 instanceof GTExpr or target_40 instanceof LTExpr)
	and target_40.getGreaterOperand().(VariableAccess).getTarget()=vlen_130
	and target_40.getLesserOperand().(ConditionalExpr).getCondition() instanceof FunctionCall
	and target_40.getLesserOperand().(ConditionalExpr).getThen() instanceof ConditionalExpr
	and target_40.getLesserOperand().(ConditionalExpr).getElse() instanceof SubExpr
}

predicate func_41(BitwiseAndExpr target_45, Function func, ReturnStmt target_41) {
	target_41.getExpr() instanceof UnaryMinusExpr
	and target_41.getParent().(IfStmt).getCondition()=target_45
	and target_41.getEnclosingFunction() = func
}

predicate func_42(Parameter vflags_130, BitwiseAndExpr target_42) {
	target_42.getLeftOperand().(VariableAccess).getTarget()=vflags_130
	and target_42.getRightOperand() instanceof Literal
}

predicate func_43(Parameter vfile_129, Parameter vaddr_129, Parameter vlen_130, FunctionCall target_43) {
	target_43.getTarget().hasName("prepare_hugepage_range")
	and target_43.getArgument(0).(VariableAccess).getTarget()=vfile_129
	and target_43.getArgument(1).(VariableAccess).getTarget()=vaddr_129
	and target_43.getArgument(2).(VariableAccess).getTarget()=vlen_130
}

predicate func_44(Parameter vaddr_129, BlockStmt target_46, VariableAccess target_44) {
	target_44.getTarget()=vaddr_129
	and target_44.getParent().(IfStmt).getThen()=target_46
}

predicate func_45(Parameter vlen_130, BitwiseAndExpr target_45) {
	target_45.getLeftOperand().(VariableAccess).getTarget()=vlen_130
	and target_45.getRightOperand() instanceof ComplementExpr
}

predicate func_46(Parameter vaddr_129, BlockStmt target_46) {
	target_46.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vaddr_129
	and target_46.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getLeftOperand() instanceof AddExpr
	and target_46.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue().(BitwiseAndExpr).getRightOperand() instanceof ComplementExpr
	and target_46.getStmt(1).(ExprStmt).getExpr() instanceof AssignExpr
	and target_46.getStmt(2) instanceof IfStmt
}

from Function func, Parameter vpgoff_130, Parameter vflags_130, Variable vh_132, Variable vmm_133, Variable vvma_134, Parameter vfile_129, Parameter vaddr_129, Parameter vlen_130, Literal target_0, Literal target_1, SubExpr target_2, FunctionCall target_3, FunctionCall target_4, FunctionCall target_5, FunctionCall target_6, ComplementExpr target_17, DeclStmt target_22, IfStmt target_23, IfStmt target_25, IfStmt target_30, IfStmt target_33, IfStmt target_39, RelationalOperation target_40, ReturnStmt target_41, BitwiseAndExpr target_42, FunctionCall target_43, VariableAccess target_44, BitwiseAndExpr target_45, BlockStmt target_46
where
func_0(func, target_0)
and func_1(func, target_1)
and func_2(func, target_2)
and func_3(vh_132, target_3)
and func_4(vh_132, target_4)
and func_5(vpgoff_130, vflags_130, vfile_129, vaddr_129, vlen_130, target_5)
and func_6(vpgoff_130, vflags_130, vfile_129, vaddr_129, vlen_130, target_6)
and not func_8(func)
and not func_9(vlen_130, target_40)
and not func_10(target_25, func)
and not func_11(target_25, func)
and not func_13(target_25, func)
and not func_15(target_25, func)
and not func_16(func)
and func_17(vh_132, vlen_130, target_41, target_17)
and func_22(func, target_22)
and func_23(vlen_130, func, target_23)
and func_25(vlen_130, func, target_25)
and func_30(vflags_130, vfile_129, vaddr_129, vlen_130, func, target_30)
and func_33(vmm_133, vvma_134, vaddr_129, vlen_130, func, target_33)
and func_39(vmm_133, func, target_39)
and func_40(vlen_130, target_40)
and func_41(target_45, func, target_41)
and func_42(vflags_130, target_42)
and func_43(vfile_129, vaddr_129, vlen_130, target_43)
and func_44(vaddr_129, target_46, target_44)
and func_45(vlen_130, target_45)
and func_46(vaddr_129, target_46)
and vpgoff_130.getType().hasName("unsigned long")
and vflags_130.getType().hasName("unsigned long")
and vh_132.getType().hasName("hstate *")
and vmm_133.getType().hasName("mm_struct *")
and vvma_134.getType().hasName("vm_area_struct *")
and vfile_129.getType().hasName("file *")
and vaddr_129.getType().hasName("unsigned long")
and vlen_130.getType().hasName("unsigned long")
and vpgoff_130.getFunction() = func
and vflags_130.getFunction() = func
and vh_132.(LocalVariable).getFunction() = func
and vmm_133.(LocalVariable).getFunction() = func
and vvma_134.(LocalVariable).getFunction() = func
and vfile_129.getFunction() = func
and vaddr_129.getFunction() = func
and vlen_130.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
