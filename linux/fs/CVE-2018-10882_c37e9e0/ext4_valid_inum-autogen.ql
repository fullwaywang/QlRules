/**
 * @name linux-c37e9e013469521d9adb932d17a1795c139b36db-ext4_valid_inum
 * @id cpp/linux/c37e9e013469521d9adb932d17a1795c139b36db/ext4-valid-inum
 * @description linux-c37e9e013469521d9adb932d17a1795c139b36db-fs/ext4/ext4.h-ext4_valid_inum CVE-2018-10882
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vino_1502, EqualityOperation target_0) {
		target_0.getAnOperand().(VariableAccess).getTarget()=vino_1502
		and target_0.getAnOperand().(Literal).getValue()="2"
}

predicate func_1(Parameter vino_1502, LogicalOrExpr target_1) {
		target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand() instanceof EqualityOperation
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vino_1502
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="3"
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vino_1502
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="4"
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vino_1502
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="5"
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vino_1502
		and target_1.getAnOperand().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="8"
		and target_1.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vino_1502
		and target_1.getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="7"
}

from Function func, Parameter vino_1502, EqualityOperation target_0, LogicalOrExpr target_1
where
func_0(vino_1502, target_0)
and func_1(vino_1502, target_1)
and vino_1502.getType().hasName("unsigned long")
and vino_1502.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
