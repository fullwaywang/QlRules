/**
 * @name linux-949dd0104c496fa7c14991a23c03c62e44637e71-create_power_zone_common_attributes
 * @id cpp/linux/949dd0104c496fa7c14991a23c03c62e44637e71/create-power-zone-common-attributes
 * @description linux-949dd0104c496fa7c14991a23c03c62e44637e71-drivers/powercap/powercap_sys.c-create_power_zone_common_attributes CVE-2020-8694
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, BitwiseOrExpr target_0) {
	target_0.getValue()="288"
	and target_0.getEnclosingFunction() = func
}

predicate func_2(Function func, BitwiseOrExpr target_2) {
	target_2.getValue()="420"
	and target_2.getParent().(AssignExpr).getRValue() = target_2
	and target_2.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="mode"
	and target_2.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="attr"
	and target_2.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("device_attribute")
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, BitwiseOrExpr target_3) {
	target_3.getValue()="292"
	and target_3.getParent().(AssignExpr).getRValue() = target_3
	and target_3.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="mode"
	and target_3.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="attr"
	and target_3.getParent().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget().getType().hasName("device_attribute")
	and target_3.getEnclosingFunction() = func
}

from Function func, BitwiseOrExpr target_0, BitwiseOrExpr target_2, BitwiseOrExpr target_3
where
func_0(func, target_0)
and func_2(func, target_2)
and func_3(func, target_3)
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
