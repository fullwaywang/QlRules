/**
 * @name linux-111103907234bffd0a34fba070ad9367de058752-ext4_xattr_set_entry
 * @id cpp/linux/111103907234bffd0a34fba070ad9367de058752/ext4-xattr-set-entry
 * @description linux-111103907234bffd0a34fba070ad9367de058752-fs/ext4/xattr.c-ext4_xattr_set_entry CVE-2024-40972
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, BitwiseOrExpr target_0) {
	target_0.getValue()="2307"
	and target_0.getEnclosingFunction() = func
}

predicate func_1(Function func, Literal target_1) {
	target_1.getValue()="1243"
	and not target_1.getValue()="1244"
	and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, Literal target_2) {
	target_2.getValue()="1244"
	and not target_2.getValue()="1245"
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
	target_3.getValue()="1245"
	and not target_3.getValue()="1243"
	and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, Literal target_4) {
	target_4.getValue()="1246"
	and not target_4.getValue()="1244"
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Function func, Literal target_5) {
	target_5.getValue()="1247"
	and not target_5.getValue()="1245"
	and target_5.getEnclosingFunction() = func
}

predicate func_6(Function func, Literal target_6) {
	target_6.getValue()="1248"
	and not target_6.getValue()="1246"
	and target_6.getEnclosingFunction() = func
}

predicate func_7(Function func, Literal target_7) {
	target_7.getValue()="1249"
	and not target_7.getValue()="1247"
	and target_7.getEnclosingFunction() = func
}

predicate func_8(Function func, Literal target_8) {
	target_8.getValue()="1250"
	and not target_8.getValue()="1248"
	and target_8.getEnclosingFunction() = func
}

predicate func_9(Function func, Literal target_9) {
	target_9.getValue()="1251"
	and not target_9.getValue()="1249"
	and target_9.getEnclosingFunction() = func
}

predicate func_10(Function func, Literal target_10) {
	target_10.getValue()="1252"
	and not target_10.getValue()="1250"
	and target_10.getEnclosingFunction() = func
}

predicate func_11(Function func, Literal target_11) {
	target_11.getValue()="1253"
	and not target_11.getValue()="1251"
	and target_11.getEnclosingFunction() = func
}

predicate func_12(Function func, Literal target_12) {
	target_12.getValue()="1254"
	and not target_12.getValue()="1252"
	and target_12.getEnclosingFunction() = func
}

predicate func_13(Function func, Literal target_13) {
	target_13.getValue()="1255"
	and not target_13.getValue()="1253"
	and target_13.getEnclosingFunction() = func
}

predicate func_14(Function func, Literal target_14) {
	target_14.getValue()="1256"
	and not target_14.getValue()="1254"
	and target_14.getEnclosingFunction() = func
}

predicate func_15(Function func, Literal target_15) {
	target_15.getValue()="1257"
	and not target_15.getValue()="1255"
	and target_15.getEnclosingFunction() = func
}

predicate func_16(Function func, Literal target_16) {
	target_16.getValue()="1258"
	and not target_16.getValue()="1256"
	and target_16.getEnclosingFunction() = func
}

predicate func_17(Function func, Literal target_17) {
	target_17.getValue()="1259"
	and not target_17.getValue()="1257"
	and target_17.getEnclosingFunction() = func
}

predicate func_18(Function func, Literal target_18) {
	target_18.getValue()="1260"
	and not target_18.getValue()="1258"
	and target_18.getEnclosingFunction() = func
}

predicate func_19(Function func, Literal target_19) {
	target_19.getValue()="1261"
	and not target_19.getValue()="1259"
	and target_19.getEnclosingFunction() = func
}

predicate func_20(Function func, Literal target_20) {
	target_20.getValue()="1262"
	and not target_20.getValue()="1260"
	and target_20.getEnclosingFunction() = func
}

predicate func_21(Function func, Literal target_21) {
	target_21.getValue()="1263"
	and not target_21.getValue()="1261"
	and target_21.getEnclosingFunction() = func
}

predicate func_22(Function func, Literal target_22) {
	target_22.getValue()="1264"
	and not target_22.getValue()="1262"
	and target_22.getEnclosingFunction() = func
}

predicate func_23(Variable v__ret_warn_on_1716, DoStmt target_73, FunctionCall target_23) {
	target_23.getTarget().hasName("__builtin_expect")
	and target_23.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1716
	and target_23.getArgument(1) instanceof Literal
	and target_23.getParent().(IfStmt).getThen()=target_73
}

predicate func_24(Function func, ExprStmt target_24) {
	target_24.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_24.getEnclosingFunction() = func
}

predicate func_25(Variable v__ret_warn_on_1759, DoStmt target_74, FunctionCall target_25) {
	target_25.getTarget().hasName("__builtin_expect")
	and target_25.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1759
	and target_25.getArgument(1) instanceof Literal
	and target_25.getParent().(IfStmt).getThen()=target_74
}

predicate func_26(Function func, ExprStmt target_26) {
	target_26.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_26.getEnclosingFunction() = func
}

predicate func_27(Function func, ExprStmt target_27) {
	target_27.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_27.getEnclosingFunction() = func
}

predicate func_28(Function func, ExprStmt target_28) {
	target_28.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_28.getEnclosingFunction() = func
}

predicate func_29(Function func, ExprStmt target_29) {
	target_29.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_29.getEnclosingFunction() = func
}

predicate func_30(Variable v__ret_warn_on_1780, DoStmt target_75, FunctionCall target_30) {
	target_30.getTarget().hasName("__builtin_expect")
	and target_30.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1780
	and target_30.getArgument(1) instanceof Literal
	and target_30.getParent().(IfStmt).getThen()=target_75
}

predicate func_31(Function func, ExprStmt target_31) {
	target_31.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_31.getEnclosingFunction() = func
}

predicate func_32(Function func, ExprStmt target_32) {
	target_32.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_32.getEnclosingFunction() = func
}

predicate func_33(Function func, ExprStmt target_33) {
	target_33.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_33.getEnclosingFunction() = func
}

predicate func_34(Function func, ExprStmt target_34) {
	target_34.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_34.getEnclosingFunction() = func
}

predicate func_35(Variable v__ret_warn_on_1802, DoStmt target_76, FunctionCall target_35) {
	target_35.getTarget().hasName("__builtin_expect")
	and target_35.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1802
	and target_35.getArgument(1) instanceof Literal
	and target_35.getParent().(IfStmt).getThen()=target_76
}

predicate func_36(Function func, ExprStmt target_36) {
	target_36.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_36.getEnclosingFunction() = func
}

predicate func_37(Function func, ExprStmt target_37) {
	target_37.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_37.getEnclosingFunction() = func
}

predicate func_38(Function func, ExprStmt target_38) {
	target_38.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_38.getEnclosingFunction() = func
}

predicate func_39(Function func, ExprStmt target_39) {
	target_39.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_39.getEnclosingFunction() = func
}

predicate func_40(Variable v__ret_warn_on_1806, DoStmt target_77, FunctionCall target_40) {
	target_40.getTarget().hasName("__builtin_expect")
	and target_40.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1806
	and target_40.getArgument(1) instanceof Literal
	and target_40.getParent().(IfStmt).getThen()=target_77
}

predicate func_41(Function func, ExprStmt target_41) {
	target_41.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_41.getEnclosingFunction() = func
}

predicate func_42(Function func, ExprStmt target_42) {
	target_42.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_42.getEnclosingFunction() = func
}

predicate func_43(Function func, ExprStmt target_43) {
	target_43.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_43.getEnclosingFunction() = func
}

predicate func_44(Function func, ExprStmt target_44) {
	target_44.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_44.getEnclosingFunction() = func
}

predicate func_45(Function func, ExprStmt target_45) {
	target_45.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_45.getEnclosingFunction() = func
}

predicate func_46(Function func, ExprStmt target_46) {
	target_46.getExpr().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(AsmStmt).getChild(0) instanceof Literal
	and target_46.getEnclosingFunction() = func
}

predicate func_47(Variable vin_inode_1627, Parameter vi_1619, BlockStmt target_78, PointerFieldAccess target_47) {
	exists(LogicalAndExpr obj_0 | obj_0=target_47.getParent() |
		obj_0.getRightOperand().(VariableAccess).getTarget()=vin_inode_1627
		and obj_0.getParent().(IfStmt).getThen()=target_78
	)
	and target_47.getTarget().getName()="value"
	and target_47.getQualifier().(VariableAccess).getTarget()=vi_1619
}

predicate func_48(Variable v__ret_warn_on_1716, ExprStmt target_48) {
	exists(FunctionCall obj_0 | obj_0=target_48.getExpr() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1716
		and obj_0.getArgument(1) instanceof Literal
	)
}

predicate func_49(Parameter vhandle_1621, Variable vold_ea_inode_1628, Variable vret_1631, VariableAccess target_79, ExprStmt target_49) {
	exists(AssignExpr obj_0 | obj_0=target_49.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			obj_1.getTarget().hasName("ext4_xattr_inode_dec_ref")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vhandle_1621
			and obj_1.getArgument(1).(VariableAccess).getTarget()=vold_ea_inode_1628
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1631
	)
	and target_49.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_79
}

predicate func_50(Parameter vinode_1621, Variable vhere_1625, Variable vold_ea_inode_1628, VariableAccess target_79, ExprStmt target_50) {
	exists(FunctionCall obj_0 | obj_0=target_50.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(2) |
			obj_1.getTarget().getName()="e_value_size"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vhere_1625
		)
		and obj_0.getTarget().hasName("ext4_xattr_inode_free_quota")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vinode_1621
		and obj_0.getArgument(1).(VariableAccess).getTarget()=vold_ea_inode_1628
	)
	and target_50.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_79
}

predicate func_51(Variable v__ret_warn_on_1759, ExprStmt target_51) {
	exists(FunctionCall obj_0 | obj_0=target_51.getExpr() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1759
		and obj_0.getArgument(1) instanceof Literal
	)
}

predicate func_52(Variable v__ret_warn_on_1780, ExprStmt target_52) {
	exists(FunctionCall obj_0 | obj_0=target_52.getExpr() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1780
		and obj_0.getArgument(1) instanceof Literal
	)
}

predicate func_53(Variable v__ret_warn_on_1802, ExprStmt target_53) {
	exists(FunctionCall obj_0 | obj_0=target_53.getExpr() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1802
		and obj_0.getArgument(1) instanceof Literal
	)
}

predicate func_54(Variable v__ret_warn_on_1806, ExprStmt target_54) {
	exists(FunctionCall obj_0 | obj_0=target_54.getExpr() |
		obj_0.getTarget().hasName("__builtin_expect")
		and obj_0.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__ret_warn_on_1806
		and obj_0.getArgument(1) instanceof Literal
	)
}

predicate func_55(FunctionCall target_80, Function func, GotoStmt target_55) {
	target_55.getName() ="out"
	and target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_80
	and target_55.getEnclosingFunction() = func
}

predicate func_56(Function func, DeclStmt target_56) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_56
}

predicate func_57(Parameter vhandle_1621, Parameter vinode_1621, Variable vin_inode_1627, Variable vnew_ea_inode_1629, Variable vret_1631, Parameter vi_1619, Function func, IfStmt target_57) {
	exists(LogicalAndExpr obj_0 | obj_0=target_57.getCondition() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getLeftOperand() |
			obj_1.getTarget().getName()="value"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vi_1619
		)
		and obj_0.getRightOperand().(VariableAccess).getTarget()=vin_inode_1627
	)
	and exists(BlockStmt obj_2 | obj_2=target_57.getThen() |
		exists(ExprStmt obj_3 | obj_3=obj_2.getStmt(0) |
			exists(StmtExpr obj_4 | obj_4=obj_3.getExpr() |
				exists(BlockStmt obj_5 | obj_5=obj_4.getStmt() |
					obj_5.getStmt(1).(IfStmt).getCondition() instanceof FunctionCall
					and obj_5.getStmt(2) instanceof ExprStmt
				)
			)
		)
		and exists(ExprStmt obj_6 | obj_6=obj_2.getStmt(1) |
			exists(AssignExpr obj_7 | obj_7=obj_6.getExpr() |
				exists(FunctionCall obj_8 | obj_8=obj_7.getRValue() |
					exists(PointerFieldAccess obj_9 | obj_9=obj_8.getArgument(2) |
						obj_9.getTarget().getName()="value"
						and obj_9.getQualifier().(VariableAccess).getTarget()=vi_1619
					)
					and exists(PointerFieldAccess obj_10 | obj_10=obj_8.getArgument(3) |
						obj_10.getTarget().getName()="value_len"
						and obj_10.getQualifier().(VariableAccess).getTarget()=vi_1619
					)
					and obj_8.getTarget().hasName("ext4_xattr_inode_lookup_create")
					and obj_8.getArgument(0).(VariableAccess).getTarget()=vhandle_1621
					and obj_8.getArgument(1).(VariableAccess).getTarget()=vinode_1621
				)
				and obj_7.getLValue().(VariableAccess).getTarget()=vnew_ea_inode_1629
			)
		)
		and exists(IfStmt obj_11 | obj_11=obj_2.getStmt(2) |
			exists(FunctionCall obj_12 | obj_12=obj_11.getCondition() |
				obj_12.getTarget().hasName("IS_ERR")
				and obj_12.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
			)
			and exists(BlockStmt obj_13 | obj_13=obj_11.getThen() |
				exists(ExprStmt obj_14 | obj_14=obj_13.getStmt(0) |
					exists(AssignExpr obj_15 | obj_15=obj_14.getExpr() |
						obj_15.getLValue().(VariableAccess).getTarget()=vret_1631
						and obj_15.getRValue().(FunctionCall).getTarget().hasName("PTR_ERR")
					)
				)
				and exists(ExprStmt obj_16 | obj_16=obj_13.getStmt(1) |
					exists(AssignExpr obj_17 | obj_17=obj_16.getExpr() |
						obj_17.getLValue().(VariableAccess).getTarget()=vnew_ea_inode_1629
						and obj_17.getRValue().(Literal).getValue()="0"
					)
				)
				and obj_13.getStmt(2) instanceof GotoStmt
			)
		)
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_57
}

/*predicate func_58(LogicalAndExpr target_81, Function func, ExprStmt target_58) {
	exists(StmtExpr obj_0 | obj_0=target_58.getExpr() |
		exists(BlockStmt obj_1 | obj_1=obj_0.getStmt() |
			exists(IfStmt obj_2 | obj_2=obj_1.getStmt(1) |
				exists(DoStmt obj_3 | obj_3=obj_2.getThen() |
					obj_3.getCondition() instanceof Literal
					and obj_3.getStmt().(BlockStmt).getStmt(1) instanceof ExprStmt
				)
				and obj_2.getCondition() instanceof FunctionCall
			)
			and obj_1.getStmt(2) instanceof ExprStmt
		)
	)
	and target_58.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_81
	and target_58.getEnclosingFunction() = func
}

*/
/*predicate func_60(Variable v__flags_1716, IfStmt target_60) {
	exists(DoStmt obj_0 | obj_0=target_60.getThen() |
		exists(BlockStmt obj_1 | obj_1=obj_0.getStmt() |
			exists(DoStmt obj_2 | obj_2=obj_1.getStmt(2) |
				exists(BlockStmt obj_3 | obj_3=obj_2.getStmt() |
					exists(AsmStmt obj_4 | obj_4=obj_3.getStmt(0) |
						exists(SizeofTypeOperator obj_5 | obj_5=obj_4.getChild(3) |
							obj_5.getType() instanceof LongType
							and obj_5.getValue()="12"
						)
						and obj_4.getChild(0) instanceof StringLiteral
						and obj_4.getChild(1) instanceof Literal
						and obj_4.getChild(2).(VariableAccess).getTarget()=v__flags_1716
					)
				)
				and obj_2.getCondition() instanceof Literal
			)
			and obj_1.getStmt(1) instanceof ExprStmt
		)
		and obj_0.getCondition() instanceof Literal
	)
	and target_60.getCondition() instanceof FunctionCall
}

*/
/*predicate func_61(Parameter vhandle_1621, Parameter vinode_1621, Variable vnew_ea_inode_1629, Parameter vi_1619, LogicalAndExpr target_81, ExprStmt target_61) {
	exists(AssignExpr obj_0 | obj_0=target_61.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			exists(PointerFieldAccess obj_2 | obj_2=obj_1.getArgument(2) |
				obj_2.getTarget().getName()="value"
				and obj_2.getQualifier().(VariableAccess).getTarget()=vi_1619
			)
			and exists(PointerFieldAccess obj_3 | obj_3=obj_1.getArgument(3) |
				obj_3.getTarget().getName()="value_len"
				and obj_3.getQualifier().(VariableAccess).getTarget()=vi_1619
			)
			and obj_1.getTarget().hasName("ext4_xattr_inode_lookup_create")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vhandle_1621
			and obj_1.getArgument(1).(VariableAccess).getTarget()=vinode_1621
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vnew_ea_inode_1629
	)
	and target_61.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_81
}

*/
/*predicate func_62(Variable vnew_ea_inode_1629, Variable vret_1631, LogicalAndExpr target_81, IfStmt target_62) {
	exists(FunctionCall obj_0 | obj_0=target_62.getCondition() |
		obj_0.getTarget().hasName("IS_ERR")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
	)
	and exists(BlockStmt obj_1 | obj_1=target_62.getThen() |
		exists(ExprStmt obj_2 | obj_2=obj_1.getStmt(0) |
			exists(AssignExpr obj_3 | obj_3=obj_2.getExpr() |
				exists(FunctionCall obj_4 | obj_4=obj_3.getRValue() |
					obj_4.getTarget().hasName("PTR_ERR")
					and obj_4.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
				)
				and obj_3.getLValue().(VariableAccess).getTarget()=vret_1631
			)
		)
		and exists(ExprStmt obj_5 | obj_5=obj_1.getStmt(1) |
			exists(AssignExpr obj_6 | obj_6=obj_5.getExpr() |
				obj_6.getLValue().(VariableAccess).getTarget()=vnew_ea_inode_1629
				and obj_6.getRValue().(Literal).getValue()="0"
			)
		)
		and obj_1.getStmt(2) instanceof GotoStmt
	)
	and target_62.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_81
}

*/
/*predicate func_63(Variable vnew_ea_inode_1629, Variable vret_1631, FunctionCall target_80, ExprStmt target_63) {
	exists(AssignExpr obj_0 | obj_0=target_63.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			obj_1.getTarget().hasName("PTR_ERR")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=vret_1631
	)
	and target_63.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_80
}

*/
/*predicate func_64(Variable vnew_ea_inode_1629, FunctionCall target_80, ExprStmt target_64) {
	exists(AssignExpr obj_0 | obj_0=target_64.getExpr() |
		obj_0.getLValue().(VariableAccess).getTarget()=vnew_ea_inode_1629
		and obj_0.getRValue().(Literal).getValue()="0"
	)
	and target_64.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_80
}

*/
predicate func_65(Variable vold_ea_inode_1628, Variable vnew_ea_inode_1629, Variable vret_1631, Function func, IfStmt target_65) {
	exists(BlockStmt obj_0 | obj_0=target_65.getThen() |
		exists(IfStmt obj_1 | obj_1=obj_0.getStmt(1) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getThen() |
				obj_2.getStmt(0).(IfStmt).getCondition().(VariableAccess).getTarget()=vnew_ea_inode_1629
				and obj_2.getStmt(1).(GotoStmt).getName() ="out"
			)
			and obj_1.getCondition().(VariableAccess).getTarget()=vret_1631
		)
		and obj_0.getStmt(0) instanceof ExprStmt
		and obj_0.getStmt(2) instanceof ExprStmt
	)
	and target_65.getCondition().(VariableAccess).getTarget()=vold_ea_inode_1628
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_65
}

/*predicate func_66(Parameter vhandle_1621, Parameter vinode_1621, Variable vnew_ea_inode_1629, Variable v__func__, Variable verr_1733, Parameter vi_1619, VariableAccess target_82, IfStmt target_66) {
	exists(BlockStmt obj_0 | obj_0=target_66.getThen() |
		exists(ExprStmt obj_1 | obj_1=obj_0.getStmt(1) |
			exists(AssignExpr obj_2 | obj_2=obj_1.getExpr() |
				exists(FunctionCall obj_3 | obj_3=obj_2.getRValue() |
					obj_3.getTarget().hasName("ext4_xattr_inode_dec_ref")
					and obj_3.getArgument(0).(VariableAccess).getTarget()=vhandle_1621
					and obj_3.getArgument(1).(VariableAccess).getTarget()=vnew_ea_inode_1629
				)
				and obj_2.getLValue().(VariableAccess).getTarget()=verr_1733
			)
		)
		and exists(IfStmt obj_4 | obj_4=obj_0.getStmt(2) |
			exists(ExprStmt obj_5 | obj_5=obj_4.getThen() |
				exists(FunctionCall obj_6 | obj_6=obj_5.getExpr() |
					obj_6.getTarget().hasName("__ext4_warning_inode")
					and obj_6.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
					and obj_6.getArgument(1).(VariableAccess).getTarget()=v__func__
					and obj_6.getArgument(2) instanceof Literal
					and obj_6.getArgument(3).(StringLiteral).getValue()="dec ref new_ea_inode err=%d"
					and obj_6.getArgument(4).(VariableAccess).getTarget()=verr_1733
				)
			)
			and obj_4.getCondition().(VariableAccess).getTarget()=verr_1733
		)
		and exists(ExprStmt obj_7 | obj_7=obj_0.getStmt(3) |
			exists(FunctionCall obj_8 | obj_8=obj_7.getExpr() |
				exists(PointerFieldAccess obj_9 | obj_9=obj_8.getArgument(2) |
					obj_9.getTarget().getName()="value_len"
					and obj_9.getQualifier().(VariableAccess).getTarget()=vi_1619
				)
				and obj_8.getTarget().hasName("ext4_xattr_inode_free_quota")
				and obj_8.getArgument(0).(VariableAccess).getTarget()=vinode_1621
				and obj_8.getArgument(1).(VariableAccess).getTarget()=vnew_ea_inode_1629
			)
		)
	)
	and target_66.getCondition().(VariableAccess).getTarget()=vnew_ea_inode_1629
	and target_66.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_82
}

*/
predicate func_67(VariableAccess target_83, Function func, DeclStmt target_67) {
	target_67.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_83
	and target_67.getEnclosingFunction() = func
}

/*predicate func_68(Parameter vhandle_1621, Variable vnew_ea_inode_1629, Variable verr_1733, VariableAccess target_83, ExprStmt target_68) {
	exists(AssignExpr obj_0 | obj_0=target_68.getExpr() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getRValue() |
			obj_1.getTarget().hasName("ext4_xattr_inode_dec_ref")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vhandle_1621
			and obj_1.getArgument(1).(VariableAccess).getTarget()=vnew_ea_inode_1629
		)
		and obj_0.getLValue().(VariableAccess).getTarget()=verr_1733
	)
	and target_68.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_83
}

*/
/*predicate func_69(Variable vnew_ea_inode_1629, Variable v__func__, Variable verr_1733, VariableAccess target_83, IfStmt target_69) {
	exists(ExprStmt obj_0 | obj_0=target_69.getThen() |
		exists(FunctionCall obj_1 | obj_1=obj_0.getExpr() |
			obj_1.getTarget().hasName("__ext4_warning_inode")
			and obj_1.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
			and obj_1.getArgument(1).(VariableAccess).getTarget()=v__func__
			and obj_1.getArgument(2) instanceof Literal
			and obj_1.getArgument(3).(StringLiteral).getValue()="dec ref new_ea_inode err=%d"
			and obj_1.getArgument(4).(VariableAccess).getTarget()=verr_1733
		)
	)
	and target_69.getCondition().(VariableAccess).getTarget()=verr_1733
	and target_69.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_83
}

*/
/*predicate func_70(Parameter vinode_1621, Variable vnew_ea_inode_1629, Parameter vi_1619, VariableAccess target_83, ExprStmt target_70) {
	exists(FunctionCall obj_0 | obj_0=target_70.getExpr() |
		exists(PointerFieldAccess obj_1 | obj_1=obj_0.getArgument(2) |
			obj_1.getTarget().getName()="value_len"
			and obj_1.getQualifier().(VariableAccess).getTarget()=vi_1619
		)
		and obj_0.getTarget().hasName("ext4_xattr_inode_free_quota")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vinode_1621
		and obj_0.getArgument(1).(VariableAccess).getTarget()=vnew_ea_inode_1629
	)
	and target_70.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_83
}

*/
/*predicate func_71(VariableAccess target_82, Function func, GotoStmt target_71) {
	target_71.getName() ="out"
	and target_71.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_82
	and target_71.getEnclosingFunction() = func
}

*/
predicate func_72(Variable vnew_ea_inode_1629, Function func, ExprStmt target_72) {
	exists(FunctionCall obj_0 | obj_0=target_72.getExpr() |
		obj_0.getTarget().hasName("iput")
		and obj_0.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
	)
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_72
}

predicate func_73(Variable v__flags_1716, DoStmt target_73) {
	exists(BlockStmt obj_0 | obj_0=target_73.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(2) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				exists(AsmStmt obj_3 | obj_3=obj_2.getStmt(0) |
					exists(SizeofTypeOperator obj_4 | obj_4=obj_3.getChild(3) |
						obj_4.getType() instanceof LongType
						and obj_4.getValue()="12"
					)
					and obj_3.getChild(0) instanceof StringLiteral
					and obj_3.getChild(1) instanceof Literal
					and obj_3.getChild(2).(VariableAccess).getTarget()=v__flags_1716
				)
			)
			and obj_1.getCondition() instanceof Literal
		)
		and obj_0.getStmt(1) instanceof ExprStmt
	)
	and target_73.getCondition() instanceof Literal
}

predicate func_74(Function func, DoStmt target_74) {
	exists(BlockStmt obj_0 | obj_0=target_74.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(2) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				obj_2.getStmt(1) instanceof ExprStmt
				and obj_2.getStmt(2).(DoStmt).getCondition() instanceof Literal
				and obj_2.getStmt(3) instanceof ExprStmt
			)
			and obj_1.getCondition() instanceof Literal
		)
		and obj_0.getStmt(0) instanceof ExprStmt
	)
	and target_74.getCondition() instanceof Literal
	and target_74.getEnclosingFunction() = func
}

predicate func_75(Function func, DoStmt target_75) {
	exists(BlockStmt obj_0 | obj_0=target_75.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(2) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				obj_2.getStmt(1) instanceof ExprStmt
				and obj_2.getStmt(2).(DoStmt).getCondition() instanceof Literal
				and obj_2.getStmt(3) instanceof ExprStmt
			)
			and obj_1.getCondition() instanceof Literal
		)
		and obj_0.getStmt(0) instanceof ExprStmt
	)
	and target_75.getCondition() instanceof Literal
	and target_75.getEnclosingFunction() = func
}

predicate func_76(Function func, DoStmt target_76) {
	exists(BlockStmt obj_0 | obj_0=target_76.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(2) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				obj_2.getStmt(1) instanceof ExprStmt
				and obj_2.getStmt(2).(DoStmt).getCondition() instanceof Literal
				and obj_2.getStmt(3) instanceof ExprStmt
			)
			and obj_1.getCondition() instanceof Literal
		)
		and obj_0.getStmt(0) instanceof ExprStmt
	)
	and target_76.getCondition() instanceof Literal
	and target_76.getEnclosingFunction() = func
}

predicate func_77(Function func, DoStmt target_77) {
	exists(BlockStmt obj_0 | obj_0=target_77.getStmt() |
		exists(DoStmt obj_1 | obj_1=obj_0.getStmt(2) |
			exists(BlockStmt obj_2 | obj_2=obj_1.getStmt() |
				obj_2.getStmt(1) instanceof ExprStmt
				and obj_2.getStmt(2).(DoStmt).getCondition() instanceof Literal
				and obj_2.getStmt(3) instanceof ExprStmt
			)
			and obj_1.getCondition() instanceof Literal
		)
		and obj_0.getStmt(0) instanceof ExprStmt
	)
	and target_77.getCondition() instanceof Literal
	and target_77.getEnclosingFunction() = func
}

predicate func_78(Function func, BlockStmt target_78) {
	target_78.getStmt(0) instanceof ExprStmt
	and target_78.getStmt(1) instanceof ExprStmt
	and target_78.getStmt(2) instanceof IfStmt
	and target_78.getEnclosingFunction() = func
}

predicate func_79(Variable vold_ea_inode_1628, BlockStmt target_84, VariableAccess target_79) {
	target_79.getTarget()=vold_ea_inode_1628
	and target_79.getParent().(IfStmt).getThen()=target_84
}

predicate func_80(Variable vnew_ea_inode_1629, FunctionCall target_80) {
	target_80.getTarget().hasName("IS_ERR")
	and target_80.getArgument(0).(VariableAccess).getTarget()=vnew_ea_inode_1629
}

predicate func_81(Variable vin_inode_1627, Parameter vi_1619, LogicalAndExpr target_81) {
	exists(PointerFieldAccess obj_0 | obj_0=target_81.getLeftOperand() |
		obj_0.getTarget().getName()="value"
		and obj_0.getQualifier().(VariableAccess).getTarget()=vi_1619
	)
	and target_81.getRightOperand().(VariableAccess).getTarget()=vin_inode_1627
}

predicate func_82(Variable vret_1631, BlockStmt target_85, VariableAccess target_82) {
	target_82.getTarget()=vret_1631
	and target_82.getParent().(IfStmt).getThen()=target_85
}

predicate func_83(Variable vnew_ea_inode_1629, BlockStmt target_86, VariableAccess target_83) {
	target_83.getTarget()=vnew_ea_inode_1629
	and target_83.getParent().(IfStmt).getThen()=target_86
}

predicate func_84(Variable vret_1631, BlockStmt target_84) {
	exists(IfStmt obj_0 | obj_0=target_84.getStmt(1) |
		obj_0.getCondition().(VariableAccess).getTarget()=vret_1631
		and obj_0.getThen() instanceof BlockStmt
	)
	and target_84.getStmt(0) instanceof ExprStmt
	and target_84.getStmt(2) instanceof ExprStmt
}

predicate func_85(Function func, BlockStmt target_85) {
	target_85.getStmt(0) instanceof IfStmt
	and target_85.getStmt(1) instanceof GotoStmt
	and target_85.getEnclosingFunction() = func
}

predicate func_86(Function func, BlockStmt target_86) {
	target_86.getStmt(1) instanceof ExprStmt
	and target_86.getStmt(2) instanceof IfStmt
	and target_86.getStmt(3) instanceof ExprStmt
	and target_86.getEnclosingFunction() = func
}

from Function func, Variable v__ret_warn_on_1759, Variable v__ret_warn_on_1780, Parameter vhandle_1621, Parameter vinode_1621, Variable vhere_1625, Variable vin_inode_1627, Variable vold_ea_inode_1628, Variable vnew_ea_inode_1629, Variable vret_1631, Variable v__func__, Variable v__ret_warn_on_1716, Variable v__flags_1716, Variable verr_1733, Parameter vi_1619, Variable v__ret_warn_on_1802, Variable v__ret_warn_on_1806, BitwiseOrExpr target_0, Literal target_1, Literal target_2, Literal target_3, Literal target_4, Literal target_5, Literal target_6, Literal target_7, Literal target_8, Literal target_9, Literal target_10, Literal target_11, Literal target_12, Literal target_13, Literal target_14, Literal target_15, Literal target_16, Literal target_17, Literal target_18, Literal target_19, Literal target_20, Literal target_21, Literal target_22, FunctionCall target_23, ExprStmt target_24, FunctionCall target_25, ExprStmt target_26, ExprStmt target_27, ExprStmt target_28, ExprStmt target_29, FunctionCall target_30, ExprStmt target_31, ExprStmt target_32, ExprStmt target_33, ExprStmt target_34, FunctionCall target_35, ExprStmt target_36, ExprStmt target_37, ExprStmt target_38, ExprStmt target_39, FunctionCall target_40, ExprStmt target_41, ExprStmt target_42, ExprStmt target_43, ExprStmt target_44, ExprStmt target_45, ExprStmt target_46, PointerFieldAccess target_47, ExprStmt target_48, ExprStmt target_49, ExprStmt target_50, ExprStmt target_51, ExprStmt target_52, ExprStmt target_53, ExprStmt target_54, GotoStmt target_55, DeclStmt target_56, IfStmt target_57, IfStmt target_65, DeclStmt target_67, ExprStmt target_72, DoStmt target_73, DoStmt target_74, DoStmt target_75, DoStmt target_76, DoStmt target_77, BlockStmt target_78, VariableAccess target_79, FunctionCall target_80, LogicalAndExpr target_81, VariableAccess target_82, VariableAccess target_83, BlockStmt target_84, BlockStmt target_85, BlockStmt target_86
where
func_0(func, target_0)
and func_1(func, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(func, target_5)
and func_6(func, target_6)
and func_7(func, target_7)
and func_8(func, target_8)
and func_9(func, target_9)
and func_10(func, target_10)
and func_11(func, target_11)
and func_12(func, target_12)
and func_13(func, target_13)
and func_14(func, target_14)
and func_15(func, target_15)
and func_16(func, target_16)
and func_17(func, target_17)
and func_18(func, target_18)
and func_19(func, target_19)
and func_20(func, target_20)
and func_21(func, target_21)
and func_22(func, target_22)
and func_23(v__ret_warn_on_1716, target_73, target_23)
and func_24(func, target_24)
and func_25(v__ret_warn_on_1759, target_74, target_25)
and func_26(func, target_26)
and func_27(func, target_27)
and func_28(func, target_28)
and func_29(func, target_29)
and func_30(v__ret_warn_on_1780, target_75, target_30)
and func_31(func, target_31)
and func_32(func, target_32)
and func_33(func, target_33)
and func_34(func, target_34)
and func_35(v__ret_warn_on_1802, target_76, target_35)
and func_36(func, target_36)
and func_37(func, target_37)
and func_38(func, target_38)
and func_39(func, target_39)
and func_40(v__ret_warn_on_1806, target_77, target_40)
and func_41(func, target_41)
and func_42(func, target_42)
and func_43(func, target_43)
and func_44(func, target_44)
and func_45(func, target_45)
and func_46(func, target_46)
and func_47(vin_inode_1627, vi_1619, target_78, target_47)
and func_48(v__ret_warn_on_1716, target_48)
and func_49(vhandle_1621, vold_ea_inode_1628, vret_1631, target_79, target_49)
and func_50(vinode_1621, vhere_1625, vold_ea_inode_1628, target_79, target_50)
and func_51(v__ret_warn_on_1759, target_51)
and func_52(v__ret_warn_on_1780, target_52)
and func_53(v__ret_warn_on_1802, target_53)
and func_54(v__ret_warn_on_1806, target_54)
and func_55(target_80, func, target_55)
and func_56(func, target_56)
and func_57(vhandle_1621, vinode_1621, vin_inode_1627, vnew_ea_inode_1629, vret_1631, vi_1619, func, target_57)
and func_65(vold_ea_inode_1628, vnew_ea_inode_1629, vret_1631, func, target_65)
and func_67(target_83, func, target_67)
and func_72(vnew_ea_inode_1629, func, target_72)
and func_73(v__flags_1716, target_73)
and func_74(func, target_74)
and func_75(func, target_75)
and func_76(func, target_76)
and func_77(func, target_77)
and func_78(func, target_78)
and func_79(vold_ea_inode_1628, target_84, target_79)
and func_80(vnew_ea_inode_1629, target_80)
and func_81(vin_inode_1627, vi_1619, target_81)
and func_82(vret_1631, target_85, target_82)
and func_83(vnew_ea_inode_1629, target_86, target_83)
and func_84(vret_1631, target_84)
and func_85(func, target_85)
and func_86(func, target_86)
and v__ret_warn_on_1759.getType().hasName("int")
and v__ret_warn_on_1780.getType().hasName("int")
and vhandle_1621.getType().hasName("handle_t *")
and vinode_1621.getType().hasName("inode *")
and vhere_1625.getType().hasName("ext4_xattr_entry *")
and vin_inode_1627.getType().hasName("int")
and vold_ea_inode_1628.getType().hasName("inode *")
and vnew_ea_inode_1629.getType().hasName("inode *")
and vret_1631.getType().hasName("int")
and v__func__.getType() instanceof ArrayType
and v__ret_warn_on_1716.getType().hasName("int")
and v__flags_1716.getType().hasName("int")
and verr_1733.getType().hasName("int")
and vi_1619.getType().hasName("ext4_xattr_info *")
and v__ret_warn_on_1802.getType().hasName("int")
and v__ret_warn_on_1806.getType().hasName("int")
and v__ret_warn_on_1759.(LocalVariable).getFunction() = func
and v__ret_warn_on_1780.(LocalVariable).getFunction() = func
and vhandle_1621.getFunction() = func
and vinode_1621.getFunction() = func
and vhere_1625.(LocalVariable).getFunction() = func
and vin_inode_1627.(LocalVariable).getFunction() = func
and vold_ea_inode_1628.(LocalVariable).getFunction() = func
and vnew_ea_inode_1629.(LocalVariable).getFunction() = func
and vret_1631.(LocalVariable).getFunction() = func
and not v__func__.getParentScope+() = func
and v__ret_warn_on_1716.(LocalVariable).getFunction() = func
and v__flags_1716.(LocalVariable).getFunction() = func
and verr_1733.(LocalVariable).getFunction() = func
and vi_1619.getFunction() = func
and v__ret_warn_on_1802.(LocalVariable).getFunction() = func
and v__ret_warn_on_1806.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
