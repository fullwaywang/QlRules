/**
 * @name linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-do_ip_setsockopt
 * @id cpp/linux/f6d8bd051c391c1c0458a30b2a7abcd939329259/do-ip-setsockopt
 * @description linux-f6d8bd051c391c1c0458a30b2a7abcd939329259-net/ipv4/ip_sockglue.c-do_ip_setsockopt CVE-2012-3552
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_1(Function func, Literal target_1) {
		target_1.getValue()="1"
		and not target_1.getValue()="0"
		and target_1.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(0) instanceof SwitchCase
		and target_1.getEnclosingFunction() = func
}

predicate func_2(Function func, Literal target_2) {
		target_2.getValue()="2"
		and not target_2.getValue()="514"
		and target_2.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(2) instanceof SwitchCase
		and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
		target_3.getValue()="4"
		and not target_3.getValue()="0"
		and target_3.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(4) instanceof SwitchCase
		and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, FunctionCall target_4) {
		target_4.getTarget().hasName("__xchg_wrong_size")
		and not target_4.getTarget().hasName("lockdep_rcu_dereference")
		and target_4.getEnclosingFunction() = func
}

predicate func_5(Variable vopt_500, FunctionCall target_5) {
		target_5.getTarget().hasName("kfree")
		and not target_5.getTarget().hasName("call_rcu_sched")
		and target_5.getArgument(0).(VariableAccess).getTarget()=vopt_500
}

predicate func_7(Variable vinet_462, ValueFieldAccess target_56, ExprStmt target_57) {
	exists(AssignExpr target_7 |
		target_7.getLValue().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_7.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
		and target_7.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_7.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_56.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_7.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_7.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_57.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_8(Function func) {
	exists(DoStmt target_8 |
		target_8.getCondition() instanceof Literal
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="owned"
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_lock"
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("bool")
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_dereference")
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_8.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_8.getEnclosingFunction() = func)
}

*/
/*predicate func_10(Parameter vsk_459, BlockStmt target_58, FunctionCall target_59, LogicalOrExpr target_24) {
	exists(LogicalAndExpr target_10 |
		target_10.getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_10.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getType().hasName("bool")
		and target_10.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="owned"
		and target_10.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk_lock"
		and target_10.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_459
		and target_10.getParent().(IfStmt).getThen()=target_58
		and target_59.getArgument(0).(VariableAccess).getLocation().isBefore(target_10.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_10.getAnOperand().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
/*predicate func_11(Function func) {
	exists(AssignExpr target_11 |
		target_11.getLValue().(VariableAccess).getType().hasName("bool")
		and target_11.getEnclosingFunction() = func)
}

*/
/*predicate func_13(Variable vinet_462, ValueFieldAccess target_56, ExprStmt target_57) {
	exists(ExprStmt target_13 |
		target_13.getExpr().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_13.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_56.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_13.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_13.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_57.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_15(Function func) {
	exists(ValueFieldAccess target_15 |
		target_15.getTarget().getName()="optlen"
		and target_15.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_15.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_15.getEnclosingFunction() = func)
}

predicate func_16(Variable vopt_500, Variable vicsk_508, LogicalOrExpr target_24, AddressOfExpr target_60, ExprStmt target_61, ExprStmt target_57, ExprStmt target_62) {
	exists(IfStmt target_16 |
		target_16.getCondition().(VariableAccess).getTarget()=vopt_500
		and target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(ValueFieldAccess).getTarget().getName()="optlen"
		and target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
		and target_16.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(1)=target_16
		and target_16.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_24
		and target_60.getOperand().(VariableAccess).getLocation().isBefore(target_16.getCondition().(VariableAccess).getLocation())
		and target_16.getCondition().(VariableAccess).getLocation().isBefore(target_61.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_57.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_16.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_62.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_17(Variable vopt_500, IfStmt target_63, ExprStmt target_61) {
	exists(ValueFieldAccess target_17 |
		target_17.getTarget().getName()="optlen"
		and target_17.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_17.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
		and target_63.getCondition().(VariableAccess).getLocation().isBefore(target_17.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
		and target_17.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_61.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_18(Variable vinet_462, Variable vopt_500, IfStmt target_64) {
	exists(StmtExpr target_18 |
		target_18.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("__builtin_constant_p")
		and target_18.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vopt_500
		and target_18.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vopt_500
		and target_18.getStmt().(BlockStmt).getStmt(0).(IfStmt).getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_18.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_18.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_18.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_500
		and target_64.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_18.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

/*predicate func_19(Variable vopt_500) {
	exists(IfStmt target_19 |
		target_19.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getTarget().hasName("__builtin_constant_p")
		and target_19.getCondition().(LogicalOrExpr).getAnOperand().(NotExpr).getOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vopt_500
		and target_19.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vopt_500
		and target_19.getCondition().(LogicalOrExpr).getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0")
}

*/
/*predicate func_20(Variable vinet_462, Variable vopt_500, IfStmt target_64) {
	exists(ExprStmt target_20 |
		target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="inet_opt"
		and target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_20.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vopt_500
		and target_64.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_20.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

*/
predicate func_21(Function func) {
	exists(IfStmt target_21 |
		target_21.getCondition().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_21.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("call_rcu_sched")
		and target_21.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
		and target_21.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_21.getEnclosingFunction() = func)
}

/*predicate func_22(Function func) {
	exists(AddressOfExpr target_22 |
		target_22.getOperand().(PointerFieldAccess).getTarget().getName()="rcu"
		and target_22.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ip_options_rcu *")
		and target_22.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
		and target_22.getEnclosingFunction() = func)
}

*/
predicate func_24(Variable vinet_462, Parameter vsk_459, BlockStmt target_58, LogicalOrExpr target_24) {
		target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="skc_family"
		and target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
		and target_24.getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_459
		and target_24.getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="2"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getLeftOperand().(Literal).getValue()="1"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getTarget().getName()="skc_state"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(BinaryBitwiseOperation).getRightOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="1152"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="skc_daddr"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="__sk_common"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ConditionalExpr).getCondition().(Literal).getValue()="1"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ConditionalExpr).getThen().(BitwiseOrExpr).getValue()="100663423"
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("__fswab32")
		and target_24.getAnOperand().(LogicalAndExpr).getAnOperand().(EqualityOperation).getAnOperand().(ConditionalExpr).getElse().(FunctionCall).getArgument(0).(Literal).getValue()="2130706438"
		and target_24.getParent().(IfStmt).getThen()=target_58
}

predicate func_25(Variable vinet_462, ExprStmt target_57, VariableAccess target_25) {
		target_25.getTarget()=vinet_462
		and target_25.getParent().(PointerFieldAccess).getParent().(IfStmt).getThen()=target_57
}

predicate func_26(Variable vinet_462, VariableAccess target_26) {
		target_26.getTarget()=vinet_462
}

predicate func_29(Variable vinet_462, ValueFieldAccess target_56, ExprStmt target_57, PointerFieldAccess target_29) {
		target_29.getTarget().getName()="opt"
		and target_29.getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_56.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_29.getQualifier().(VariableAccess).getLocation())
		and target_29.getQualifier().(VariableAccess).getLocation().isBefore(target_57.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

predicate func_30(Variable vinet_462, PointerFieldAccess target_30) {
		target_30.getTarget().getName()="optlen"
		and target_30.getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_30.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_31(Variable vopt_500, ExprStmt target_61, VariableAccess target_31) {
		target_31.getTarget()=vopt_500
		and target_31.getParent().(IfStmt).getThen()=target_61
}

predicate func_32(Variable vopt_500, PointerFieldAccess target_32) {
		target_32.getTarget().getName()="optlen"
		and target_32.getQualifier().(VariableAccess).getTarget()=vopt_500
}

predicate func_33(Variable vopt_500, Variable v__x_524, AssignExpr target_33) {
		target_33.getLValue().(VariableAccess).getTarget()=vopt_500
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getExpr().(SizeofExprOperator).getValue()="8"
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr() instanceof Literal
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof Literal
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(2) instanceof BreakStmt
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="8"
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(8).(SwitchCase).toString() = "default: "
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(SwitchStmt).getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr() instanceof FunctionCall
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2) instanceof LabelStmt
		and target_33.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(VariableAccess).getTarget()=v__x_524
}

/*predicate func_35(Variable v__x_524, Variable v__ptr_524, Variable v__ptr_1_524, Variable v__ptr_2_524, Variable v__ptr_3_524, SwitchStmt target_35) {
		target_35.getExpr().(SizeofExprOperator).getValue()="8"
		and target_35.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
		and target_35.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_524
		and target_35.getStmt().(BlockStmt).getStmt(1).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(2).(SwitchCase).getExpr() instanceof Literal
		and target_35.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1_524
		and target_35.getStmt().(BlockStmt).getStmt(3).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(4).(SwitchCase).getExpr() instanceof Literal
		and target_35.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_2_524
		and target_35.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(5).(BlockStmt).getStmt(2) instanceof BreakStmt
		and target_35.getStmt().(BlockStmt).getStmt(6).(SwitchCase).getExpr().(Literal).getValue()="8"
		and target_35.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_3_524
		and target_35.getStmt().(BlockStmt).getStmt(7).(BlockStmt).getStmt(1).(AsmStmt).getChild(2).(VariableAccess).getTarget()=v__x_524
		and target_35.getStmt().(BlockStmt).getStmt(8).(SwitchCase).toString() = "default: "
		and target_35.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr() instanceof FunctionCall
}

*/
/*predicate func_36(Function func, SwitchCase target_36) {
		target_36.getExpr() instanceof Literal
		and target_36.getEnclosingFunction() = func
}

*/
/*predicate func_38(Variable v__x_524, VariableAccess target_38) {
		target_38.getTarget()=v__x_524
}

*/
/*predicate func_39(Variable v__ptr_524, PointerDereferenceExpr target_39) {
		target_39.getOperand().(VariableAccess).getTarget()=v__ptr_524
}

*/
/*predicate func_40(Variable v__x_524, VariableAccess target_40) {
		target_40.getTarget()=v__x_524
}

*/
/*predicate func_42(Function func, SwitchCase target_42) {
		target_42.getExpr() instanceof Literal
		and target_42.getEnclosingFunction() = func
}

*/
/*predicate func_44(Variable v__x_524, Variable v__ptr_1_524, AsmStmt target_44) {
		target_44.getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_44.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_1_524
		and target_44.getChild(2).(VariableAccess).getTarget()=v__x_524
}

*/
/*predicate func_46(Function func, SwitchCase target_46) {
		target_46.getExpr() instanceof Literal
		and target_46.getEnclosingFunction() = func
}

*/
/*predicate func_48(Variable v__x_524, Variable v__ptr_2_524, AsmStmt target_48) {
		target_48.getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_48.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_2_524
		and target_48.getChild(2).(VariableAccess).getTarget()=v__x_524
}

*/
/*predicate func_49(Function func, SwitchCase target_49) {
		target_49.getExpr().(Literal).getValue()="8"
		and target_49.getEnclosingFunction() = func
}

*/
/*predicate func_51(Variable v__x_524, Variable v__ptr_3_524, AsmStmt target_51) {
		target_51.getChild(0).(VariableAccess).getTarget()=v__x_524
		and target_51.getChild(1).(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=v__ptr_3_524
		and target_51.getChild(2).(VariableAccess).getTarget()=v__x_524
}

*/
/*predicate func_53(Function func, SwitchCase target_53) {
		target_53.toString() = "default: "
		and target_53.getEnclosingFunction() = func
}

*/
/*predicate func_54(Variable v__x_524, VariableAccess target_54) {
		target_54.getTarget()=v__x_524
}

*/
predicate func_55(VariableAccess target_69, Function func, BreakStmt target_55) {
		target_55.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_69
		and target_55.getEnclosingFunction() = func
}

predicate func_56(Variable vinet_462, ValueFieldAccess target_56) {
		target_56.getTarget().getName()="__sk_common"
		and target_56.getQualifier().(PointerFieldAccess).getTarget().getName()="sk"
		and target_56.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_57(Variable vinet_462, Variable vicsk_508, ExprStmt target_57) {
		target_57.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_57.getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_57.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_57.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_57.getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_58(Variable vinet_462, Variable vicsk_508, BlockStmt target_58) {
		target_58.getStmt(0).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="opt"
		and target_58.getStmt(0).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_58.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_58.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_58.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_58.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_58.getStmt(0).(IfStmt).getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_59(Parameter vsk_459, FunctionCall target_59) {
		target_59.getTarget().hasName("inet_csk")
		and target_59.getArgument(0).(VariableAccess).getTarget()=vsk_459
}

predicate func_60(Variable vopt_500, AddressOfExpr target_60) {
		target_60.getOperand().(VariableAccess).getTarget()=vopt_500
}

predicate func_61(Variable vopt_500, Variable vicsk_508, ExprStmt target_61) {
		target_61.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_61.getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_61.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_61.getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
}

predicate func_62(Parameter vsk_459, Variable vicsk_508, ExprStmt target_62) {
		target_62.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="icsk_sync_mss"
		and target_62.getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_62.getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vsk_459
		and target_62.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="icsk_pmtu_cookie"
		and target_62.getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
}

predicate func_63(Variable vopt_500, Variable vicsk_508, IfStmt target_63) {
		target_63.getCondition().(VariableAccess).getTarget()=vopt_500
		and target_63.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_63.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_63.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_63.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vopt_500
}

predicate func_64(Variable vinet_462, Variable vicsk_508, IfStmt target_64) {
		target_64.getCondition().(PointerFieldAccess).getTarget().getName()="opt"
		and target_64.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
		and target_64.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getTarget().getName()="icsk_ext_hdr_len"
		and target_64.getThen().(ExprStmt).getExpr().(AssignSubExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vicsk_508
		and target_64.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getTarget().getName()="optlen"
		and target_64.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="opt"
		and target_64.getThen().(ExprStmt).getExpr().(AssignSubExpr).getRValue().(PointerFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vinet_462
}

predicate func_69(Parameter voptname_460, VariableAccess target_69) {
		target_69.getTarget()=voptname_460
}

from Function func, Parameter voptname_460, Variable vinet_462, Parameter vsk_459, Variable vopt_500, Variable vicsk_508, Variable v__x_524, Variable v__ptr_524, Variable v__ptr_1_524, Variable v__ptr_2_524, Variable v__ptr_3_524, Literal target_1, Literal target_2, Literal target_3, FunctionCall target_4, FunctionCall target_5, LogicalOrExpr target_24, VariableAccess target_25, VariableAccess target_26, PointerFieldAccess target_29, PointerFieldAccess target_30, VariableAccess target_31, PointerFieldAccess target_32, AssignExpr target_33, BreakStmt target_55, ValueFieldAccess target_56, ExprStmt target_57, BlockStmt target_58, FunctionCall target_59, AddressOfExpr target_60, ExprStmt target_61, ExprStmt target_62, IfStmt target_63, IfStmt target_64, VariableAccess target_69
where
func_1(func, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and func_5(vopt_500, target_5)
and not func_7(vinet_462, target_56, target_57)
and not func_15(func)
and not func_16(vopt_500, vicsk_508, target_24, target_60, target_61, target_57, target_62)
and not func_18(vinet_462, vopt_500, target_64)
and not func_21(func)
and func_24(vinet_462, vsk_459, target_58, target_24)
and func_25(vinet_462, target_57, target_25)
and func_26(vinet_462, target_26)
and func_29(vinet_462, target_56, target_57, target_29)
and func_30(vinet_462, target_30)
and func_31(vopt_500, target_61, target_31)
and func_32(vopt_500, target_32)
and func_33(vopt_500, v__x_524, target_33)
and func_55(target_69, func, target_55)
and func_56(vinet_462, target_56)
and func_57(vinet_462, vicsk_508, target_57)
and func_58(vinet_462, vicsk_508, target_58)
and func_59(vsk_459, target_59)
and func_60(vopt_500, target_60)
and func_61(vopt_500, vicsk_508, target_61)
and func_62(vsk_459, vicsk_508, target_62)
and func_63(vopt_500, vicsk_508, target_63)
and func_64(vinet_462, vicsk_508, target_64)
and func_69(voptname_460, target_69)
and voptname_460.getType().hasName("int")
and vinet_462.getType().hasName("inet_sock *")
and vsk_459.getType().hasName("sock *")
and vopt_500.getType().hasName("ip_options *")
and vicsk_508.getType().hasName("inet_connection_sock *")
and v__x_524.getType().hasName("ip_options *")
and v__ptr_524.getType().hasName("volatile u8 *")
and v__ptr_1_524.getType().hasName("volatile u16 *")
and v__ptr_2_524.getType().hasName("volatile u32 *")
and v__ptr_3_524.getType().hasName("volatile u64 *")
and voptname_460.getFunction() = func
and vinet_462.(LocalVariable).getFunction() = func
and vsk_459.getFunction() = func
and vopt_500.(LocalVariable).getFunction() = func
and vicsk_508.(LocalVariable).getFunction() = func
and v__x_524.(LocalVariable).getFunction() = func
and v__ptr_524.(LocalVariable).getFunction() = func
and v__ptr_1_524.(LocalVariable).getFunction() = func
and v__ptr_2_524.(LocalVariable).getFunction() = func
and v__ptr_3_524.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
