/**
 * @name linux-973c096f6a85e5b5f2a295126ba6928d9a6afd45-vgacon_scrolldelta
 * @id cpp/linux/973c096f6a85e5b5f2a295126ba6928d9a6afd45/vgacon-scrolldelta
 * @description linux-973c096f6a85e5b5f2a295126ba6928d9a6afd45-drivers/video/console/vgacon.c-vgacon_scrolldelta CVE-2020-28097
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vc_290, FunctionCall target_0) {
	target_0.getTarget().hasName("vgacon_restore_screen")
	and not target_0.getTarget().hasName("vga_set_mem_top")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vc_290
}

predicate func_1(Parameter vc_290, FunctionCall target_1) {
	target_1.getTarget().hasName("vgacon_cursor")
	and not target_1.getTarget().hasName("vc_scrolldelta_helper")
	and target_1.getArgument(0).(VariableAccess).getTarget()=vc_290
	and target_1.getArgument(1).(Literal).getValue()="2"
}

predicate func_5(Parameter vlines_290, BlockStmt target_58, VariableAccess target_5) {
	target_5.getTarget()=vlines_290
	and target_5.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_58
}

predicate func_6(NotExpr target_59, Function func, ReturnStmt target_6) {
	target_6.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_59
	and target_6.getEnclosingFunction() = func
}

predicate func_7(Function func, DeclStmt target_7) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_7
}

predicate func_8(Parameter vlines_290, Function func, IfStmt target_8) {
	target_8.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vlines_290
	and target_8.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_8.getThen().(BlockStmt).getStmt(1) instanceof ReturnStmt
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_8
}

predicate func_9(Variable vvgacon_scrollback_cur, Function func, IfStmt target_9) {
	target_9.getCondition().(NotExpr).getOperand().(PointerFieldAccess).getTarget().getName()="data"
	and target_9.getCondition().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_9
}

predicate func_10(Variable vvgacon_scrollback_cur, Parameter vc_290, Function func, IfStmt target_10) {
	target_10.getCondition().(NotExpr).getOperand().(PointerFieldAccess).getTarget().getName()="save"
	and target_10.getCondition().(NotExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_10.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_10.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vgacon_save_screen")
	and target_10.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vc_290
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vc_origin"
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="vc_screenbuf"
	and target_10.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_10.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="save"
	and target_10.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_10.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_10
}

/*predicate func_11(Parameter vc_290, NotExpr target_60, ExprStmt target_11) {
	target_11.getExpr().(FunctionCall).getTarget().hasName("vgacon_save_screen")
	and target_11.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vc_290
	and target_11.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_60
}

*/
/*predicate func_12(Parameter vc_290, NotExpr target_60, ExprStmt target_12) {
	target_12.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vc_origin"
	and target_12.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_12.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="vc_screenbuf"
	and target_12.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_60
}

*/
/*predicate func_13(Variable vvgacon_scrollback_cur, NotExpr target_60, ExprStmt target_13) {
	target_13.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="save"
	and target_13.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_13.getExpr().(AssignExpr).getRValue().(Literal).getValue()="1"
	and target_13.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_60
}

*/
predicate func_14(Variable vvgacon_scrollback_cur, Function func, ExprStmt target_14) {
	target_14.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="restore"
	and target_14.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_14.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_14
}

predicate func_15(Parameter vlines_290, Variable vstart_292, Variable vvgacon_scrollback_cur, Function func, ExprStmt target_15) {
	target_15.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstart_292
	and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="cur"
	and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_15.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(VariableAccess).getTarget()=vlines_290
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
}

predicate func_16(Variable vstart_292, Variable vend_292, Function func, ExprStmt target_16) {
	target_16.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_292
	and target_16.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vstart_292
	and target_16.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(BuiltInChooseExpr).getChild(0).(LogicalOrExpr).getValue()="0"
	and target_16.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(BuiltInChooseExpr).getChild(2).(BuiltInChooseExpr).getChild(0).(LogicalOrExpr).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

/*predicate func_18(Variable v__x_311, ExprStmt target_18) {
	target_18.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__x_311
	and target_18.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_18.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getOperand().(VariableAccess).getTarget()=v__x_311
	and target_18.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__x_311
}

*/
/*predicate func_20(Variable v__x_1_311, ExprStmt target_20) {
	target_20.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__x_1_311
	and target_20.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_20.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getOperand().(VariableAccess).getTarget()=v__x_1_311
	and target_20.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__x_1_311
}

*/
/*predicate func_22(Variable v__x_2_311, ExprStmt target_22) {
	target_22.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__x_2_311
	and target_22.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_22.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getOperand().(VariableAccess).getTarget()=v__x_2_311
	and target_22.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__x_2_311
}

*/
/*predicate func_24(Variable v__x_3_311, ExprStmt target_24) {
	target_24.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__x_3_311
	and target_24.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_24.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getOperand().(VariableAccess).getTarget()=v__x_3_311
	and target_24.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__x_3_311
}

*/
/*predicate func_26(Variable v__x_4_311, ExprStmt target_26) {
	target_26.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__x_4_311
	and target_26.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_26.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getOperand().(VariableAccess).getTarget()=v__x_4_311
	and target_26.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__x_4_311
}

*/
/*predicate func_28(Variable v__x_5_311, ExprStmt target_28) {
	target_28.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__x_5_311
	and target_28.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_28.getExpr().(ConditionalExpr).getThen().(UnaryMinusExpr).getOperand().(VariableAccess).getTarget()=v__x_5_311
	and target_28.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__x_5_311
}

*/
predicate func_29(Variable vstart_292, Function func, IfStmt target_29) {
	target_29.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vstart_292
	and target_29.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_29.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstart_292
	and target_29.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
}

predicate func_30(Variable vstart_292, Variable vvgacon_scrollback_cur, Function func, IfStmt target_30) {
	target_30.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vstart_292
	and target_30.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="cnt"
	and target_30.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_30.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vstart_292
	and target_30.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="cnt"
	and target_30.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_30
}

predicate func_31(Variable vend_292, Function func, IfStmt target_31) {
	target_31.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vend_292
	and target_31.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_31.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_292
	and target_31.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_31
}

predicate func_32(Variable vend_292, Variable vvgacon_scrollback_cur, Function func, IfStmt target_32) {
	target_32.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vend_292
	and target_32.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="cnt"
	and target_32.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_32.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vend_292
	and target_32.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="cnt"
	and target_32.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_32
}

predicate func_33(Variable vstart_292, Variable vvgacon_scrollback_cur, Function func, ExprStmt target_33) {
	target_33.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="cur"
	and target_33.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_33.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vstart_292
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_33
}

predicate func_34(Variable vstart_292, Variable vend_292, Variable vcount_292, Function func, ExprStmt target_34) {
	target_34.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_34.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vend_292
	and target_34.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vstart_292
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_34
}

predicate func_35(Variable vend_292, Variable vsoff_292, Variable vvgacon_scrollback_cur, Parameter vc_290, Function func, ExprStmt target_35) {
	target_35.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsoff_292
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="tail"
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(MulExpr).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="cnt"
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(MulExpr).getLeftOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(MulExpr).getLeftOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vend_292
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(MulExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vc_size_row"
	and target_35.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(MulExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
}

predicate func_36(Variable vcount_292, Variable vsoff_292, Parameter vc_290, Function func, ExprStmt target_36) {
	target_36.getExpr().(AssignSubExpr).getLValue().(VariableAccess).getTarget()=vsoff_292
	and target_36.getExpr().(AssignSubExpr).getRValue().(MulExpr).getLeftOperand().(VariableAccess).getTarget()=vcount_292
	and target_36.getExpr().(AssignSubExpr).getRValue().(MulExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vc_size_row"
	and target_36.getExpr().(AssignSubExpr).getRValue().(MulExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
}

predicate func_37(Variable vsoff_292, Variable vvgacon_scrollback_cur, Function func, IfStmt target_37) {
	target_37.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vsoff_292
	and target_37.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getLValue().(VariableAccess).getTarget()=vsoff_292
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getTarget().getName()="size"
	and target_37.getThen().(ExprStmt).getExpr().(AssignAddExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_37
}

predicate func_38(Variable vstart_292, Variable vcount_292, Variable vvgacon_scrollback_cur, Function func, ExprStmt target_38) {
	target_38.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_38.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="cnt"
	and target_38.getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_38.getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vstart_292
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

predicate func_39(Variable vcount_292, Parameter vc_290, Function func, IfStmt target_39) {
	target_39.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vcount_292
	and target_39.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getTarget().getName()="vc_rows"
	and target_39.getCondition().(RelationalOperation).getLesserOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_39.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_39.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="vc_rows"
	and target_39.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_39
}

predicate func_40(Variable vcount_292, Variable vsoff_292, Variable vvgacon_scrollback_cur, Variable vcopysize_340, Variable vdiff_342, Variable vd_343, Variable vs_344, Parameter vc_290, Function func, IfStmt target_40) {
	target_40.getCondition().(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignMulExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignMulExpr).getRValue().(PointerFieldAccess).getTarget().getName()="vc_size_row"
	and target_40.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignMulExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_40.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopysize_340
	and target_40.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_40.getThen().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_40.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_40.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="data"
	and target_40.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_40.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vsoff_292
	and target_40.getThen().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vcopysize_340
	and target_40.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getTarget()=vd_343
	and target_40.getThen().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vcopysize_340
	and target_40.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignSubExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(8).(ExprStmt).getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vcopysize_340
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getCondition().(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getTarget()=vd_343
	and target_40.getThen().(BlockStmt).getStmt(9).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vcount_292
	and target_40.getThen().(BlockStmt).getStmt(10).(IfStmt).getCondition().(VariableAccess).getTarget()=vdiff_342
	and target_40.getThen().(BlockStmt).getStmt(10).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_40.getThen().(BlockStmt).getStmt(10).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_40.getThen().(BlockStmt).getStmt(10).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vs_344
	and target_40.getThen().(BlockStmt).getStmt(10).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(VariableAccess).getTarget()=vdiff_342
	and target_40.getThen().(BlockStmt).getStmt(10).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vc_size_row"
	and target_40.getElse().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vgacon_cursor")
	and target_40.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vc_290
	and target_40.getElse().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(Literal).getValue()="3"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_40
}

predicate func_41(VariableAccess target_61, Function func, DeclStmt target_41) {
	target_41.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
	and target_41.getEnclosingFunction() = func
}

predicate func_42(VariableAccess target_61, Function func, DeclStmt target_42) {
	target_42.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
	and target_42.getEnclosingFunction() = func
}

predicate func_43(VariableAccess target_61, Function func, DeclStmt target_43) {
	target_43.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
	and target_43.getEnclosingFunction() = func
}

predicate func_44(VariableAccess target_61, Function func, DeclStmt target_44) {
	target_44.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
	and target_44.getEnclosingFunction() = func
}

/*predicate func_45(Variable vcount_292, Parameter vc_290, VariableAccess target_61, ExprStmt target_45) {
	target_45.getExpr().(AssignMulExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_45.getExpr().(AssignMulExpr).getRValue().(PointerFieldAccess).getTarget().getName()="vc_size_row"
	and target_45.getExpr().(AssignMulExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_45.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_46(Variable vcount_292, Variable vsoff_292, Variable vvgacon_scrollback_cur, Variable vcopysize_340, VariableAccess target_61, ExprStmt target_46) {
	target_46.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopysize_340
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(0).(LogicalAndExpr).getValue()="0"
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vcount_292
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="size"
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vsoff_292
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getThen().(VariableAccess).getTarget()=vcount_292
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(SubExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="size"
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(SubExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_46.getExpr().(AssignExpr).getRValue().(BuiltInChooseExpr).getChild(1).(ConditionalExpr).getElse().(SubExpr).getRightOperand().(VariableAccess).getTarget()=vsoff_292
	and target_46.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_49(Variable v__UNIQUE_ID___x1026_348, Variable v__UNIQUE_ID___y1027_348, ExprStmt target_49) {
	target_49.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=v__UNIQUE_ID___x1026_348
	and target_49.getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=v__UNIQUE_ID___y1027_348
	and target_49.getExpr().(ConditionalExpr).getThen().(VariableAccess).getTarget()=v__UNIQUE_ID___x1026_348
	and target_49.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=v__UNIQUE_ID___y1027_348
}

*/
/*predicate func_50(Variable vsoff_292, Variable vvgacon_scrollback_cur, Variable vcopysize_340, Variable vd_343, VariableAccess target_61, ExprStmt target_50) {
	target_50.getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_50.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_50.getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getTarget().getName()="data"
	and target_50.getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_50.getExpr().(FunctionCall).getArgument(1).(PointerArithmeticOperation).getRightOperand().(VariableAccess).getTarget()=vsoff_292
	and target_50.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vcopysize_340
	and target_50.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_51(Variable vcopysize_340, Variable vd_343, VariableAccess target_61, ExprStmt target_51) {
	target_51.getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getTarget()=vd_343
	and target_51.getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vcopysize_340
	and target_51.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_52(Variable vcount_292, Variable vcopysize_340, VariableAccess target_61, ExprStmt target_52) {
	target_52.getExpr().(AssignSubExpr).getLValue().(VariableAccess).getTarget()=vcount_292
	and target_52.getExpr().(AssignSubExpr).getRValue().(VariableAccess).getTarget()=vcopysize_340
	and target_52.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_53(Variable vcount_292, Variable vvgacon_scrollback_cur, Variable vd_343, VariableAccess target_61, IfStmt target_53) {
	target_53.getCondition().(VariableAccess).getTarget()=vcount_292
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_53.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vcount_292
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getTarget()=vd_343
	and target_53.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vcount_292
	and target_53.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_54(Variable vcount_292, Variable vvgacon_scrollback_cur, Variable vd_343, VariableAccess target_62, ExprStmt target_54) {
	target_54.getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_54.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_54.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="data"
	and target_54.getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
	and target_54.getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vcount_292
	and target_54.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_62
}

*/
/*predicate func_55(Variable vcount_292, Variable vd_343, VariableAccess target_62, ExprStmt target_55) {
	target_55.getExpr().(AssignPointerAddExpr).getLValue().(VariableAccess).getTarget()=vd_343
	and target_55.getExpr().(AssignPointerAddExpr).getRValue().(VariableAccess).getTarget()=vcount_292
	and target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_62
}

*/
/*predicate func_56(Variable vdiff_342, Variable vd_343, Variable vs_344, Parameter vc_290, VariableAccess target_61, IfStmt target_56) {
	target_56.getCondition().(VariableAccess).getTarget()=vdiff_342
	and target_56.getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("scr_memcpyw")
	and target_56.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vd_343
	and target_56.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vs_344
	and target_56.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getLeftOperand().(VariableAccess).getTarget()=vdiff_342
	and target_56.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="vc_size_row"
	and target_56.getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(MulExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vc_290
	and target_56.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_61
}

*/
predicate func_57(Function func, ReturnStmt target_57) {
	func.getEntryPoint().(BlockStmt).getAStmt()=target_57
}

predicate func_58(Function func, BlockStmt target_58) {
	target_58.getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
	and target_58.getStmt(1) instanceof ReturnStmt
	and target_58.getEnclosingFunction() = func
}

predicate func_59(Parameter vlines_290, NotExpr target_59) {
	target_59.getOperand().(VariableAccess).getTarget()=vlines_290
}

predicate func_60(Variable vvgacon_scrollback_cur, NotExpr target_60) {
	target_60.getOperand().(PointerFieldAccess).getTarget().getName()="save"
	and target_60.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvgacon_scrollback_cur
}

predicate func_61(Variable vcount_292, BlockStmt target_63, VariableAccess target_61) {
	target_61.getTarget()=vcount_292
	and target_61.getParent().(IfStmt).getThen()=target_63
}

predicate func_62(Variable vcount_292, BlockStmt target_64, VariableAccess target_62) {
	target_62.getTarget()=vcount_292
	and target_62.getParent().(IfStmt).getThen()=target_64
}

predicate func_63(Function func, BlockStmt target_63) {
	target_63.getStmt(4) instanceof ExprStmt
	and target_63.getStmt(5) instanceof ExprStmt
	and target_63.getStmt(6) instanceof ExprStmt
	and target_63.getStmt(7) instanceof ExprStmt
	and target_63.getStmt(8) instanceof ExprStmt
	and target_63.getEnclosingFunction() = func
}

predicate func_64(Function func, BlockStmt target_64) {
	target_64.getStmt(0) instanceof ExprStmt
	and target_64.getStmt(1) instanceof ExprStmt
	and target_64.getEnclosingFunction() = func
}

from Function func, Parameter vlines_290, Variable vstart_292, Variable vend_292, Variable vcount_292, Variable vsoff_292, Variable vvgacon_scrollback_cur, Variable v__x_311, Variable v__x_1_311, Variable v__x_2_311, Variable v__x_3_311, Variable v__x_4_311, Variable v__x_5_311, Variable vcopysize_340, Variable vdiff_342, Variable vd_343, Variable vs_344, Variable v__UNIQUE_ID___x1026_348, Variable v__UNIQUE_ID___y1027_348, Parameter vc_290, FunctionCall target_0, FunctionCall target_1, VariableAccess target_5, ReturnStmt target_6, DeclStmt target_7, IfStmt target_8, IfStmt target_9, IfStmt target_10, ExprStmt target_14, ExprStmt target_15, ExprStmt target_16, IfStmt target_29, IfStmt target_30, IfStmt target_31, IfStmt target_32, ExprStmt target_33, ExprStmt target_34, ExprStmt target_35, ExprStmt target_36, IfStmt target_37, ExprStmt target_38, IfStmt target_39, IfStmt target_40, DeclStmt target_41, DeclStmt target_42, DeclStmt target_43, DeclStmt target_44, ReturnStmt target_57, BlockStmt target_58, NotExpr target_59, NotExpr target_60, VariableAccess target_61, VariableAccess target_62, BlockStmt target_63, BlockStmt target_64
where
func_0(vc_290, target_0)
and func_1(vc_290, target_1)
and func_5(vlines_290, target_58, target_5)
and func_6(target_59, func, target_6)
and func_7(func, target_7)
and func_8(vlines_290, func, target_8)
and func_9(vvgacon_scrollback_cur, func, target_9)
and func_10(vvgacon_scrollback_cur, vc_290, func, target_10)
and func_14(vvgacon_scrollback_cur, func, target_14)
and func_15(vlines_290, vstart_292, vvgacon_scrollback_cur, func, target_15)
and func_16(vstart_292, vend_292, func, target_16)
and func_29(vstart_292, func, target_29)
and func_30(vstart_292, vvgacon_scrollback_cur, func, target_30)
and func_31(vend_292, func, target_31)
and func_32(vend_292, vvgacon_scrollback_cur, func, target_32)
and func_33(vstart_292, vvgacon_scrollback_cur, func, target_33)
and func_34(vstart_292, vend_292, vcount_292, func, target_34)
and func_35(vend_292, vsoff_292, vvgacon_scrollback_cur, vc_290, func, target_35)
and func_36(vcount_292, vsoff_292, vc_290, func, target_36)
and func_37(vsoff_292, vvgacon_scrollback_cur, func, target_37)
and func_38(vstart_292, vcount_292, vvgacon_scrollback_cur, func, target_38)
and func_39(vcount_292, vc_290, func, target_39)
and func_40(vcount_292, vsoff_292, vvgacon_scrollback_cur, vcopysize_340, vdiff_342, vd_343, vs_344, vc_290, func, target_40)
and func_41(target_61, func, target_41)
and func_42(target_61, func, target_42)
and func_43(target_61, func, target_43)
and func_44(target_61, func, target_44)
and func_57(func, target_57)
and func_58(func, target_58)
and func_59(vlines_290, target_59)
and func_60(vvgacon_scrollback_cur, target_60)
and func_61(vcount_292, target_63, target_61)
and func_62(vcount_292, target_64, target_62)
and func_63(func, target_63)
and func_64(func, target_64)
and vlines_290.getType().hasName("int")
and vstart_292.getType().hasName("int")
and vend_292.getType().hasName("int")
and vcount_292.getType().hasName("int")
and vsoff_292.getType().hasName("int")
and vvgacon_scrollback_cur.getType().hasName("vgacon_scrollback_info *")
and v__x_311.getType().hasName("signed long long")
and v__x_1_311.getType().hasName("signed long")
and v__x_2_311.getType().hasName("signed int")
and v__x_3_311.getType().hasName("signed short")
and v__x_4_311.getType().hasName("signed char")
and v__x_5_311.getType().hasName("signed char")
and vcopysize_340.getType().hasName("int")
and vdiff_342.getType().hasName("int")
and vd_343.getType().hasName("void *")
and vs_344.getType().hasName("void *")
and v__UNIQUE_ID___x1026_348.getType().hasName("int")
and v__UNIQUE_ID___y1027_348.getType().hasName("int")
and vc_290.getType().hasName("vc_data *")
and vlines_290.getFunction() = func
and vstart_292.(LocalVariable).getFunction() = func
and vend_292.(LocalVariable).getFunction() = func
and vcount_292.(LocalVariable).getFunction() = func
and vsoff_292.(LocalVariable).getFunction() = func
and not vvgacon_scrollback_cur.getParentScope+() = func
and v__x_311.(LocalVariable).getFunction() = func
and v__x_1_311.(LocalVariable).getFunction() = func
and v__x_2_311.(LocalVariable).getFunction() = func
and v__x_3_311.(LocalVariable).getFunction() = func
and v__x_4_311.(LocalVariable).getFunction() = func
and v__x_5_311.(LocalVariable).getFunction() = func
and vcopysize_340.(LocalVariable).getFunction() = func
and vdiff_342.(LocalVariable).getFunction() = func
and vd_343.(LocalVariable).getFunction() = func
and vs_344.(LocalVariable).getFunction() = func
and v__UNIQUE_ID___x1026_348.(LocalVariable).getFunction() = func
and v__UNIQUE_ID___y1027_348.(LocalVariable).getFunction() = func
and vc_290.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
