/**
 * @name memcached-6987918e9a3094ec4fc8976f01f769f624d790fa-_process_tokenize
 * @id cpp/memcached/6987918e9a3094ec4fc8976f01f769f624d790fa/-process-tokenize
 * @description memcached-6987918e9a3094ec4fc8976f01f769f624d790fa-proxy_request.c-_process_tokenize CVE-2023-46853
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vpr_10, PointerFieldAccess target_0) {
		target_0.getTarget().getName()="reqlen"
		and target_0.getQualifier().(VariableAccess).getTarget()=vpr_10
}

predicate func_1(Parameter vpr_10, SubExpr target_1) {
		target_1.getLeftOperand().(PointerFieldAccess).getTarget().getName()="reqlen"
		and target_1.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vpr_10
		and target_1.getRightOperand().(Literal).getValue()="2"
}

from Function func, Parameter vpr_10, PointerFieldAccess target_0, SubExpr target_1
where
func_0(vpr_10, target_0)
and func_1(vpr_10, target_1)
and vpr_10.getType().hasName("mcp_parser_t *")
and vpr_10.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
