commit e4840c88c516d959785fcd842d8658d3b7a6ae43	e4840c88c516d959785fcd842d8658d3b7a6ae43
Author: Alessandro Ghedini <alessandro@ghedini.me>
Date:   Fri Oct 2 14:38:30 2015 +0200

    Validate ClientHello extension field length
    
    RT#4069
    
    Reviewed-by: Emilia KÃ¤sper <emilia@openssl.org>
    Reviewed-by: Matt Caswell <matt@openssl.org>

diff --git a/ssl/t1_lib.c b/ssl/t1_lib.c
index d70b93fead..ef6c6fa270 100644
--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -1024,7 +1024,7 @@ int ssl_parse_clienthello_tlsext(SSL *s, unsigned char **p, unsigned char *d,
 
     n2s(data, len);
 
-    if (data > (d + n - len))
+    if (data + len != d + n)
         goto err;
 
     while (data <= (d + n - 4)) {
