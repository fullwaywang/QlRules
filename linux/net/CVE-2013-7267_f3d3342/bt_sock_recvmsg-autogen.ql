/**
 * @name linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-bt_sock_recvmsg
 * @id cpp/linux/f3d3342602f8bcbf37d7c46641cb9bca7618eb1c/bt-sock-recvmsg
 * @description linux-f3d3342602f8bcbf37d7c46641cb9bca7618eb1c-net/bluetooth/af_bluetooth.c-bt_sock_recvmsg CVE-2013-7267
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Function func, UnaryMinusExpr target_0) {
		target_0.getValue()="-95"
		and target_0.getEnclosingFunction() = func
}

predicate func_1(Parameter vflags_212, Variable vnoblock_214, Variable vsk_215, Variable verr_218, VariableAccess target_1) {
		target_1.getTarget()=verr_218
		and target_1.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_1.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_215
		and target_1.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_212
		and target_1.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vnoblock_214
}

predicate func_2(Variable verr_218, VariableAccess target_2) {
		target_2.getTarget()=verr_218
}

predicate func_3(Parameter vlen_212, Variable vcopied_217, BlockStmt target_60, VariableAccess target_3) {
		target_3.getTarget()=vlen_212
		and vlen_212.getIndex() = 3
		and target_3.getParent().(LTExpr).getGreaterOperand().(VariableAccess).getTarget()=vcopied_217
		and target_3.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_60
}

/*predicate func_4(Parameter vlen_212, Variable vcopied_217, BlockStmt target_60, VariableAccess target_4) {
		target_4.getTarget()=vcopied_217
		and target_4.getParent().(LTExpr).getLesserOperand().(VariableAccess).getTarget()=vlen_212
		and target_4.getParent().(LTExpr).getParent().(IfStmt).getThen()=target_60
}

*/
predicate func_5(Variable vskb_216, FunctionCall target_5) {
		target_5.getTarget().hasName("skb_reset_transport_header")
		and not target_5.getTarget().hasName("consume_skb")
		and target_5.getArgument(0).(VariableAccess).getTarget()=vskb_216
}

predicate func_6(Variable vskb_216, Variable vcopied_217, Variable verr_218, Parameter vmsg_212, VariableAccess target_6) {
		target_6.getTarget()=verr_218
		and target_6.getParent().(AssignExpr).getLValue() = target_6
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_216
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_6.getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_217
}

/*predicate func_7(Variable vskb_216, Variable vcopied_217, Parameter vmsg_212, VariableAccess target_7) {
		target_7.getTarget()=vmsg_212
		and vmsg_212.getIndex() = 2
		and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_216
		and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_7.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vcopied_217
}

*/
/*predicate func_8(Variable vskb_216, Variable vcopied_217, Parameter vmsg_212, VariableAccess target_8) {
		target_8.getTarget()=vcopied_217
		and target_8.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_copy_datagram_iovec")
		and target_8.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vskb_216
		and target_8.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_8.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="msg_iov"
		and target_8.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
}

*/
predicate func_9(Variable verr_218, BlockStmt target_61, VariableAccess target_9) {
		target_9.getTarget()=verr_218
		and target_9.getParent().(EQExpr).getAnOperand().(Literal).getValue()="0"
		and target_9.getParent().(EQExpr).getParent().(IfStmt).getThen()=target_61
}

predicate func_10(Function func, Initializer target_10) {
		target_10.getExpr() instanceof BitwiseAndExpr
		and target_10.getExpr().getEnclosingFunction() = func
}

predicate func_12(Parameter vlen_212, VariableAccess target_12) {
		target_12.getTarget()=vlen_212
		and vlen_212.getIndex() = 3
		and target_12.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

/*predicate func_13(Parameter vflags_212, Variable vnoblock_214, Variable vsk_215, Variable verr_218, VariableAccess target_13) {
		target_13.getTarget()=vflags_212
		and vflags_212.getIndex() = 4
		and target_13.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_13.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_215
		and target_13.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vnoblock_214
		and target_13.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_218
}

*/
predicate func_14(Variable vskb_216, Variable vcopied_217, VariableAccess target_14) {
		target_14.getTarget()=vcopied_217
		and target_14.getParent().(AssignExpr).getLValue() = target_14
		and target_14.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="len"
		and target_14.getParent().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vskb_216
}

predicate func_15(Parameter vlen_212, Variable vcopied_217, VariableAccess target_15) {
		target_15.getTarget()=vlen_212
		and vlen_212.getIndex() = 3
		and target_15.getParent().(AssignExpr).getRValue() = target_15
		and target_15.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_217
}

predicate func_16(Variable vsk_215, Variable vskb_216, Parameter vmsg_212, FunctionCall target_16) {
		target_16.getTarget().hasName("sock_recv_ts_and_drops")
		and not target_16.getTarget().hasName("kfree_skb")
		and target_16.getArgument(0).(VariableAccess).getTarget()=vmsg_212
		and target_16.getArgument(1).(VariableAccess).getTarget()=vsk_215
		and target_16.getArgument(2).(VariableAccess).getTarget()=vskb_216
}

predicate func_17(Variable vcopied_217, VariableAccess target_17) {
		target_17.getTarget()=vcopied_217
}

predicate func_18(Variable vsk_215, ExprStmt target_62, ExprStmt target_55) {
	exists(ValueFieldAccess target_18 |
		target_18.getTarget().getName()="skc_state"
		and target_18.getQualifier().(PointerFieldAccess).getTarget().getName()="__sk_common"
		and target_18.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_215
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_18.getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_22(Function func) {
	exists(ComplementExpr target_22 |
		target_22.getValue()="-65"
		and target_22.getParent().(BitwiseAndExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition() instanceof FunctionCall
		and target_22.getEnclosingFunction() = func)
}

predicate func_23(BlockStmt target_63, Function func) {
	exists(RelationalOperation target_23 |
		 (target_23 instanceof GTExpr or target_23 instanceof LTExpr)
		and target_23.getLesserOperand().(VariableAccess).getType().hasName("int")
		and target_23.getGreaterOperand().(Literal).getValue()="0"
		and target_23.getParent().(IfStmt).getThen()=target_63
		and target_23.getEnclosingFunction() = func)
}

predicate func_24(NotExpr target_47, Function func) {
	exists(GotoStmt target_24 |
		target_24.getParent().(IfStmt).getCondition()=target_47
		and target_24.getEnclosingFunction() = func)
}

predicate func_25(Variable vcopied_217) {
	exists(StmtExpr target_25 |
		target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("size_t")
		and target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("size_t")
		and target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getThen().(VariableAccess).getType().hasName("size_t")
		and target_25.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(ConditionalExpr).getElse().(VariableAccess).getType().hasName("size_t")
		and target_25.getParent().(AssignExpr).getRValue() = target_25
		and target_25.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_217)
}

predicate func_28(Parameter vflags_212, BitwiseAndExpr target_28) {
		target_28.getLeftOperand().(VariableAccess).getTarget()=vflags_212
		and target_28.getRightOperand().(Literal).getValue()="64"
}

predicate func_29(Variable vskb_216, Variable vcopied_217, PointerFieldAccess target_29) {
		target_29.getTarget().getName()="len"
		and target_29.getQualifier().(VariableAccess).getTarget()=vskb_216
		and target_29.getParent().(AssignExpr).getRValue() = target_29
		and target_29.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_217
}

predicate func_30(Parameter vflags_212, ReturnStmt target_45, VariableAccess target_30) {
		target_30.getTarget()=vflags_212
		and target_30.getParent().(BitwiseAndExpr).getRightOperand() instanceof Literal
		and target_30.getParent().(BitwiseAndExpr).getParent().(IfStmt).getThen()=target_45
}

predicate func_31(Variable vsk_215, VariableAccess target_31) {
		target_31.getTarget()=vsk_215
}

predicate func_33(Variable vskb_216, VariableAccess target_33) {
		target_33.getTarget()=vskb_216
		and target_33.getParent().(VariableCall).getParent().(ExprStmt).getExpr() instanceof VariableCall
}

predicate func_34(Variable vskb_216, BlockStmt target_63, VariableAccess target_34) {
		target_34.getTarget()=vskb_216
		and target_34.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_63
}

predicate func_36(Parameter vlen_212, Variable vsk_215, Variable vdescriptor_220, Parameter vsock_211, Function func, DoStmt target_36) {
		target_36.getCondition() instanceof Literal
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__dynamic_pr_debug")
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdescriptor_220
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="sock %p sk %p len %zu\n"
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vsock_211
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(3).(VariableAccess).getTarget()=vsk_215
		and target_36.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(FunctionCall).getArgument(4).(VariableAccess).getTarget()=vlen_212
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
}

/*predicate func_40(Variable vdescriptor_220, ExprStmt target_64, FunctionCall target_40) {
		target_40.getTarget().hasName("__builtin_expect")
		and target_40.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="flags"
		and target_40.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(VariableAccess).getTarget()=vdescriptor_220
		and target_40.getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(BitwiseAndExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="1"
		and target_40.getArgument(1) instanceof Literal
		and target_40.getParent().(IfStmt).getThen()=target_64
}

*/
/*predicate func_41(Variable vdescriptor_220, ValueFieldAccess target_41) {
		target_41.getTarget().getName()="flags"
		and target_41.getQualifier().(VariableAccess).getTarget()=vdescriptor_220
		and target_41.getParent().(BitwiseAndExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_41.getParent().(BitwiseAndExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_42(Function func, BinaryBitwiseOperation target_42) {
		target_42.getValue()="1"
		and target_42.getParent().(BitwiseAndExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_42.getParent().(BitwiseAndExpr).getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(IfStmt).getCondition().(FunctionCall).getArgument(1) instanceof Literal
		and target_42.getEnclosingFunction() = func
}

*/
/*predicate func_43(Parameter vlen_212, Variable vsk_215, Variable vdescriptor_220, Parameter vsock_211, FunctionCall target_43) {
		target_43.getTarget().hasName("__dynamic_pr_debug")
		and target_43.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vdescriptor_220
		and target_43.getArgument(1).(StringLiteral).getValue()="sock %p sk %p len %zu\n"
		and target_43.getArgument(2).(VariableAccess).getTarget()=vsock_211
		and target_43.getArgument(3).(VariableAccess).getTarget()=vsk_215
		and target_43.getArgument(4).(VariableAccess).getTarget()=vlen_212
}

*/
predicate func_45(BitwiseAndExpr target_65, Function func, ReturnStmt target_45) {
		target_45.getExpr() instanceof UnaryMinusExpr
		and target_45.getParent().(IfStmt).getCondition()=target_65
		and target_45.getEnclosingFunction() = func
}

predicate func_46(Parameter vflags_212, Variable vnoblock_214, Variable vsk_215, Variable verr_218, VariableAccess target_46) {
		target_46.getTarget()=vnoblock_214
		and target_46.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_46.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_215
		and target_46.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_212
		and target_46.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_218
}

predicate func_47(Variable vskb_216, BlockStmt target_63, NotExpr target_47) {
		target_47.getOperand().(VariableAccess).getTarget()=vskb_216
		and target_47.getParent().(IfStmt).getThen()=target_63
}

predicate func_48(Variable vsk_215, BlockStmt target_66, BitwiseAndExpr target_48) {
		target_48.getLeftOperand().(PointerFieldAccess).getTarget().getName()="sk_shutdown"
		and target_48.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_215
		and target_48.getRightOperand().(Literal).getValue()="1"
		and target_48.getParent().(IfStmt).getThen()=target_66
}

predicate func_49(Parameter vmsg_212, PointerFieldAccess target_49) {
		target_49.getTarget().getName()="msg_namelen"
		and target_49.getQualifier().(VariableAccess).getTarget()=vmsg_212
}

predicate func_51(Parameter vlen_212, Variable vcopied_217, Parameter vmsg_212, Function func, IfStmt target_51) {
		target_51.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vlen_212
		and target_51.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vcopied_217
		and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_51.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignOrExpr).getRValue().(Literal).getValue()="32"
		and target_51.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_217
		and target_51.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_212
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_51
}

/*predicate func_52(Parameter vmsg_212, AssignOrExpr target_52) {
		target_52.getLValue().(PointerFieldAccess).getTarget().getName()="msg_flags"
		and target_52.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_52.getRValue().(Literal).getValue()="32"
}

*/
/*predicate func_53(Parameter vlen_212, Variable vcopied_217, RelationalOperation target_68, ExprStmt target_53) {
		target_53.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vcopied_217
		and target_53.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vlen_212
		and target_53.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_68
}

*/
predicate func_54(Variable vsk_215, Variable vskb_216, Variable verr_218, Parameter vmsg_212, Function func, IfStmt target_54) {
		target_54.getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=verr_218
		and target_54.getCondition().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_54.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr() instanceof FunctionCall
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_215
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_215
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vskb_216
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(VariableCall).getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_54.getThen().(BlockStmt).getStmt(1).(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_54
}

predicate func_55(Function func, ExprStmt target_55) {
		target_55.getExpr() instanceof FunctionCall
		and target_55.getEnclosingFunction() = func
}

/*predicate func_56(Variable vsk_215, Variable vskb_216, Parameter vmsg_212, EqualityOperation target_69, IfStmt target_56) {
		target_56.getCondition().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_56.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_215
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getTarget().getName()="skb_msg_name"
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsk_215
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(0).(VariableAccess).getTarget()=vskb_216
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="msg_name"
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_56.getThen().(ExprStmt).getExpr().(VariableCall).getArgument(2).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_56.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_56.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_56.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and target_56.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_69
}

*/
predicate func_57(Variable vsk_215, Variable vskb_216, Function func, ExprStmt target_57) {
		target_57.getExpr().(FunctionCall).getTarget().hasName("skb_free_datagram")
		and target_57.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_215
		and target_57.getExpr().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vskb_216
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_57
}

predicate func_58(Variable vcopied_217, Variable verr_218, Function func, ReturnStmt target_58) {
		target_58.getExpr().(ConditionalExpr).getCondition().(VariableAccess).getTarget()=verr_218
		and target_58.getExpr().(ConditionalExpr).getElse().(VariableAccess).getTarget()=vcopied_217
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_58
}

/*predicate func_59(Variable verr_218, EqualityOperation target_69, VariableAccess target_59) {
		target_59.getTarget()=verr_218
		and target_69.getAnOperand().(VariableAccess).getLocation().isBefore(target_59.getLocation())
}

*/
predicate func_60(Function func, BlockStmt target_60) {
		target_60.getStmt(0).(ExprStmt).getExpr() instanceof AssignOrExpr
		and target_60.getStmt(1) instanceof ExprStmt
		and target_60.getEnclosingFunction() = func
}

predicate func_61(Function func, BlockStmt target_61) {
		target_61.getStmt(0) instanceof ExprStmt
		and target_61.getStmt(1) instanceof IfStmt
		and target_61.getEnclosingFunction() = func
}

predicate func_62(Parameter vflags_212, Variable vnoblock_214, Variable vsk_215, Variable vskb_216, Variable verr_218, ExprStmt target_62) {
		target_62.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vskb_216
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("skb_recv_datagram")
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vsk_215
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vflags_212
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(VariableAccess).getTarget()=vnoblock_214
		and target_62.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(3).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=verr_218
}

predicate func_63(Parameter vmsg_212, BlockStmt target_63) {
		target_63.getStmt(0).(IfStmt).getCondition() instanceof BitwiseAndExpr
		and target_63.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_63.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_63.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
		and target_63.getStmt(0).(IfStmt).getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr() instanceof Literal
}

predicate func_64(Function func, ExprStmt target_64) {
		target_64.getExpr() instanceof FunctionCall
		and target_64.getEnclosingFunction() = func
}

predicate func_65(Parameter vflags_212, BitwiseAndExpr target_65) {
		target_65.getLeftOperand().(VariableAccess).getTarget()=vflags_212
		and target_65.getRightOperand() instanceof Literal
}

predicate func_66(Parameter vmsg_212, BlockStmt target_66) {
		target_66.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="msg_namelen"
		and target_66.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vmsg_212
		and target_66.getStmt(0).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
		and target_66.getStmt(1).(ReturnStmt).getExpr() instanceof Literal
}

predicate func_68(Parameter vlen_212, Variable vcopied_217, RelationalOperation target_68) {
		 (target_68 instanceof GTExpr or target_68 instanceof LTExpr)
		and target_68.getLesserOperand().(VariableAccess).getTarget()=vlen_212
		and target_68.getGreaterOperand().(VariableAccess).getTarget()=vcopied_217
}

predicate func_69(Variable verr_218, EqualityOperation target_69) {
		target_69.getAnOperand().(VariableAccess).getTarget()=verr_218
		and target_69.getAnOperand().(Literal).getValue()="0"
}

from Function func, Parameter vlen_212, Parameter vflags_212, Variable vnoblock_214, Variable vsk_215, Variable vskb_216, Variable vcopied_217, Variable verr_218, Variable vdescriptor_220, Parameter vsock_211, Parameter vmsg_212, UnaryMinusExpr target_0, VariableAccess target_1, VariableAccess target_2, VariableAccess target_3, FunctionCall target_5, VariableAccess target_6, VariableAccess target_9, Initializer target_10, VariableAccess target_12, VariableAccess target_14, VariableAccess target_15, FunctionCall target_16, VariableAccess target_17, BitwiseAndExpr target_28, PointerFieldAccess target_29, VariableAccess target_30, VariableAccess target_31, VariableAccess target_33, VariableAccess target_34, DoStmt target_36, ReturnStmt target_45, VariableAccess target_46, NotExpr target_47, BitwiseAndExpr target_48, PointerFieldAccess target_49, IfStmt target_51, IfStmt target_54, ExprStmt target_55, ExprStmt target_57, ReturnStmt target_58, BlockStmt target_60, BlockStmt target_61, ExprStmt target_62, BlockStmt target_63, ExprStmt target_64, BitwiseAndExpr target_65, BlockStmt target_66, RelationalOperation target_68, EqualityOperation target_69
where
func_0(func, target_0)
and func_1(vflags_212, vnoblock_214, vsk_215, verr_218, target_1)
and func_2(verr_218, target_2)
and func_3(vlen_212, vcopied_217, target_60, target_3)
and func_5(vskb_216, target_5)
and func_6(vskb_216, vcopied_217, verr_218, vmsg_212, target_6)
and func_9(verr_218, target_61, target_9)
and func_10(func, target_10)
and func_12(vlen_212, target_12)
and func_14(vskb_216, vcopied_217, target_14)
and func_15(vlen_212, vcopied_217, target_15)
and func_16(vsk_215, vskb_216, vmsg_212, target_16)
and func_17(vcopied_217, target_17)
and not func_18(vsk_215, target_62, target_55)
and not func_22(func)
and not func_23(target_63, func)
and not func_24(target_47, func)
and not func_25(vcopied_217)
and func_28(vflags_212, target_28)
and func_29(vskb_216, vcopied_217, target_29)
and func_30(vflags_212, target_45, target_30)
and func_31(vsk_215, target_31)
and func_33(vskb_216, target_33)
and func_34(vskb_216, target_63, target_34)
and func_36(vlen_212, vsk_215, vdescriptor_220, vsock_211, func, target_36)
and func_45(target_65, func, target_45)
and func_46(vflags_212, vnoblock_214, vsk_215, verr_218, target_46)
and func_47(vskb_216, target_63, target_47)
and func_48(vsk_215, target_66, target_48)
and func_49(vmsg_212, target_49)
and func_51(vlen_212, vcopied_217, vmsg_212, func, target_51)
and func_54(vsk_215, vskb_216, verr_218, vmsg_212, func, target_54)
and func_55(func, target_55)
and func_57(vsk_215, vskb_216, func, target_57)
and func_58(vcopied_217, verr_218, func, target_58)
and func_60(func, target_60)
and func_61(func, target_61)
and func_62(vflags_212, vnoblock_214, vsk_215, vskb_216, verr_218, target_62)
and func_63(vmsg_212, target_63)
and func_64(func, target_64)
and func_65(vflags_212, target_65)
and func_66(vmsg_212, target_66)
and func_68(vlen_212, vcopied_217, target_68)
and func_69(verr_218, target_69)
and vlen_212.getType().hasName("size_t")
and vflags_212.getType().hasName("int")
and vnoblock_214.getType().hasName("int")
and vsk_215.getType().hasName("sock *")
and vskb_216.getType().hasName("sk_buff *")
and vcopied_217.getType().hasName("size_t")
and verr_218.getType().hasName("int")
and vdescriptor_220.getType().hasName("_ddebug")
and vsock_211.getType().hasName("socket *")
and vmsg_212.getType().hasName("msghdr *")
and vlen_212.getFunction() = func
and vflags_212.getFunction() = func
and vnoblock_214.(LocalVariable).getFunction() = func
and vsk_215.(LocalVariable).getFunction() = func
and vskb_216.(LocalVariable).getFunction() = func
and vcopied_217.(LocalVariable).getFunction() = func
and verr_218.(LocalVariable).getFunction() = func
and vdescriptor_220.(LocalVariable).getFunction() = func
and vsock_211.getFunction() = func
and vmsg_212.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
