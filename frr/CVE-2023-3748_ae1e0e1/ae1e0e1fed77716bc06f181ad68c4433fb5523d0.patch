commit ae1e0e1fed77716bc06f181ad68c4433fb5523d0	ae1e0e1fed77716bc06f181ad68c4433fb5523d0
Author: harryreps <harryreps@gmail.com>
Date:   Fri Mar 3 23:17:14 2023 +0000

    babeld: fix #11808 to avoid infinite loops
    
    Replacing continue in loops to goto done so that index of packet buffer
    increases.
    
    Signed-off-by: harryreps <harryreps@gmail.com>

diff --git a/babeld/message.c b/babeld/message.c
index 687f76844..b5c2a5898 100644
--- a/babeld/message.c
+++ b/babeld/message.c
@@ -422,7 +422,7 @@ parse_packet(const unsigned char *from, struct interface *ifp,
 			debugf(BABEL_DEBUG_COMMON,
 			       "Received Hello from %s on %s that does not have all 0's in the unused section of flags, ignoring",
 			       format_address(from), ifp->name);
-			continue;
+			goto done;
 		}
 
 		/*
@@ -434,7 +434,7 @@ parse_packet(const unsigned char *from, struct interface *ifp,
 			debugf(BABEL_DEBUG_COMMON,
 			       "Received Unicast Hello from %s on %s that FRR is not prepared to understand yet",
 			       format_address(from), ifp->name);
-			continue;
+			goto done;
 		}
 
 		DO_NTOHS(seqno, message + 4);
@@ -452,7 +452,7 @@ parse_packet(const unsigned char *from, struct interface *ifp,
 			debugf(BABEL_DEBUG_COMMON,
 			       "Received hello from %s on %s should be ignored as that this version of FRR does not know how to properly handle interval == 0",
 			       format_address(from), ifp->name);
-			continue;
+			goto done;
 		}
 
 		changed = update_neighbour(neigh, seqno, interval);
