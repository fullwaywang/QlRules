/**
 * @name linux-55749769fe608fa3f4a075e42e89d237c8e37637-kvm_xen_shared_info_init
 * @id cpp/linux/55749769fe608fa3f4a075e42e89d237c8e37637/kvm-xen-shared-info-init
 * @description linux-55749769fe608fa3f4a075e42e89d237c8e37637-arch/x86/kvm/xen.c-kvm_xen_shared_info_init CVE-2021-4095
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vkvm_25, Variable vgpa_28, Variable vwc_ofs_29, Variable vsec_hi_ofs_29, FunctionCall target_0) {
	target_0.getTarget().hasName("kvm_write_wall_clock")
	and not target_0.getTarget().hasName("_raw_read_lock_irq")
	and target_0.getArgument(0).(VariableAccess).getTarget()=vkvm_25
	and target_0.getArgument(1).(AddExpr).getLeftOperand().(VariableAccess).getTarget()=vgpa_28
	and target_0.getArgument(1).(AddExpr).getRightOperand().(VariableAccess).getTarget()=vwc_ofs_29
	and target_0.getArgument(2).(SubExpr).getLeftOperand().(VariableAccess).getTarget()=vsec_hi_ofs_29
	and target_0.getArgument(2).(SubExpr).getRightOperand().(VariableAccess).getTarget()=vwc_ofs_29
}

predicate func_2(Parameter vkvm_25, Variable vgpc_27, ExprStmt target_21, ExprStmt target_36, Function func) {
exists(DoStmt target_2 |
	target_2.getCondition().(Literal).getValue()="1"
	and target_2.getStmt().(BlockStmt).getStmt(0) instanceof ExprStmt
	and target_2.getStmt().(BlockStmt).getStmt(1) instanceof IfStmt
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("u64")
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getLeftOperand().(FunctionCall).getTarget().hasName("ktime_get_real_ns")
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(FunctionCall).getTarget().hasName("get_kvmclock_ns")
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkvm_25
	and target_2.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_raw_read_lock_irq")
	and target_2.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_2.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27
	and target_2.getStmt().(BlockStmt).getStmt(4).(IfStmt).getCondition().(PointerFieldAccess).getTarget().getName()="valid"
	and target_2.getStmt().(BlockStmt).getStmt(4).(IfStmt).getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27
	and target_2.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("_raw_read_unlock_irq")
	and target_2.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_2.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_2
	and target_2.getLocation().isBefore(target_21.getLocation())
	and target_2.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(SubExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

/*predicate func_3(Parameter vkvm_25, ExprStmt target_36) {
exists(AssignExpr target_3 |
	target_3.getLValue().(VariableAccess).getType().hasName("u64")
	and target_3.getRValue().(SubExpr).getLeftOperand().(FunctionCall).getTarget().hasName("ktime_get_real_ns")
	and target_3.getRValue().(SubExpr).getRightOperand().(FunctionCall).getTarget().hasName("get_kvmclock_ns")
	and target_3.getRValue().(SubExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkvm_25
	and target_3.getRValue().(SubExpr).getRightOperand().(FunctionCall).getArgument(0).(VariableAccess).getLocation().isBefore(target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getLocation()))
}

*/
/*predicate func_4(Variable vgpc_27) {
exists(AddressOfExpr target_4 |
	target_4.getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_4.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27
	and target_4.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall)
}

*/
/*predicate func_5(Variable vgpc_27, ValueFieldAccess target_23) {
exists(IfStmt target_5 |
	target_5.getCondition().(PointerFieldAccess).getTarget().getName()="valid"
	and target_5.getCondition().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27
	and target_5.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(4)=target_5
	and target_5.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_23)
}

*/
/*predicate func_6(Variable vgpc_27) {
exists(FunctionCall target_6 |
	target_6.getTarget().hasName("_raw_read_unlock_irq")
	and target_6.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_6.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27)
}

*/
predicate func_7(BlockStmt target_37, Function func) {
exists(LogicalAndExpr target_7 |
	target_7.getLeftOperand().(Literal).getValue()="1"
	and target_7.getRightOperand() instanceof ValueFieldAccess
	and target_7.getParent().(IfStmt).getThen()=target_37
	and target_7.getEnclosingFunction() = func)
}

predicate func_8(Function func) {
exists(AssignExpr target_8 |
	target_8.getLValue().(VariableAccess).getType().hasName("u32 *")
	and target_8.getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="wc_sec_hi"
	and target_8.getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("shared_info *")
	and target_8.getEnclosingFunction() = func)
}

predicate func_9(ValueFieldAccess target_23, Function func) {
exists(ExprStmt target_9 |
	target_9.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_9.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="wc"
	and target_9.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("shared_info *")
	and target_9.getParent().(BlockStmt).getParent().(IfStmt).getThen().(BlockStmt).getStmt(2)=target_9
	and target_9.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_23
	and target_9.getEnclosingFunction() = func)
}

predicate func_10(ValueFieldAccess target_23, Function func) {
exists(ExprStmt target_10 |
	target_10.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("u32 *")
	and target_10.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="wc_sec_hi"
	and target_10.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="arch"
	and target_10.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("compat_shared_info *")
	and target_10.getParent().(BlockStmt).getParent().(IfStmt).getElse().(BlockStmt).getStmt(1)=target_10
	and target_10.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_23
	and target_10.getEnclosingFunction() = func)
}

/*predicate func_11(Function func) {
exists(PointerFieldAccess target_11 |
	target_11.getTarget().getName()="arch"
	and target_11.getQualifier().(VariableAccess).getType().hasName("compat_shared_info *")
	and target_11.getEnclosingFunction() = func)
}

*/
predicate func_12(ValueFieldAccess target_23, Function func) {
exists(ExprStmt target_12 |
	target_12.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_12.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="wc"
	and target_12.getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("compat_shared_info *")
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getElse().(BlockStmt).getStmt(2)=target_12
	and target_12.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_23
	and target_12.getEnclosingFunction() = func)
}

predicate func_13(DoStmt target_38, Function func) {
exists(ExprStmt target_13 |
	target_13.getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("u32")
	and target_13.getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="version"
	and target_13.getExpr().(AssignExpr).getRValue().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_13.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(AddExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="version"
	and target_13.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(AddExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_13.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(BitwiseOrExpr).getLeftOperand().(AddExpr).getRightOperand().(Literal).getValue()="1"
	and target_13.getExpr().(AssignExpr).getRValue().(AssignExpr).getRValue().(BitwiseOrExpr).getRightOperand().(Literal).getValue()="1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_13
	and target_13.getLocation().isBefore(target_38.getLocation()))
}

predicate func_14(DoStmt target_38, Function func) {
exists(AsmStmt target_14 |
	func.getEntryPoint().(BlockStmt).getAStmt()=target_14
	and target_14.getLocation().isBefore(target_38.getLocation()))
}

predicate func_15(DoStmt target_38, Function func) {
exists(ExprStmt target_15 |
	target_15.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="nsec"
	and target_15.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_15.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("uint32_t")
	and target_15.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("u64")
	and target_15.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(VariableAccess).getType().hasName("uint32_t")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_15
	and target_15.getLocation().isBefore(target_38.getLocation()))
}

predicate func_16(DoStmt target_38, Function func) {
exists(ExprStmt target_16 |
	target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="sec"
	and target_16.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_16.getExpr().(AssignExpr).getRValue().(VariableAccess).getType().hasName("u64")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_16
	and target_16.getLocation().isBefore(target_38.getLocation()))
}

predicate func_17(DoStmt target_38, Function func) {
exists(ExprStmt target_17 |
	target_17.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getType().hasName("u32 *")
	and target_17.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getLeftOperand().(VariableAccess).getType().hasName("u64")
	and target_17.getExpr().(AssignExpr).getRValue().(BinaryBitwiseOperation).getRightOperand().(Literal).getValue()="32"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_17
	and target_17.getLocation().isBefore(target_38.getLocation()))
}

predicate func_18(DoStmt target_38, Function func) {
exists(AsmStmt target_18 |
	func.getEntryPoint().(BlockStmt).getAStmt()=target_18
	and target_18.getLocation().isBefore(target_38.getLocation()))
}

predicate func_19(DoStmt target_38, Function func) {
exists(ExprStmt target_19 |
	target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="version"
	and target_19.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pvclock_wall_clock *")
	and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("u32")
	and target_19.getExpr().(AssignExpr).getRValue().(AddExpr).getRightOperand().(Literal).getValue()="1"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_19
	and target_19.getLocation().isBefore(target_38.getLocation()))
}

predicate func_20(Variable vgpc_27) {
exists(FunctionCall target_20 |
	target_20.getTarget().hasName("_raw_read_unlock_irq")
	and target_20.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_20.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vgpc_27)
}

predicate func_21(Parameter vkvm_25, Variable vgpc_27, Variable vgpa_28, Variable vret_30, Function func, ExprStmt target_21) {
	target_21.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_30
	and target_21.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("kvm_gfn_to_pfn_cache_init")
	and target_21.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkvm_25
	and target_21.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vgpc_27
	and target_21.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(Literal).getValue()="0"
	and target_21.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(5).(VariableAccess).getTarget()=vgpa_28
	and target_21.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(6).(BinaryBitwiseOperation).getValue()="4096"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
}

predicate func_22(Variable vret_30, Function func, IfStmt target_22) {
	target_22.getCondition().(VariableAccess).getTarget()=vret_30
	and target_22.getThen().(GotoStmt).getName() ="out"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_22
}

predicate func_23(Parameter vkvm_25, ValueFieldAccess target_23) {
	target_23.getTarget().getName()="long_mode"
	and target_23.getQualifier().(ValueFieldAccess).getTarget().getName()="xen"
	and target_23.getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="arch"
	and target_23.getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkvm_25
}

predicate func_24(Parameter vkvm_25, VariableAccess target_24) {
	target_24.getTarget()=vkvm_25
	and target_24.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_27(Variable vwc_ofs_29, AssignExpr target_27) {
	target_27.getLValue().(VariableAccess).getTarget()=vwc_ofs_29
	and target_27.getRValue().(BuiltInOperationBuiltInOffsetOf).getValue()="2304"
}

predicate func_28(Variable vsec_hi_ofs_29, AssignExpr target_28) {
	target_28.getLValue().(VariableAccess).getTarget()=vsec_hi_ofs_29
	and target_28.getRValue().(BuiltInOperationBuiltInOffsetOf).getValue()="2340"
}

predicate func_29(Function func, ValueFieldAccess target_29) {
	target_29.getTarget().getName()="arch"
	and target_29.getQualifier().(PointerDereferenceExpr).getOperand().(Literal).getValue()="0"
	and target_29.getEnclosingFunction() = func
}

predicate func_30(Variable vwc_ofs_29, AssignExpr target_30) {
	target_30.getLValue().(VariableAccess).getTarget()=vwc_ofs_29
	and target_30.getRValue().(BuiltInOperationBuiltInOffsetOf).getValue()="3072"
}

predicate func_31(Variable vsec_hi_ofs_29, AssignExpr target_31) {
	target_31.getLValue().(VariableAccess).getTarget()=vsec_hi_ofs_29
	and target_31.getRValue().(BuiltInOperationBuiltInOffsetOf).getValue()="3084"
}

predicate func_32(Variable vgpa_28, VariableAccess target_32) {
	target_32.getTarget()=vgpa_28
	and target_32.getParent().(AddExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_33(Variable vwc_ofs_29, VariableAccess target_33) {
	target_33.getTarget()=vwc_ofs_29
	and target_33.getParent().(AddExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_34(Variable vsec_hi_ofs_29, VariableAccess target_34) {
	target_34.getTarget()=vsec_hi_ofs_29
	and target_34.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_35(Variable vwc_ofs_29, VariableAccess target_35) {
	target_35.getTarget()=vwc_ofs_29
	and target_35.getParent().(SubExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_36(Parameter vkvm_25, ExprStmt target_36) {
	target_36.getExpr().(FunctionCall).getTarget().hasName("kvm_make_all_cpus_request")
	and target_36.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vkvm_25
	and target_36.getExpr().(FunctionCall).getArgument(1).(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition().(Literal).getValue()="0"
	and target_36.getExpr().(FunctionCall).getArgument(1).(StmtExpr).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(BitwiseOrExpr).getValue()="21"
}

predicate func_37(Function func, BlockStmt target_37) {
	target_37.getStmt(0).(ExprStmt).getExpr() instanceof AssignExpr
	and target_37.getStmt(1).(ExprStmt).getExpr() instanceof AssignExpr
	and target_37.getEnclosingFunction() = func
}

predicate func_38(Function func, DoStmt target_38) {
	target_38.getCondition().(Literal).getValue()="0"
	and target_38.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
	and target_38.getEnclosingFunction() = func
}

from Function func, Parameter vkvm_25, Variable vgpc_27, Variable vgpa_28, Variable vwc_ofs_29, Variable vsec_hi_ofs_29, Variable vret_30, FunctionCall target_0, ExprStmt target_21, IfStmt target_22, ValueFieldAccess target_23, VariableAccess target_24, AssignExpr target_27, AssignExpr target_28, ValueFieldAccess target_29, AssignExpr target_30, AssignExpr target_31, VariableAccess target_32, VariableAccess target_33, VariableAccess target_34, VariableAccess target_35, ExprStmt target_36, BlockStmt target_37, DoStmt target_38
where
func_0(vkvm_25, vgpa_28, vwc_ofs_29, vsec_hi_ofs_29, target_0)
and not func_2(vkvm_25, vgpc_27, target_21, target_36, func)
and not func_7(target_37, func)
and not func_8(func)
and not func_9(target_23, func)
and not func_10(target_23, func)
and not func_12(target_23, func)
and not func_13(target_38, func)
and not func_14(target_38, func)
and not func_15(target_38, func)
and not func_16(target_38, func)
and not func_17(target_38, func)
and not func_18(target_38, func)
and not func_19(target_38, func)
and not func_20(vgpc_27)
and func_21(vkvm_25, vgpc_27, vgpa_28, vret_30, func, target_21)
and func_22(vret_30, func, target_22)
and func_23(vkvm_25, target_23)
and func_24(vkvm_25, target_24)
and func_27(vwc_ofs_29, target_27)
and func_28(vsec_hi_ofs_29, target_28)
and func_29(func, target_29)
and func_30(vwc_ofs_29, target_30)
and func_31(vsec_hi_ofs_29, target_31)
and func_32(vgpa_28, target_32)
and func_33(vwc_ofs_29, target_33)
and func_34(vsec_hi_ofs_29, target_34)
and func_35(vwc_ofs_29, target_35)
and func_36(vkvm_25, target_36)
and func_37(func, target_37)
and func_38(func, target_38)
and vkvm_25.getType().hasName("kvm *")
and vgpc_27.getType().hasName("gfn_to_pfn_cache *")
and vgpa_28.getType().hasName("gpa_t")
and vwc_ofs_29.getType().hasName("int")
and vsec_hi_ofs_29.getType().hasName("int")
and vret_30.getType().hasName("int")
and vkvm_25.getFunction() = func
and vgpc_27.(LocalVariable).getFunction() = func
and vgpa_28.(LocalVariable).getFunction() = func
and vwc_ofs_29.(LocalVariable).getFunction() = func
and vsec_hi_ofs_29.(LocalVariable).getFunction() = func
and vret_30.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
