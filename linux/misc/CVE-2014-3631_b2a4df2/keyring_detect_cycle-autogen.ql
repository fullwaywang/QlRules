/**
 * @name linux-b2a4df200d570b2c33a57e1ebfa5896e4bc81b69-keyring_detect_cycle
 * @id cpp/linux/b2a4df200d570b2c33a57e1ebfa5896e4bc81b69/keyring-detect-cycle
 * @description linux-b2a4df200d570b2c33a57e1ebfa5896e4bc81b69-security/keys/keyring.c-keyring_detect_cycle CVE-2014-3631
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vret_656, UnaryMinusExpr target_0) {
		target_0.getValue()="-35"
		and target_0.getParent().(AssignExpr).getRValue() = target_0
		and target_0.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_656
}

predicate func_1(Variable vsubtree_655, PointerFieldAccess target_1) {
		target_1.getTarget().getName()="payload"
		and target_1.getQualifier().(VariableAccess).getTarget()=vsubtree_655
}

predicate func_2(Function func, Literal target_2) {
		target_2.getValue()="1"
		and not target_2.getValue()="8"
		and target_2.getParent().(ConditionalExpr).getParent().(IfStmt).getCondition() instanceof ConditionalExpr
		and target_2.getEnclosingFunction() = func
}

predicate func_3(Function func, Literal target_3) {
		target_3.getValue()="2"
		and not target_3.getValue()="16"
		and target_3.getParent().(FunctionCall).getParent().(ConditionalExpr).getElse() instanceof FunctionCall
		and target_3.getEnclosingFunction() = func
}

predicate func_4(Function func, Initializer target_4) {
		target_4.getExpr().(PointerDereferenceExpr).getOperand() instanceof AddressOfExpr
		and target_4.getExpr().getEnclosingFunction() = func
}

predicate func_7(Parameter vB_647, ExprStmt target_21) {
	exists(FunctionCall target_7 |
		target_7.getTarget().hasName("search_nested_keyrings")
		and target_7.getArgument(0).(VariableAccess).getTarget()=vB_647
		and target_7.getArgument(1).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("keyring_search_context")
		and target_7.getArgument(0).(VariableAccess).getLocation().isBefore(target_21.getExpr().(AssignExpr).getRValue().(VariableAccess).getLocation()))
}

predicate func_8(Function func) {
	exists(ConditionalExpr target_8 |
		target_8.getCondition().(EqualityOperation).getAnOperand().(FunctionCall).getTarget().hasName("PTR_ERR")
		and target_8.getCondition().(EqualityOperation).getAnOperand().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="result"
		and target_8.getCondition().(EqualityOperation).getAnOperand().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("keyring_search_context")
		and target_8.getCondition().(EqualityOperation).getAnOperand().(UnaryMinusExpr).getValue()="-11"
		and target_8.getThen().(Literal).getValue()="0"
		and target_8.getElse().(FunctionCall).getTarget().hasName("PTR_ERR")
		and target_8.getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="result"
		and target_8.getElse().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("keyring_search_context")
		and target_8.getEnclosingFunction() = func)
}

/*predicate func_9(Parameter vA_647, Parameter vB_647) {
	exists(FunctionCall target_9 |
		target_9.getTarget().hasName("PTR_ERR")
		and target_9.getArgument(0).(ValueFieldAccess).getTarget().getName()="result"
		and target_9.getArgument(0).(ValueFieldAccess).getQualifier().(VariableAccess).getType().hasName("keyring_search_context")
		and target_9.getParent().(EQExpr).getAnOperand().(VariableAccess).getTarget()=vA_647
		and target_9.getParent().(EQExpr).getAnOperand().(VariableAccess).getTarget()=vB_647
		and target_9.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt)
}

*/
predicate func_10(Parameter vA_647, Parameter vB_647, VariableAccess target_10) {
		target_10.getTarget()=vA_647
		and target_10.getParent().(EQExpr).getAnOperand().(VariableAccess).getTarget()=vB_647
		and target_10.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

/*predicate func_11(Parameter vB_647, VariableAccess target_11) {
		target_11.getTarget()=vB_647
		and target_11.getParent().(EQExpr).getParent().(IfStmt).getThen() instanceof GotoStmt
}

*/
predicate func_14(Function func, TypeDeclarationEntry target_14) {
		target_14.getType() instanceof LocalStruct
		and target_14.getDeclaration().getEnclosingFunction() = func
}

predicate func_16(Function func, DeclStmt target_16) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_16
}

predicate func_17(Function func, DeclStmt target_17) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_17
}

predicate func_18(Function func, DeclStmt target_18) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_18
}

predicate func_19(Variable vret_656, DeclStmt target_18, AssignExpr target_19) {
		target_19.getLValue().(VariableAccess).getTarget()=vret_656
		and target_19.getRValue() instanceof UnaryMinusExpr
}

predicate func_20(Parameter vA_647, Parameter vB_647, Function func, IfStmt target_20) {
		target_20.getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vA_647
		and target_20.getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vB_647
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
}

predicate func_21(Variable vsubtree_655, Parameter vB_647, Function func, ExprStmt target_21) {
		target_21.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsubtree_655
		and target_21.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vB_647
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_21
}

predicate func_22(Variable vsp_656, Function func, ExprStmt target_22) {
		target_22.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsp_656
		and target_22.getExpr().(AssignExpr).getRValue() instanceof Literal
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_22
}

predicate func_23(Variable vsubtree_655, Function func, IfStmt target_23) {
		target_23.getCondition().(ConditionalExpr).getCondition() instanceof Literal
		and target_23.getCondition().(ConditionalExpr).getThen().(FunctionCall).getTarget().hasName("constant_test_bit")
		and target_23.getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(0) instanceof Literal
		and target_23.getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_23.getCondition().(ConditionalExpr).getThen().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsubtree_655
		and target_23.getCondition().(ConditionalExpr).getElse().(FunctionCall).getTarget().hasName("variable_test_bit")
		and target_23.getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(0) instanceof Literal
		and target_23.getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_23.getCondition().(ConditionalExpr).getElse().(FunctionCall).getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsubtree_655
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_23
}

predicate func_24(Variable vkeylist_654, Variable v_________p1_672, Function func, ExprStmt target_24) {
		target_24.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkeylist_654
		and target_24.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
		and target_24.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(DoStmt).getCondition() instanceof Literal
		and target_24.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_________p1_672
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_24
}

predicate func_26(Variable vsubtree_655, AddressOfExpr target_26) {
		target_26.getOperand().(ValueFieldAccess).getTarget().getName()="subscriptions"
		and target_26.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="payload"
		and target_26.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsubtree_655
}

/*predicate func_27(Variable v__warned_672, DoStmt target_27) {
		target_27.getCondition() instanceof Literal
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_672
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_672
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_27.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_29(Variable v__warned_672, IfStmt target_29) {
		target_29.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_29.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_672
		and target_29.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_29.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_29.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_672
		and target_29.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_29.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_29.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_29.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_30(Variable v__warned_672, LogicalAndExpr target_69, ExprStmt target_30) {
		target_30.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_672
		and target_30.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_69
}

*/
/*predicate func_31(LogicalAndExpr target_69, Function func, ExprStmt target_31) {
		target_31.getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_31.getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_31.getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_31.getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
		and target_31.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_69
		and target_31.getEnclosingFunction() = func
}

*/
/*predicate func_33(Function func, DoStmt target_33) {
		target_33.getCondition() instanceof Literal
		and target_33.getEnclosingFunction() = func
}

*/
/*predicate func_34(Variable v_________p1_672, ExprStmt target_34) {
		target_34.getExpr().(VariableAccess).getTarget()=v_________p1_672
}

*/
predicate func_35(Variable vkeylist_654, Function func, IfStmt target_35) {
		target_35.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vkeylist_654
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_35
}

predicate func_36(Variable vkix_656, Function func, ExprStmt target_36) {
		target_36.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkix_656
		and target_36.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_36
}

predicate func_37(Variable vkeylist_654, Variable vnkeys_656, Function func, ExprStmt target_37) {
		target_37.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vnkeys_656
		and target_37.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getTarget().getName()="nkeys"
		and target_37.getExpr().(AssignExpr).getRValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkeylist_654
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_37
}

predicate func_38(Function func, AsmStmt target_38) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_38
}

predicate func_39(Variable vkeylist_654, Variable vsubtree_655, Variable vkey_655, Variable vsp_656, Variable vnkeys_656, Variable vkix_656, Variable vkey_type_keyring, Parameter vA_647, Function func, ForStmt target_39) {
		target_39.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getTarget()=vkix_656
		and target_39.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vnkeys_656
		and target_39.getUpdate().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vkix_656
		and target_39.getStmt().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkey_655
		and target_39.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vkey_655
		and target_39.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vA_647
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="type"
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="(unknown field)"
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(EqualityOperation).getAnOperand().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vkey_type_keyring
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vsp_656
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="6"
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="keylist"
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkeylist_654
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="kix"
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkix_656
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsp_656
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsubtree_655
		and target_39.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkey_655
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_39
}

/*predicate func_40(Variable vkey_655, Variable v_________p1_682, ExprStmt target_40) {
		target_40.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkey_655
		and target_40.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
		and target_40.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(3).(DoStmt).getCondition() instanceof Literal
		and target_40.getExpr().(AssignExpr).getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(VariableAccess).getTarget()=v_________p1_682
}

*/
/*predicate func_42(Variable v__warned_682, DoStmt target_42) {
		target_42.getCondition() instanceof Literal
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_682
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_682
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_42.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_44(Variable v__warned_682, IfStmt target_44) {
		target_44.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(FunctionCall).getTarget().hasName("debug_lockdep_rcu_enabled")
		and target_44.getCondition().(LogicalAndExpr).getAnOperand().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=v__warned_682
		and target_44.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand().(FunctionCall).getTarget().hasName("rcu_read_lock_held")
		and target_44.getCondition().(LogicalAndExpr).getAnOperand().(NotExpr).getOperand().(LogicalOrExpr).getAnOperand() instanceof Literal
		and target_44.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_682
		and target_44.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_44.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_44.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_44.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
}

*/
/*predicate func_45(Variable v__warned_682, LogicalAndExpr target_70, ExprStmt target_45) {
		target_45.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=v__warned_682
		and target_45.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_70
}

*/
/*predicate func_46(LogicalAndExpr target_70, Function func, ExprStmt target_46) {
		target_46.getExpr().(FunctionCall).getTarget().hasName("lockdep_rcu_suspicious")
		and target_46.getExpr().(FunctionCall).getArgument(0) instanceof StringLiteral
		and target_46.getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_46.getExpr().(FunctionCall).getArgument(2).(StringLiteral).getValue()="suspicious rcu_dereference_check() usage"
		and target_46.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_70
		and target_46.getEnclosingFunction() = func
}

*/
/*predicate func_48(Function func, DoStmt target_48) {
		target_48.getCondition() instanceof Literal
		and target_48.getEnclosingFunction() = func
}

*/
/*predicate func_49(Variable v_________p1_682, ExprStmt target_49) {
		target_49.getExpr().(VariableAccess).getTarget()=v_________p1_682
}

*/
/*predicate func_50(Variable vkey_655, Parameter vA_647, IfStmt target_50) {
		target_50.getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vkey_655
		and target_50.getCondition().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vA_647
}

*/
/*predicate func_51(Variable vstack_652, Variable vkeylist_654, Variable vsubtree_655, Variable vkey_655, Variable vsp_656, Variable vkix_656, Variable vkey_type_keyring, IfStmt target_51) {
		target_51.getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getTarget().getName()="type"
		and target_51.getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="(unknown field)"
		and target_51.getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_51.getCondition().(EqualityOperation).getAnOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vkey_655
		and target_51.getCondition().(EqualityOperation).getAnOperand().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vkey_type_keyring
		and target_51.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vsp_656
		and target_51.getThen().(BlockStmt).getStmt(0).(IfStmt).getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="6"
		and target_51.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="keylist"
		and target_51.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_51.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_51.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkeylist_654
		and target_51.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="kix"
		and target_51.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_51.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_51.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkix_656
		and target_51.getThen().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsp_656
		and target_51.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsubtree_655
		and target_51.getThen().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkey_655
}

*/
/*predicate func_52(Variable vsp_656, EqualityOperation target_71, IfStmt target_52) {
		target_52.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vsp_656
		and target_52.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="6"
		and target_52.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_71
}

*/
/*predicate func_53(Variable vstack_652, Variable vkeylist_654, Variable vsp_656, EqualityOperation target_71, ExprStmt target_53) {
		target_53.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="keylist"
		and target_53.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_53.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_53.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkeylist_654
		and target_53.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_71
}

*/
/*predicate func_54(Variable vstack_652, Variable vsp_656, Variable vkix_656, EqualityOperation target_71, ExprStmt target_54) {
		target_54.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getTarget().getName()="kix"
		and target_54.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_54.getExpr().(AssignExpr).getLValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_54.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkix_656
		and target_54.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_71
}

*/
/*predicate func_55(Variable vsp_656, EqualityOperation target_71, ExprStmt target_55) {
		target_55.getExpr().(PostfixIncrExpr).getOperand().(VariableAccess).getTarget()=vsp_656
		and target_55.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_71
}

*/
/*predicate func_56(Variable vsubtree_655, Variable vkey_655, EqualityOperation target_71, ExprStmt target_56) {
		target_56.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vsubtree_655
		and target_56.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vkey_655
		and target_56.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_71
}

*/
/*predicate func_57(EqualityOperation target_71, Function func, GotoStmt target_57) {
		target_57.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_71
		and target_57.getEnclosingFunction() = func
}

*/
predicate func_58(Variable vstack_652, Variable vkeylist_654, Variable vsp_656, Variable vkix_656, Function func, IfStmt target_58) {
		target_58.getCondition().(RelationalOperation).getGreaterOperand().(VariableAccess).getTarget()=vsp_656
		and target_58.getCondition().(RelationalOperation).getLesserOperand().(Literal).getValue()="0"
		and target_58.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(PostfixDecrExpr).getOperand().(VariableAccess).getTarget()=vsp_656
		and target_58.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkeylist_654
		and target_58.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="keylist"
		and target_58.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_58.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_58.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkix_656
		and target_58.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(ValueFieldAccess).getTarget().getName()="kix"
		and target_58.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(Literal).getValue()="1"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_58
}

/*predicate func_59(Variable vsp_656, RelationalOperation target_72, ExprStmt target_59) {
		target_59.getExpr().(PostfixDecrExpr).getOperand().(VariableAccess).getTarget()=vsp_656
		and target_59.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_72
}

*/
/*predicate func_60(Variable vstack_652, Variable vkeylist_654, Variable vsp_656, RelationalOperation target_72, ExprStmt target_60) {
		target_60.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkeylist_654
		and target_60.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getTarget().getName()="keylist"
		and target_60.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_60.getExpr().(AssignExpr).getRValue().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_60.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_72
}

*/
/*predicate func_61(Variable vstack_652, Variable vsp_656, Variable vkix_656, RelationalOperation target_72, ExprStmt target_61) {
		target_61.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vkix_656
		and target_61.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(ValueFieldAccess).getTarget().getName()="kix"
		and target_61.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayBase().(VariableAccess).getTarget()=vstack_652
		and target_61.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(ValueFieldAccess).getQualifier().(ArrayExpr).getArrayOffset().(VariableAccess).getTarget()=vsp_656
		and target_61.getExpr().(AssignExpr).getRValue().(AddExpr).getAnOperand().(Literal).getValue()="1"
		and target_61.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_72
}

*/
/*predicate func_62(RelationalOperation target_72, Function func, GotoStmt target_62) {
		target_62.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_72
		and target_62.getEnclosingFunction() = func
}

*/
predicate func_63(Variable vret_656, Function func, ExprStmt target_63) {
		target_63.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_656
		and target_63.getExpr().(AssignExpr).getRValue().(Literal).getValue()="0"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_63
}

predicate func_64(Variable vret_656, VariableAccess target_64) {
		target_64.getTarget()=vret_656
}

predicate func_65(Variable vret_656, Function func, ExprStmt target_65) {
		target_65.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_656
		and target_65.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-40"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_65
}

predicate func_66(Function func, GotoStmt target_66) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_66
}

predicate func_67(Variable vret_656, Function func, ExprStmt target_67) {
		target_67.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_656
		and target_67.getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-35"
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_67
}

predicate func_68(Function func, GotoStmt target_68) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_68
}

predicate func_69(BlockStmt target_73, Function func, LogicalAndExpr target_69) {
		target_69.getAnOperand() instanceof LogicalAndExpr
		and target_69.getAnOperand() instanceof NotExpr
		and target_69.getParent().(IfStmt).getThen()=target_73
		and target_69.getEnclosingFunction() = func
}

predicate func_70(BlockStmt target_74, Function func, LogicalAndExpr target_70) {
		target_70.getAnOperand() instanceof LogicalAndExpr
		and target_70.getAnOperand() instanceof NotExpr
		and target_70.getParent().(IfStmt).getThen()=target_74
		and target_70.getEnclosingFunction() = func
}

predicate func_71(Function func, EqualityOperation target_71) {
		target_71.getAnOperand() instanceof ValueFieldAccess
		and target_71.getAnOperand() instanceof AddressOfExpr
		and target_71.getEnclosingFunction() = func
}

predicate func_72(Variable vsp_656, RelationalOperation target_72) {
		 (target_72 instanceof GTExpr or target_72 instanceof LTExpr)
		and target_72.getGreaterOperand().(VariableAccess).getTarget()=vsp_656
		and target_72.getLesserOperand() instanceof Literal
}

predicate func_73(LogicalAndExpr target_69, Function func, BlockStmt target_73) {
		target_73.getStmt(0) instanceof ExprStmt
		and target_73.getStmt(1) instanceof ExprStmt
		and target_73.getParent().(IfStmt).getCondition()=target_69
		and target_73.getEnclosingFunction() = func
}

predicate func_74(LogicalAndExpr target_70, Function func, BlockStmt target_74) {
		target_74.getStmt(0) instanceof ExprStmt
		and target_74.getStmt(1) instanceof ExprStmt
		and target_74.getParent().(IfStmt).getCondition()=target_70
		and target_74.getEnclosingFunction() = func
}

from Function func, Variable vstack_652, Variable vkeylist_654, Variable vsubtree_655, Variable vkey_655, Variable vsp_656, Variable vnkeys_656, Variable vkix_656, Variable vret_656, Variable v_________p1_672, Variable v__warned_672, Variable v_________p1_682, Variable v__warned_682, Variable vkey_type_keyring, Parameter vA_647, Parameter vB_647, UnaryMinusExpr target_0, PointerFieldAccess target_1, Literal target_2, Literal target_3, Initializer target_4, VariableAccess target_10, TypeDeclarationEntry target_14, DeclStmt target_16, DeclStmt target_17, DeclStmt target_18, AssignExpr target_19, IfStmt target_20, ExprStmt target_21, ExprStmt target_22, IfStmt target_23, ExprStmt target_24, AddressOfExpr target_26, IfStmt target_35, ExprStmt target_36, ExprStmt target_37, AsmStmt target_38, ForStmt target_39, IfStmt target_58, ExprStmt target_63, VariableAccess target_64, ExprStmt target_65, GotoStmt target_66, ExprStmt target_67, GotoStmt target_68, LogicalAndExpr target_69, LogicalAndExpr target_70, EqualityOperation target_71, RelationalOperation target_72, BlockStmt target_73, BlockStmt target_74
where
func_0(vret_656, target_0)
and func_1(vsubtree_655, target_1)
and func_2(func, target_2)
and func_3(func, target_3)
and func_4(func, target_4)
and not func_7(vB_647, target_21)
and not func_8(func)
and func_10(vA_647, vB_647, target_10)
and func_14(func, target_14)
and func_16(func, target_16)
and func_17(func, target_17)
and func_18(func, target_18)
and func_19(vret_656, target_18, target_19)
and func_20(vA_647, vB_647, func, target_20)
and func_21(vsubtree_655, vB_647, func, target_21)
and func_22(vsp_656, func, target_22)
and func_23(vsubtree_655, func, target_23)
and func_24(vkeylist_654, v_________p1_672, func, target_24)
and func_26(vsubtree_655, target_26)
and func_35(vkeylist_654, func, target_35)
and func_36(vkix_656, func, target_36)
and func_37(vkeylist_654, vnkeys_656, func, target_37)
and func_38(func, target_38)
and func_39(vkeylist_654, vsubtree_655, vkey_655, vsp_656, vnkeys_656, vkix_656, vkey_type_keyring, vA_647, func, target_39)
and func_58(vstack_652, vkeylist_654, vsp_656, vkix_656, func, target_58)
and func_63(vret_656, func, target_63)
and func_64(vret_656, target_64)
and func_65(vret_656, func, target_65)
and func_66(func, target_66)
and func_67(vret_656, func, target_67)
and func_68(func, target_68)
and func_69(target_73, func, target_69)
and func_70(target_74, func, target_70)
and func_71(func, target_71)
and func_72(vsp_656, target_72)
and func_73(target_69, func, target_73)
and func_74(target_70, func, target_74)
and vstack_652.getType().hasName("struct <unnamed>[6]")
and vkeylist_654.getType().hasName("keyring_list *")
and vsubtree_655.getType().hasName("key *")
and vkey_655.getType().hasName("key *")
and vsp_656.getType().hasName("int")
and vnkeys_656.getType().hasName("int")
and vkix_656.getType().hasName("int")
and vret_656.getType().hasName("int")
and v_________p1_672.getType().hasName("keyring_list *")
and v__warned_672.getType().hasName("bool")
and v_________p1_682.getType().hasName("key *")
and v__warned_682.getType().hasName("bool")
and vkey_type_keyring.getType().hasName("key_type")
and vA_647.getType().hasName("key *")
and vB_647.getType().hasName("key *")
and vstack_652.(LocalVariable).getFunction() = func
and vkeylist_654.(LocalVariable).getFunction() = func
and vsubtree_655.(LocalVariable).getFunction() = func
and vkey_655.(LocalVariable).getFunction() = func
and vsp_656.(LocalVariable).getFunction() = func
and vnkeys_656.(LocalVariable).getFunction() = func
and vkix_656.(LocalVariable).getFunction() = func
and vret_656.(LocalVariable).getFunction() = func
and v_________p1_672.(LocalVariable).getFunction() = func
and v__warned_672.(LocalVariable).getFunction() = func
and v_________p1_682.(LocalVariable).getFunction() = func
and v__warned_682.(LocalVariable).getFunction() = func
and not vkey_type_keyring.getParentScope+() = func
and vA_647.getFunction() = func
and vB_647.getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
