/**
 * @name linux-158b515f703e75e7d68289bf4d98c664e1d632df-tun_net_init
 * @id cpp/linux/158b515f703e75e7d68289bf4d98c664e1d632df/tun-net-init
 * @description linux-158b515f703e75e7d68289bf4d98c664e1d632df-drivers/net/tun.c-tun_net_init CVE-2022-4744
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Variable vtun_1297, Literal target_0) {
	target_0.getValue()="15"
	and not target_0.getValue()="12"
	and target_0.getParent().(BitwiseAndExpr).getParent().(SwitchStmt).getExpr().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_0.getParent().(BitwiseAndExpr).getParent().(SwitchStmt).getExpr().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
}

predicate func_1(Parameter vdev_1295, Literal target_1) {
	target_1.getValue()="1500"
	and not target_1.getValue()="0"
	and target_1.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="mtu"
	and target_1.getParent().(AssignExpr).getParent().(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
}

predicate func_2(Function func, Literal target_2) {
	target_2.getValue()="65534"
	and not target_2.getValue()="0"
	and target_2.getParent().(AssignExpr).getParent().(ExprStmt).getExpr() instanceof AssignExpr
	and target_2.getEnclosingFunction() = func
}

predicate func_3(Parameter vdev_1295, BitwiseOrExpr target_3) {
	target_3.getValue()="4240"
	and target_3.getParent().(AssignExpr).getRValue() = target_3
	and target_3.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_3.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
}

predicate func_4(Function func, Literal target_4) {
	target_4.getValue()="2"
	and not target_4.getValue()="1"
	and target_4.getParent().(SwitchCase).getParent().(BlockStmt).getStmt(9) instanceof SwitchCase
	and target_4.getEnclosingFunction() = func
}

predicate func_5(Parameter vdev_1295, FunctionCall target_5) {
	target_5.getTarget().hasName("ether_setup")
	and not target_5.getTarget().hasName("u64_stats_init")
	and target_5.getArgument(0).(VariableAccess).getTarget()=vdev_1295
}

predicate func_6(Function func, ComplementExpr target_6) {
	target_6.getValue()="4294965247"
	and target_6.getEnclosingFunction() = func
}

predicate func_8(Parameter vdev_1295, FunctionCall target_8) {
	target_8.getTarget().hasName("eth_hw_addr_random")
	and not target_8.getTarget().hasName("__raw_spin_lock_init")
	and target_8.getArgument(0).(VariableAccess).getTarget()=vdev_1295
}

predicate func_9(Function func, Literal target_9) {
	target_9.getValue()="68"
	and not target_9.getValue()="1"
	and target_9.getParent().(AssignExpr).getParent().(ExprStmt).getExpr() instanceof AssignExpr
	and target_9.getEnclosingFunction() = func
}

predicate func_10(Function func, Literal target_10) {
	target_10.getValue()="65535"
	and not target_10.getValue()="1"
	and target_10.getParent().(SubExpr).getParent().(AssignExpr).getRValue() instanceof SubExpr
	and target_10.getEnclosingFunction() = func
}

predicate func_11(Parameter vdev_1295) {
exists(AssignExpr target_11 |
	target_11.getLValue().(ValueFieldAccess).getTarget().getName()="tstats"
	and target_11.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_11.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_11.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(VariableAccess).getType().hasName("pcpu_sw_netstats *")
	and target_11.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(VariableAccess).getType().hasName("pcpu_sw_netstats *"))
}

/*predicate func_12(BitwiseAndExpr target_71, Function func) {
exists(IfStmt target_12 |
	target_12.getCondition().(VariableAccess).getType().hasName("pcpu_sw_netstats *")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getInitialization().(ExprStmt).getExpr().(AssignExpr).getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getLValue().(VariableAccess).getType().hasName("int")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("cpumask_next")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getLeftOperand().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("int")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getCondition().(CommaExpr).getRightOperand().(RelationalOperation).getGreaterOperand().(VariableAccess).getType().hasName("unsigned int")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getType().hasName("pcpu_sw_netstats *")
	and target_12.getThen().(BlockStmt).getStmt(1).(ForStmt).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("u64_stats_init")
	and target_12.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_71
	and target_12.getEnclosingFunction() = func)
}

*/
/*predicate func_13(Function func) {
exists(AssignExpr target_13 |
	target_13.getLValue().(VariableAccess).getType().hasName("int")
	and target_13.getRValue().(UnaryMinusExpr).getValue()="-1"
	and target_13.getEnclosingFunction() = func)
}

*/
/*predicate func_14(Function func) {
exists(AssignExpr target_14 |
	target_14.getLValue().(VariableAccess).getType().hasName("pcpu_sw_netstats *")
	and target_14.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getCondition() instanceof Literal
	and target_14.getRValue().(StmtExpr).getStmt().(BlockStmt).getStmt(0).(DoStmt).getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(VariableAccess).getType().hasName("const void *")
	and target_14.getEnclosingFunction() = func)
}

*/
/*predicate func_16(Function func) {
exists(StmtExpr target_16 |
	target_16.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(0).(VariableAccess).getType().hasName("unsigned long")
	and target_16.getStmt().(BlockStmt).getStmt(1).(AsmStmt).getChild(1).(VariableAccess).getType().hasName("pcpu_sw_netstats *")
	and target_16.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getLeftOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_16.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("unsigned long[8192]")
	and target_16.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AddExpr).getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_16.getEnclosingFunction() = func)
}

*/
/*predicate func_17(Function func) {
exists(AddExpr target_17 |
	target_17.getLeftOperand().(VariableAccess).getType().hasName("unsigned long")
	and target_17.getRightOperand().(ArrayExpr).getArrayBase().(VariableAccess).getType().hasName("unsigned long[8192]")
	and target_17.getRightOperand().(ArrayExpr).getArrayOffset().(VariableAccess).getType().hasName("int")
	and target_17.getEnclosingFunction() = func)
}

*/
/*predicate func_18(Function func) {
exists(AddressOfExpr target_18 |
	target_18.getOperand().(PointerFieldAccess).getTarget().getName()="syncp"
	and target_18.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("pcpu_sw_netstats *")
	and target_18.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_18.getEnclosingFunction() = func)
}

*/
predicate func_20(Parameter vdev_1295, ExprStmt target_72, Function func) {
exists(IfStmt target_20 |
	target_20.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getTarget().getName()="tstats"
	and target_20.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_20.getCondition().(NotExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_20.getThen().(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-12"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_20
	and target_20.getLocation().isBefore(target_72.getLocation()))
}

/*predicate func_21(Function func) {
exists(UnaryMinusExpr target_21 |
	target_21.getValue()="-12"
	and target_21.getEnclosingFunction() = func)
}

*/
predicate func_22(ExprStmt target_72, Function func) {
exists(DoStmt target_22 |
	target_22.getCondition().(Literal).getValue()="0"
	and target_22.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__raw_spin_lock_init")
	and target_22.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getTarget().hasName("spinlock_check")
	and target_22.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_22.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(StringLiteral).getValue()="&tun->lock"
	and target_22.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("lock_class_key")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_22
	and target_22.getLocation().isBefore(target_72.getLocation()))
}

/*predicate func_23(Variable vtun_1297) {
exists(FunctionCall target_23 |
	target_23.getTarget().hasName("spinlock_check")
	and target_23.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="lock"
	and target_23.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_23.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall)
}

*/
/*predicate func_25(Function func) {
exists(AddressOfExpr target_25 |
	target_25.getOperand().(VariableAccess).getType().hasName("lock_class_key")
	and target_25.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
	and target_25.getEnclosingFunction() = func)
}

*/
predicate func_26(Variable vtun_1297, BitwiseAndExpr target_71) {
exists(AssignExpr target_26 |
	target_26.getLValue().(VariableAccess).getType().hasName("int")
	and target_26.getRValue().(FunctionCall).getTarget().hasName("security_tun_dev_alloc_security")
	and target_26.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="security"
	and target_26.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_71.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_26.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_27(Parameter vdev_1295, ExprStmt target_72, Function func) {
exists(IfStmt target_27 |
	target_27.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_27.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_27.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("free_percpu")
	and target_27.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="tstats"
	and target_27.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_27.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_27.getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_27
	and target_27.getLocation().isBefore(target_72.getLocation()))
}

predicate func_28(Variable vtun_1297, ExprStmt target_72, Function func) {
exists(ExprStmt target_28 |
	target_28.getExpr().(FunctionCall).getTarget().hasName("tun_flow_init")
	and target_28.getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_1297
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_28
	and target_28.getLocation().isBefore(target_72.getLocation()))
}

predicate func_29(Parameter vdev_1295, ExprStmt target_72, ExprStmt target_75, Function func) {
exists(ExprStmt target_29 |
	target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="hw_features"
	and target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_29.getExpr().(AssignExpr).getRValue().(BitwiseOrExpr).getValue()="35184373465289"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_29
	and target_29.getLocation().isBefore(target_72.getLocation())
	and target_29.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_75.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getLocation()))
}

predicate func_30(Parameter vdev_1295) {
exists(AssignExpr target_30 |
	target_30.getLValue().(PointerFieldAccess).getTarget().getName()="features"
	and target_30.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_30.getRValue().(BitwiseOrExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="hw_features"
	and target_30.getRValue().(BitwiseOrExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_30.getRValue().(BitwiseOrExpr).getRightOperand().(BinaryBitwiseOperation).getValue()="4096")
}

predicate func_31(Parameter vdev_1295) {
exists(AssignExpr target_31 |
	target_31.getLValue().(PointerFieldAccess).getTarget().getName()="vlan_features"
	and target_31.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_31.getRValue().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="features"
	and target_31.getRValue().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_31.getRValue().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="18446708889337462655")
}

predicate func_33(Parameter vdev_1295, Variable vtun_1297) {
exists(BitwiseOrExpr target_33 |
	target_33.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_33.getLeftOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_33.getLeftOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294938319"
	and target_33.getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_33.getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_33.getRightOperand().(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ifreq *")
	and target_33.getRightOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="28976"
	and target_33.getParent().(AssignExpr).getRValue() = target_33
	and target_33.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="mtu"
	and target_33.getParent().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295)
}

predicate func_34(Function func) {
exists(BitwiseOrExpr target_34 |
	target_34.getValue()="28928"
	and target_34.getEnclosingFunction() = func)
}

predicate func_37(Variable vtun_1297) {
exists(FunctionCall target_37 |
	target_37.getTarget().hasName("INIT_LIST_HEAD")
	and target_37.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="disabled"
	and target_37.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297)
}

predicate func_38(Variable vtun_1297) {
exists(AssignExpr target_38 |
	target_38.getLValue().(VariableAccess).getType().hasName("int")
	and target_38.getRValue().(FunctionCall).getTarget().hasName("tun_attach")
	and target_38.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_1297
	and target_38.getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="file"
	and target_38.getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_38.getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_38.getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_38.getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ifreq *")
	and target_38.getRValue().(FunctionCall).getArgument(3).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="16"
	and target_38.getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getTarget().getName()="ifru_flags"
	and target_38.getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="ifr_ifru"
	and target_38.getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getLeftOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("ifreq *")
	and target_38.getRValue().(FunctionCall).getArgument(4).(BitwiseAndExpr).getRightOperand().(Literal).getValue()="32")
}

predicate func_39(Parameter vdev_1295, Variable vtun_1297, Function func) {
exists(IfStmt target_39 |
	target_39.getCondition().(RelationalOperation).getLesserOperand().(VariableAccess).getType().hasName("int")
	and target_39.getCondition().(RelationalOperation).getGreaterOperand().(Literal).getValue()="0"
	and target_39.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("tun_flow_uninit")
	and target_39.getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(VariableAccess).getTarget()=vtun_1297
	and target_39.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("security_tun_dev_free_security")
	and target_39.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="security"
	and target_39.getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_39.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("free_percpu")
	and target_39.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getTarget().getName()="tstats"
	and target_39.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
	and target_39.getThen().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_39.getThen().(BlockStmt).getStmt(3).(ReturnStmt).getExpr().(VariableAccess).getType().hasName("int")
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_39)
}

predicate func_40(Function func) {
exists(ReturnStmt target_40 |
	target_40.getExpr().(Literal).getValue()="0"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_40)
}

predicate func_41(Parameter vdev_1295, VariableAccess target_41) {
	target_41.getTarget()=vdev_1295
}

predicate func_42(Parameter vdev_1295, VariableAccess target_42) {
	target_42.getTarget()=vdev_1295
}

predicate func_43(Parameter vdev_1295, VariableAccess target_43) {
	target_43.getTarget()=vdev_1295
}

predicate func_44(Parameter vdev_1295, VariableAccess target_44) {
	target_44.getTarget()=vdev_1295
}

predicate func_45(Parameter vdev_1295, VariableAccess target_45) {
	target_45.getTarget()=vdev_1295
}

predicate func_46(Parameter vdev_1295, VariableAccess target_46) {
	target_46.getTarget()=vdev_1295
}

predicate func_47(Parameter vdev_1295, VariableAccess target_47) {
	target_47.getTarget()=vdev_1295
}

predicate func_48(Parameter vdev_1295, VariableAccess target_48) {
	target_48.getTarget()=vdev_1295
}

predicate func_49(Parameter vdev_1295, VariableAccess target_49) {
	target_49.getTarget()=vdev_1295
}

predicate func_53(Parameter vdev_1295, Variable vtun_1297, Variable vtun_netdev_ops, Variable vip_tunnel_header_ops, Variable vtap_netdev_ops, Function func, SwitchStmt target_53) {
	target_53.getExpr().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_53.getExpr().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_53.getExpr().(BitwiseAndExpr).getRightOperand() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(0).(SwitchCase).getExpr() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="netdev_ops"
	and target_53.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtun_netdev_ops
	and target_53.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="header_ops"
	and target_53.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vip_tunnel_header_ops
	and target_53.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="hard_header_len"
	and target_53.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="addr_len"
	and target_53.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="mtu"
	and target_53.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="type"
	and target_53.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(6).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_53.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(7).(ExprStmt).getExpr().(AssignExpr).getRValue() instanceof BitwiseOrExpr
	and target_53.getStmt().(BlockStmt).getStmt(9).(SwitchCase).getExpr() instanceof Literal
	and target_53.getStmt().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="netdev_ops"
	and target_53.getStmt().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(10).(ExprStmt).getExpr().(AssignExpr).getRValue().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtap_netdev_ops
	and target_53.getStmt().(BlockStmt).getStmt(11).(ExprStmt).getExpr() instanceof FunctionCall
	and target_53.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignAndExpr).getLValue().(PointerFieldAccess).getTarget().getName()="priv_flags"
	and target_53.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignAndExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(12).(ExprStmt).getExpr().(AssignAndExpr).getRValue() instanceof ComplementExpr
	and target_53.getStmt().(BlockStmt).getStmt(13).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getTarget().getName()="priv_flags"
	and target_53.getStmt().(BlockStmt).getStmt(13).(ExprStmt).getExpr().(AssignOrExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_53.getStmt().(BlockStmt).getStmt(13).(ExprStmt).getExpr().(AssignOrExpr).getRValue() instanceof EnumConstantAccess
	and target_53.getStmt().(BlockStmt).getStmt(14).(ExprStmt).getExpr() instanceof FunctionCall
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_53
}

/*predicate func_54(Function func, SwitchCase target_54) {
	target_54.getExpr() instanceof Literal
	and target_54.getEnclosingFunction() = func
}

*/
/*predicate func_55(Parameter vdev_1295, Variable vtun_netdev_ops, AssignExpr target_55) {
	target_55.getLValue().(PointerFieldAccess).getTarget().getName()="netdev_ops"
	and target_55.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_55.getRValue().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtun_netdev_ops
}

*/
/*predicate func_56(Parameter vdev_1295, Variable vip_tunnel_header_ops, AssignExpr target_56) {
	target_56.getLValue().(PointerFieldAccess).getTarget().getName()="header_ops"
	and target_56.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_56.getRValue().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vip_tunnel_header_ops
}

*/
/*predicate func_57(Parameter vdev_1295, AssignExpr target_57) {
	target_57.getLValue().(PointerFieldAccess).getTarget().getName()="hard_header_len"
	and target_57.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_57.getRValue() instanceof Literal
}

*/
/*predicate func_58(Parameter vdev_1295, AssignExpr target_58) {
	target_58.getLValue().(PointerFieldAccess).getTarget().getName()="addr_len"
	and target_58.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_58.getRValue() instanceof Literal
}

*/
/*predicate func_59(Parameter vdev_1295, PointerFieldAccess target_59) {
	target_59.getTarget().getName()="mtu"
	and target_59.getQualifier().(VariableAccess).getTarget()=vdev_1295
}

*/
/*predicate func_60(Parameter vdev_1295, AssignExpr target_60) {
	target_60.getLValue().(PointerFieldAccess).getTarget().getName()="type"
	and target_60.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_60.getRValue() instanceof Literal
}

*/
/*predicate func_61(Parameter vdev_1295, AssignExpr target_61) {
	target_61.getLValue().(PointerFieldAccess).getTarget().getName()="flags"
	and target_61.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_61.getRValue() instanceof BitwiseOrExpr
}

*/
/*predicate func_62(BitwiseAndExpr target_71, Function func, BreakStmt target_62) {
	target_62.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_71
	and target_62.getEnclosingFunction() = func
}

*/
/*predicate func_63(Function func, SwitchCase target_63) {
	target_63.getExpr() instanceof Literal
	and target_63.getEnclosingFunction() = func
}

*/
/*predicate func_64(Parameter vdev_1295, Variable vtap_netdev_ops, AssignExpr target_64) {
	target_64.getLValue().(PointerFieldAccess).getTarget().getName()="netdev_ops"
	and target_64.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_64.getRValue().(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vtap_netdev_ops
}

*/
/*predicate func_65(Parameter vdev_1295, AssignAndExpr target_65) {
	target_65.getLValue().(PointerFieldAccess).getTarget().getName()="priv_flags"
	and target_65.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_65.getRValue() instanceof ComplementExpr
}

*/
/*predicate func_66(Parameter vdev_1295, AssignOrExpr target_66) {
	target_66.getLValue().(PointerFieldAccess).getTarget().getName()="priv_flags"
	and target_66.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_66.getRValue() instanceof EnumConstantAccess
}

*/
/*predicate func_67(BitwiseAndExpr target_71, Function func, BreakStmt target_67) {
	target_67.getParent().(BlockStmt).getParent().(SwitchStmt).getExpr()=target_71
	and target_67.getEnclosingFunction() = func
}

*/
predicate func_68(Parameter vdev_1295, AssignExpr target_68) {
	target_68.getLValue().(PointerFieldAccess).getTarget().getName()="min_mtu"
	and target_68.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_68.getRValue() instanceof Literal
}

predicate func_69(Parameter vdev_1295, AssignExpr target_69) {
	target_69.getLValue().(PointerFieldAccess).getTarget().getName()="max_mtu"
	and target_69.getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_69.getRValue().(SubExpr).getLeftOperand() instanceof Literal
	and target_69.getRValue().(SubExpr).getRightOperand().(PointerFieldAccess).getTarget().getName()="hard_header_len"
	and target_69.getRValue().(SubExpr).getRightOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
}

predicate func_71(Variable vtun_1297, BitwiseAndExpr target_71) {
	target_71.getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
	and target_71.getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vtun_1297
	and target_71.getRightOperand() instanceof Literal
}

predicate func_72(Function func, ExprStmt target_72) {
	target_72.getExpr() instanceof AssignExpr
	and target_72.getEnclosingFunction() = func
}

predicate func_75(Parameter vdev_1295, ExprStmt target_75) {
	target_75.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="mtu"
	and target_75.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_1295
	and target_75.getExpr().(AssignExpr).getRValue() instanceof Literal
}

from Function func, Parameter vdev_1295, Variable vtun_1297, Variable vtun_netdev_ops, Variable vip_tunnel_header_ops, Variable vtap_netdev_ops, Literal target_0, Literal target_1, Literal target_2, BitwiseOrExpr target_3, Literal target_4, FunctionCall target_5, ComplementExpr target_6, FunctionCall target_8, Literal target_9, Literal target_10, VariableAccess target_41, VariableAccess target_42, VariableAccess target_43, VariableAccess target_44, VariableAccess target_45, VariableAccess target_46, VariableAccess target_47, VariableAccess target_48, VariableAccess target_49, SwitchStmt target_53, AssignExpr target_68, AssignExpr target_69, BitwiseAndExpr target_71, ExprStmt target_72, ExprStmt target_75
where
func_0(vtun_1297, target_0)
and func_1(vdev_1295, target_1)
and func_2(func, target_2)
and func_3(vdev_1295, target_3)
and func_4(func, target_4)
and func_5(vdev_1295, target_5)
and func_6(func, target_6)
and func_8(vdev_1295, target_8)
and func_9(func, target_9)
and func_10(func, target_10)
and not func_11(vdev_1295)
and not func_20(vdev_1295, target_72, func)
and not func_22(target_72, func)
and not func_26(vtun_1297, target_71)
and not func_27(vdev_1295, target_72, func)
and not func_28(vtun_1297, target_72, func)
and not func_29(vdev_1295, target_72, target_75, func)
and not func_30(vdev_1295)
and not func_31(vdev_1295)
and not func_33(vdev_1295, vtun_1297)
and not func_34(func)
and not func_37(vtun_1297)
and not func_38(vtun_1297)
and not func_39(vdev_1295, vtun_1297, func)
and not func_40(func)
and func_41(vdev_1295, target_41)
and func_42(vdev_1295, target_42)
and func_43(vdev_1295, target_43)
and func_44(vdev_1295, target_44)
and func_45(vdev_1295, target_45)
and func_46(vdev_1295, target_46)
and func_47(vdev_1295, target_47)
and func_48(vdev_1295, target_48)
and func_49(vdev_1295, target_49)
and func_53(vdev_1295, vtun_1297, vtun_netdev_ops, vip_tunnel_header_ops, vtap_netdev_ops, func, target_53)
and func_68(vdev_1295, target_68)
and func_69(vdev_1295, target_69)
and func_71(vtun_1297, target_71)
and func_72(func, target_72)
and func_75(vdev_1295, target_75)
and vdev_1295.getType().hasName("net_device *")
and vtun_1297.getType().hasName("tun_struct *")
and vtun_netdev_ops.getType().hasName("const net_device_ops")
and vip_tunnel_header_ops.getType().hasName("const header_ops")
and vtap_netdev_ops.getType().hasName("const net_device_ops")
and vdev_1295.getFunction() = func
and vtun_1297.(LocalVariable).getFunction() = func
and not vtun_netdev_ops.getParentScope+() = func
and not vip_tunnel_header_ops.getParentScope+() = func
and not vtap_netdev_ops.getParentScope+() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
