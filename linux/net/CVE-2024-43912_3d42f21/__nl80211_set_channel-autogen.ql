/**
 * @name linux-3d42f2125f6c89e1e71c87b9f23412afddbba45e-__nl80211_set_channel
 * @id cpp/linux/3d42f2125f6c89e1e71c87b9f23412afddbba45e/--nl80211-set-channel
 * @description linux-3d42f2125f6c89e1e71c87b9f23412afddbba45e-net/wireless/nl80211.c-__nl80211_set_channel CVE-2024-43912
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

/*predicate func_2(Function func, UnaryMinusExpr target_2) {
	target_2.getValue()="-22"
	and target_2.getEnclosingFunction() = func
}

*/
predicate func_3(Function func, ReturnStmt target_3) {
	target_3.getExpr().(UnaryMinusExpr).getValue()="-22"
	and func.getEntryPoint().(BlockStmt).getAStmt()=target_3
}

from Function func, ReturnStmt target_3
where
func_3(func, target_3)
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
