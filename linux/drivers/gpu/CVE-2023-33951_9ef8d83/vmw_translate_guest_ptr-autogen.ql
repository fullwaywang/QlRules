/**
 * @name linux-9ef8d83e8e25d5f1811b3a38eb1484f85f64296c-vmw_translate_guest_ptr
 * @id cpp/linux/9ef8d83e8e25d5f1811b3a38eb1484f85f64296c/vmw-translate-guest-ptr
 * @description linux-9ef8d83e8e25d5f1811b3a38eb1484f85f64296c-drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c-vmw_translate_guest_ptr CVE-2023-33951
 * @kind problem
 * @problem.severity error
 * @tags security
 */

import cpp

predicate func_0(Parameter vsw_context_1205, Variable vvmw_bo_1209, Variable vhandle_1210, VariableAccess target_0) {
		target_0.getTarget()=vvmw_bo_1209
		and target_0.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_lookup")
		and target_0.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="filp"
		and target_0.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
		and target_0.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_1210
}

/*predicate func_1(Variable vvmw_bo_1209, VariableAccess target_1) {
		target_1.getTarget()=vvmw_bo_1209
		and target_1.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("ttm_bo_put")
		and target_1.getParent().(PointerFieldAccess).getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="tbo"
}

*/
predicate func_2(Function func, UnaryMinusExpr target_2) {
		target_2.getValue()="-12"
		and target_2.getEnclosingFunction() = func
}

predicate func_3(Parameter vptr_1206, Initializer target_3) {
		target_3.getExpr().(PointerFieldAccess).getTarget().getName()="gmrId"
		and target_3.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vptr_1206
}

predicate func_4(Parameter vsw_context_1205, FunctionCall target_4) {
		target_4.getTarget().hasName("vmw_validation_preload_bo")
		and not target_4.getTarget().hasName("vmw_user_bo_synccpu_grab")
		and target_4.getArgument(0).(PointerFieldAccess).getTarget().getName()="ctx"
		and target_4.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
}

predicate func_7(Function func, FunctionCall target_7) {
		target_7.getTarget().hasName("__compiletime_assert_996")
		and not target_7.getTarget().hasName("__drm_err")
		and target_7.getEnclosingFunction() = func
}

predicate func_10(Variable v__UNIQUE_ID_ddebug995_1217, FunctionCall target_10) {
		target_10.getTarget().hasName("__drm_dev_dbg")
		and not target_10.getTarget().hasName("vmw_bo_unreference")
		and target_10.getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=v__UNIQUE_ID_ddebug995_1217
		and target_10.getArgument(1).(ConditionalExpr).getCondition() instanceof AddressOfExpr
		and target_10.getArgument(1).(ConditionalExpr).getThen().(PointerFieldAccess).getTarget().getName()="dev"
		and target_10.getArgument(1).(ConditionalExpr).getThen().(PointerFieldAccess).getQualifier() instanceof AddressOfExpr
		and target_10.getArgument(1).(ConditionalExpr).getElse() instanceof Literal
		and target_10.getArgument(3).(StringLiteral).getValue()="Could not find or use GMR region.\n"
}

predicate func_11(Variable vvmw_bo_1209, AddressOfExpr target_84, ExprStmt target_72, FunctionCall target_11) {
		target_11.getTarget().hasName("PTR_ERR")
		and not target_11.getTarget().hasName("__builtin_expect")
		and target_11.getArgument(0).(VariableAccess).getTarget()=vvmw_bo_1209
		and target_84.getOperand().(VariableAccess).getLocation().isBefore(target_11.getArgument(0).(VariableAccess).getLocation())
}

predicate func_12(Variable vvmw_bo_1209, FunctionCall target_12) {
		target_12.getTarget().hasName("vmw_bo_placement_set")
		and not target_12.getTarget().hasName("drm_gem_object_put")
		and target_12.getArgument(0).(VariableAccess).getTarget()=vvmw_bo_1209
		and target_12.getArgument(1).(BitwiseOrExpr).getValue()="12"
		and target_12.getArgument(2).(BitwiseOrExpr).getValue()="12"
}

predicate func_13(Parameter vsw_context_1205, Variable vvmw_bo_1209, Variable vret_1212, FunctionCall target_13) {
		target_13.getTarget().hasName("vmw_validation_add_bo")
		and not target_13.getTarget().hasName("vmw_user_bo_synccpu_release")
		and target_13.getArgument(0).(PointerFieldAccess).getTarget().getName()="ctx"
		and target_13.getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
		and target_13.getArgument(1).(VariableAccess).getTarget()=vvmw_bo_1209
		and target_13.getParent().(AssignExpr).getRValue() = target_13
		and target_13.getParent().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1212
}

predicate func_14(Variable vvmw_bo_1209, FunctionCall target_14) {
		target_14.getTarget().hasName("ttm_bo_put")
		and not target_14.getTarget().hasName("__drm_err")
		and target_14.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="tbo"
		and target_14.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vvmw_bo_1209
}

predicate func_15(Parameter vsw_context_1205, Variable vreloc_1211, FunctionCall target_15) {
		target_15.getTarget().hasName("list_add_tail")
		and not target_15.getTarget().hasName("__drm_err")
		and target_15.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="head"
		and target_15.getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreloc_1211
		and target_15.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="bo_relocations"
		and target_15.getArgument(1).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
}

predicate func_18(ExprStmt target_85, Function func) {
	exists(LogicalOrExpr target_18 |
		target_18.getAnOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getRightOperand().(BitwiseOrExpr).getValue()="3"
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getTarget().getName()="flags"
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getLeftOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(BitwiseAndExpr).getRightOperand().(ComplementExpr).getValue()="4294967280"
		and target_18.getAnOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_18.getParent().(IfStmt).getThen()=target_85
		and target_18.getEnclosingFunction() = func)
}

predicate func_20(Variable vret_1212) {
	exists(SwitchStmt target_20 |
		target_20.getExpr().(PointerFieldAccess).getTarget().getName()="op"
		and target_20.getExpr().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_20.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1212
		and target_20.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_lookup")
		and target_20.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("drm_file *")
		and target_20.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="handle"
		and target_20.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_20.getStmt().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vmw_bo *")
		and target_20.getStmt().(BlockStmt).getStmt(2) instanceof IfStmt
		and target_20.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1212
		and target_20.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_synccpu_grab")
		and target_20.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("vmw_bo *")
		and target_20.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="flags"
		and target_20.getStmt().(BlockStmt).getStmt(3).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_20.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("vmw_bo_unreference")
		and target_20.getStmt().(BlockStmt).getStmt(4).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(VariableAccess).getType().hasName("vmw_bo *")
		and target_20.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("drm_gem_object_put")
		and target_20.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="base"
		and target_20.getStmt().(BlockStmt).getStmt(5).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="tbo"
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand() instanceof EqualityOperation
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__drm_err")
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="Failed synccpu grab on handle 0x%08x.\n"
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getThen().(BlockStmt).getStmt(1).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="handle"
		and target_20.getStmt().(BlockStmt).getStmt(6).(IfStmt).getThen().(BlockStmt).getStmt(2).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_1212
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1212
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_synccpu_release")
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("drm_file *")
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="handle"
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="flags"
		and target_20.getStmt().(BlockStmt).getStmt(9).(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_20.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_20.getStmt().(BlockStmt).getStmt(10).(IfStmt).getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_20.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__drm_err")
		and target_20.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="Failed synccpu release on handle 0x%08x.\n"
		and target_20.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(0).(ExprStmt).getExpr().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="handle"
		and target_20.getStmt().(BlockStmt).getStmt(10).(IfStmt).getThen().(BlockStmt).getStmt(1).(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_1212
		and target_20.getStmt().(BlockStmt).getStmt(12).(SwitchCase).toString() = "default: "
		and target_20.getStmt().(BlockStmt).getStmt(13).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__drm_err")
		and target_20.getStmt().(BlockStmt).getStmt(13).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(StringLiteral).getValue()="Invalid synccpu operation.\n"
		and target_20.getStmt().(BlockStmt).getStmt(14).(ReturnStmt).getExpr().(UnaryMinusExpr).getValue()="-22")
}

/*predicate func_23(Function func) {
	exists(PointerFieldAccess target_23 |
		target_23.getTarget().getName()="handle"
		and target_23.getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_23.getEnclosingFunction() = func)
}

*/
/*predicate func_24(Function func) {
	exists(PointerFieldAccess target_24 |
		target_24.getTarget().getName()="flags"
		and target_24.getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_24.getEnclosingFunction() = func)
}

*/
/*predicate func_25(Function func) {
	exists(AddressOfExpr target_25 |
		target_25.getOperand().(VariableAccess).getType().hasName("vmw_bo *")
		and target_25.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
		and target_25.getEnclosingFunction() = func)
}

*/
/*predicate func_26(Function func) {
	exists(AddressOfExpr target_26 |
		target_26.getOperand().(ValueFieldAccess).getTarget().getName()="base"
		and target_26.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="tbo"
		and target_26.getOperand().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("vmw_bo *")
		and target_26.getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
		and target_26.getEnclosingFunction() = func)
}

*/
/*predicate func_27(Variable vret_1212, ExprStmt target_68, EqualityOperation target_46) {
	exists(LogicalOrExpr target_27 |
		target_27.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vret_1212
		and target_27.getAnOperand().(EqualityOperation).getAnOperand().(UnaryMinusExpr).getValue()="-512"
		and target_27.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vret_1212
		and target_27.getAnOperand().(EqualityOperation).getAnOperand().(UnaryMinusExpr).getValue()="-16"
		and target_27.getParent().(IfStmt).getThen()=target_68
		and target_46.getAnOperand().(VariableAccess).getLocation().isBefore(target_27.getAnOperand().(EqualityOperation).getAnOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_28(StmtExpr target_59, Function func) {
	exists(ReturnStmt target_28 |
		target_28.getExpr().(UnaryMinusExpr).getValue()="-16"
		and target_28.getParent().(IfStmt).getCondition()=target_59
		and target_28.getEnclosingFunction() = func)
}

*/
/*predicate func_30(Function func) {
	exists(PointerFieldAccess target_30 |
		target_30.getTarget().getName()="handle"
		and target_30.getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_30.getEnclosingFunction() = func)
}

*/
/*predicate func_34(Variable vret_1212) {
	exists(AssignExpr target_34 |
		target_34.getLValue().(VariableAccess).getTarget()=vret_1212
		and target_34.getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_synccpu_release")
		and target_34.getRValue().(FunctionCall).getArgument(0).(VariableAccess).getType().hasName("drm_file *")
		and target_34.getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getTarget().getName()="handle"
		and target_34.getRValue().(FunctionCall).getArgument(1).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_34.getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getTarget().getName()="flags"
		and target_34.getRValue().(FunctionCall).getArgument(2).(PointerFieldAccess).getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *"))
}

*/
/*predicate func_36(Function func) {
	exists(PointerFieldAccess target_36 |
		target_36.getTarget().getName()="handle"
		and target_36.getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_36.getEnclosingFunction() = func)
}

*/
/*predicate func_37(Function func) {
	exists(PointerFieldAccess target_37 |
		target_37.getTarget().getName()="flags"
		and target_37.getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_37.getEnclosingFunction() = func)
}

*/
/*predicate func_38(Variable vreloc_1211, Variable vret_1212, ReturnStmt target_87, ReturnStmt target_88) {
	exists(NotExpr target_38 |
		target_38.getOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vret_1212
		and target_38.getOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_38.getParent().(NotExpr).getOperand().(VariableAccess).getTarget()=vreloc_1211
		and target_38.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_87
		and target_88.getExpr().(VariableAccess).getLocation().isBefore(target_38.getOperand().(EqualityOperation).getAnOperand().(VariableAccess).getLocation()))
}

*/
/*predicate func_40(Function func) {
	exists(PointerFieldAccess target_40 |
		target_40.getTarget().getName()="handle"
		and target_40.getQualifier().(VariableAccess).getType().hasName("drm_vmw_synccpu_arg *")
		and target_40.getEnclosingFunction() = func)
}

*/
/*predicate func_43(Function func) {
	exists(SwitchCase target_43 |
		target_43.toString() = "default: "
		and target_43.getEnclosingFunction() = func)
}

*/
/*predicate func_44(Function func) {
	exists(FunctionCall target_44 |
		target_44.getTarget().hasName("__drm_err")
		and target_44.getArgument(0).(StringLiteral).getValue()="Invalid synccpu operation.\n"
		and target_44.getEnclosingFunction() = func)
}

*/
/*predicate func_45(Function func) {
	exists(ReturnStmt target_45 |
		target_45.getExpr().(UnaryMinusExpr).getValue()="-22"
		and target_45.getEnclosingFunction() = func)
}

*/
predicate func_46(Variable vret_1212, BlockStmt target_89, EqualityOperation target_46) {
		target_46.getAnOperand().(VariableAccess).getTarget()=vret_1212
		and target_46.getAnOperand().(Literal).getValue()="0"
		and target_46.getParent().(IfStmt).getThen()=target_89
}

predicate func_47(Variable vret_1212, Function func, IfStmt target_47) {
		target_47.getCondition().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_47.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(VariableAccess).getTarget()=vret_1212
		and target_47.getCondition().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(EqualityOperation).getAnOperand().(Literal).getValue()="0"
		and target_47.getCondition().(FunctionCall).getArgument(1).(Literal).getValue()="0"
		and target_47.getThen().(ReturnStmt).getExpr().(VariableAccess).getTarget()=vret_1212
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_47
}

predicate func_48(Function func, DeclStmt target_48) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_48
}

predicate func_49(Parameter vptr_1206, VariableAccess target_49) {
		target_49.getTarget()=vptr_1206
}

predicate func_50(Function func, DeclStmt target_50) {
		func.getEntryPoint().(BlockStmt).getAStmt()=target_50
}

predicate func_51(Parameter vsw_context_1205, ExprStmt target_91, VariableAccess target_51) {
		target_51.getTarget()=vsw_context_1205
		and target_51.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
		and target_51.getLocation().isBefore(target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation())
}

/*predicate func_52(Parameter vsw_context_1205, PointerFieldAccess target_52) {
		target_52.getTarget().getName()="filp"
		and target_52.getQualifier().(VariableAccess).getTarget()=vsw_context_1205
}

*/
predicate func_53(Parameter vsw_context_1205, Variable vvmw_bo_1209, Variable vhandle_1210, VariableAccess target_53) {
		target_53.getTarget()=vhandle_1210
		and target_53.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_lookup")
		and target_53.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="filp"
		and target_53.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
		and target_53.getParent().(FunctionCall).getParent().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vvmw_bo_1209
}

predicate func_54(EqualityOperation target_46, Function func, DoStmt target_54) {
		target_54.getCondition() instanceof Literal
		and target_54.getStmt().(BlockStmt).getStmt(1).(DoStmt).getCondition() instanceof Literal
		and target_54.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
		and target_54.getStmt().(BlockStmt).getStmt(1).(DoStmt).getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
		and target_54.getStmt().(BlockStmt).getStmt(2).(IfStmt).getCondition().(StmtExpr).getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_54.getStmt().(BlockStmt).getStmt(2).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
		and target_54.getParent().(BlockStmt).getParent().(IfStmt).getCondition()=target_46
		and target_54.getEnclosingFunction() = func
}

/*predicate func_56(Function func, DoStmt target_56) {
		target_56.getCondition() instanceof Literal
		and target_56.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(NotExpr).getValue()="0"
		and target_56.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr() instanceof FunctionCall
		and target_56.getEnclosingFunction() = func
}

*/
/*predicate func_58(ExprStmt target_85, Function func, NotExpr target_58) {
		target_58.getValue()="0"
		and target_58.getParent().(IfStmt).getThen()=target_85
		and target_58.getEnclosingFunction() = func
}

*/
/*predicate func_59(Variable vbranch_1217, ExprStmt target_68, StmtExpr target_59) {
		target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getCondition().(BuiltInOperation).getValue()="0"
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof EnumConstantAccess
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getCondition().(BuiltInOperation).getValue()="1"
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_59.getStmt().(BlockStmt).getStmt(1).(IfStmt).getElse().(IfStmt).getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
		and target_59.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_59.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vbranch_1217
		and target_59.getStmt().(BlockStmt).getStmt(2).(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
		and target_59.getParent().(IfStmt).getThen()=target_68
}

*/
/*predicate func_61(Function func, BuiltInOperation target_61) {
		target_61.getValue()="0"
		and target_61.getEnclosingFunction() = func
}

*/
/*predicate func_62(Variable vbranch_1217, AssignExpr target_62) {
		target_62.getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_62.getRValue().(FunctionCall).getTarget().hasName("arch_static_branch_jump")
		and target_62.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
		and target_62.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="dd_key_false"
		and target_62.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="key"
		and target_62.getRValue().(FunctionCall).getArgument(1) instanceof EnumConstantAccess
}

*/
/*predicate func_63(Variable vbranch_1217, BuiltInOperation target_61, IfStmt target_63) {
		target_63.getCondition().(BuiltInOperation).getValue()="1"
		and target_63.getThen().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_63.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
		and target_63.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
		and target_63.getThen().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1) instanceof EnumConstantAccess
		and target_63.getElse().(ExprStmt).getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_63.getElse().(ExprStmt).getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
		and target_63.getParent().(IfStmt).getCondition()=target_61
}

*/
/*predicate func_64(Variable vbranch_1217, AssignExpr target_64) {
		target_64.getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_64.getRValue().(FunctionCall).getTarget().hasName("arch_static_branch")
		and target_64.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="key"
		and target_64.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(ValueFieldAccess).getTarget().getName()="dd_key_false"
		and target_64.getRValue().(FunctionCall).getArgument(0).(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(AddressOfExpr).getOperand().(ValueFieldAccess).getQualifier().(ValueFieldAccess).getTarget().getName()="key"
		and target_64.getRValue().(FunctionCall).getArgument(1) instanceof EnumConstantAccess
}

*/
/*predicate func_65(Variable vbranch_1217, AssignExpr target_65) {
		target_65.getLValue().(VariableAccess).getTarget()=vbranch_1217
		and target_65.getRValue().(FunctionCall).getTarget().hasName("____wrong_branch_error")
}

*/
/*predicate func_66(Variable vbranch_1217, ExprStmt target_66) {
		target_66.getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_66.getExpr().(FunctionCall).getArgument(0).(NotExpr).getOperand().(NotExpr).getOperand().(VariableAccess).getTarget()=vbranch_1217
		and target_66.getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_67(Variable vbranch_1217, VariableAccess target_67) {
		target_67.getTarget()=vbranch_1217
		and target_67.getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getTarget().hasName("__builtin_expect")
		and target_67.getParent().(NotExpr).getParent().(NotExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr().(FunctionCall).getArgument(1) instanceof Literal
}

*/
/*predicate func_68(StmtExpr target_59, Function func, ExprStmt target_68) {
		target_68.getExpr() instanceof FunctionCall
		and target_68.getParent().(IfStmt).getCondition()=target_59
		and target_68.getEnclosingFunction() = func
}

*/
predicate func_69(Variable v__UNIQUE_ID_ddebug995_1217, VariableAccess target_69) {
		target_69.getTarget()=v__UNIQUE_ID_ddebug995_1217
		and target_69.getParent().(AddressOfExpr).getParent().(FunctionCall).getParent().(ExprStmt).getExpr() instanceof FunctionCall
}

predicate func_70(Parameter vdev_priv_1204, AddressOfExpr target_70) {
		target_70.getOperand().(PointerFieldAccess).getTarget().getName()="drm"
		and target_70.getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_priv_1204
}

predicate func_71(Parameter vdev_priv_1204, PointerFieldAccess target_71) {
		target_71.getTarget().getName()="dev"
		and target_71.getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getTarget().getName()="drm"
		and target_71.getQualifier().(AddressOfExpr).getOperand().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vdev_priv_1204
}

predicate func_72(Function func, ExprStmt target_72) {
		target_72.getExpr() instanceof FunctionCall
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_72
}

predicate func_73(Variable vret_1212, Function func, ExprStmt target_73) {
		target_73.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1212
		and target_73.getExpr().(AssignExpr).getRValue() instanceof FunctionCall
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_73
}

predicate func_74(Parameter vsw_context_1205, ExprStmt target_91, VariableAccess target_74) {
		target_74.getTarget()=vsw_context_1205
		and target_74.getParent().(PointerFieldAccess).getParent().(FunctionCall).getParent().(AssignExpr).getRValue() instanceof FunctionCall
		and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getLocation().isBefore(target_74.getLocation())
}

predicate func_75(Parameter vsw_context_1205, Variable vreloc_1211, AssignExpr target_75) {
		target_75.getLValue().(VariableAccess).getTarget()=vreloc_1211
		and target_75.getRValue().(FunctionCall).getTarget().hasName("vmw_validation_mem_alloc")
		and target_75.getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="ctx"
		and target_75.getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
		and target_75.getRValue().(FunctionCall).getArgument(1).(SizeofExprOperator).getValue()="32"
}

predicate func_76(Variable vreloc_1211, Function func, IfStmt target_76) {
		target_76.getCondition().(NotExpr).getOperand().(VariableAccess).getTarget()=vreloc_1211
		and target_76.getThen().(ReturnStmt).getExpr() instanceof UnaryMinusExpr
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_76
}

/*predicate func_77(Variable vreloc_1211, ReturnStmt target_87, PointerDereferenceExpr target_93, VariableAccess target_77) {
		target_77.getTarget()=vreloc_1211
		and target_77.getParent().(NotExpr).getParent().(IfStmt).getThen()=target_87
		and target_93.getOperand().(VariableAccess).getLocation().isBefore(target_77.getLocation())
}

*/
predicate func_78(Parameter vptr_1206, Variable vreloc_1211, AssignExpr target_78) {
		target_78.getLValue().(ValueFieldAccess).getTarget().getName()="location"
		and target_78.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getTarget().getName()="(unknown field)"
		and target_78.getLValue().(ValueFieldAccess).getQualifier().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreloc_1211
		and target_78.getRValue().(VariableAccess).getTarget()=vptr_1206
}

predicate func_79(Variable vvmw_bo_1209, Variable vreloc_1211, Function func, ExprStmt target_79) {
		target_79.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getTarget().getName()="vbo"
		and target_79.getExpr().(AssignExpr).getLValue().(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vreloc_1211
		and target_79.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vvmw_bo_1209
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_79
}

predicate func_80(Parameter vvmw_bo_p_1207, Variable vvmw_bo_1209, Function func, ExprStmt target_80) {
		target_80.getExpr().(AssignExpr).getLValue().(PointerDereferenceExpr).getOperand().(VariableAccess).getTarget()=vvmw_bo_p_1207
		and target_80.getExpr().(AssignExpr).getRValue().(VariableAccess).getTarget()=vvmw_bo_1209
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_80
}

predicate func_81(Function func, ExprStmt target_81) {
		target_81.getExpr() instanceof FunctionCall
		and func.getEntryPoint().(BlockStmt).getAStmt()=target_81
}

predicate func_82(Variable vreloc_1211, PointerFieldAccess target_82) {
		target_82.getTarget().getName()="head"
		and target_82.getQualifier().(VariableAccess).getTarget()=vreloc_1211
}

predicate func_83(Parameter vsw_context_1205, PointerFieldAccess target_83) {
		target_83.getTarget().getName()="bo_relocations"
		and target_83.getQualifier().(VariableAccess).getTarget()=vsw_context_1205
}

predicate func_84(Variable vvmw_bo_1209, AddressOfExpr target_84) {
		target_84.getOperand().(VariableAccess).getTarget()=vvmw_bo_1209
}

predicate func_85(Function func, ExprStmt target_85) {
		target_85.getExpr() instanceof FunctionCall
		and target_85.getEnclosingFunction() = func
}

predicate func_87(Function func, ReturnStmt target_87) {
		target_87.getExpr() instanceof UnaryMinusExpr
		and target_87.getEnclosingFunction() = func
}

predicate func_88(Variable vret_1212, ReturnStmt target_88) {
		target_88.getExpr().(VariableAccess).getTarget()=vret_1212
}

predicate func_89(Function func, BlockStmt target_89) {
		target_89.getStmt(0) instanceof DoStmt
		and target_89.getStmt(1).(ReturnStmt).getExpr() instanceof FunctionCall
		and target_89.getEnclosingFunction() = func
}

predicate func_91(Parameter vsw_context_1205, Variable vvmw_bo_1209, Variable vhandle_1210, Variable vret_1212, ExprStmt target_91) {
		target_91.getExpr().(AssignExpr).getLValue().(VariableAccess).getTarget()=vret_1212
		and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getTarget().hasName("vmw_user_bo_lookup")
		and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getTarget().getName()="filp"
		and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(0).(PointerFieldAccess).getQualifier().(VariableAccess).getTarget()=vsw_context_1205
		and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(1).(VariableAccess).getTarget()=vhandle_1210
		and target_91.getExpr().(AssignExpr).getRValue().(FunctionCall).getArgument(2).(AddressOfExpr).getOperand().(VariableAccess).getTarget()=vvmw_bo_1209
}

predicate func_93(Variable vreloc_1211, PointerDereferenceExpr target_93) {
		target_93.getOperand().(VariableAccess).getTarget()=vreloc_1211
}

from Function func, Parameter vdev_priv_1204, Parameter vsw_context_1205, Parameter vptr_1206, Parameter vvmw_bo_p_1207, Variable vvmw_bo_1209, Variable vhandle_1210, Variable vreloc_1211, Variable vret_1212, Variable v__UNIQUE_ID_ddebug995_1217, Variable vbranch_1217, VariableAccess target_0, UnaryMinusExpr target_2, Initializer target_3, FunctionCall target_4, FunctionCall target_7, FunctionCall target_10, FunctionCall target_11, FunctionCall target_12, FunctionCall target_13, FunctionCall target_14, FunctionCall target_15, EqualityOperation target_46, IfStmt target_47, DeclStmt target_48, VariableAccess target_49, DeclStmt target_50, VariableAccess target_51, VariableAccess target_53, DoStmt target_54, VariableAccess target_69, AddressOfExpr target_70, PointerFieldAccess target_71, ExprStmt target_72, ExprStmt target_73, VariableAccess target_74, AssignExpr target_75, IfStmt target_76, AssignExpr target_78, ExprStmt target_79, ExprStmt target_80, ExprStmt target_81, PointerFieldAccess target_82, PointerFieldAccess target_83, AddressOfExpr target_84, ExprStmt target_85, ReturnStmt target_87, ReturnStmt target_88, BlockStmt target_89, ExprStmt target_91, PointerDereferenceExpr target_93
where
func_0(vsw_context_1205, vvmw_bo_1209, vhandle_1210, target_0)
and func_2(func, target_2)
and func_3(vptr_1206, target_3)
and func_4(vsw_context_1205, target_4)
and func_7(func, target_7)
and func_10(v__UNIQUE_ID_ddebug995_1217, target_10)
and func_11(vvmw_bo_1209, target_84, target_72, target_11)
and func_12(vvmw_bo_1209, target_12)
and func_13(vsw_context_1205, vvmw_bo_1209, vret_1212, target_13)
and func_14(vvmw_bo_1209, target_14)
and func_15(vsw_context_1205, vreloc_1211, target_15)
and not func_18(target_85, func)
and not func_20(vret_1212)
and func_46(vret_1212, target_89, target_46)
and func_47(vret_1212, func, target_47)
and func_48(func, target_48)
and func_49(vptr_1206, target_49)
and func_50(func, target_50)
and func_51(vsw_context_1205, target_91, target_51)
and func_53(vsw_context_1205, vvmw_bo_1209, vhandle_1210, target_53)
and func_54(target_46, func, target_54)
and func_69(v__UNIQUE_ID_ddebug995_1217, target_69)
and func_70(vdev_priv_1204, target_70)
and func_71(vdev_priv_1204, target_71)
and func_72(func, target_72)
and func_73(vret_1212, func, target_73)
and func_74(vsw_context_1205, target_91, target_74)
and func_75(vsw_context_1205, vreloc_1211, target_75)
and func_76(vreloc_1211, func, target_76)
and func_78(vptr_1206, vreloc_1211, target_78)
and func_79(vvmw_bo_1209, vreloc_1211, func, target_79)
and func_80(vvmw_bo_p_1207, vvmw_bo_1209, func, target_80)
and func_81(func, target_81)
and func_82(vreloc_1211, target_82)
and func_83(vsw_context_1205, target_83)
and func_84(vvmw_bo_1209, target_84)
and func_85(func, target_85)
and func_87(func, target_87)
and func_88(vret_1212, target_88)
and func_89(func, target_89)
and func_91(vsw_context_1205, vvmw_bo_1209, vhandle_1210, vret_1212, target_91)
and func_93(vreloc_1211, target_93)
and vdev_priv_1204.getType().hasName("vmw_private *")
and vsw_context_1205.getType().hasName("vmw_sw_context *")
and vptr_1206.getType().hasName("SVGAGuestPtr *")
and vvmw_bo_p_1207.getType().hasName("vmw_bo **")
and vvmw_bo_1209.getType().hasName("vmw_bo *")
and vhandle_1210.getType().hasName("uint32_t")
and vreloc_1211.getType().hasName("vmw_relocation *")
and vret_1212.getType().hasName("int")
and v__UNIQUE_ID_ddebug995_1217.getType().hasName("_ddebug")
and vbranch_1217.getType().hasName("bool")
and vdev_priv_1204.getFunction() = func
and vsw_context_1205.getFunction() = func
and vptr_1206.getFunction() = func
and vvmw_bo_p_1207.getFunction() = func
and vvmw_bo_1209.(LocalVariable).getFunction() = func
and vhandle_1210.(LocalVariable).getFunction() = func
and vreloc_1211.(LocalVariable).getFunction() = func
and vret_1212.(LocalVariable).getFunction() = func
and v__UNIQUE_ID_ddebug995_1217.(LocalVariable).getFunction() = func
and vbranch_1217.(LocalVariable).getFunction() = func
select func, func.getFile().toString() + ":" + func.getLocation().getStartLine().toString()
